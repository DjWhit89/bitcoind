<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.15.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>bitcoind: src/secp256k1 Directory Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="bitcoin.ico"/></td>
  <td id="projectalign">
   <div id="projectname">bitcoind<span id="projectnumber">&#160;2.8</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.15.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('dir_44f34d1e62fda08bdb4ca69ab2d205ae.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">secp256k1 Directory Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-subdirs" class="groupheader"><a id="subdirs" name="subdirs"></a>
Directories</h2></td></tr>
<tr class="memitem:contrib" id="r_contrib"><td class="memItemLeft" align="right" valign="top"><span class="iconfolder"><div class="folder-icon"></div></span>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dir_b0f147e0d78dd6f743f7b009c9930b03.html">contrib</a></td></tr>
<tr class="memitem:doc" id="r_doc"><td class="memItemLeft" align="right" valign="top"><span class="iconfolder"><div class="folder-icon"></div></span>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dir_27fc7c72d0bcf916a5694fd64d85e5bc.html">doc</a></td></tr>
<tr class="memitem:examples" id="r_examples"><td class="memItemLeft" align="right" valign="top"><span class="iconfolder"><div class="folder-icon"></div></span>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dir_e741857438d419bc49ccc02a6a209135.html">examples</a></td></tr>
<tr class="memitem:include" id="r_include"><td class="memItemLeft" align="right" valign="top"><span class="iconfolder"><div class="folder-icon"></div></span>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dir_1b4df0b9bba47cf333db333897c5a5a4.html">include</a></td></tr>
<tr class="memitem:src" id="r_src"><td class="memItemLeft" align="right" valign="top"><span class="iconfolder"><div class="folder-icon"></div></span>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dir_8db2ef784512d48b2a7d00369dfaac28.html">src</a></td></tr>
<tr class="memitem:tools" id="r_tools"><td class="memItemLeft" align="right" valign="top"><span class="iconfolder"><div class="folder-icon"></div></span>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dir_9f0dde52d402d70a74c4ae0c3bb35e51.html">tools</a></td></tr>
</table>
<a name="details" id="details"></a><h2 id="header-details" class="groupheader">Detailed Description</h2>
<p><img src="https://img.shields.io/badge/dependencies-none-success" alt="Dependencies: None" class="inline"/> <a href="https://web.libera.chat/#secp256k1"><img src="https://img.shields.io/badge/irc.libera.chat-%23secp256k1-success" alt="irc.libera.chat #secp256k1" class="inline"/></a></p>
<p>High-performance high-assurance C library for digital signatures and other cryptographic primitives on the secp256k1 elliptic curve.</p>
<p>This library is intended to be the highest quality publicly available library for cryptography on the secp256k1 curve. However, the primary focus of its development has been for usage in the Bitcoin system and usage unlike Bitcoin's may be less well tested, verified, or suffer from a less well thought out interface. Correct usage requires some care and consideration that the library is fit for your application's purpose.</p>
<p>Features:</p><ul>
<li>secp256k1 ECDSA signing/verification and key generation.</li>
<li>Additive and multiplicative tweaking of secret/public keys.</li>
<li>Serialization/parsing of secret keys, public keys, signatures.</li>
<li>Constant time, constant memory access signing and public key generation.</li>
<li>Derandomized ECDSA (via RFC6979 or with a caller provided function.)</li>
<li>Very efficient implementation.</li>
<li>Suitable for embedded systems.</li>
<li>No runtime dependencies.</li>
<li>Optional module for public key recovery.</li>
<li>Optional module for ECDH key exchange.</li>
<li>Optional module for Schnorr signatures according to <a href="https://github.com/bitcoin/bips/blob/master/bip-0340.mediawiki">BIP-340</a>.</li>
<li>Optional module for ElligatorSwift key exchange according to <a href="https://github.com/bitcoin/bips/blob/master/bip-0324.mediawiki">BIP-324</a>.</li>
<li>Optional module for MuSig2 Schnorr multi-signatures according to <a href="https://github.com/bitcoin/bips/blob/master/bip-0327.mediawiki">BIP-327</a>.</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="autotoc_md211"></a>
Implementation details</h1>
<ul>
<li>General<ul>
<li>No runtime heap allocation.</li>
<li>Extensive testing infrastructure.</li>
<li>Structured to facilitate review and analysis.</li>
<li>Intended to be portable to any system with a C89 compiler and uint64_t support.</li>
<li>No use of floating types.</li>
<li>Expose only higher level interfaces to minimize the API surface and improve application security. ("Be difficult to use insecurely.")</li>
</ul>
</li>
<li>Field operations<ul>
<li>Optimized implementation of arithmetic modulo the curve's field size (2^256 - 0x1000003D1).<ul>
<li>Using 5 52-bit limbs</li>
<li>Using 10 26-bit limbs (including hand-optimized assembly for 32-bit ARM, by Wladimir J. van der Laan).<ul>
<li>This is an experimental feature that has not received enough scrutiny to satisfy the standard of quality of this library but is made available for testing and review by the community.</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>Scalar operations<ul>
<li>Optimized implementation without data-dependent branches of arithmetic modulo the curve's order.<ul>
<li>Using 4 64-bit limbs (relying on __int128 support in the compiler).</li>
<li>Using 8 32-bit limbs.</li>
</ul>
</li>
</ul>
</li>
<li>Modular inverses (both field elements and scalars) based on <a href="https://gcd.cr.yp.to/index.html">safegcd</a> with some modifications, and a variable-time variant (by Peter Dettman).</li>
<li>Group operations<ul>
<li>Point addition formula specifically simplified for the curve equation (y^2 = x^3 + 7).</li>
<li>Use addition between points in Jacobian and affine coordinates where possible.</li>
<li>Use a unified addition/doubling formula where necessary to avoid data-dependent branches.</li>
<li>Point/x comparison without a field inversion by comparison in the Jacobian coordinate space.</li>
</ul>
</li>
<li>Point multiplication for verification (a*P + b*G).<ul>
<li>Use wNAF notation for point multiplicands.</li>
<li>Use a much larger window for multiples of G, using precomputed multiples.</li>
<li>Use Shamir's trick to do the multiplication with the public key and the generator simultaneously.</li>
<li>Use secp256k1's efficiently-computable endomorphism to split the P multiplicand into 2 half-sized ones.</li>
</ul>
</li>
<li>Point multiplication for signing<ul>
<li>Use a precomputed table of multiples of powers of 16 multiplied with the generator, so general multiplication becomes a series of additions.</li>
<li>Intended to be completely free of timing sidechannels for secret-key operations (on reasonable hardware/toolchains)<ul>
<li>Access the table with branch-free conditional moves so memory access is uniform.</li>
<li>No data-dependent branches</li>
</ul>
</li>
<li>Optional runtime blinding which attempts to frustrate differential power analysis.</li>
<li>The precomputed tables add and eventually subtract points for which no known scalar (secret key) is known, preventing even an attacker with control over the secret key used to control the data internally.</li>
</ul>
</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="autotoc_md212"></a>
Obtaining and verifying</h1>
<p>The git tag for each release (e.g. <span class="tt">v0.6.0</span>) is GPG-signed by one of the maintainers. For a fully verified build of this project, it is recommended to obtain this repository via git, obtain the GPG keys of the signing maintainer(s), and then verify the release tag's signature using git.</p>
<p>This can be done with the following steps:</p>
<ol type="1">
<li>Obtain the GPG keys listed in SECURITY.md.</li>
<li>If possible, cross-reference these key IDs with another source controlled by its owner (e.g. social media, personal website). This is to mitigate the unlikely case that incorrect content is being presented by this repository.</li>
<li>Clone the repository: <div class="fragment"><div class="line">git clone https://github.com/bitcoin-core/secp256k1</div>
</div><!-- fragment --></li>
<li>Check out the latest release tag, e.g. <div class="fragment"><div class="line">git checkout v0.6.0</div>
</div><!-- fragment --></li>
<li>Use git to verify the GPG signature: <div class="fragment"><div class="line">% git tag -v v0.6.0 | grep -C 3 &#39;Good signature&#39;</div>
<div class="line"> </div>
<div class="line">gpg: Signature made Mon 04 Nov 2024 12:14:44 PM EST</div>
<div class="line">gpg:                using RSA key 4BBB845A6F5A65A69DFAEC234861DBF262123605</div>
<div class="line">gpg: Good signature from &quot;Jonas Nick &lt;jonas@n-ck.net&gt;&quot; [unknown]</div>
<div class="line">gpg:                 aka &quot;Jonas Nick &lt;jonasd.nick@gmail.com&gt;&quot; [unknown]</div>
<div class="line">gpg: WARNING: This key is not certified with a trusted signature!</div>
<div class="line">gpg:          There is no indication that the signature belongs to the owner.</div>
<div class="line">Primary key fingerprint: 36C7 1A37 C9D9 88BD E825  08D9 B1A7 0E4F 8DCD 0366</div>
<div class="line">     Subkey fingerprint: 4BBB 845A 6F5A 65A6 9DFA  EC23 4861 DBF2 6212 3605</div>
</div><!-- fragment --></li>
</ol>
<h1 class="doxsection"><a class="anchor" id="autotoc_md213"></a>
Building with Autotools</h1>
<pre class="fragment">$ ./autogen.sh       # Generate a ./configure script
$ ./configure        # Generate a build system
$ make               # Run the actual build process
$ make check         # Run the test suite
$ sudo make install  # Install the library into the system (optional)
</pre><p>To compile optional modules (such as Schnorr signatures), you need to run <span class="tt">./configure</span> with additional flags (such as <span class="tt">--enable-module-schnorrsig</span>). Run <span class="tt">./configure --help</span> to see the full list of available flags.</p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md214"></a>
Building with CMake</h1>
<p>To maintain a pristine source tree, CMake encourages to perform an out-of-source build by using a separate dedicated build tree.</p>
<h2 class="doxsection"><a class="anchor" id="autotoc_md215"></a>
Building on POSIX systems</h2>
<pre class="fragment">$ cmake -B build              # Generate a build system in subdirectory "build"
$ cmake --build build         # Run the actual build process
$ ctest --test-dir build      # Run the test suite
$ sudo cmake --install build  # Install the library into the system (optional)
</pre><p>To compile optional modules (such as Schnorr signatures), you need to run <span class="tt">cmake</span> with additional flags (such as <span class="tt">-DSECP256K1_ENABLE_MODULE_SCHNORRSIG=ON</span>). Run <span class="tt">cmake -<a class="el" href="util__tests_8cpp.html#a111da81ae5883147168bbb8366377b10">B</a> build -LH</span> or <span class="tt">ccmake -<a class="el" href="util__tests_8cpp.html#a111da81ae5883147168bbb8366377b10">B</a> build</span> to see the full list of available flags.</p>
<h2 class="doxsection"><a class="anchor" id="autotoc_md216"></a>
Cross compiling</h2>
<p>To alleviate issues with cross compiling, preconfigured toolchain files are available in the <span class="tt">cmake</span> directory. For example, to cross compile for Windows: </p><pre class="fragment">$ cmake -B build -DCMAKE_TOOLCHAIN_FILE=cmake/x86_64-w64-mingw32.toolchain.cmake
</pre><p>To cross compile for Android with <a href="https://developer.android.com/ndk/guides/cmake">NDK</a> (using NDK's toolchain file, and assuming the <span class="tt">ANDROID_NDK_ROOT</span> environment variable has been set): </p><pre class="fragment">$ cmake -B build -DCMAKE_TOOLCHAIN_FILE="${ANDROID_NDK_ROOT}/build/cmake/android.toolchain.cmake" -DANDROID_ABI=arm64-v8a -DANDROID_PLATFORM=28
</pre><h2 class="doxsection"><a class="anchor" id="autotoc_md217"></a>
Building on Windows</h2>
<p>The following example assumes Visual Studio 2022. Using clang-cl is recommended.</p>
<p>In "Developer Command Prompt for VS 2022": </p><pre class="fragment">&gt;cmake -B build -T ClangCL
&gt;cmake --build build --config RelWithDebInfo
</pre><h1 class="doxsection"><a class="anchor" id="autotoc_md218"></a>
Usage examples</h1>
<p>Usage examples can be found in the [examples](examples) directory. To compile them you need to configure with <span class="tt">--enable-examples</span>.</p><ul>
<li><a href="examples/ecdsa.c">ECDSA example</a></li>
<li><a href="examples/schnorr.c">Schnorr signatures example</a></li>
<li><a href="examples/ecdh.c">Deriving a shared secret (ECDH) example</a></li>
<li><a href="examples/ellswift.c">ElligatorSwift key exchange example</a></li>
<li><a href="examples/musig.c">MuSig2 Schnorr multi-signatures example</a></li>
</ul>
<p>To compile the examples, make sure the corresponding modules are enabled.</p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md219"></a>
Benchmark</h1>
<p>If configured with <span class="tt">--enable-benchmark</span> (which is the default), binaries for benchmarking the libsecp256k1 functions will be present in the root directory after the build.</p>
<p>To print the benchmark result to the command line: </p><pre class="fragment">$ ./bench_name
</pre><p>To create a CSV file for the benchmark result : </p><pre class="fragment">$ ./bench_name | sed '2d;s/ \{1,\}//g' &gt; bench_name.csv
</pre><h1 class="doxsection"><a class="anchor" id="autotoc_md220"></a>
Reporting a vulnerability</h1>
<p>See SECURITY.md</p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md221"></a>
Contributing to libsecp256k1</h1>
<p>See CONTRIBUTING.md </p>
</div><!-- contents -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a href="dir_44f34d1e62fda08bdb4ca69ab2d205ae.html">secp256k1</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.15.0 </li>
  </ul>
</div>
</body>
</html>
