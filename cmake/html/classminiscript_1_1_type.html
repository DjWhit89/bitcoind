<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.15.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>bitcoind: Type Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="bitcoin.ico"/></td>
  <td id="projectalign">
   <div id="projectname">bitcoind<span id="projectnumber">&#160;2.8</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.15.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('classminiscript_1_1_type.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">Type Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="miniscript_8h_source.html">miniscript.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-pub-methods" class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:aa58345ef655940616bd03f35d4c79b6b" id="r_aa58345ef655940616bd03f35d4c79b6b"><td class="memItemLeft" align="right" valign="top">constexpr Type&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa58345ef655940616bd03f35d4c79b6b">operator|</a> (Type x) const</td></tr>
<tr class="memdesc:aa58345ef655940616bd03f35d4c79b6b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the type with the union of properties.  <br /></td></tr>
<tr class="memitem:ac509dfc3e180f1d2aa512af53908c969" id="r_ac509dfc3e180f1d2aa512af53908c969"><td class="memItemLeft" align="right" valign="top">constexpr Type&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac509dfc3e180f1d2aa512af53908c969">operator&amp;</a> (Type x) const</td></tr>
<tr class="memdesc:ac509dfc3e180f1d2aa512af53908c969"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the type with the intersection of properties.  <br /></td></tr>
<tr class="memitem:a5fee719ce71eb863297aae67217ac617" id="r_a5fee719ce71eb863297aae67217ac617"><td class="memItemLeft" align="right" valign="top">constexpr bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5fee719ce71eb863297aae67217ac617">operator&lt;&lt;</a> (Type x) const</td></tr>
<tr class="memdesc:a5fee719ce71eb863297aae67217ac617"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check whether the left hand's properties are superset of the right's (= left is a subtype of right).  <br /></td></tr>
<tr class="memitem:a2bce9880c3beb4640853608a0ef156f6" id="r_a2bce9880c3beb4640853608a0ef156f6"><td class="memItemLeft" align="right" valign="top">constexpr bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2bce9880c3beb4640853608a0ef156f6">operator&lt;</a> (Type x) const</td></tr>
<tr class="memdesc:a2bce9880c3beb4640853608a0ef156f6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Comparison operator to enable use in sets/maps (total ordering incompatible with &lt;&lt;).  <br /></td></tr>
<tr class="memitem:a3a1d5901e2080b0e618344205105437f" id="r_a3a1d5901e2080b0e618344205105437f"><td class="memItemLeft" align="right" valign="top">constexpr bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3a1d5901e2080b0e618344205105437f">operator==</a> (Type x) const</td></tr>
<tr class="memdesc:a3a1d5901e2080b0e618344205105437f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Equality operator.  <br /></td></tr>
<tr class="memitem:ae263399c804447fedd628d3b3698b858" id="r_ae263399c804447fedd628d3b3698b858"><td class="memItemLeft" align="right" valign="top">constexpr Type&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae263399c804447fedd628d3b3698b858">If</a> (bool x) const</td></tr>
<tr class="memdesc:ae263399c804447fedd628d3b3698b858"><td class="mdescLeft">&#160;</td><td class="mdescRight">The empty type if x is false, itself otherwise.  <br /></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-friends" class="groupheader"><a id="friends" name="friends"></a>
Friends</h2></td></tr>
<tr class="memitem:aa18c69f8bbcd4b37faa9d96250ffad7f" id="r_aa18c69f8bbcd4b37faa9d96250ffad7f"><td class="memItemLeft" align="right" valign="top">consteval Type&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa18c69f8bbcd4b37faa9d96250ffad7f">operator&quot;&quot;_mst</a> (const char *c, size_t l)</td></tr>
<tr class="memdesc:aa18c69f8bbcd4b37faa9d96250ffad7f"><td class="mdescLeft">&#160;</td><td class="mdescRight">The only way to publicly construct a <a class="el" href="classminiscript_1_1_type.html">Type</a> is using this literal operator.  <br /></td></tr>
</table>
<a name="details" id="details"></a><h2 id="header-details" class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This type encapsulates the miniscript type system properties.</p>
<p>Every miniscript expression is one of 4 basic types, and additionally has a number of boolean type properties.</p>
<p>The basic types are:</p><ul>
<li>"B" <a class="el" href="class_base.html" title="(Un)serialize a number as raw byte or 2 hexadecimal chars.">Base</a>:<ul>
<li>Takes its inputs from the top of the stack.</li>
<li>When satisfied, pushes a nonzero value of up to 4 bytes onto the stack.</li>
<li>When dissatisfied, pushes a 0 onto the stack.</li>
<li>This is used for most expressions, and required for the top level one.</li>
<li>For example: older(n) = &lt;n&gt; OP_CHECKSEQUENCEVERIFY.</li>
</ul>
</li>
<li>"V" Verify:<ul>
<li>Takes its inputs from the top of the stack.</li>
<li>When satisfied, pushes nothing.</li>
<li>Cannot be dissatisfied.</li>
<li>This can be obtained by adding an OP_VERIFY to a B, modifying the last opcode of a B to its -VERIFY version (only for OP_CHECKSIG, OP_CHECKSIGVERIFY, OP_NUMEQUAL and OP_EQUAL), or by combining a V fragment under some conditions.</li>
<li>For example vc:pk_k(key) = &lt;key&gt; OP_CHECKSIGVERIFY</li>
</ul>
</li>
<li>"K" Key:<ul>
<li>Takes its inputs from the top of the stack.</li>
<li>Becomes a B when followed by OP_CHECKSIG.</li>
<li>Always pushes a public key onto the stack, for which a signature is to be provided to satisfy the expression.</li>
<li>For example pk_h(key) = OP_DUP OP_HASH160 &lt;Hash160(key)&gt; OP_EQUALVERIFY</li>
</ul>
</li>
<li>"W" Wrapped:<ul>
<li>Takes its input from one below the top of the stack.</li>
<li>When satisfied, pushes a nonzero value (like B) on top of the stack, or one below.</li>
<li>When dissatisfied, pushes 0 op top of the stack or one below.</li>
<li>Is always "OP_SWAP [B]" or "OP_TOALTSTACK [B] OP_FROMALTSTACK".</li>
<li>For example sc:pk_k(key) = OP_SWAP &lt;key&gt; OP_CHECKSIG</li>
</ul>
</li>
</ul>
<p>There are type properties that help reasoning about correctness:</p><ul>
<li>"z" Zero-arg:<ul>
<li>Is known to always consume exactly 0 stack elements.</li>
<li>For example after(n) = &lt;n&gt; OP_CHECKLOCKTIMEVERIFY</li>
</ul>
</li>
<li>"o" One-arg:<ul>
<li>Is known to always consume exactly 1 stack element.</li>
<li>Conflicts with property 'z'</li>
<li>For example <a class="el" href="namespacesha256.html" title="Internal SHA-256 implementation.">sha256(hash)</a> = OP_SIZE 32 OP_EQUALVERIFY OP_SHA256 &lt;hash&gt; OP_EQUAL</li>
</ul>
</li>
<li>"n" Nonzero:<ul>
<li>For every way this expression can be satisfied, a satisfaction exists that never needs a zero top stack element.</li>
<li>Conflicts with property 'z' and with type 'W'.</li>
</ul>
</li>
<li>"d" Dissatisfiable:<ul>
<li>There is an easy way to construct a dissatisfaction for this expression.</li>
<li>Conflicts with type 'V'.</li>
</ul>
</li>
<li>"u" Unit:<ul>
<li>In case of satisfaction, an exact 1 is put on the stack (rather than just nonzero).</li>
<li>Conflicts with type 'V'.</li>
</ul>
</li>
</ul>
<p>Additional type properties help reasoning about nonmalleability:</p><ul>
<li>"e" Expression:<ul>
<li>This implies property 'd', but the dissatisfaction is nonmalleable.</li>
<li>This generally requires 'e' for all subexpressions which are invoked for that dissatisfaction, and property 'f' for the unexecuted subexpressions in that case.</li>
<li>Conflicts with type 'V'.</li>
</ul>
</li>
<li>"f" Forced:<ul>
<li>Dissatisfactions (if any) for this expression always involve at least one signature.</li>
<li>Is always true for type 'V'.</li>
</ul>
</li>
<li>"s" Safe:<ul>
<li>Satisfactions for this expression always involve at least one signature.</li>
</ul>
</li>
<li>"m" Nonmalleable:<ul>
<li>For every way this expression can be satisfied (which may be none), a nonmalleable satisfaction exists.</li>
<li>This generally requires 'm' for all subexpressions, and 'e' for all subexpressions which are dissatisfied when satisfying the parent.</li>
</ul>
</li>
</ul>
<p>One type property is an implementation detail:</p><ul>
<li>"x" Expensive verify:<ul>
<li>Expressions with this property have a script whose last opcode is not EQUAL, CHECKSIG, or CHECKMULTISIG.</li>
<li>Not having this property means that it can be converted to a V at no cost (by switching to the -VERIFY version of the last opcode).</li>
</ul>
</li>
</ul>
<p>Five more type properties for representing timelock information. Spend paths in miniscripts containing conflicting timelocks and heightlocks cannot be spent together. This helps users detect if miniscript does not match the semantic behaviour the user expects.</p><ul>
<li>"g" Whether the branch contains a relative time timelock</li>
<li>"h" Whether the branch contains a relative height timelock</li>
<li>"i" Whether the branch contains an absolute time timelock</li>
<li>"j" Whether the branch contains an absolute height timelock</li>
<li>"k"<ul>
<li>Whether all satisfactions of this expression don't contain a mix of heightlock and timelock of the same type.</li>
<li>If the miniscript does not have the "k" property, the miniscript template will not match the user expectation of the corresponding spending policy. For each of these properties the subset rule holds: an expression with properties X, Y, and Z, is also valid in places where an X, a Y, a Z, an XY, ... is expected. </li>
</ul>
</li>
</ul>
</div><a name="doc-func-members" id="doc-func-members"></a><h2 id="header-doc-func-members" class="groupheader">Member Function Documentation</h2>
<a id="ae263399c804447fedd628d3b3698b858" name="ae263399c804447fedd628d3b3698b858"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae263399c804447fedd628d3b3698b858">&#9670;&#160;</a></span>If()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Type If </td>
          <td>(</td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>x</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span><span class="mlabel constexpr">constexpr</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The empty type if x is false, itself otherwise. </p>

</div>
</div>
<a id="ac509dfc3e180f1d2aa512af53908c969" name="ac509dfc3e180f1d2aa512af53908c969"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac509dfc3e180f1d2aa512af53908c969">&#9670;&#160;</a></span>operator&amp;()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Type operator&amp; </td>
          <td>(</td>
          <td class="paramtype">Type</td>          <td class="paramname"><span class="paramname"><em>x</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span><span class="mlabel constexpr">constexpr</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Compute the type with the intersection of properties. </p>

</div>
</div>
<a id="a2bce9880c3beb4640853608a0ef156f6" name="a2bce9880c3beb4640853608a0ef156f6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2bce9880c3beb4640853608a0ef156f6">&#9670;&#160;</a></span>operator&lt;()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool operator&lt; </td>
          <td>(</td>
          <td class="paramtype">Type</td>          <td class="paramname"><span class="paramname"><em>x</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span><span class="mlabel constexpr">constexpr</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Comparison operator to enable use in sets/maps (total ordering incompatible with &lt;&lt;). </p>

</div>
</div>
<a id="a5fee719ce71eb863297aae67217ac617" name="a5fee719ce71eb863297aae67217ac617"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5fee719ce71eb863297aae67217ac617">&#9670;&#160;</a></span>operator&lt;&lt;()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool operator&lt;&lt; </td>
          <td>(</td>
          <td class="paramtype">Type</td>          <td class="paramname"><span class="paramname"><em>x</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span><span class="mlabel constexpr">constexpr</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Check whether the left hand's properties are superset of the right's (= left is a subtype of right). </p>

</div>
</div>
<a id="a3a1d5901e2080b0e618344205105437f" name="a3a1d5901e2080b0e618344205105437f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3a1d5901e2080b0e618344205105437f">&#9670;&#160;</a></span>operator==()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool operator== </td>
          <td>(</td>
          <td class="paramtype">Type</td>          <td class="paramname"><span class="paramname"><em>x</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span><span class="mlabel constexpr">constexpr</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Equality operator. </p>

</div>
</div>
<a id="aa58345ef655940616bd03f35d4c79b6b" name="aa58345ef655940616bd03f35d4c79b6b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa58345ef655940616bd03f35d4c79b6b">&#9670;&#160;</a></span>operator|()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Type operator| </td>
          <td>(</td>
          <td class="paramtype">Type</td>          <td class="paramname"><span class="paramname"><em>x</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span><span class="mlabel constexpr">constexpr</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Compute the type with the union of properties. </p>

</div>
</div>
<a name="doc-related-members" id="doc-related-members"></a><h2 id="header-doc-related-members" class="groupheader">Friends And Related Symbol Documentation</h2>
<a id="aa18c69f8bbcd4b37faa9d96250ffad7f" name="aa18c69f8bbcd4b37faa9d96250ffad7f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa18c69f8bbcd4b37faa9d96250ffad7f">&#9670;&#160;</a></span>operator&quot;&quot;_mst</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Type operator&quot;&quot;_mst </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>c</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>l</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel friend">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The only way to publicly construct a <a class="el" href="classminiscript_1_1_type.html">Type</a> is using this literal operator. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>src/script/<a class="el" href="miniscript_8h_source.html">miniscript.h</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a href="namespaceminiscript.html">miniscript</a></li><li class="navelem"><a href="classminiscript_1_1_type.html">Type</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.15.0 </li>
  </ul>
</div>
</body>
</html>
