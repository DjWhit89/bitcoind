<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.15.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>bitcoind: src/secp256k1/src/modules/ellswift/main_impl.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="bitcoin.ico"/></td>
  <td id="projectalign">
   <div id="projectname">bitcoind<span id="projectnumber">&#160;2.8</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.15.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('ellswift_2main__impl_8h.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">main_impl.h File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="secp256k1_8h_source.html">../../../include/secp256k1.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="secp256k1__ellswift_8h_source.html">../../../include/secp256k1_ellswift.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="eckey_8h_source.html">../../eckey.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="secp256k1_2src_2hash_8h_source.html">../../hash.h</a>&quot;</code><br />
</div>
<p><a href="ellswift_2main__impl_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-func-members" class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ae507a00028bb585ea530824d15630dc6" id="r_ae507a00028bb585ea530824d15630dc6"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae507a00028bb585ea530824d15630dc6">secp256k1_ellswift_encode</a> (const <a class="el" href="secp256k1_8h.html#a282ec9e6dfec8c35955c3eb2f7476e5e">secp256k1_context</a> *ctx, unsigned char *ell64, const <a class="el" href="structsecp256k1__pubkey.html">secp256k1_pubkey</a> *pubkey, const unsigned char *rnd32)</td></tr>
<tr class="memitem:a48e79201d56ff62c5e952647ac1563e7" id="r_a48e79201d56ff62c5e952647ac1563e7"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a48e79201d56ff62c5e952647ac1563e7">secp256k1_ellswift_create</a> (const <a class="el" href="secp256k1_8h.html#a282ec9e6dfec8c35955c3eb2f7476e5e">secp256k1_context</a> *ctx, unsigned char *ell64, const unsigned char *seckey32, const unsigned char *auxrnd32)</td></tr>
<tr class="memitem:ae88ee4e67572f02768f89e5cc0f271a7" id="r_ae88ee4e67572f02768f89e5cc0f271a7"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae88ee4e67572f02768f89e5cc0f271a7">secp256k1_ellswift_decode</a> (const <a class="el" href="secp256k1_8h.html#a282ec9e6dfec8c35955c3eb2f7476e5e">secp256k1_context</a> *ctx, <a class="el" href="structsecp256k1__pubkey.html">secp256k1_pubkey</a> *pubkey, const unsigned char *ell64)</td></tr>
<tr class="memitem:a4b4ed069c280c8d4caea2afa7e43779a" id="r_a4b4ed069c280c8d4caea2afa7e43779a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4b4ed069c280c8d4caea2afa7e43779a">secp256k1_ellswift_xdh</a> (const <a class="el" href="secp256k1_8h.html#a282ec9e6dfec8c35955c3eb2f7476e5e">secp256k1_context</a> *ctx, unsigned char *output, const unsigned char *ell_a64, const unsigned char *ell_b64, const unsigned char *seckey32, int party, <a class="el" href="secp256k1__ellswift_8h.html#ac1ac7f0ce1fa1f4bbbe054c3128a5640">secp256k1_ellswift_xdh_hash_function</a> hashfp, void *data)</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-var-members" class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a2e7ab4d967f95dddbbcf9a72f067ca1f" id="r_a2e7ab4d967f95dddbbcf9a72f067ca1f"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="secp256k1__ellswift_8h.html#ac1ac7f0ce1fa1f4bbbe054c3128a5640">secp256k1_ellswift_xdh_hash_function</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2e7ab4d967f95dddbbcf9a72f067ca1f">secp256k1_ellswift_xdh_hash_function_prefix</a> = ellswift_xdh_hash_function_prefix</td></tr>
<tr class="memitem:a9e66d67ac918016de7350e0acfe9bcda" id="r_a9e66d67ac918016de7350e0acfe9bcda"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="secp256k1__ellswift_8h.html#ac1ac7f0ce1fa1f4bbbe054c3128a5640">secp256k1_ellswift_xdh_hash_function</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9e66d67ac918016de7350e0acfe9bcda">secp256k1_ellswift_xdh_hash_function_bip324</a> = ellswift_xdh_hash_function_bip324</td></tr>
</table>
<a name="doc-func-members" id="doc-func-members"></a><h2 id="header-doc-func-members" class="groupheader">Function Documentation</h2>
<a id="a48e79201d56ff62c5e952647ac1563e7" name="a48e79201d56ff62c5e952647ac1563e7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a48e79201d56ff62c5e952647ac1563e7">&#9670;&#160;</a></span>secp256k1_ellswift_create()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int secp256k1_ellswift_create </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="secp256k1_8h.html#a282ec9e6dfec8c35955c3eb2f7476e5e">secp256k1_context</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *</td>          <td class="paramname"><span class="paramname"><em>ell64</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *</td>          <td class="paramname"><span class="paramname"><em>seckey32</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *</td>          <td class="paramname"><span class="paramname"><em>auxrnd32</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute an ElligatorSwift public key for a secret key.</p>
<p>Returns: 1: secret was valid, public key was stored. 0: secret was invalid, try again. Args: ctx: pointer to a context object (not secp256k1_context_static) Out: ell64: pointer to a 64-byte array to receive the ElligatorSwift public key In: seckey32: pointer to a 32-byte secret key auxrnd32: (optional) pointer to 32 bytes of randomness</p>
<p>Constant time in seckey and auxrnd32, but not in the resulting public key.</p>
<p>It is recommended that auxrnd32 contains 32 uniformly random bytes, though it is optional (and does result in encodings that are indistinguishable from uniform even without any auxrnd32). It differs from the (mandatory) rnd32 argument to secp256k1_ellswift_encode in this regard.</p>
<p>This function can be used instead of calling secp256k1_ec_pubkey_create followed by secp256k1_ellswift_encode. It is safer, as it uses the secret key as entropy for the encoding (supplemented with auxrnd32, if provided).</p>
<p>Like secp256k1_ellswift_encode, this function does not guarantee that the computed encoding is stable across versions of the library, even if all arguments (including auxrnd32) are the same. </p>

</div>
</div>
<a id="ae88ee4e67572f02768f89e5cc0f271a7" name="ae88ee4e67572f02768f89e5cc0f271a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae88ee4e67572f02768f89e5cc0f271a7">&#9670;&#160;</a></span>secp256k1_ellswift_decode()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int secp256k1_ellswift_decode </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="secp256k1_8h.html#a282ec9e6dfec8c35955c3eb2f7476e5e">secp256k1_context</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structsecp256k1__pubkey.html">secp256k1_pubkey</a> *</td>          <td class="paramname"><span class="paramname"><em>pubkey</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *</td>          <td class="paramname"><span class="paramname"><em>ell64</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Decode a 64-bytes ElligatorSwift encoded public key.</p>
<p>Returns: always 1 Args: ctx: pointer to a context object Out: pubkey: pointer to a <a class="el" href="structsecp256k1__pubkey.html">secp256k1_pubkey</a> that will be filled In: ell64: pointer to a 64-byte array to decode</p>
<p>This function runs in variable time. </p>

</div>
</div>
<a id="ae507a00028bb585ea530824d15630dc6" name="ae507a00028bb585ea530824d15630dc6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae507a00028bb585ea530824d15630dc6">&#9670;&#160;</a></span>secp256k1_ellswift_encode()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int secp256k1_ellswift_encode </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="secp256k1_8h.html#a282ec9e6dfec8c35955c3eb2f7476e5e">secp256k1_context</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *</td>          <td class="paramname"><span class="paramname"><em>ell64</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structsecp256k1__pubkey.html">secp256k1_pubkey</a> *</td>          <td class="paramname"><span class="paramname"><em>pubkey</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *</td>          <td class="paramname"><span class="paramname"><em>rnd32</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Construct a 64-byte ElligatorSwift encoding of a given pubkey.</p>
<p>Returns: 1 always. Args: ctx: pointer to a context object Out: ell64: pointer to a 64-byte array to be filled In: pubkey: pointer to a <a class="el" href="structsecp256k1__pubkey.html">secp256k1_pubkey</a> containing an initialized public key rnd32: pointer to 32 bytes of randomness</p>
<p>It is recommended that rnd32 consists of 32 uniformly random bytes, not known to any adversary trying to detect whether public keys are being encoded, though 16 bytes of randomness (padded to an array of 32 bytes, e.g., with zeros) suffice to make the result indistinguishable from uniform. The randomness in rnd32 must not be a deterministic function of the pubkey (it can be derived from the private key, though).</p>
<p>It is not guaranteed that the computed encoding is stable across versions of the library, even if all arguments to this function (including rnd32) are the same.</p>
<p>This function runs in variable time. </p>

</div>
</div>
<a id="a4b4ed069c280c8d4caea2afa7e43779a" name="a4b4ed069c280c8d4caea2afa7e43779a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4b4ed069c280c8d4caea2afa7e43779a">&#9670;&#160;</a></span>secp256k1_ellswift_xdh()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int secp256k1_ellswift_xdh </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="secp256k1_8h.html#a282ec9e6dfec8c35955c3eb2f7476e5e">secp256k1_context</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *</td>          <td class="paramname"><span class="paramname"><em>output</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *</td>          <td class="paramname"><span class="paramname"><em>ell_a64</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *</td>          <td class="paramname"><span class="paramname"><em>ell_b64</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *</td>          <td class="paramname"><span class="paramname"><em>seckey32</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>party</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="secp256k1__ellswift_8h.html#ac1ac7f0ce1fa1f4bbbe054c3128a5640">secp256k1_ellswift_xdh_hash_function</a></td>          <td class="paramname"><span class="paramname"><em>hashfp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *</td>          <td class="paramname"><span class="paramname"><em>data</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Given a private key, and ElligatorSwift public keys sent in both directions, compute a shared secret using x-only Elliptic Curve Diffie-Hellman (ECDH).</p>
<p>Returns: 1: shared secret was successfully computed 0: secret was invalid or hashfp returned 0 Args: ctx: pointer to a context object. Out: output: pointer to an array to be filled by hashfp. In: ell_a64: pointer to the 64-byte encoded public key of party A (will not be NULL) ell_b64: pointer to the 64-byte encoded public key of party B (will not be NULL) seckey32: pointer to our 32-byte secret key party: boolean indicating which party we are: zero if we are party A, non-zero if we are party B. seckey32 must be the private key corresponding to that party's ell_?64. This correspondence is not checked. hashfp: pointer to a hash function. data: arbitrary data pointer passed through to hashfp.</p>
<p>Constant time in seckey32.</p>
<p>This function is more efficient than decoding the public keys, and performing ECDH on them. </p>

</div>
</div>
<a name="doc-var-members" id="doc-var-members"></a><h2 id="header-doc-var-members" class="groupheader">Variable Documentation</h2>
<a id="a9e66d67ac918016de7350e0acfe9bcda" name="a9e66d67ac918016de7350e0acfe9bcda"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9e66d67ac918016de7350e0acfe9bcda">&#9670;&#160;</a></span>secp256k1_ellswift_xdh_hash_function_bip324</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="secp256k1__ellswift_8h.html#ac1ac7f0ce1fa1f4bbbe054c3128a5640">secp256k1_ellswift_xdh_hash_function</a> secp256k1_ellswift_xdh_hash_function_bip324 = ellswift_xdh_hash_function_bip324</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a2e7ab4d967f95dddbbcf9a72f067ca1f" name="a2e7ab4d967f95dddbbcf9a72f067ca1f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2e7ab4d967f95dddbbcf9a72f067ca1f">&#9670;&#160;</a></span>secp256k1_ellswift_xdh_hash_function_prefix</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="secp256k1__ellswift_8h.html#ac1ac7f0ce1fa1f4bbbe054c3128a5640">secp256k1_ellswift_xdh_hash_function</a> secp256k1_ellswift_xdh_hash_function_prefix = ellswift_xdh_hash_function_prefix</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a href="dir_44f34d1e62fda08bdb4ca69ab2d205ae.html">secp256k1</a></li><li class="navelem"><a href="dir_8db2ef784512d48b2a7d00369dfaac28.html">src</a></li><li class="navelem"><a href="dir_403fe05abfd2d392aa3c0b8c300f7bf6.html">modules</a></li><li class="navelem"><a href="dir_5480996ceb324424f6134b43462bd33c.html">ellswift</a></li><li class="navelem"><a href="ellswift_2main__impl_8h.html">main_impl.h</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.15.0 </li>
  </ul>
</div>
</body>
</html>
