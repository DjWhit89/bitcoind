<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.15.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>bitcoind: src/coins.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="bitcoin.ico"/></td>
  <td id="projectalign">
   <div id="projectname">bitcoind<span id="projectnumber">&#160;2.8</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.15.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('coins_8h.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">coins.h File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;<a class="el" href="compressor_8h_source.html">compressor.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="core__memusage_8h_source.html">core_memusage.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="memusage_8h_source.html">memusage.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="primitives_2transaction_8h_source.html">primitives/transaction.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="serialize_8h_source.html">serialize.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="pool_8h_source.html">support/allocators/pool.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="uint256_8h_source.html">uint256.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="check_8h_source.html">util/check.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="hasher_8h_source.html">util/hasher.h</a>&gt;</code><br />
<code>#include &lt;cassert&gt;</code><br />
<code>#include &lt;cstdint&gt;</code><br />
<code>#include &lt;functional&gt;</code><br />
<code>#include &lt;unordered_map&gt;</code><br />
</div>
<p><a href="coins_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-nested-classes" class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:Coin" id="r_Coin"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_coin.html">Coin</a></td></tr>
<tr class="memitem:CCoinsCacheEntry" id="r_CCoinsCacheEntry"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_c_coins_cache_entry.html">CCoinsCacheEntry</a></td></tr>
<tr class="memitem:CCoinsViewCursor" id="r_CCoinsViewCursor"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_c_coins_view_cursor.html">CCoinsViewCursor</a></td></tr>
<tr class="memitem:CoinsViewCacheCursor" id="r_CoinsViewCacheCursor"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_coins_view_cache_cursor.html">CoinsViewCacheCursor</a></td></tr>
<tr class="memitem:CCoinsView" id="r_CCoinsView"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_c_coins_view.html">CCoinsView</a></td></tr>
<tr class="memitem:CCoinsViewBacked" id="r_CCoinsViewBacked"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_c_coins_view_backed.html">CCoinsViewBacked</a></td></tr>
<tr class="memitem:CCoinsViewCache" id="r_CCoinsViewCache"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_c_coins_view_cache.html">CCoinsViewCache</a></td></tr>
<tr class="memitem:CCoinsViewErrorCatcher" id="r_CCoinsViewErrorCatcher"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_c_coins_view_error_catcher.html">CCoinsViewErrorCatcher</a></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-typedef-members" class="groupheader"><a id="typedef-members" name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a4f73235f01457f00d91f656dffdb6235" id="r_a4f73235f01457f00d91f656dffdb6235"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4f73235f01457f00d91f656dffdb6235">CoinsCachePair</a> = std::pair&lt;const <a class="el" href="class_c_out_point.html">COutPoint</a>, <a class="el" href="struct_c_coins_cache_entry.html">CCoinsCacheEntry</a>&gt;</td></tr>
<tr class="memitem:abb6c00f4f94a3084a430d1848fed7697" id="r_abb6c00f4f94a3084a430d1848fed7697"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#abb6c00f4f94a3084a430d1848fed7697">CCoinsMap</a></td></tr>
<tr class="memitem:ad512438d571689179e69cf922c01bcc8" id="r_ad512438d571689179e69cf922c01bcc8"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad512438d571689179e69cf922c01bcc8">CCoinsMapMemoryResource</a> = CCoinsMap::allocator_type::ResourceType</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-func-members" class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a3ab3ef128100cf9afb171a00bd8728ee" id="r_a3ab3ef128100cf9afb171a00bd8728ee"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3ab3ef128100cf9afb171a00bd8728ee">AddCoins</a> (<a class="el" href="class_c_coins_view_cache.html">CCoinsViewCache</a> &amp;cache, const <a class="el" href="class_c_transaction.html">CTransaction</a> &amp;tx, int <a class="el" href="mempool__ephemeral__spends_8cpp.html#a2e4c6b811457a16b7033af6741cfb1db">nHeight</a>, bool check=false)</td></tr>
<tr class="memitem:aa7a3b70bc84ca569a0d03183bcb94ea0" id="r_aa7a3b70bc84ca569a0d03183bcb94ea0"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="class_coin.html">Coin</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa7a3b70bc84ca569a0d03183bcb94ea0">AccessByTxid</a> (const <a class="el" href="class_c_coins_view_cache.html">CCoinsViewCache</a> &amp;cache, const <a class="el" href="transaction__identifier_8h.html#ac4bb3c35b94889843d632be4de4b223c">Txid</a> &amp;txid)</td></tr>
</table>
<a name="doc-typedef-members" id="doc-typedef-members"></a><h2 id="header-doc-typedef-members" class="groupheader">Typedef Documentation</h2>
<a id="abb6c00f4f94a3084a430d1848fed7697" name="abb6c00f4f94a3084a430d1848fed7697"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb6c00f4f94a3084a430d1848fed7697">&#9670;&#160;</a></span>CCoinsMap</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="#abb6c00f4f94a3084a430d1848fed7697">CCoinsMap</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line"> std::unordered_map&lt;<a class="code hl_class" href="class_c_out_point.html">COutPoint</a>,</div>
<div class="line">                                     <a class="code hl_struct" href="struct_c_coins_cache_entry.html">CCoinsCacheEntry</a>,</div>
<div class="line">                                     <a class="code hl_class" href="class_salted_outpoint_hasher.html">SaltedOutpointHasher</a>,</div>
<div class="line">                                     std::equal_to&lt;COutPoint&gt;,</div>
<div class="line">                                     <a class="code hl_class" href="class_pool_allocator.html">PoolAllocator</a>&lt;<a class="code hl_typedef" href="#a4f73235f01457f00d91f656dffdb6235">CoinsCachePair</a>,</div>
<div class="line">                                                   <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="#a4f73235f01457f00d91f656dffdb6235">CoinsCachePair</a>) + <span class="keyword">sizeof</span>(<span class="keywordtype">void</span>*) * 4&gt;&gt;</div>
<div class="ttc" id="aclass_c_out_point_html"><div class="ttname"><a href="class_c_out_point.html">COutPoint</a></div><div class="ttdef"><b>Definition</b> transaction.h:29</div></div>
<div class="ttc" id="aclass_pool_allocator_html"><div class="ttname"><a href="class_pool_allocator.html">PoolAllocator</a></div><div class="ttdef"><b>Definition</b> pool.h:290</div></div>
<div class="ttc" id="aclass_salted_outpoint_hasher_html"><div class="ttname"><a href="class_salted_outpoint_hasher.html">SaltedOutpointHasher</a></div><div class="ttdef"><b>Definition</b> hasher.h:58</div></div>
<div class="ttc" id="acoins_8h_html_a4f73235f01457f00d91f656dffdb6235"><div class="ttname"><a href="#a4f73235f01457f00d91f656dffdb6235">CoinsCachePair</a></div><div class="ttdeci">std::pair&lt; const COutPoint, CCoinsCacheEntry &gt; CoinsCachePair</div><div class="ttdef"><b>Definition</b> coins.h:91</div></div>
<div class="ttc" id="astruct_c_coins_cache_entry_html"><div class="ttname"><a href="struct_c_coins_cache_entry.html">CCoinsCacheEntry</a></div><div class="ttdef"><b>Definition</b> coins.h:109</div></div>
</div><!-- fragment --><p><a class="el" href="class_pool_allocator.html">PoolAllocator</a>'s MAX_BLOCK_SIZE_BYTES parameter here uses sizeof the data, and adds the size of 4 pointers. We do not know the exact node size used in the std::unordered_node implementation because it is implementation defined. Most implementations have an overhead of 1 or 2 pointers, so nodes can be connected in a linked list, and in some cases the hash value is stored as well. Using an additional sizeof(void*)*4 for MAX_BLOCK_SIZE_BYTES should thus be sufficient so that all implementations can allocate the nodes from the <a class="el" href="class_pool_allocator.html">PoolAllocator</a>. </p>

</div>
</div>
<a id="ad512438d571689179e69cf922c01bcc8" name="ad512438d571689179e69cf922c01bcc8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad512438d571689179e69cf922c01bcc8">&#9670;&#160;</a></span>CCoinsMapMemoryResource</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="#ad512438d571689179e69cf922c01bcc8">CCoinsMapMemoryResource</a> = CCoinsMap::allocator_type::ResourceType</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a4f73235f01457f00d91f656dffdb6235" name="a4f73235f01457f00d91f656dffdb6235"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4f73235f01457f00d91f656dffdb6235">&#9670;&#160;</a></span>CoinsCachePair</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="#a4f73235f01457f00d91f656dffdb6235">CoinsCachePair</a> = std::pair&lt;const <a class="el" href="class_c_out_point.html">COutPoint</a>, <a class="el" href="struct_c_coins_cache_entry.html">CCoinsCacheEntry</a>&gt;</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a name="doc-func-members" id="doc-func-members"></a><h2 id="header-doc-func-members" class="groupheader">Function Documentation</h2>
<a id="aa7a3b70bc84ca569a0d03183bcb94ea0" name="aa7a3b70bc84ca569a0d03183bcb94ea0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa7a3b70bc84ca569a0d03183bcb94ea0">&#9670;&#160;</a></span>AccessByTxid()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="class_coin.html">Coin</a> &amp; AccessByTxid </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_c_coins_view_cache.html">CCoinsViewCache</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>cache</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="transaction__identifier_8h.html#ac4bb3c35b94889843d632be4de4b223c">Txid</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>txid</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Utility function to find any unspent output with a given txid. This function can be quite expensive because in the event of a transaction which is not found in the cache, it can cause up to MAX_OUTPUTS_PER_BLOCK lookups to database, so it should be used with care. </p>

</div>
</div>
<a id="a3ab3ef128100cf9afb171a00bd8728ee" name="a3ab3ef128100cf9afb171a00bd8728ee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3ab3ef128100cf9afb171a00bd8728ee">&#9670;&#160;</a></span>AddCoins()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void AddCoins </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_c_coins_view_cache.html">CCoinsViewCache</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>cache</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_c_transaction.html">CTransaction</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>tx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>nHeight</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>check</em></span><span class="paramdefsep"> = </span><span class="paramdefval">false</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Utility function to add all of a transaction's outputs to a cache. When check is false, this assumes that overwrites are only possible for coinbase transactions. When check is true, the underlying view may be queried to determine whether an addition is an overwrite. </p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a href="coins_8h.html">coins.h</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.15.0 </li>
  </ul>
</div>
</body>
</html>
