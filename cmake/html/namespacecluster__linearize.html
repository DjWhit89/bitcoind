<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.15.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>bitcoind: cluster_linearize Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="bitcoin.ico"/></td>
  <td id="projectalign">
   <div id="projectname">bitcoind<span id="projectnumber">&#160;2.8</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.15.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('namespacecluster__linearize.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">cluster_linearize Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-nested-classes" class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:DepGraph" id="r_DepGraph"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcluster__linearize_1_1_dep_graph.html">DepGraph</a></td></tr>
<tr class="memitem:SetInfo" id="r_SetInfo"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structcluster__linearize_1_1_set_info.html">SetInfo</a></td></tr>
<tr class="memitem:SpanningForestState" id="r_SpanningForestState"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcluster__linearize_1_1_spanning_forest_state.html">SpanningForestState</a></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-typedef-members" class="groupheader"><a id="typedef-members" name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:afe7ae098b4cbd5b112f81d1e9429e90d" id="r_afe7ae098b4cbd5b112f81d1e9429e90d"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#afe7ae098b4cbd5b112f81d1e9429e90d">DepGraphIndex</a> = uint32_t</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-func-members" class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a30f9a354e247428df47e59a11e2a098f" id="r_a30f9a354e247428df47e59a11e2a098f"><td class="memTemplParams" colspan="2">template&lt;typename SetType&gt; </td></tr>
<tr class="memitem:a30f9a354e247428df47e59a11e2a098f template"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="structcluster__linearize_1_1_set_info.html">SetInfo</a>&lt; SetType &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a30f9a354e247428df47e59a11e2a098f">ChunkLinearizationInfo</a> (const <a class="el" href="classcluster__linearize_1_1_dep_graph.html">DepGraph</a>&lt; SetType &gt; &amp;depgraph, std::span&lt; const <a class="el" href="#afe7ae098b4cbd5b112f81d1e9429e90d">DepGraphIndex</a> &gt; linearization) noexcept</td></tr>
<tr class="memitem:a8efd6c0d9203d9d942b0c8b9baf81e87" id="r_a8efd6c0d9203d9d942b0c8b9baf81e87"><td class="memTemplParams" colspan="2">template&lt;typename SetType&gt; </td></tr>
<tr class="memitem:a8efd6c0d9203d9d942b0c8b9baf81e87 template"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="struct_fee_frac.html">FeeFrac</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8efd6c0d9203d9d942b0c8b9baf81e87">ChunkLinearization</a> (const <a class="el" href="classcluster__linearize_1_1_dep_graph.html">DepGraph</a>&lt; SetType &gt; &amp;depgraph, std::span&lt; const <a class="el" href="#afe7ae098b4cbd5b112f81d1e9429e90d">DepGraphIndex</a> &gt; linearization) noexcept</td></tr>
<tr class="memitem:ad7fec78514892bfc4213dec2180ea5fa" id="r_ad7fec78514892bfc4213dec2180ea5fa"><td class="memTemplParams" colspan="2">template&lt;typename SetType&gt; </td></tr>
<tr class="memitem:ad7fec78514892bfc4213dec2180ea5fa template"><td class="memItemLeft" align="right" valign="top">std::tuple&lt; std::vector&lt; <a class="el" href="#afe7ae098b4cbd5b112f81d1e9429e90d">DepGraphIndex</a> &gt;, bool, uint64_t &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad7fec78514892bfc4213dec2180ea5fa">Linearize</a> (const <a class="el" href="classcluster__linearize_1_1_dep_graph.html">DepGraph</a>&lt; SetType &gt; &amp;depgraph, uint64_t max_iterations, uint64_t rng_seed, std::span&lt; const <a class="el" href="#afe7ae098b4cbd5b112f81d1e9429e90d">DepGraphIndex</a> &gt; old_linearization={}) noexcept</td></tr>
<tr class="memitem:ab4dfb7a53e485a4f5eac2219e4176a91" id="r_ab4dfb7a53e485a4f5eac2219e4176a91"><td class="memTemplParams" colspan="2">template&lt;typename SetType&gt; </td></tr>
<tr class="memitem:ab4dfb7a53e485a4f5eac2219e4176a91 template"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab4dfb7a53e485a4f5eac2219e4176a91">PostLinearize</a> (const <a class="el" href="classcluster__linearize_1_1_dep_graph.html">DepGraph</a>&lt; SetType &gt; &amp;depgraph, std::span&lt; <a class="el" href="#afe7ae098b4cbd5b112f81d1e9429e90d">DepGraphIndex</a> &gt; linearization)</td></tr>
<tr class="memitem:a2d8e8c7af3c1fd9b4bbd67716b358430" id="r_a2d8e8c7af3c1fd9b4bbd67716b358430"><td class="memTemplParams" colspan="2">template&lt;typename SetType&gt; </td></tr>
<tr class="memitem:a2d8e8c7af3c1fd9b4bbd67716b358430 template"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2d8e8c7af3c1fd9b4bbd67716b358430">FixLinearization</a> (const <a class="el" href="classcluster__linearize_1_1_dep_graph.html">DepGraph</a>&lt; SetType &gt; &amp;depgraph, std::span&lt; <a class="el" href="#afe7ae098b4cbd5b112f81d1e9429e90d">DepGraphIndex</a> &gt; linearization) noexcept</td></tr>
</table>
<a name="doc-typedef-members" id="doc-typedef-members"></a><h2 id="header-doc-typedef-members" class="groupheader">Typedef Documentation</h2>
<a id="afe7ae098b4cbd5b112f81d1e9429e90d" name="afe7ae098b4cbd5b112f81d1e9429e90d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afe7ae098b4cbd5b112f81d1e9429e90d">&#9670;&#160;</a></span>DepGraphIndex</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="#afe7ae098b4cbd5b112f81d1e9429e90d">DepGraphIndex</a> = uint32_t</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Data type to represent transaction indices in DepGraphs and the clusters they represent. </p>

</div>
</div>
<a name="doc-func-members" id="doc-func-members"></a><h2 id="header-doc-func-members" class="groupheader">Function Documentation</h2>
<a id="a8efd6c0d9203d9d942b0c8b9baf81e87" name="a8efd6c0d9203d9d942b0c8b9baf81e87"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8efd6c0d9203d9d942b0c8b9baf81e87">&#9670;&#160;</a></span>ChunkLinearization()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename SetType&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; <a class="el" href="struct_fee_frac.html">FeeFrac</a> &gt; ChunkLinearization </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classcluster__linearize_1_1_dep_graph.html">DepGraph</a>&lt; SetType &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>depgraph</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::span&lt; const <a class="el" href="#afe7ae098b4cbd5b112f81d1e9429e90d">DepGraphIndex</a> &gt;</td>          <td class="paramname"><span class="paramname"><em>linearization</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel noexcept">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Compute the feerates of the chunks of linearization. Identical to ChunkLinearizationInfo, but only returns the chunk feerates, not the corresponding transaction sets. </p>
<p>The new chunk to be added, initially a singleton.</p>

</div>
</div>
<a id="a30f9a354e247428df47e59a11e2a098f" name="a30f9a354e247428df47e59a11e2a098f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a30f9a354e247428df47e59a11e2a098f">&#9670;&#160;</a></span>ChunkLinearizationInfo()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename SetType&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; <a class="el" href="structcluster__linearize_1_1_set_info.html">SetInfo</a>&lt; SetType &gt; &gt; ChunkLinearizationInfo </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classcluster__linearize_1_1_dep_graph.html">DepGraph</a>&lt; SetType &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>depgraph</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::span&lt; const <a class="el" href="#afe7ae098b4cbd5b112f81d1e9429e90d">DepGraphIndex</a> &gt;</td>          <td class="paramname"><span class="paramname"><em>linearization</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel noexcept">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Compute the chunks of linearization as SetInfos. </p>
<p>The new chunk to be added, initially a singleton.</p>

</div>
</div>
<a id="a2d8e8c7af3c1fd9b4bbd67716b358430" name="a2d8e8c7af3c1fd9b4bbd67716b358430"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2d8e8c7af3c1fd9b4bbd67716b358430">&#9670;&#160;</a></span>FixLinearization()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename SetType&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void FixLinearization </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classcluster__linearize_1_1_dep_graph.html">DepGraph</a>&lt; SetType &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>depgraph</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::span&lt; <a class="el" href="#afe7ae098b4cbd5b112f81d1e9429e90d">DepGraphIndex</a> &gt;</td>          <td class="paramname"><span class="paramname"><em>linearization</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel noexcept">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Make linearization topological, retaining its ordering where possible. </p>
<p>The element at that position.</p>
<p>j represents how far from the back of the linearization elem should be placed.</p>

</div>
</div>
<a id="ad7fec78514892bfc4213dec2180ea5fa" name="ad7fec78514892bfc4213dec2180ea5fa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad7fec78514892bfc4213dec2180ea5fa">&#9670;&#160;</a></span>Linearize()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename SetType&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::tuple&lt; std::vector&lt; <a class="el" href="#afe7ae098b4cbd5b112f81d1e9429e90d">DepGraphIndex</a> &gt;, bool, uint64_t &gt; Linearize </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classcluster__linearize_1_1_dep_graph.html">DepGraph</a>&lt; SetType &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>depgraph</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t</td>          <td class="paramname"><span class="paramname"><em>max_iterations</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t</td>          <td class="paramname"><span class="paramname"><em>rng_seed</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::span&lt; const <a class="el" href="#afe7ae098b4cbd5b112f81d1e9429e90d">DepGraphIndex</a> &gt;</td>          <td class="paramname"><span class="paramname"><em>old_linearization</em></span><span class="paramdefsep"> = </span><span class="paramdefval">{}</span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel noexcept">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Find or improve a linearization for a cluster.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">depgraph</td><td>Dependency graph of the cluster to be linearized. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">max_iterations</td><td>Upper bound on the amount of work that will be done. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rng_seed</td><td>A random number seed to control search order. This prevents peers from predicting exactly which clusters would be hard for us to linearize. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">old_linearization</td><td>An existing linearization for the cluster (which must be topologically valid), or empty. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A tuple of:<ul>
<li>The resulting linearization. It is guaranteed to be at least as good (in the feerate diagram sense) as old_linearization.</li>
<li>A boolean indicating whether the result is guaranteed to be optimal.</li>
<li>How many optimization steps were actually performed. </li>
</ul>
</dd></dl>
<p>Initialize a spanning forest data structure for this cluster.</p>

</div>
</div>
<a id="ab4dfb7a53e485a4f5eac2219e4176a91" name="ab4dfb7a53e485a4f5eac2219e4176a91"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab4dfb7a53e485a4f5eac2219e4176a91">&#9670;&#160;</a></span>PostLinearize()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename SetType&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void PostLinearize </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classcluster__linearize_1_1_dep_graph.html">DepGraph</a>&lt; SetType &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>depgraph</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::span&lt; <a class="el" href="#afe7ae098b4cbd5b112f81d1e9429e90d">DepGraphIndex</a> &gt;</td>          <td class="paramname"><span class="paramname"><em>linearization</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Improve a given linearization.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">depgraph</td><td>Dependency graph of the cluster being linearized. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">linearization</td><td>On input, an existing linearization for depgraph. On output, a potentially better linearization for the same graph.</td></tr>
  </table>
  </dd>
</dl>
<p>Postlinearization guarantees:</p><ul>
<li>The resulting chunks are connected.</li>
<li>If the input has a tree shape (either all transactions have at most one child, or all transactions have at most one parent), the result is optimal.</li>
<li>Given a linearization L1 and a leaf transaction T in it. Let L2 be L1 with T moved to the end, optionally with its fee increased. Let L3 be the postlinearization of L2. L3 will be at least as good as L1. This means that replacing transactions with same-size higher-fee transactions will not worsen linearizations through a "drop conflicts, append new transactions,
  postlinearize" process. </li>
</ul>
<p>Index of the sentinel in the entries array below.</p>
<p>Indicator that a group has no previous transaction.</p>
<p>Data structure per transaction entry.</p>
<p>The index of the previous transaction in this group; NO_PREV_TX if this is the first entry of a group.</p>
<p>Index of the first transaction in this group, possibly itself.</p>
<p>Index of the last transaction in the previous group. The first group (the sentinel) points back to the last group here, making it a singly-linked circular list.</p>
<p>All transactions in the group. Empty for the sentinel.</p>
<p>All dependencies of the group (descendants in even passes; ancestors in odd ones).</p>
<p>The combined fee/size of transactions in the group. Fee is negated in even passes.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a href="namespacecluster__linearize.html">cluster_linearize</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.15.0 </li>
  </ul>
</div>
</body>
</html>
