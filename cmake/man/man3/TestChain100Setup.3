.TH "TestChain100Setup" 3 "Version 2.8" "bitcoind" \" -*- nroff -*-
.ad l
.nh
.SH NAME
TestChain100Setup
.SH SYNOPSIS
.br
.PP
.PP
\fR#include <setup_common\&.h>\fP
.PP
Inherits \fBTestingSetup\fP\&.
.PP
Inherited by \fBBuildChainTestingSetup\fP, \fBCheckValueTest\fP, \fBDersig100Setup\fP, \fBSnapshotTestSetup\fP, \fBTxPackageTest\fP, and \fBListCoinsTestingSetup\fP\&.
.SS "Public Member Functions"

.in +1c
.ti -1c
.RI "\fBTestChain100Setup\fP (const \fBChainType\fP chain_type=\fBChainType::REGTEST\fP, \fBTestOpts\fP={})"
.br
.ti -1c
.RI "\fBCBlock\fP \fBCreateAndProcessBlock\fP (const std::vector< \fBCMutableTransaction\fP > &txns, const \fBCScript\fP &scriptPubKey, \fBChainstate\fP *chainstate=nullptr)"
.br
.ti -1c
.RI "\fBCBlock\fP \fBCreateBlock\fP (const std::vector< \fBCMutableTransaction\fP > &txns, const \fBCScript\fP &scriptPubKey, \fBChainstate\fP &chainstate)"
.br
.ti -1c
.RI "void \fBmineBlocks\fP (int num_blocks)"
.br
.RI "Mine a series of new blocks on the active chain\&. "
.ti -1c
.RI "std::pair< \fBCMutableTransaction\fP, \fBCAmount\fP > \fBCreateValidTransaction\fP (const std::vector< \fBCTransactionRef\fP > &input_transactions, const std::vector< \fBCOutPoint\fP > &inputs, int input_height, const std::vector< \fBCKey\fP > &input_signing_keys, const std::vector< \fBCTxOut\fP > &outputs, const std::optional< \fBCFeeRate\fP > &feerate, const std::optional< uint32_t > &fee_output)"
.br
.ti -1c
.RI "\fBCMutableTransaction\fP \fBCreateValidMempoolTransaction\fP (const std::vector< \fBCTransactionRef\fP > &input_transactions, const std::vector< \fBCOutPoint\fP > &inputs, int input_height, const std::vector< \fBCKey\fP > &input_signing_keys, const std::vector< \fBCTxOut\fP > &outputs, bool submit=true)"
.br
.ti -1c
.RI "\fBCMutableTransaction\fP \fBCreateValidMempoolTransaction\fP (\fBCTransactionRef\fP input_transaction, uint32_t input_vout, int input_height, \fBCKey\fP input_signing_key, \fBCScript\fP output_destination, \fBCAmount\fP output_amount=\fBCAmount\fP(1 *COIN), bool submit=true)"
.br
.ti -1c
.RI "std::vector< \fBCTransactionRef\fP > \fBPopulateMempool\fP (\fBFastRandomContext\fP &det_rand, size_t num_transactions, bool submit)"
.br
.in -1c

Public Member Functions inherited from \fBTestingSetup\fP
.in +1c
.ti -1c
.RI "\fBTestingSetup\fP (const \fBChainType\fP chainType=\fBChainType::MAIN\fP, \fBTestOpts\fP={})"
.br
.in -1c

Public Member Functions inherited from \fBChainTestingSetup\fP
.in +1c
.ti -1c
.RI "\fBChainTestingSetup\fP (const \fBChainType\fP chainType=\fBChainType::MAIN\fP, \fBTestOpts\fP={})"
.br
.ti -1c
.RI "\fB~ChainTestingSetup\fP ()"
.br
.ti -1c
.RI "void \fBLoadVerifyActivateChainstate\fP ()"
.br
.in -1c

Public Member Functions inherited from \fBBasicTestingSetup\fP
.in +1c
.ti -1c
.RI "void \fBSeedRandomForTest\fP (\fBSeedRand\fP seed)"
.br
.ti -1c
.RI "\fBBasicTestingSetup\fP (const \fBChainType\fP chainType=\fBChainType::MAIN\fP, \fBTestOpts\fP={})"
.br
.ti -1c
.RI "\fB~BasicTestingSetup\fP ()"
.br
.in -1c
.SS "Data Fields"

.in +1c
.ti -1c
.RI "std::vector< \fBCTransactionRef\fP > \fBm_coinbase_txns\fP"
.br
.ti -1c
.RI "\fBCKey\fP \fBcoinbaseKey\fP"
.br
.in -1c

Data Fields inherited from \fBChainTestingSetup\fP
.in +1c
.ti -1c
.RI "\fBkernel::CacheSizes\fP \fBm_kernel_cache_sizes\fP {\fBnode::CalculateCacheSizes\fP(\fBm_args\fP)\&.\fBkernel\fP}"
.br
.ti -1c
.RI "bool \fBm_coins_db_in_memory\fP {true}"
.br
.ti -1c
.RI "bool \fBm_block_tree_db_in_memory\fP {true}"
.br
.ti -1c
.RI "std::function< void()> \fBm_make_chainman\fP {}"
.br
.in -1c

Data Fields inherited from \fBBasicTestingSetup\fP
.in +1c
.ti -1c
.RI "\fButil::SignalInterrupt\fP \fBm_interrupt\fP"
.br
.ti -1c
.RI "\fBnode::NodeContext\fP \fBm_node\fP"
.br
.ti -1c
.RI "\fBFastRandomContext\fP \fBm_rng\fP"
.br
.ti -1c
.RI "\fBfs::path\fP \fBm_path_root\fP"
.br
.ti -1c
.RI "\fBfs::path\fP \fBm_path_lock\fP"
.br
.ti -1c
.RI "bool \fBm_has_custom_datadir\fP {false}"
.br
.ti -1c
.RI "\fBArgsManager\fP \fBm_args\fP"
.br
.RI "Test-specific arguments and settings\&. "
.in -1c
.SH "Detailed Description"
.PP 
Testing fixture that pre-creates a 100-block REGTEST-mode block chain 
.SH "Constructor & Destructor Documentation"
.PP 
.SS "\fBTestChain100Setup\fP (const \fBChainType\fP chain_type = \fR\fBChainType::REGTEST\fP\fP, \fBTestOpts\fP opts = \fR{}\fP)"

.SH "Member Function Documentation"
.PP 
.SS "\fBCBlock\fP CreateAndProcessBlock (const std::vector< \fBCMutableTransaction\fP > & txns, const \fBCScript\fP & scriptPubKey, \fBChainstate\fP * chainstate = \fRnullptr\fP)"
Create a new block with just given transactions, coinbase paying to scriptPubKey, and try to add it to the current chain\&. If no chainstate is specified, default to the active\&. 
.SS "\fBCBlock\fP CreateBlock (const std::vector< \fBCMutableTransaction\fP > & txns, const \fBCScript\fP & scriptPubKey, \fBChainstate\fP & chainstate)"
Create a new block with just given transactions, coinbase paying to scriptPubKey\&. 
.SS "\fBCMutableTransaction\fP CreateValidMempoolTransaction (const std::vector< \fBCTransactionRef\fP > & input_transactions, const std::vector< \fBCOutPoint\fP > & inputs, int input_height, const std::vector< \fBCKey\fP > & input_signing_keys, const std::vector< \fBCTxOut\fP > & outputs, bool submit = \fRtrue\fP)"
Create a transaction and, optionally, submit to the mempool\&.

.PP
\fBParameters\fP
.RS 4
\fIinput_transactions\fP The transactions to spend 
.br
\fIinputs\fP Outpoints with which to construct transaction vin\&. 
.br
\fIinput_height\fP The height of the block that included the input transaction(s)\&. 
.br
\fIinput_signing_keys\fP The keys to spend inputs\&. 
.br
\fIoutputs\fP Transaction vout\&. 
.br
\fIsubmit\fP Whether or not to submit to mempool 
.RE
.PP

.SS "\fBCMutableTransaction\fP CreateValidMempoolTransaction (\fBCTransactionRef\fP input_transaction, uint32_t input_vout, int input_height, \fBCKey\fP input_signing_key, \fBCScript\fP output_destination, \fBCAmount\fP output_amount = \fR\fBCAmount\fP(1 * COIN)\fP, bool submit = \fRtrue\fP)"
Create a 1-in-1-out transaction and, optionally, submit to the mempool\&.

.PP
\fBParameters\fP
.RS 4
\fIinput_transaction\fP The transaction to spend 
.br
\fIinput_vout\fP The vout to spend from the input_transaction 
.br
\fIinput_height\fP The height of the block that included the input_transaction 
.br
\fIinput_signing_key\fP The key to spend the input_transaction 
.br
\fIoutput_destination\fP Where to send the output 
.br
\fIoutput_amount\fP How much to send 
.br
\fIsubmit\fP Whether or not to submit to mempool 
.RE
.PP

.SS "std::pair< \fBCMutableTransaction\fP, \fBCAmount\fP > CreateValidTransaction (const std::vector< \fBCTransactionRef\fP > & input_transactions, const std::vector< \fBCOutPoint\fP > & inputs, int input_height, const std::vector< \fBCKey\fP > & input_signing_keys, const std::vector< \fBCTxOut\fP > & outputs, const std::optional< \fBCFeeRate\fP > & feerate, const std::optional< uint32_t > & fee_output)"
Create a transaction, optionally setting the fee based on the feerate\&. Note: The feerate may not be met exactly depending on whether the signatures can have different sizes\&.

.PP
\fBParameters\fP
.RS 4
\fIinput_transactions\fP The transactions to spend 
.br
\fIinputs\fP Outpoints with which to construct transaction vin\&. 
.br
\fIinput_height\fP The height of the block that included the input transactions\&. 
.br
\fIinput_signing_keys\fP The keys to spend the input transactions\&. 
.br
\fIoutputs\fP Transaction vout\&. 
.br
\fIfeerate\fP The feerate the transaction should pay\&. 
.br
\fIfee_output\fP The index of the output to take the fee from\&. 
.RE
.PP
\fBReturns\fP
.RS 4
The transaction and the fee it pays 
.RE
.PP

.SS "void mineBlocks (int num_blocks)"

.PP
Mine a series of new blocks on the active chain\&. 
.SS "std::vector< \fBCTransactionRef\fP > PopulateMempool (\fBFastRandomContext\fP & det_rand, size_t num_transactions, bool submit)"
Create transactions spending from m_coinbase_txns\&. These transactions will only spend coins that exist in the current chain, but may be premature coinbase spends, have missing signatures, or violate some other consensus rules\&. They should only be used for testing mempool consistency\&. All transactions will have some random number of inputs and outputs (between 1 and 24)\&. Transactions may or may not be dependent upon each other; if dependencies exit, every parent will always be somewhere in the list before the child so each transaction can be submitted in the same order they appear in the list\&. 
.PP
\fBParameters\fP
.RS 4
\fIsubmit\fP When true, submit transactions to the mempool\&. When false, return them but don't submit them\&. 
.RE
.PP
\fBReturns\fP
.RS 4
A vector of transactions that can be submitted to the mempool\&. 
.RE
.PP

.SH "Field Documentation"
.PP 
.SS "\fBCKey\fP coinbaseKey"

.SS "std::vector<\fBCTransactionRef\fP> m_coinbase_txns"


.SH "Author"
.PP 
Generated automatically by Doxygen for bitcoind from the source code\&.
