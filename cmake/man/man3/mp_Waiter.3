.TH "Waiter" 3 "Version 2.8" "bitcoind" \" -*- nroff -*-
.ad l
.nh
.SH NAME
Waiter
.SH SYNOPSIS
.br
.PP
.PP
\fR#include <proxy\-io\&.h>\fP
.SS "Public Member Functions"

.in +1c
.ti -1c
.RI "\fBWaiter\fP ()=default"
.br
.ti -1c
.RI "template<typename Fn> bool \fBpost\fP (Fn &&fn)"
.br
.ti -1c
.RI "template<class Predicate> void \fBwait\fP (\fBLock\fP &lock, Predicate pred)"
.br
.ti -1c
.RI "std::optional< kj::Function< void()> > m_fn \fBMP_GUARDED_BY\fP (\fBm_mutex\fP)"
.br
.in -1c
.SS "Data Fields"

.in +1c
.ti -1c
.RI "\fBMutex\fP \fBm_mutex\fP"
.br
.ti -1c
.RI "std::condition_variable \fBm_cv\fP"
.br
.in -1c
.SH "Detailed Description"
.PP 
Single element task queue used to handle recursive capnp calls\&. (If server makes an callback into the client in the middle of a request, while client thread is blocked waiting for server response, this is what allows the client to run the request in the same thread, the same way code would run in single process, with the callback sharing same thread stack as the original call\&. 
.SH "Constructor & Destructor Documentation"
.PP 
.SS "Waiter ()\fR [default]\fP"

.SH "Member Function Documentation"
.PP 
.SS "std::optional< kj::Function< void()> > m_fn MP_GUARDED_BY (\fBm_mutex\fP )"

.SS "template<typename Fn> bool post (Fn && fn)\fR [inline]\fP"

.SS "template<class Predicate> void wait (\fBLock\fP & lock, Predicate pred)\fR [inline]\fP"

.SH "Field Documentation"
.PP 
.SS "std::condition_variable m_cv"

.SS "\fBMutex\fP m_mutex"
\fBMutex\fP mainly used internally by waiter class, but also used externally to guard access to related state\&. Specifically, since the thread_local \fBThreadContext\fP struct owns a \fBWaiter\fP, the \fBWaiter::m_mutex\fP is used to guard access to other parts of the struct to avoid needing to deal with more mutexes than necessary\&. This mutex can be held at the same time as \fBEventLoop::m_mutex\fP as long as Waiter::mutex is locked first and \fBEventLoop::m_mutex\fP is locked second\&. 

.SH "Author"
.PP 
Generated automatically by Doxygen for bitcoind from the source code\&.
