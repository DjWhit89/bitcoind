\doxysection{src/secp256k1/src/scalar\+\_\+4x64\+\_\+impl.h File Reference}
\label{scalar__4x64__impl_8h}\index{src/secp256k1/src/scalar\_4x64\_impl.h@{src/secp256k1/src/scalar\_4x64\_impl.h}}
{\ttfamily \#include "{}checkmem.\+h"{}}\newline
{\ttfamily \#include "{}int128.\+h"{}}\newline
{\ttfamily \#include "{}modinv64\+\_\+impl.\+h"{}}\newline
{\ttfamily \#include "{}util.\+h"{}}\newline
\doxysubsubsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \textbf{ SECP256\+K1\+\_\+\+N\+\_\+0}~((uint64\+\_\+t)0x\+BFD25\+E8\+CD0364141\+ULL)
\item 
\#define \textbf{ SECP256\+K1\+\_\+\+N\+\_\+1}~((uint64\+\_\+t)0x\+BAAEDCE6\+AF48\+A03\+BULL)
\item 
\#define \textbf{ SECP256\+K1\+\_\+\+N\+\_\+2}~((uint64\+\_\+t)0x\+FFFFFFFFFFFFFFFEULL)
\item 
\#define \textbf{ SECP256\+K1\+\_\+\+N\+\_\+3}~((uint64\+\_\+t)0x\+FFFFFFFFFFFFFFFFULL)
\item 
\#define \textbf{ SECP256\+K1\+\_\+\+N\+\_\+\+C\+\_\+0}~($\sim$\textbf{ SECP256\+K1\+\_\+\+N\+\_\+0} + 1)
\item 
\#define \textbf{ SECP256\+K1\+\_\+\+N\+\_\+\+C\+\_\+1}~($\sim$\textbf{ SECP256\+K1\+\_\+\+N\+\_\+1})
\item 
\#define \textbf{ SECP256\+K1\+\_\+\+N\+\_\+\+C\+\_\+2}~(1)
\item 
\#define \textbf{ SECP256\+K1\+\_\+\+N\+\_\+\+H\+\_\+0}~((uint64\+\_\+t)0x\+DFE92\+F46681\+B20\+A0\+ULL)
\item 
\#define \textbf{ SECP256\+K1\+\_\+\+N\+\_\+\+H\+\_\+1}~((uint64\+\_\+t)0x5\+D576\+E7357\+A4501\+DULL)
\item 
\#define \textbf{ SECP256\+K1\+\_\+\+N\+\_\+\+H\+\_\+2}~((uint64\+\_\+t)0x\+FFFFFFFFFFFFFFFFULL)
\item 
\#define \textbf{ SECP256\+K1\+\_\+\+N\+\_\+\+H\+\_\+3}~((uint64\+\_\+t)0x7\+FFFFFFFFFFFFFFFULL)
\item 
\#define \textbf{ muladd}(a,  b)
\item 
\#define \textbf{ muladd\+\_\+fast}(a,  b)
\item 
\#define \textbf{ sumadd}(a)
\item 
\#define \textbf{ sumadd\+\_\+fast}(a)
\item 
\#define \textbf{ extract}(n)
\item 
\#define \textbf{ extract\+\_\+fast}(n)
\end{DoxyCompactItemize}


\label{doc-define-members}
\doxysubsection{Macro Definition Documentation}
\index{scalar\_4x64\_impl.h@{scalar\_4x64\_impl.h}!extract@{extract}}
\index{extract@{extract}!scalar\_4x64\_impl.h@{scalar\_4x64\_impl.h}}
\doxysubsubsection{extract}
{\footnotesize\ttfamily \label{scalar__4x64__impl_8h_a2384e06d62f7580d7599d3b77b68acbb} 
\#define extract(\begin{DoxyParamCaption}\item[{}]{n}{}\end{DoxyParamCaption})}

{\bfseries Value\+:}
\begin{DoxyCode}{0}
\DoxyCodeLine{\ \ \ \ \{\ \(\backslash\)}
\DoxyCodeLine{\ \ \ \ (n)\ =\ c0;\ \(\backslash\)}
\DoxyCodeLine{\ \ \ \ c0\ =\ c1;\ \(\backslash\)}
\DoxyCodeLine{\ \ \ \ c1\ =\ c2;\ \(\backslash\)}
\DoxyCodeLine{\ \ \ \ c2\ =\ 0;\ \(\backslash\)}
\DoxyCodeLine{\}}

\end{DoxyCode}
Extract the lowest 64 bits of (c0,c1,c2) into n, and left shift the number 64 bits. \index{scalar\_4x64\_impl.h@{scalar\_4x64\_impl.h}!extract\_fast@{extract\_fast}}
\index{extract\_fast@{extract\_fast}!scalar\_4x64\_impl.h@{scalar\_4x64\_impl.h}}
\doxysubsubsection{extract\_fast}
{\footnotesize\ttfamily \label{scalar__4x64__impl_8h_a7738483bf87a265b882763603d527b3b} 
\#define extract\+\_\+fast(\begin{DoxyParamCaption}\item[{}]{n}{}\end{DoxyParamCaption})}

{\bfseries Value\+:}
\begin{DoxyCode}{0}
\DoxyCodeLine{\ \ \ \ \{\ \(\backslash\)}
\DoxyCodeLine{\ \ \ \ (n)\ =\ c0;\ \(\backslash\)}
\DoxyCodeLine{\ \ \ \ c0\ =\ c1;\ \(\backslash\)}
\DoxyCodeLine{\ \ \ \ c1\ =\ 0;\ \(\backslash\)}
\DoxyCodeLine{\ \ \ \ VERIFY\_CHECK(c2\ ==\ 0);\ \(\backslash\)}
\DoxyCodeLine{\}}

\end{DoxyCode}
Extract the lowest 64 bits of (c0,c1,c2) into n, and left shift the number 64 bits. c2 is required to be zero. \index{scalar\_4x64\_impl.h@{scalar\_4x64\_impl.h}!muladd@{muladd}}
\index{muladd@{muladd}!scalar\_4x64\_impl.h@{scalar\_4x64\_impl.h}}
\doxysubsubsection{muladd}
{\footnotesize\ttfamily \label{scalar__4x64__impl_8h_a7c03352e405b1d65f6afd0b7a0f01730} 
\#define muladd(\begin{DoxyParamCaption}\item[{}]{a}{, }\item[{}]{b}{}\end{DoxyParamCaption})}

{\bfseries Value\+:}
\begin{DoxyCode}{0}
\DoxyCodeLine{\ \ \ \ \{\ \(\backslash\)}
\DoxyCodeLine{\ \ \ \ uint64\_t\ tl,\ th;\ \(\backslash\)}
\DoxyCodeLine{\ \ \ \ \{\ \(\backslash\)}
\DoxyCodeLine{\ \ \ \ \ \ \ \ secp256k1\_uint128\ t;\ \(\backslash\)}
\DoxyCodeLine{\ \ \ \ \ \ \ \ secp256k1\_u128\_mul(\&t,\ a,\ b);\ \(\backslash\)}
\DoxyCodeLine{\ \ \ \ \ \ \ \ th\ =\ secp256k1\_u128\_hi\_u64(\&t);\ \ \textcolor{comment}{/*\ at\ most\ 0xFFFFFFFFFFFFFFFE\ */}\ \(\backslash\)}
\DoxyCodeLine{\ \ \ \ \ \ \ \ tl\ =\ secp256k1\_u128\_to\_u64(\&t);\ \(\backslash\)}
\DoxyCodeLine{\ \ \ \ \}\ \(\backslash\)}
\DoxyCodeLine{\ \ \ \ c0\ +=\ tl;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ overflow\ is\ handled\ on\ the\ next\ line\ */}\ \(\backslash\)}
\DoxyCodeLine{\ \ \ \ th\ +=\ (c0\ <\ tl);\ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ at\ most\ 0xFFFFFFFFFFFFFFFF\ */}\ \(\backslash\)}
\DoxyCodeLine{\ \ \ \ c1\ +=\ th;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ overflow\ is\ handled\ on\ the\ next\ line\ */}\ \(\backslash\)}
\DoxyCodeLine{\ \ \ \ c2\ +=\ (c1\ <\ th);\ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ never\ overflows\ by\ contract\ (verified\ in\ the\ next\ line)\ */}\ \(\backslash\)}
\DoxyCodeLine{\ \ \ \ VERIFY\_CHECK((c1\ >=\ th)\ ||\ (c2\ !=\ 0));\ \(\backslash\)}
\DoxyCodeLine{\}}

\end{DoxyCode}
Add a$\ast$b to the number defined by (c0,c1,c2). c2 must never overflow. \index{scalar\_4x64\_impl.h@{scalar\_4x64\_impl.h}!muladd\_fast@{muladd\_fast}}
\index{muladd\_fast@{muladd\_fast}!scalar\_4x64\_impl.h@{scalar\_4x64\_impl.h}}
\doxysubsubsection{muladd\_fast}
{\footnotesize\ttfamily \label{scalar__4x64__impl_8h_adeb6e766b53f39bb9c0c9f6502aa3b62} 
\#define muladd\+\_\+fast(\begin{DoxyParamCaption}\item[{}]{a}{, }\item[{}]{b}{}\end{DoxyParamCaption})}

{\bfseries Value\+:}
\begin{DoxyCode}{0}
\DoxyCodeLine{\ \ \ \ \{\ \(\backslash\)}
\DoxyCodeLine{\ \ \ \ uint64\_t\ tl,\ th;\ \(\backslash\)}
\DoxyCodeLine{\ \ \ \ \{\ \(\backslash\)}
\DoxyCodeLine{\ \ \ \ \ \ \ \ secp256k1\_uint128\ t;\ \(\backslash\)}
\DoxyCodeLine{\ \ \ \ \ \ \ \ secp256k1\_u128\_mul(\&t,\ a,\ b);\ \(\backslash\)}
\DoxyCodeLine{\ \ \ \ \ \ \ \ th\ =\ secp256k1\_u128\_hi\_u64(\&t);\ \ \textcolor{comment}{/*\ at\ most\ 0xFFFFFFFFFFFFFFFE\ */}\ \(\backslash\)}
\DoxyCodeLine{\ \ \ \ \ \ \ \ tl\ =\ secp256k1\_u128\_to\_u64(\&t);\ \(\backslash\)}
\DoxyCodeLine{\ \ \ \ \}\ \(\backslash\)}
\DoxyCodeLine{\ \ \ \ c0\ +=\ tl;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ overflow\ is\ handled\ on\ the\ next\ line\ */}\ \(\backslash\)}
\DoxyCodeLine{\ \ \ \ th\ +=\ (c0\ <\ tl);\ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ at\ most\ 0xFFFFFFFFFFFFFFFF\ */}\ \(\backslash\)}
\DoxyCodeLine{\ \ \ \ c1\ +=\ th;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ never\ overflows\ by\ contract\ (verified\ in\ the\ next\ line)\ */}\ \(\backslash\)}
\DoxyCodeLine{\ \ \ \ VERIFY\_CHECK(c1\ >=\ th);\ \(\backslash\)}
\DoxyCodeLine{\}}

\end{DoxyCode}
Add a$\ast$b to the number defined by (c0,c1). c1 must never overflow. \index{scalar\_4x64\_impl.h@{scalar\_4x64\_impl.h}!SECP256K1\_N\_0@{SECP256K1\_N\_0}}
\index{SECP256K1\_N\_0@{SECP256K1\_N\_0}!scalar\_4x64\_impl.h@{scalar\_4x64\_impl.h}}
\doxysubsubsection{SECP256K1\_N\_0}
{\footnotesize\ttfamily \label{scalar__4x64__impl_8h_a9e65a0592c11e099de8e8f58b38a14ae} 
\#define SECP256\+K1\+\_\+\+N\+\_\+0~((uint64\+\_\+t)0x\+BFD25\+E8\+CD0364141\+ULL)}

\index{scalar\_4x64\_impl.h@{scalar\_4x64\_impl.h}!SECP256K1\_N\_1@{SECP256K1\_N\_1}}
\index{SECP256K1\_N\_1@{SECP256K1\_N\_1}!scalar\_4x64\_impl.h@{scalar\_4x64\_impl.h}}
\doxysubsubsection{SECP256K1\_N\_1}
{\footnotesize\ttfamily \label{scalar__4x64__impl_8h_a53cc412ecd7e47061b65c0ff5c6db4e2} 
\#define SECP256\+K1\+\_\+\+N\+\_\+1~((uint64\+\_\+t)0x\+BAAEDCE6\+AF48\+A03\+BULL)}

\index{scalar\_4x64\_impl.h@{scalar\_4x64\_impl.h}!SECP256K1\_N\_2@{SECP256K1\_N\_2}}
\index{SECP256K1\_N\_2@{SECP256K1\_N\_2}!scalar\_4x64\_impl.h@{scalar\_4x64\_impl.h}}
\doxysubsubsection{SECP256K1\_N\_2}
{\footnotesize\ttfamily \label{scalar__4x64__impl_8h_a5cfbef70d2cba970443032a43450d0b3} 
\#define SECP256\+K1\+\_\+\+N\+\_\+2~((uint64\+\_\+t)0x\+FFFFFFFFFFFFFFFEULL)}

\index{scalar\_4x64\_impl.h@{scalar\_4x64\_impl.h}!SECP256K1\_N\_3@{SECP256K1\_N\_3}}
\index{SECP256K1\_N\_3@{SECP256K1\_N\_3}!scalar\_4x64\_impl.h@{scalar\_4x64\_impl.h}}
\doxysubsubsection{SECP256K1\_N\_3}
{\footnotesize\ttfamily \label{scalar__4x64__impl_8h_a1d38f968c428d48fe1041ef38eec96d4} 
\#define SECP256\+K1\+\_\+\+N\+\_\+3~((uint64\+\_\+t)0x\+FFFFFFFFFFFFFFFFULL)}

\index{scalar\_4x64\_impl.h@{scalar\_4x64\_impl.h}!SECP256K1\_N\_C\_0@{SECP256K1\_N\_C\_0}}
\index{SECP256K1\_N\_C\_0@{SECP256K1\_N\_C\_0}!scalar\_4x64\_impl.h@{scalar\_4x64\_impl.h}}
\doxysubsubsection{SECP256K1\_N\_C\_0}
{\footnotesize\ttfamily \label{scalar__4x64__impl_8h_a7004f2007d2a43820488d377d7167ece} 
\#define SECP256\+K1\+\_\+\+N\+\_\+\+C\+\_\+0~($\sim$\textbf{ SECP256\+K1\+\_\+\+N\+\_\+0} + 1)}

\index{scalar\_4x64\_impl.h@{scalar\_4x64\_impl.h}!SECP256K1\_N\_C\_1@{SECP256K1\_N\_C\_1}}
\index{SECP256K1\_N\_C\_1@{SECP256K1\_N\_C\_1}!scalar\_4x64\_impl.h@{scalar\_4x64\_impl.h}}
\doxysubsubsection{SECP256K1\_N\_C\_1}
{\footnotesize\ttfamily \label{scalar__4x64__impl_8h_a3f8f9c444183fbe3da955925b585290c} 
\#define SECP256\+K1\+\_\+\+N\+\_\+\+C\+\_\+1~($\sim$\textbf{ SECP256\+K1\+\_\+\+N\+\_\+1})}

\index{scalar\_4x64\_impl.h@{scalar\_4x64\_impl.h}!SECP256K1\_N\_C\_2@{SECP256K1\_N\_C\_2}}
\index{SECP256K1\_N\_C\_2@{SECP256K1\_N\_C\_2}!scalar\_4x64\_impl.h@{scalar\_4x64\_impl.h}}
\doxysubsubsection{SECP256K1\_N\_C\_2}
{\footnotesize\ttfamily \label{scalar__4x64__impl_8h_a2ba4e9e828bc0a11cf7ffc81cd823509} 
\#define SECP256\+K1\+\_\+\+N\+\_\+\+C\+\_\+2~(1)}

\index{scalar\_4x64\_impl.h@{scalar\_4x64\_impl.h}!SECP256K1\_N\_H\_0@{SECP256K1\_N\_H\_0}}
\index{SECP256K1\_N\_H\_0@{SECP256K1\_N\_H\_0}!scalar\_4x64\_impl.h@{scalar\_4x64\_impl.h}}
\doxysubsubsection{SECP256K1\_N\_H\_0}
{\footnotesize\ttfamily \label{scalar__4x64__impl_8h_a824415debca677af24eb249946df4404} 
\#define SECP256\+K1\+\_\+\+N\+\_\+\+H\+\_\+0~((uint64\+\_\+t)0x\+DFE92\+F46681\+B20\+A0\+ULL)}

\index{scalar\_4x64\_impl.h@{scalar\_4x64\_impl.h}!SECP256K1\_N\_H\_1@{SECP256K1\_N\_H\_1}}
\index{SECP256K1\_N\_H\_1@{SECP256K1\_N\_H\_1}!scalar\_4x64\_impl.h@{scalar\_4x64\_impl.h}}
\doxysubsubsection{SECP256K1\_N\_H\_1}
{\footnotesize\ttfamily \label{scalar__4x64__impl_8h_a93c4692d6cad53df3cce3fb4631dee82} 
\#define SECP256\+K1\+\_\+\+N\+\_\+\+H\+\_\+1~((uint64\+\_\+t)0x5\+D576\+E7357\+A4501\+DULL)}

\index{scalar\_4x64\_impl.h@{scalar\_4x64\_impl.h}!SECP256K1\_N\_H\_2@{SECP256K1\_N\_H\_2}}
\index{SECP256K1\_N\_H\_2@{SECP256K1\_N\_H\_2}!scalar\_4x64\_impl.h@{scalar\_4x64\_impl.h}}
\doxysubsubsection{SECP256K1\_N\_H\_2}
{\footnotesize\ttfamily \label{scalar__4x64__impl_8h_a5dfabdaac8359544dd1131ca3af807ae} 
\#define SECP256\+K1\+\_\+\+N\+\_\+\+H\+\_\+2~((uint64\+\_\+t)0x\+FFFFFFFFFFFFFFFFULL)}

\index{scalar\_4x64\_impl.h@{scalar\_4x64\_impl.h}!SECP256K1\_N\_H\_3@{SECP256K1\_N\_H\_3}}
\index{SECP256K1\_N\_H\_3@{SECP256K1\_N\_H\_3}!scalar\_4x64\_impl.h@{scalar\_4x64\_impl.h}}
\doxysubsubsection{SECP256K1\_N\_H\_3}
{\footnotesize\ttfamily \label{scalar__4x64__impl_8h_ac658856dbff7e81aca7cdd131c05dde4} 
\#define SECP256\+K1\+\_\+\+N\+\_\+\+H\+\_\+3~((uint64\+\_\+t)0x7\+FFFFFFFFFFFFFFFULL)}

\index{scalar\_4x64\_impl.h@{scalar\_4x64\_impl.h}!sumadd@{sumadd}}
\index{sumadd@{sumadd}!scalar\_4x64\_impl.h@{scalar\_4x64\_impl.h}}
\doxysubsubsection{sumadd}
{\footnotesize\ttfamily \label{scalar__4x64__impl_8h_a833c2f6d148537ff7aac34a668c9a455} 
\#define sumadd(\begin{DoxyParamCaption}\item[{}]{a}{}\end{DoxyParamCaption})}

{\bfseries Value\+:}
\begin{DoxyCode}{0}
\DoxyCodeLine{\ \ \ \ \{\ \(\backslash\)}
\DoxyCodeLine{\ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ over;\ \(\backslash\)}
\DoxyCodeLine{\ \ \ \ c0\ +=\ (a);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ overflow\ is\ handled\ on\ the\ next\ line\ */}\ \(\backslash\)}
\DoxyCodeLine{\ \ \ \ over\ =\ (c0\ <\ (a));\ \ \ \ \ \ \ \ \ \(\backslash\)}
\DoxyCodeLine{\ \ \ \ c1\ +=\ over;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ overflow\ is\ handled\ on\ the\ next\ line\ */}\ \(\backslash\)}
\DoxyCodeLine{\ \ \ \ c2\ +=\ (c1\ <\ over);\ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ never\ overflows\ by\ contract\ */}\ \(\backslash\)}
\DoxyCodeLine{\}}

\end{DoxyCode}
Add a to the number defined by (c0,c1,c2). c2 must never overflow. \index{scalar\_4x64\_impl.h@{scalar\_4x64\_impl.h}!sumadd\_fast@{sumadd\_fast}}
\index{sumadd\_fast@{sumadd\_fast}!scalar\_4x64\_impl.h@{scalar\_4x64\_impl.h}}
\doxysubsubsection{sumadd\_fast}
{\footnotesize\ttfamily \label{scalar__4x64__impl_8h_a4f682f5ec94e74581289057925976d11} 
\#define sumadd\+\_\+fast(\begin{DoxyParamCaption}\item[{}]{a}{}\end{DoxyParamCaption})}

{\bfseries Value\+:}
\begin{DoxyCode}{0}
\DoxyCodeLine{\ \ \ \ \{\ \(\backslash\)}
\DoxyCodeLine{\ \ \ \ c0\ +=\ (a);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ overflow\ is\ handled\ on\ the\ next\ line\ */}\ \(\backslash\)}
\DoxyCodeLine{\ \ \ \ c1\ +=\ (c0\ <\ (a));\ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ never\ overflows\ by\ contract\ (verified\ the\ next\ line)\ */}\ \(\backslash\)}
\DoxyCodeLine{\ \ \ \ VERIFY\_CHECK((c1\ !=\ 0)\ |\ (c0\ >=\ (a)));\ \(\backslash\)}
\DoxyCodeLine{\ \ \ \ VERIFY\_CHECK(c2\ ==\ 0);\ \(\backslash\)}
\DoxyCodeLine{\}}

\end{DoxyCode}
Add a to the number defined by (c0,c1). c1 must never overflow, c2 must be zero. 