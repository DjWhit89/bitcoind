\doxysection{src/consensus/tx\+\_\+verify.cpp File Reference}
\label{tx__verify_8cpp}\index{src/consensus/tx\_verify.cpp@{src/consensus/tx\_verify.cpp}}
{\ttfamily \#include $<$consensus/tx\+\_\+verify.\+h$>$}\newline
{\ttfamily \#include $<$chain.\+h$>$}\newline
{\ttfamily \#include $<$coins.\+h$>$}\newline
{\ttfamily \#include $<$consensus/amount.\+h$>$}\newline
{\ttfamily \#include $<$consensus/consensus.\+h$>$}\newline
{\ttfamily \#include $<$consensus/validation.\+h$>$}\newline
{\ttfamily \#include $<$primitives/transaction.\+h$>$}\newline
{\ttfamily \#include $<$script/interpreter.\+h$>$}\newline
{\ttfamily \#include $<$util/check.\+h$>$}\newline
{\ttfamily \#include $<$util/moneystr.\+h$>$}\newline
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
bool \textbf{ Is\+Final\+Tx} (const \textbf{ CTransaction} \&tx, int n\+Block\+Height, int64\+\_\+t n\+Block\+Time)
\item 
std\+::pair$<$ int, int64\+\_\+t $>$ \textbf{ Calculate\+Sequence\+Locks} (const \textbf{ CTransaction} \&tx, int \textbf{ flags}, std\+::vector$<$ int $>$ \&prev\+Heights, const \textbf{ CBlock\+Index} \&block)
\item 
bool \textbf{ Evaluate\+Sequence\+Locks} (const \textbf{ CBlock\+Index} \&block, std\+::pair$<$ int, int64\+\_\+t $>$ lock\+Pair)
\item 
bool \textbf{ Sequence\+Locks} (const \textbf{ CTransaction} \&tx, int \textbf{ flags}, std\+::vector$<$ int $>$ \&prev\+Heights, const \textbf{ CBlock\+Index} \&block)
\item 
unsigned int \textbf{ Get\+Legacy\+Sig\+Op\+Count} (const \textbf{ CTransaction} \&tx)
\item 
unsigned int \textbf{ Get\+P2\+SHSig\+Op\+Count} (const \textbf{ CTransaction} \&tx, const \textbf{ CCoins\+View\+Cache} \&inputs)
\item 
int64\+\_\+t \textbf{ Get\+Transaction\+Sig\+Op\+Cost} (const \textbf{ CTransaction} \&tx, const \textbf{ CCoins\+View\+Cache} \&inputs, \textbf{ script\+\_\+verify\+\_\+flags} \textbf{ flags})
\end{DoxyCompactItemize}


\label{doc-func-members}
\doxysubsection{Function Documentation}
\index{tx\_verify.cpp@{tx\_verify.cpp}!CalculateSequenceLocks@{CalculateSequenceLocks}}
\index{CalculateSequenceLocks@{CalculateSequenceLocks}!tx\_verify.cpp@{tx\_verify.cpp}}
\doxysubsubsection{CalculateSequenceLocks()}
{\footnotesize\ttfamily \label{tx__verify_8cpp_abc528b150bf26a1644aef9713336dda2} 
std\+::pair$<$ int, int64\+\_\+t $>$ Calculate\+Sequence\+Locks (\begin{DoxyParamCaption}\item[{const \textbf{ CTransaction} \&}]{tx}{, }\item[{int}]{flags}{, }\item[{std\+::vector$<$ int $>$ \&}]{prev\+Heights}{, }\item[{const \textbf{ CBlock\+Index} \&}]{block}{}\end{DoxyParamCaption})}

Calculates the block height and previous block\textquotesingle{}s median time past at which the transaction will be considered final in the context of BIP 68. For each input that is not sequence locked, the corresponding entries in prev\+Heights are set to 0 as they do not affect the calculation. \index{tx\_verify.cpp@{tx\_verify.cpp}!EvaluateSequenceLocks@{EvaluateSequenceLocks}}
\index{EvaluateSequenceLocks@{EvaluateSequenceLocks}!tx\_verify.cpp@{tx\_verify.cpp}}
\doxysubsubsection{EvaluateSequenceLocks()}
{\footnotesize\ttfamily \label{tx__verify_8cpp_ab6bb0246e751e82b8d6e3c97ed88b839} 
bool Evaluate\+Sequence\+Locks (\begin{DoxyParamCaption}\item[{const \textbf{ CBlock\+Index} \&}]{block}{, }\item[{std\+::pair$<$ int, int64\+\_\+t $>$}]{lock\+Pair}{}\end{DoxyParamCaption})}

\index{tx\_verify.cpp@{tx\_verify.cpp}!GetLegacySigOpCount@{GetLegacySigOpCount}}
\index{GetLegacySigOpCount@{GetLegacySigOpCount}!tx\_verify.cpp@{tx\_verify.cpp}}
\doxysubsubsection{GetLegacySigOpCount()}
{\footnotesize\ttfamily \label{tx__verify_8cpp_ad2eaf4f8542c12ea9ee1183609cc6d1a} 
unsigned int Get\+Legacy\+Sig\+Op\+Count (\begin{DoxyParamCaption}\item[{const \textbf{ CTransaction} \&}]{tx}{}\end{DoxyParamCaption})}

Auxiliary functions for transaction validation (ideally should not be exposed) Count ECDSA signature operations the old-\/fashioned (pre-\/0.\+6) way \begin{DoxyReturn}{Returns}
number of sigops this transaction\textquotesingle{}s outputs will produce when spent 
\end{DoxyReturn}
\begin{DoxySeeAlso}{See also}
CTransaction\+::\+Fetch\+Inputs 
\end{DoxySeeAlso}
\index{tx\_verify.cpp@{tx\_verify.cpp}!GetP2SHSigOpCount@{GetP2SHSigOpCount}}
\index{GetP2SHSigOpCount@{GetP2SHSigOpCount}!tx\_verify.cpp@{tx\_verify.cpp}}
\doxysubsubsection{GetP2SHSigOpCount()}
{\footnotesize\ttfamily \label{tx__verify_8cpp_ad6c100c0465bcda555599ecd8e5577b8} 
unsigned int Get\+P2\+SHSig\+Op\+Count (\begin{DoxyParamCaption}\item[{const \textbf{ CTransaction} \&}]{tx}{, }\item[{const \textbf{ CCoins\+View\+Cache} \&}]{map\+Inputs}{}\end{DoxyParamCaption})}

Count ECDSA signature operations in pay-\/to-\/script-\/hash inputs.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{in}}  & {\em map\+Inputs} & Map of previous transactions that have outputs we\textquotesingle{}re spending \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
maximum number of sigops required to validate this transaction\textquotesingle{}s inputs 
\end{DoxyReturn}
\begin{DoxySeeAlso}{See also}
CTransaction\+::\+Fetch\+Inputs 
\end{DoxySeeAlso}
\index{tx\_verify.cpp@{tx\_verify.cpp}!GetTransactionSigOpCost@{GetTransactionSigOpCost}}
\index{GetTransactionSigOpCost@{GetTransactionSigOpCost}!tx\_verify.cpp@{tx\_verify.cpp}}
\doxysubsubsection{GetTransactionSigOpCost()}
{\footnotesize\ttfamily \label{tx__verify_8cpp_ac1e236f29c0fd2b8ecee5a2846122151} 
int64\+\_\+t Get\+Transaction\+Sig\+Op\+Cost (\begin{DoxyParamCaption}\item[{const \textbf{ CTransaction} \&}]{tx}{, }\item[{const \textbf{ CCoins\+View\+Cache} \&}]{inputs}{, }\item[{\textbf{ script\+\_\+verify\+\_\+flags}}]{flags}{}\end{DoxyParamCaption})}

Compute total signature operation cost of a transaction. 
\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{in}}  & {\em tx} & Transaction for which we are computing the cost \\
\hline
\mbox{\texttt{in}}  & {\em inputs} & Map of previous transactions that have outputs we\textquotesingle{}re spending \\
\hline
\mbox{\texttt{in}}  & {\em flags} & Script verification flags \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Total signature operation cost of tx 
\end{DoxyReturn}
\index{tx\_verify.cpp@{tx\_verify.cpp}!IsFinalTx@{IsFinalTx}}
\index{IsFinalTx@{IsFinalTx}!tx\_verify.cpp@{tx\_verify.cpp}}
\doxysubsubsection{IsFinalTx()}
{\footnotesize\ttfamily \label{tx__verify_8cpp_adc332cd7ac94e639bb4239618341be19} 
bool Is\+Final\+Tx (\begin{DoxyParamCaption}\item[{const \textbf{ CTransaction} \&}]{tx}{, }\item[{int}]{n\+Block\+Height}{, }\item[{int64\+\_\+t}]{n\+Block\+Time}{}\end{DoxyParamCaption})}

Check if transaction is final and can be included in a block with the specified height and time. \doxyref{Consensus}{p.}{namespace_consensus} critical. \index{tx\_verify.cpp@{tx\_verify.cpp}!SequenceLocks@{SequenceLocks}}
\index{SequenceLocks@{SequenceLocks}!tx\_verify.cpp@{tx\_verify.cpp}}
\doxysubsubsection{SequenceLocks()}
{\footnotesize\ttfamily \label{tx__verify_8cpp_ad5b7bf644ada0a55c6aac8cfa89ed14a} 
bool Sequence\+Locks (\begin{DoxyParamCaption}\item[{const \textbf{ CTransaction} \&}]{tx}{, }\item[{int}]{flags}{, }\item[{std\+::vector$<$ int $>$ \&}]{prev\+Heights}{, }\item[{const \textbf{ CBlock\+Index} \&}]{block}{}\end{DoxyParamCaption})}

Check if transaction is final per BIP 68 sequence numbers and can be included in a block. \doxyref{Consensus}{p.}{namespace_consensus} critical. Takes as input a list of heights at which tx\textquotesingle{}s inputs (in order) confirmed. 