\doxysection{src/test/headers\+\_\+sync\+\_\+chainwork\+\_\+tests.cpp File Reference}
\label{headers__sync__chainwork__tests_8cpp}\index{src/test/headers\_sync\_chainwork\_tests.cpp@{src/test/headers\_sync\_chainwork\_tests.cpp}}
{\ttfamily \#include $<$chain.\+h$>$}\newline
{\ttfamily \#include $<$chainparams.\+h$>$}\newline
{\ttfamily \#include $<$consensus/params.\+h$>$}\newline
{\ttfamily \#include $<$headerssync.\+h$>$}\newline
{\ttfamily \#include $<$net\+\_\+processing.\+h$>$}\newline
{\ttfamily \#include $<$pow.\+h$>$}\newline
{\ttfamily \#include $<$test/util/setup\+\_\+common.\+h$>$}\newline
{\ttfamily \#include $<$validation.\+h$>$}\newline
{\ttfamily \#include $<$cstddef$>$}\newline
{\ttfamily \#include $<$vector$>$}\newline
{\ttfamily \#include $<$boost/test/unit\+\_\+test.\+hpp$>$}\newline
\doxysubsubsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \textbf{ Headers\+Generator\+Setup}
\end{DoxyCompactItemize}
\doxysubsubsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \textbf{ CHECK\+\_\+\+RESULT}(result\+\_\+expression,  hss,  exp\+\_\+state,  exp\+\_\+success,  exp\+\_\+request\+\_\+more,  exp\+\_\+headers\+\_\+size,  exp\+\_\+pow\+\_\+validated\+\_\+prev,  exp\+\_\+locator\+\_\+hash)
\end{DoxyCompactItemize}
\doxysubsubsection*{Typedefs}
\begin{DoxyCompactItemize}
\item 
using \textbf{ State} = \textbf{ Headers\+Sync\+State\+::\+State}
\end{DoxyCompactItemize}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\textbf{ BOOST\+\_\+\+AUTO\+\_\+\+TEST\+\_\+\+CASE} (sneaky\+\_\+redownload)
\item 
\textbf{ BOOST\+\_\+\+AUTO\+\_\+\+TEST\+\_\+\+CASE} (happy\+\_\+path)
\item 
\textbf{ BOOST\+\_\+\+AUTO\+\_\+\+TEST\+\_\+\+CASE} (too\+\_\+little\+\_\+work)
\end{DoxyCompactItemize}
\doxysubsubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
constexpr size\+\_\+t \textbf{ TARGET\+\_\+\+BLOCKS} \{15\textquotesingle{}000\}
\item 
constexpr \textbf{ arith\+\_\+uint256} \textbf{ CHAIN\+\_\+\+WORK} \{\textbf{ TARGET\+\_\+\+BLOCKS} $\ast$ 2\}
\item 
constexpr size\+\_\+t \textbf{ REDOWNLOAD\+\_\+\+BUFFER\+\_\+\+SIZE} \{\textbf{ TARGET\+\_\+\+BLOCKS} -\/ (MAX\+\_\+\+HEADERS\+\_\+\+RESULTS + 123)\}
\item 
constexpr size\+\_\+t \textbf{ COMMITMENT\+\_\+\+PERIOD} \{600\}
\end{DoxyCompactItemize}


\label{doc-define-members}
\doxysubsection{Macro Definition Documentation}
\index{headers\_sync\_chainwork\_tests.cpp@{headers\_sync\_chainwork\_tests.cpp}!CHECK\_RESULT@{CHECK\_RESULT}}
\index{CHECK\_RESULT@{CHECK\_RESULT}!headers\_sync\_chainwork\_tests.cpp@{headers\_sync\_chainwork\_tests.cpp}}
\doxysubsubsection{CHECK\_RESULT}
{\footnotesize\ttfamily \label{headers__sync__chainwork__tests_8cpp_a5081d03b0118bf8cf6c68a99bc51b518} 
\#define CHECK\+\_\+\+RESULT(\begin{DoxyParamCaption}\item[{}]{result\+\_\+expression}{, }\item[{}]{hss}{, }\item[{}]{exp\+\_\+state}{, }\item[{}]{exp\+\_\+success}{, }\item[{}]{exp\+\_\+request\+\_\+more}{, }\item[{}]{exp\+\_\+headers\+\_\+size}{, }\item[{}]{exp\+\_\+pow\+\_\+validated\+\_\+prev}{, }\item[{}]{exp\+\_\+locator\+\_\+hash}{}\end{DoxyParamCaption})}

{\bfseries Value\+:}
\begin{DoxyCode}{0}
\DoxyCodeLine{\ \ \ \ \textcolor{keywordflow}{do}\ \{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\ result\{result\_expression\};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}
\DoxyCodeLine{\ \ \ \ \ \ \ \ BOOST\_REQUIRE\_EQUAL(hss.GetState(),\ exp\_state);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}
\DoxyCodeLine{\ \ \ \ \ \ \ \ BOOST\_CHECK\_EQUAL(result.success,\ exp\_success);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}
\DoxyCodeLine{\ \ \ \ \ \ \ \ BOOST\_CHECK\_EQUAL(result.request\_more,\ exp\_request\_more);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}
\DoxyCodeLine{\ \ \ \ \ \ \ \ BOOST\_CHECK\_EQUAL(result.pow\_validated\_headers.size(),\ exp\_headers\_size);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::optional<uint256>\ pow\_validated\_prev\_opt\{exp\_pow\_validated\_prev\};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}
\DoxyCodeLine{\ \ \ \ \ \ \ \ if\ (pow\_validated\_prev\_opt)\ \{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ BOOST\_CHECK\_EQUAL(result.pow\_validated\_headers.at(0).hashPrevBlock,\ pow\_validated\_prev\_opt);\ \(\backslash\)}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ BOOST\_CHECK\_EQUAL(exp\_headers\_size,\ 0);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::optional<uint256>\ locator\_hash\_opt\{exp\_locator\_hash\};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}
\DoxyCodeLine{\ \ \ \ \ \ \ \ if\ (locator\_hash\_opt)\ \{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ BOOST\_CHECK\_EQUAL(hss.NextHeadersRequestLocator().vHave.at(0),\ locator\_hash\_opt);\ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ BOOST\_CHECK\_EQUAL(exp\_state,\ State::FINAL);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}
\DoxyCodeLine{\ \ \ \ \}\ \textcolor{keywordflow}{while}\ (\textcolor{keyword}{false})}

\end{DoxyCode}


\label{doc-typedef-members}
\doxysubsection{Typedef Documentation}
\index{headers\_sync\_chainwork\_tests.cpp@{headers\_sync\_chainwork\_tests.cpp}!State@{State}}
\index{State@{State}!headers\_sync\_chainwork\_tests.cpp@{headers\_sync\_chainwork\_tests.cpp}}
\doxysubsubsection{State}
{\footnotesize\ttfamily \label{headers__sync__chainwork__tests_8cpp_ae883f65c4951396ab945f766e09e3c94} 
using \textbf{ State} = \textbf{ Headers\+Sync\+State\+::\+State}}



\label{doc-func-members}
\doxysubsection{Function Documentation}
\index{headers\_sync\_chainwork\_tests.cpp@{headers\_sync\_chainwork\_tests.cpp}!BOOST\_AUTO\_TEST\_CASE@{BOOST\_AUTO\_TEST\_CASE}}
\index{BOOST\_AUTO\_TEST\_CASE@{BOOST\_AUTO\_TEST\_CASE}!headers\_sync\_chainwork\_tests.cpp@{headers\_sync\_chainwork\_tests.cpp}}
\doxysubsubsection{BOOST\_AUTO\_TEST\_CASE()\hspace{0.1cm}{\footnotesize\ttfamily [1/3]}}
{\footnotesize\ttfamily \label{headers__sync__chainwork__tests_8cpp_adaf2a9e718f159f3b1c7f50140f0206b} 
BOOST\+\_\+\+AUTO\+\_\+\+TEST\+\_\+\+CASE (\begin{DoxyParamCaption}\item[{happy\+\_\+path}]{}{}\end{DoxyParamCaption})}

\index{headers\_sync\_chainwork\_tests.cpp@{headers\_sync\_chainwork\_tests.cpp}!BOOST\_AUTO\_TEST\_CASE@{BOOST\_AUTO\_TEST\_CASE}}
\index{BOOST\_AUTO\_TEST\_CASE@{BOOST\_AUTO\_TEST\_CASE}!headers\_sync\_chainwork\_tests.cpp@{headers\_sync\_chainwork\_tests.cpp}}
\doxysubsubsection{BOOST\_AUTO\_TEST\_CASE()\hspace{0.1cm}{\footnotesize\ttfamily [2/3]}}
{\footnotesize\ttfamily \label{headers__sync__chainwork__tests_8cpp_ab2bedb0544dd726b874b468a17edd566} 
BOOST\+\_\+\+AUTO\+\_\+\+TEST\+\_\+\+CASE (\begin{DoxyParamCaption}\item[{sneaky\+\_\+redownload}]{}{}\end{DoxyParamCaption})}

\index{headers\_sync\_chainwork\_tests.cpp@{headers\_sync\_chainwork\_tests.cpp}!BOOST\_AUTO\_TEST\_CASE@{BOOST\_AUTO\_TEST\_CASE}}
\index{BOOST\_AUTO\_TEST\_CASE@{BOOST\_AUTO\_TEST\_CASE}!headers\_sync\_chainwork\_tests.cpp@{headers\_sync\_chainwork\_tests.cpp}}
\doxysubsubsection{BOOST\_AUTO\_TEST\_CASE()\hspace{0.1cm}{\footnotesize\ttfamily [3/3]}}
{\footnotesize\ttfamily \label{headers__sync__chainwork__tests_8cpp_a7833b4345b5680214f0a8d78940e7c72} 
BOOST\+\_\+\+AUTO\+\_\+\+TEST\+\_\+\+CASE (\begin{DoxyParamCaption}\item[{too\+\_\+little\+\_\+work}]{}{}\end{DoxyParamCaption})}



\label{doc-var-members}
\doxysubsection{Variable Documentation}
\index{headers\_sync\_chainwork\_tests.cpp@{headers\_sync\_chainwork\_tests.cpp}!CHAIN\_WORK@{CHAIN\_WORK}}
\index{CHAIN\_WORK@{CHAIN\_WORK}!headers\_sync\_chainwork\_tests.cpp@{headers\_sync\_chainwork\_tests.cpp}}
\doxysubsubsection{CHAIN\_WORK}
{\footnotesize\ttfamily \label{headers__sync__chainwork__tests_8cpp_ac1b9a37f14725c7a2b8f287a65eb709c} 
\textbf{ arith\+\_\+uint256} CHAIN\+\_\+\+WORK \{\textbf{ TARGET\+\_\+\+BLOCKS} $\ast$ 2\}\hspace{0.3cm}{\ttfamily [constexpr]}}

\index{headers\_sync\_chainwork\_tests.cpp@{headers\_sync\_chainwork\_tests.cpp}!COMMITMENT\_PERIOD@{COMMITMENT\_PERIOD}}
\index{COMMITMENT\_PERIOD@{COMMITMENT\_PERIOD}!headers\_sync\_chainwork\_tests.cpp@{headers\_sync\_chainwork\_tests.cpp}}
\doxysubsubsection{COMMITMENT\_PERIOD}
{\footnotesize\ttfamily \label{headers__sync__chainwork__tests_8cpp_ab468aef165611ac90cae8047029da4cf} 
size\+\_\+t COMMITMENT\+\_\+\+PERIOD \{600\}\hspace{0.3cm}{\ttfamily [constexpr]}}

\index{headers\_sync\_chainwork\_tests.cpp@{headers\_sync\_chainwork\_tests.cpp}!REDOWNLOAD\_BUFFER\_SIZE@{REDOWNLOAD\_BUFFER\_SIZE}}
\index{REDOWNLOAD\_BUFFER\_SIZE@{REDOWNLOAD\_BUFFER\_SIZE}!headers\_sync\_chainwork\_tests.cpp@{headers\_sync\_chainwork\_tests.cpp}}
\doxysubsubsection{REDOWNLOAD\_BUFFER\_SIZE}
{\footnotesize\ttfamily \label{headers__sync__chainwork__tests_8cpp_a328a5577602ede7431cced584910a017} 
size\+\_\+t REDOWNLOAD\+\_\+\+BUFFER\+\_\+\+SIZE \{\textbf{ TARGET\+\_\+\+BLOCKS} -\/ (MAX\+\_\+\+HEADERS\+\_\+\+RESULTS + 123)\}\hspace{0.3cm}{\ttfamily [constexpr]}}

\index{headers\_sync\_chainwork\_tests.cpp@{headers\_sync\_chainwork\_tests.cpp}!TARGET\_BLOCKS@{TARGET\_BLOCKS}}
\index{TARGET\_BLOCKS@{TARGET\_BLOCKS}!headers\_sync\_chainwork\_tests.cpp@{headers\_sync\_chainwork\_tests.cpp}}
\doxysubsubsection{TARGET\_BLOCKS}
{\footnotesize\ttfamily \label{headers__sync__chainwork__tests_8cpp_a3cb50571e0562dc8fe3e213e0e29238f} 
size\+\_\+t TARGET\+\_\+\+BLOCKS \{15\textquotesingle{}000\}\hspace{0.3cm}{\ttfamily [constexpr]}}

