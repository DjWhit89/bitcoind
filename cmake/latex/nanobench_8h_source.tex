\doxysection{nanobench.\+h}
\label{nanobench_8h_source}\index{src/bench/nanobench.h@{src/bench/nanobench.h}}
\textbf{ Go to the documentation of this file.}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{//\ \ \_\_\ \ \ \_\ \_\_\_\_\_\_\_\ \_\_\ \ \ \_\ \ \_\_\_\_\_\ \ \_\_\_\_\_\_\ \ \_\_\_\_\_\_\_\ \_\_\ \ \ \_\ \_\_\_\_\_\_\_\ \_\ \ \ \ \ \_}}
\DoxyCodeLine{00002\ \textcolor{comment}{//\ \ |\ \(\backslash\)\ \ |\ |\_\_\_\_\_|\ |\ \(\backslash\)\ \ |\ |\ \ \ \ \ |\ |\_\_\_\_\_]\ |\_\_\_\_\_\_\ |\ \(\backslash\)\ \ |\ |\ \ \ \ \ \ \ |\_\_\_\_\_|}}
\DoxyCodeLine{00003\ \textcolor{comment}{//\ \ |\ \ \(\backslash\)\_|\ |\ \ \ \ \ |\ |\ \ \(\backslash\)\_|\ |\_\_\_\_\_|\ |\_\_\_\_\_]\ |\_\_\_\_\_\_\ |\ \ \(\backslash\)\_|\ |\_\_\_\_\_\ \ |\ \ \ \ \ |}}
\DoxyCodeLine{00004\ \textcolor{comment}{//}}
\DoxyCodeLine{00005\ \textcolor{comment}{//\ Microbenchmark\ framework\ for\ C++11/14/17/20}}
\DoxyCodeLine{00006\ \textcolor{comment}{//\ https://github.com/martinus/nanobench}}
\DoxyCodeLine{00007\ \textcolor{comment}{//}}
\DoxyCodeLine{00008\ \textcolor{comment}{//\ Licensed\ under\ the\ MIT\ License\ <http://opensource.org/licenses/MIT>.}}
\DoxyCodeLine{00009\ \textcolor{comment}{//\ SPDX-\/License-\/Identifier:\ MIT}}
\DoxyCodeLine{00010\ \textcolor{comment}{//\ Copyright\ (c)\ 2019-\/2023\ Martin\ Leitner-\/Ankerl\ <martin.ankerl@gmail.com>}}
\DoxyCodeLine{00011\ \textcolor{comment}{//}}
\DoxyCodeLine{00012\ \textcolor{comment}{//\ Permission\ is\ hereby\ granted,\ free\ of\ charge,\ to\ any\ person\ obtaining\ a\ copy}}
\DoxyCodeLine{00013\ \textcolor{comment}{//\ of\ this\ software\ and\ associated\ documentation\ files\ (the\ "{}Software"{}),\ to\ deal}}
\DoxyCodeLine{00014\ \textcolor{comment}{//\ in\ the\ Software\ without\ restriction,\ including\ without\ limitation\ the\ rights}}
\DoxyCodeLine{00015\ \textcolor{comment}{//\ to\ use,\ copy,\ modify,\ merge,\ publish,\ distribute,\ sublicense,\ and/or\ sell}}
\DoxyCodeLine{00016\ \textcolor{comment}{//\ copies\ of\ the\ Software,\ and\ to\ permit\ persons\ to\ whom\ the\ Software\ is}}
\DoxyCodeLine{00017\ \textcolor{comment}{//\ furnished\ to\ do\ so,\ subject\ to\ the\ following\ conditions:}}
\DoxyCodeLine{00018\ \textcolor{comment}{//}}
\DoxyCodeLine{00019\ \textcolor{comment}{//\ The\ above\ copyright\ notice\ and\ this\ permission\ notice\ shall\ be\ included\ in\ all}}
\DoxyCodeLine{00020\ \textcolor{comment}{//\ copies\ or\ substantial\ portions\ of\ the\ Software.}}
\DoxyCodeLine{00021\ \textcolor{comment}{//}}
\DoxyCodeLine{00022\ \textcolor{comment}{//\ THE\ SOFTWARE\ IS\ PROVIDED\ "{}AS\ IS"{},\ WITHOUT\ WARRANTY\ OF\ ANY\ KIND,\ EXPRESS\ OR}}
\DoxyCodeLine{00023\ \textcolor{comment}{//\ IMPLIED,\ INCLUDING\ BUT\ NOT\ LIMITED\ TO\ THE\ WARRANTIES\ OF\ MERCHANTABILITY,}}
\DoxyCodeLine{00024\ \textcolor{comment}{//\ FITNESS\ FOR\ A\ PARTICULAR\ PURPOSE\ AND\ NONINFRINGEMENT.\ IN\ NO\ EVENT\ SHALL\ THE}}
\DoxyCodeLine{00025\ \textcolor{comment}{//\ AUTHORS\ OR\ COPYRIGHT\ HOLDERS\ BE\ LIABLE\ FOR\ ANY\ CLAIM,\ DAMAGES\ OR\ OTHER}}
\DoxyCodeLine{00026\ \textcolor{comment}{//\ LIABILITY,\ WHETHER\ IN\ AN\ ACTION\ OF\ CONTRACT,\ TORT\ OR\ OTHERWISE,\ ARISING\ FROM,}}
\DoxyCodeLine{00027\ \textcolor{comment}{//\ OUT\ OF\ OR\ IN\ CONNECTION\ WITH\ THE\ SOFTWARE\ OR\ THE\ USE\ OR\ OTHER\ DEALINGS\ IN\ THE}}
\DoxyCodeLine{00028\ \textcolor{comment}{//\ SOFTWARE.}}
\DoxyCodeLine{00029\ }
\DoxyCodeLine{00030\ \textcolor{preprocessor}{\#ifndef\ ANKERL\_NANOBENCH\_H\_INCLUDED}}
\DoxyCodeLine{00031\ \textcolor{preprocessor}{\#define\ ANKERL\_NANOBENCH\_H\_INCLUDED}}
\DoxyCodeLine{00032\ }
\DoxyCodeLine{00033\ \textcolor{comment}{//\ see\ https://semver.org/}}
\DoxyCodeLine{00034\ \textcolor{preprocessor}{\#define\ ANKERL\_NANOBENCH\_VERSION\_MAJOR\ 4\ \ }\textcolor{comment}{//\ incompatible\ API\ changes}}
\DoxyCodeLine{00035\ \textcolor{preprocessor}{\#define\ ANKERL\_NANOBENCH\_VERSION\_MINOR\ 3\ \ }\textcolor{comment}{//\ backwards-\/compatible\ changes}}
\DoxyCodeLine{00036\ \textcolor{preprocessor}{\#define\ ANKERL\_NANOBENCH\_VERSION\_PATCH\ 11\ }\textcolor{comment}{//\ backwards-\/compatible\ bug\ fixes}}
\DoxyCodeLine{00037\ }
\DoxyCodeLine{00039\ \textcolor{comment}{//\ public\ facing\ api\ -\/\ as\ minimal\ as\ possible}}
\DoxyCodeLine{00041\ }
\DoxyCodeLine{00042\ \textcolor{preprocessor}{\#include\ <chrono>}\ \ \ \ \ \ \ \ \textcolor{comment}{//\ high\_resolution\_clock}}
\DoxyCodeLine{00043\ \textcolor{preprocessor}{\#include\ <cstring>}\ \ \ \ \ \ \ \textcolor{comment}{//\ memcpy}}
\DoxyCodeLine{00044\ \textcolor{preprocessor}{\#include\ <iosfwd>}\ \ \ \ \ \ \ \ \textcolor{comment}{//\ for\ std::ostream*\ custom\ output\ target\ in\ Config}}
\DoxyCodeLine{00045\ \textcolor{preprocessor}{\#include\ <string>}\ \ \ \ \ \ \ \ \textcolor{comment}{//\ all\ names}}
\DoxyCodeLine{00046\ \textcolor{preprocessor}{\#include\ <unordered\_map>}\ \textcolor{comment}{//\ holds\ context\ information\ of\ results}}
\DoxyCodeLine{00047\ \textcolor{preprocessor}{\#include\ <vector>}\ \ \ \ \ \ \ \ \textcolor{comment}{//\ holds\ all\ results}}
\DoxyCodeLine{00048\ }
\DoxyCodeLine{00049\ \textcolor{preprocessor}{\#define\ ANKERL\_NANOBENCH(x)\ ANKERL\_NANOBENCH\_PRIVATE\_\#\#x()}}
\DoxyCodeLine{00050\ }
\DoxyCodeLine{00051\ \textcolor{preprocessor}{\#define\ ANKERL\_NANOBENCH\_PRIVATE\_CXX()\ \_\_cplusplus}}
\DoxyCodeLine{00052\ \textcolor{preprocessor}{\#define\ ANKERL\_NANOBENCH\_PRIVATE\_CXX98()\ 199711L}}
\DoxyCodeLine{00053\ \textcolor{preprocessor}{\#define\ ANKERL\_NANOBENCH\_PRIVATE\_CXX11()\ 201103L}}
\DoxyCodeLine{00054\ \textcolor{preprocessor}{\#define\ ANKERL\_NANOBENCH\_PRIVATE\_CXX14()\ 201402L}}
\DoxyCodeLine{00055\ \textcolor{preprocessor}{\#define\ ANKERL\_NANOBENCH\_PRIVATE\_CXX17()\ 201703L}}
\DoxyCodeLine{00056\ }
\DoxyCodeLine{00057\ \textcolor{preprocessor}{\#if\ ANKERL\_NANOBENCH(CXX)\ >=\ ANKERL\_NANOBENCH(CXX17)}}
\DoxyCodeLine{00058\ \textcolor{preprocessor}{\#\ \ \ \ define\ ANKERL\_NANOBENCH\_PRIVATE\_NODISCARD()\ [[nodiscard]]}}
\DoxyCodeLine{00059\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00060\ \textcolor{preprocessor}{\#\ \ \ \ define\ ANKERL\_NANOBENCH\_PRIVATE\_NODISCARD()}}
\DoxyCodeLine{00061\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00062\ }
\DoxyCodeLine{00063\ \textcolor{preprocessor}{\#if\ defined(\_\_clang\_\_)}}
\DoxyCodeLine{00064\ \textcolor{preprocessor}{\#\ \ \ \ define\ ANKERL\_NANOBENCH\_PRIVATE\_IGNORE\_PADDED\_PUSH()\ \(\backslash\)}}
\DoxyCodeLine{00065\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \_Pragma("{}clang\ diagnostic\ push"{})\ \_Pragma("{}clang\ diagnostic\ ignored\ \(\backslash\)"{}-\/Wpadded\(\backslash\)"{}"{})}}
\DoxyCodeLine{00066\ \textcolor{preprocessor}{\#\ \ \ \ define\ ANKERL\_NANOBENCH\_PRIVATE\_IGNORE\_PADDED\_POP()\ \_Pragma("{}clang\ diagnostic\ pop"{})}}
\DoxyCodeLine{00067\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00068\ \textcolor{preprocessor}{\#\ \ \ \ define\ ANKERL\_NANOBENCH\_PRIVATE\_IGNORE\_PADDED\_PUSH()}}
\DoxyCodeLine{00069\ \textcolor{preprocessor}{\#\ \ \ \ define\ ANKERL\_NANOBENCH\_PRIVATE\_IGNORE\_PADDED\_POP()}}
\DoxyCodeLine{00070\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00071\ }
\DoxyCodeLine{00072\ \textcolor{preprocessor}{\#if\ defined(\_\_GNUC\_\_)}}
\DoxyCodeLine{00073\ \textcolor{preprocessor}{\#\ \ \ \ define\ ANKERL\_NANOBENCH\_PRIVATE\_IGNORE\_EFFCPP\_PUSH()\ \_Pragma("{}GCC\ diagnostic\ push"{})\ \_Pragma("{}GCC\ diagnostic\ ignored\ \(\backslash\)"{}-\/Weffc++\(\backslash\)"{}"{})}}
\DoxyCodeLine{00074\ \textcolor{preprocessor}{\#\ \ \ \ define\ ANKERL\_NANOBENCH\_PRIVATE\_IGNORE\_EFFCPP\_POP()\ \_Pragma("{}GCC\ diagnostic\ pop"{})}}
\DoxyCodeLine{00075\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00076\ \textcolor{preprocessor}{\#\ \ \ \ define\ ANKERL\_NANOBENCH\_PRIVATE\_IGNORE\_EFFCPP\_PUSH()}}
\DoxyCodeLine{00077\ \textcolor{preprocessor}{\#\ \ \ \ define\ ANKERL\_NANOBENCH\_PRIVATE\_IGNORE\_EFFCPP\_POP()}}
\DoxyCodeLine{00078\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00079\ }
\DoxyCodeLine{00080\ \textcolor{preprocessor}{\#if\ defined(ANKERL\_NANOBENCH\_LOG\_ENABLED)}}
\DoxyCodeLine{00081\ \textcolor{preprocessor}{\#\ \ \ \ include\ <iostream>}}
\DoxyCodeLine{00082\ \textcolor{preprocessor}{\#\ \ \ \ define\ ANKERL\_NANOBENCH\_LOG(x)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00083\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ do\ \{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00084\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ std::cout\ <<\ \_\_FUNCTION\_\_\ <<\ "{}@"{}\ <<\ \_\_LINE\_\_\ <<\ "{}:\ "{}\ <<\ x\ <<\ std::endl;\ \(\backslash\)}}
\DoxyCodeLine{00085\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \}\ while\ (0)}}
\DoxyCodeLine{00086\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00087\ \textcolor{preprocessor}{\#\ \ \ \ define\ ANKERL\_NANOBENCH\_LOG(x)\ \(\backslash\)}}
\DoxyCodeLine{00088\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ do\ \{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00089\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \}\ while\ (0)}}
\DoxyCodeLine{00090\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00091\ }
\DoxyCodeLine{00092\ \textcolor{preprocessor}{\#define\ ANKERL\_NANOBENCH\_PRIVATE\_PERF\_COUNTERS()\ 0}}
\DoxyCodeLine{00093\ \textcolor{preprocessor}{\#if\ defined(\_\_linux\_\_)\ \&\&\ !defined(ANKERL\_NANOBENCH\_DISABLE\_PERF\_COUNTERS)}}
\DoxyCodeLine{00094\ \textcolor{preprocessor}{\#\ \ \ \ include\ <linux/version.h>}}
\DoxyCodeLine{00095\ \textcolor{preprocessor}{\#\ \ \ \ if\ LINUX\_VERSION\_CODE\ >=\ KERNEL\_VERSION(3,\ 3,\ 0)}}
\DoxyCodeLine{00096\ \textcolor{comment}{//\ PERF\_COUNT\_HW\_REF\_CPU\_CYCLES\ only\ available\ since\ kernel\ 3.3}}
\DoxyCodeLine{00097\ \textcolor{comment}{//\ PERF\_FLAG\_FD\_CLOEXEC\ since\ kernel\ 3.14}}
\DoxyCodeLine{00098\ \textcolor{preprocessor}{\#\ \ \ \ \ \ \ \ undef\ ANKERL\_NANOBENCH\_PRIVATE\_PERF\_COUNTERS}}
\DoxyCodeLine{00099\ \textcolor{preprocessor}{\#\ \ \ \ \ \ \ \ define\ ANKERL\_NANOBENCH\_PRIVATE\_PERF\_COUNTERS()\ 1}}
\DoxyCodeLine{00100\ \textcolor{preprocessor}{\#\ \ \ \ endif}}
\DoxyCodeLine{00101\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00102\ }
\DoxyCodeLine{00103\ \textcolor{preprocessor}{\#if\ defined(\_\_clang\_\_)}}
\DoxyCodeLine{00104\ \textcolor{preprocessor}{\#\ \ \ \ define\ ANKERL\_NANOBENCH\_NO\_SANITIZE(...)\ \_\_attribute\_\_((no\_sanitize(\_\_VA\_ARGS\_\_)))}}
\DoxyCodeLine{00105\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00106\ \textcolor{preprocessor}{\#\ \ \ \ define\ ANKERL\_NANOBENCH\_NO\_SANITIZE(...)}}
\DoxyCodeLine{00107\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00108\ }
\DoxyCodeLine{00109\ \textcolor{preprocessor}{\#if\ defined(\_MSC\_VER)}}
\DoxyCodeLine{00110\ \textcolor{preprocessor}{\#\ \ \ \ define\ ANKERL\_NANOBENCH\_PRIVATE\_NOINLINE()\ \_\_declspec(noinline)}}
\DoxyCodeLine{00111\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00112\ \textcolor{preprocessor}{\#\ \ \ \ define\ ANKERL\_NANOBENCH\_PRIVATE\_NOINLINE()\ \_\_attribute\_\_((noinline))}}
\DoxyCodeLine{00113\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00114\ }
\DoxyCodeLine{00115\ \textcolor{comment}{//\ workaround\ missing\ "{}is\_trivially\_copyable"{}\ in\ g++\ <\ 5.0}}
\DoxyCodeLine{00116\ \textcolor{comment}{//\ See\ https://stackoverflow.com/a/31798726/48181}}
\DoxyCodeLine{00117\ \textcolor{preprocessor}{\#if\ defined(\_\_GNUC\_\_)\ \&\&\ \_\_GNUC\_\_\ <\ 5}}
\DoxyCodeLine{00118\ \textcolor{preprocessor}{\#\ \ \ \ define\ ANKERL\_NANOBENCH\_IS\_TRIVIALLY\_COPYABLE(...)\ \_\_has\_trivial\_copy(\_\_VA\_ARGS\_\_)}}
\DoxyCodeLine{00119\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00120\ \textcolor{preprocessor}{\#\ \ \ \ define\ ANKERL\_NANOBENCH\_IS\_TRIVIALLY\_COPYABLE(...)\ std::is\_trivially\_copyable<\_\_VA\_ARGS\_\_>::value}}
\DoxyCodeLine{00121\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00122\ }
\DoxyCodeLine{00123\ \textcolor{comment}{//\ noexcept\ may\ be\ missing\ for\ std::string.}}
\DoxyCodeLine{00124\ \textcolor{comment}{//\ See\ https://gcc.gnu.org/bugzilla/show\_bug.cgi?id=58265}}
\DoxyCodeLine{00125\ \textcolor{preprocessor}{\#define\ ANKERL\_NANOBENCH\_PRIVATE\_NOEXCEPT\_STRING\_MOVE()\ std::is\_nothrow\_move\_assignable<std::string>::value}}
\DoxyCodeLine{00126\ }
\DoxyCodeLine{00127\ \textcolor{comment}{//\ declarations\ ///////////////////////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{00128\ }
\DoxyCodeLine{00129\ \textcolor{keyword}{namespace\ }ankerl\ \{}
\DoxyCodeLine{00130\ \textcolor{keyword}{namespace\ }nanobench\ \{}
\DoxyCodeLine{00131\ }
\DoxyCodeLine{00132\ \textcolor{keyword}{using\ }Clock\ =\ std::conditional<std::chrono::high\_resolution\_clock::is\_steady,\ std::chrono::high\_resolution\_clock,}
\DoxyCodeLine{00133\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::chrono::steady\_clock>::type;}
\DoxyCodeLine{00134\ \textcolor{keyword}{class\ }Bench;}
\DoxyCodeLine{00135\ \textcolor{keyword}{struct\ }Config;}
\DoxyCodeLine{00136\ \textcolor{keyword}{class\ }Result;}
\DoxyCodeLine{00137\ \textcolor{keyword}{class\ }Rng;}
\DoxyCodeLine{00138\ \textcolor{keyword}{class\ }BigO;}
\DoxyCodeLine{00139\ }
\DoxyCodeLine{00290\ \textcolor{keywordtype}{void}\ render(\textcolor{keywordtype}{char}\ \textcolor{keyword}{const}*\ mustacheTemplate,\ Bench\ \textcolor{keyword}{const}\&\ bench,\ std::ostream\&\ out);}
\DoxyCodeLine{00291\ \textcolor{keywordtype}{void}\ render(std::string\ \textcolor{keyword}{const}\&\ mustacheTemplate,\ Bench\ \textcolor{keyword}{const}\&\ bench,\ std::ostream\&\ out);}
\DoxyCodeLine{00292\ }
\DoxyCodeLine{00301\ \textcolor{keywordtype}{void}\ render(\textcolor{keywordtype}{char}\ \textcolor{keyword}{const}*\ mustacheTemplate,\ std::vector<Result>\ \textcolor{keyword}{const}\&\ results,\ std::ostream\&\ out);}
\DoxyCodeLine{00302\ \textcolor{keywordtype}{void}\ render(std::string\ \textcolor{keyword}{const}\&\ mustacheTemplate,\ std::vector<Result>\ \textcolor{keyword}{const}\&\ results,\ std::ostream\&\ out);}
\DoxyCodeLine{00303\ }
\DoxyCodeLine{00304\ \textcolor{comment}{//\ Contains\ mustache-\/like\ templates}}
\DoxyCodeLine{00305\ \textcolor{keyword}{namespace\ }templates\ \{}
\DoxyCodeLine{00306\ }
\DoxyCodeLine{00316\ \textcolor{keywordtype}{char}\ \textcolor{keyword}{const}*\ csv()\ noexcept;}
\DoxyCodeLine{00317\ }
\DoxyCodeLine{00328\ \textcolor{keywordtype}{char}\ const*\ htmlBoxplot()\ noexcept;}
\DoxyCodeLine{00329\ }
\DoxyCodeLine{00336\ \textcolor{keywordtype}{char}\ const*\ pyperf()\ noexcept;}
\DoxyCodeLine{00337\ }
\DoxyCodeLine{00347\ \textcolor{keywordtype}{char}\ const*\ json()\ noexcept;}
\DoxyCodeLine{00348\ }
\DoxyCodeLine{00349\ \}\ \textcolor{comment}{//\ namespace\ templates}}
\DoxyCodeLine{00350\ }
\DoxyCodeLine{00351\ namespace\ detail\ \{}
\DoxyCodeLine{00352\ }
\DoxyCodeLine{00353\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00354\ \textcolor{keyword}{struct\ }PerfCountSet;}
\DoxyCodeLine{00355\ }
\DoxyCodeLine{00356\ \textcolor{keyword}{class\ }IterationLogic;}
\DoxyCodeLine{00357\ \textcolor{keyword}{class\ }PerformanceCounters;}
\DoxyCodeLine{00358\ }
\DoxyCodeLine{00359\ \textcolor{preprocessor}{\#if\ ANKERL\_NANOBENCH(PERF\_COUNTERS)}}
\DoxyCodeLine{00360\ \textcolor{keyword}{class\ }LinuxPerformanceCounters;}
\DoxyCodeLine{00361\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00362\ }
\DoxyCodeLine{00363\ \}\ \textcolor{comment}{//\ namespace\ detail}}
\DoxyCodeLine{00364\ \}\ \textcolor{comment}{//\ namespace\ nanobench}}
\DoxyCodeLine{00365\ \}\ \textcolor{comment}{//\ namespace\ ankerl}}
\DoxyCodeLine{00366\ }
\DoxyCodeLine{00367\ \textcolor{comment}{//\ definitions\ ////////////////////////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{00368\ }
\DoxyCodeLine{00369\ \textcolor{keyword}{namespace\ }ankerl\ \{}
\DoxyCodeLine{00370\ \textcolor{keyword}{namespace\ }nanobench\ \{}
\DoxyCodeLine{00371\ \textcolor{keyword}{namespace\ }detail\ \{}
\DoxyCodeLine{00372\ }
\DoxyCodeLine{00373\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00374\ \textcolor{keyword}{struct\ }PerfCountSet\ \{}
\DoxyCodeLine{00375\ \ \ \ \ T\ pageFaults\{\};}
\DoxyCodeLine{00376\ \ \ \ \ T\ cpuCycles\{\};}
\DoxyCodeLine{00377\ \ \ \ \ T\ contextSwitches\{\};}
\DoxyCodeLine{00378\ \ \ \ \ T\ instructions\{\};}
\DoxyCodeLine{00379\ \ \ \ \ T\ branchInstructions\{\};}
\DoxyCodeLine{00380\ \ \ \ \ T\ branchMisses\{\};}
\DoxyCodeLine{00381\ \};}
\DoxyCodeLine{00382\ }
\DoxyCodeLine{00383\ \}\ \textcolor{comment}{//\ namespace\ detail}}
\DoxyCodeLine{00384\ }
\DoxyCodeLine{00385\ ANKERL\_NANOBENCH(IGNORE\_PADDED\_PUSH)}
\DoxyCodeLine{00386\ struct\ Config\ \{}
\DoxyCodeLine{00387\ \ \ \ \ \textcolor{comment}{//\ actual\ benchmark\ config}}
\DoxyCodeLine{00388\ \ \ \ \ std::string\ mBenchmarkTitle\ =\ \textcolor{stringliteral}{"{}benchmark"{}};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ NOLINT(misc-\/non-\/private-\/member-\/variables-\/in-\/classes)}}
\DoxyCodeLine{00389\ \ \ \ \ std::string\ mBenchmarkName\ =\ \textcolor{stringliteral}{"{}noname"{}};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ NOLINT(misc-\/non-\/private-\/member-\/variables-\/in-\/classes)}}
\DoxyCodeLine{00390\ \ \ \ \ std::string\ mUnit\ =\ \textcolor{stringliteral}{"{}op"{}};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ NOLINT(misc-\/non-\/private-\/member-\/variables-\/in-\/classes)}}
\DoxyCodeLine{00391\ \ \ \ \ \textcolor{keywordtype}{double}\ mBatch\ =\ 1.0;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ NOLINT(misc-\/non-\/private-\/member-\/variables-\/in-\/classes)}}
\DoxyCodeLine{00392\ \ \ \ \ \textcolor{keywordtype}{double}\ mComplexityN\ =\ -\/1.0;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ NOLINT(misc-\/non-\/private-\/member-\/variables-\/in-\/classes)}}
\DoxyCodeLine{00393\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ mNumEpochs\ =\ 11;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ NOLINT(misc-\/non-\/private-\/member-\/variables-\/in-\/classes)}}
\DoxyCodeLine{00394\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ mClockResolutionMultiple\ =\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{size\_t}\textcolor{keyword}{>}(1000);\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ NOLINT(misc-\/non-\/private-\/member-\/variables-\/in-\/classes)}}
\DoxyCodeLine{00395\ \ \ \ \ std::chrono::nanoseconds\ mMaxEpochTime\ =\ std::chrono::milliseconds(100);\ \textcolor{comment}{//\ NOLINT(misc-\/non-\/private-\/member-\/variables-\/in-\/classes)}}
\DoxyCodeLine{00396\ \ \ \ \ std::chrono::nanoseconds\ mMinEpochTime\ =\ std::chrono::milliseconds(1);\ \ \ \textcolor{comment}{//\ NOLINT(misc-\/non-\/private-\/member-\/variables-\/in-\/classes)}}
\DoxyCodeLine{00397\ \ \ \ \ uint64\_t\ mMinEpochIterations\{1\};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ NOLINT(misc-\/non-\/private-\/member-\/variables-\/in-\/classes)}}
\DoxyCodeLine{00398\ \ \ \ \ \textcolor{comment}{//\ If\ not\ 0,\ run\ *exactly*\ these\ number\ of\ iterations\ per\ epoch.}}
\DoxyCodeLine{00399\ \ \ \ \ uint64\_t\ mEpochIterations\{0\};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ NOLINT(misc-\/non-\/private-\/member-\/variables-\/in-\/classes)}}
\DoxyCodeLine{00400\ \ \ \ \ uint64\_t\ mWarmup\ =\ 0;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ NOLINT(misc-\/non-\/private-\/member-\/variables-\/in-\/classes)}}
\DoxyCodeLine{00401\ \ \ \ \ std::ostream*\ mOut\ =\ \textcolor{keyword}{nullptr};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ NOLINT(misc-\/non-\/private-\/member-\/variables-\/in-\/classes)}}
\DoxyCodeLine{00402\ \ \ \ \ std::chrono::duration<double>\ mTimeUnit\ =\ std::chrono::nanoseconds\{1\};\ \textcolor{comment}{//\ NOLINT(misc-\/non-\/private-\/member-\/variables-\/in-\/classes)}}
\DoxyCodeLine{00403\ \ \ \ \ std::string\ mTimeUnitName\ =\ \textcolor{stringliteral}{"{}ns"{}};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ NOLINT(misc-\/non-\/private-\/member-\/variables-\/in-\/classes)}}
\DoxyCodeLine{00404\ \ \ \ \ \textcolor{keywordtype}{bool}\ mShowPerformanceCounters\ =\ \textcolor{keyword}{true};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ NOLINT(misc-\/non-\/private-\/member-\/variables-\/in-\/classes)}}
\DoxyCodeLine{00405\ \ \ \ \ \textcolor{keywordtype}{bool}\ mIsRelative\ =\ \textcolor{keyword}{false};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ NOLINT(misc-\/non-\/private-\/member-\/variables-\/in-\/classes)}}
\DoxyCodeLine{00406\ \ \ \ \ std::unordered\_map<std::string,\ std::string>\ mContext\{\};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ NOLINT(misc-\/non-\/private-\/member-\/variables-\/in-\/classes)}}
\DoxyCodeLine{00407\ }
\DoxyCodeLine{00408\ \ \ \ \ Config();}
\DoxyCodeLine{00409\ \ \ \ \ \string~Config();}
\DoxyCodeLine{00410\ \ \ \ \ Config\&\ operator=(Config\ \textcolor{keyword}{const}\&\ other);}
\DoxyCodeLine{00411\ \ \ \ \ Config\&\ operator=(Config\&\&\ other)\ \textcolor{keyword}{noexcept}(ANKERL\_NANOBENCH(NOEXCEPT\_STRING\_MOVE));}
\DoxyCodeLine{00412\ \ \ \ \ Config(Config\ \textcolor{keyword}{const}\&\ other);}
\DoxyCodeLine{00413\ \ \ \ \ Config(Config\&\&\ other)\ \textcolor{keyword}{noexcept};}
\DoxyCodeLine{00414\ \};}
\DoxyCodeLine{00415\ ANKERL\_NANOBENCH(IGNORE\_PADDED\_POP)}
\DoxyCodeLine{00416\ }
\DoxyCodeLine{00417\ \textcolor{comment}{//\ Result\ returned\ after\ a\ benchmark\ has\ finished.\ Can\ be\ used\ as\ a\ baseline\ for\ relative().}}
\DoxyCodeLine{00418\ ANKERL\_NANOBENCH(IGNORE\_PADDED\_PUSH)}
\DoxyCodeLine{00419\ class\ Result\ \{}
\DoxyCodeLine{00420\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00421\ \ \ \ \ \textcolor{keyword}{enum\ class}\ Measure\ :\ \textcolor{keywordtype}{size\_t}\ \{}
\DoxyCodeLine{00422\ \ \ \ \ \ \ \ \ elapsed,}
\DoxyCodeLine{00423\ \ \ \ \ \ \ \ \ iterations,}
\DoxyCodeLine{00424\ \ \ \ \ \ \ \ \ pagefaults,}
\DoxyCodeLine{00425\ \ \ \ \ \ \ \ \ cpucycles,}
\DoxyCodeLine{00426\ \ \ \ \ \ \ \ \ contextswitches,}
\DoxyCodeLine{00427\ \ \ \ \ \ \ \ \ instructions,}
\DoxyCodeLine{00428\ \ \ \ \ \ \ \ \ branchinstructions,}
\DoxyCodeLine{00429\ \ \ \ \ \ \ \ \ branchmisses,}
\DoxyCodeLine{00430\ \ \ \ \ \ \ \ \ \_size}
\DoxyCodeLine{00431\ \ \ \ \ \};}
\DoxyCodeLine{00432\ }
\DoxyCodeLine{00433\ \ \ \ \ \textcolor{keyword}{explicit}\ Result(Config\ benchmarkConfig);}
\DoxyCodeLine{00434\ }
\DoxyCodeLine{00435\ \ \ \ \ \string~Result();}
\DoxyCodeLine{00436\ \ \ \ \ Result\&\ operator=(Result\ \textcolor{keyword}{const}\&\ other);}
\DoxyCodeLine{00437\ \ \ \ \ Result\&\ operator=(Result\&\&\ other)\ \textcolor{keyword}{noexcept}(ANKERL\_NANOBENCH(NOEXCEPT\_STRING\_MOVE));}
\DoxyCodeLine{00438\ \ \ \ \ Result(Result\ \textcolor{keyword}{const}\&\ other);}
\DoxyCodeLine{00439\ \ \ \ \ Result(Result\&\&\ other)\ \textcolor{keyword}{noexcept};}
\DoxyCodeLine{00440\ }
\DoxyCodeLine{00441\ \ \ \ \ \textcolor{comment}{//\ adds\ new\ measurement\ results}}
\DoxyCodeLine{00442\ \ \ \ \ \textcolor{comment}{//\ all\ values\ are\ scaled\ by\ iters\ (except\ iters...)}}
\DoxyCodeLine{00443\ \ \ \ \ \textcolor{keywordtype}{void}\ add(Clock::duration\ totalElapsed,\ uint64\_t\ iters,\ detail::PerformanceCounters\ \textcolor{keyword}{const}\&\ pc);}
\DoxyCodeLine{00444\ }
\DoxyCodeLine{00445\ \ \ \ \ ANKERL\_NANOBENCH(NODISCARD)\ Config\ \textcolor{keyword}{const}\&\ config()\ const\ noexcept;}
\DoxyCodeLine{00446\ }
\DoxyCodeLine{00447\ \ \ \ \ ANKERL\_NANOBENCH(NODISCARD)\ \textcolor{keywordtype}{double}\ median(Measure\ m)\ const;}
\DoxyCodeLine{00448\ \ \ \ \ ANKERL\_NANOBENCH(NODISCARD)\ \textcolor{keywordtype}{double}\ medianAbsolutePercentError(Measure\ m)\ const;}
\DoxyCodeLine{00449\ \ \ \ \ ANKERL\_NANOBENCH(NODISCARD)\ \textcolor{keywordtype}{double}\ average(Measure\ m)\ const;}
\DoxyCodeLine{00450\ \ \ \ \ ANKERL\_NANOBENCH(NODISCARD)\ \textcolor{keywordtype}{double}\ sum(Measure\ m)\ const\ noexcept;}
\DoxyCodeLine{00451\ \ \ \ \ ANKERL\_NANOBENCH(NODISCARD)\ \textcolor{keywordtype}{double}\ sumProduct(Measure\ m1,\ Measure\ m2)\ const\ noexcept;}
\DoxyCodeLine{00452\ \ \ \ \ ANKERL\_NANOBENCH(NODISCARD)\ \textcolor{keywordtype}{double}\ minimum(Measure\ m)\ const\ noexcept;}
\DoxyCodeLine{00453\ \ \ \ \ ANKERL\_NANOBENCH(NODISCARD)\ \textcolor{keywordtype}{double}\ maximum(Measure\ m)\ const\ noexcept;}
\DoxyCodeLine{00454\ \ \ \ \ ANKERL\_NANOBENCH(NODISCARD)\ std::\textcolor{keywordtype}{string}\ const\&\ context(\textcolor{keywordtype}{char}\ const*\ variableName)\ const;}
\DoxyCodeLine{00455\ \ \ \ \ ANKERL\_NANOBENCH(NODISCARD)\ std::\textcolor{keywordtype}{string}\ const\&\ context(std::\textcolor{keywordtype}{string}\ const\&\ variableName)\ const;}
\DoxyCodeLine{00456\ }
\DoxyCodeLine{00457\ \ \ \ \ ANKERL\_NANOBENCH(NODISCARD)\ \textcolor{keywordtype}{bool}\ has(Measure\ m)\ const\ noexcept;}
\DoxyCodeLine{00458\ \ \ \ \ ANKERL\_NANOBENCH(NODISCARD)\ \textcolor{keywordtype}{double}\ get(\textcolor{keywordtype}{size\_t}\ idx,\ Measure\ m)\ const;}
\DoxyCodeLine{00459\ \ \ \ \ ANKERL\_NANOBENCH(NODISCARD)\ \textcolor{keywordtype}{bool}\ empty()\ const\ noexcept;}
\DoxyCodeLine{00460\ \ \ \ \ ANKERL\_NANOBENCH(NODISCARD)\ \textcolor{keywordtype}{size\_t}\ size()\ const\ noexcept;}
\DoxyCodeLine{00461\ }
\DoxyCodeLine{00462\ \ \ \ \ \textcolor{comment}{//\ Finds\ string,\ if\ not\ found,\ returns\ \_size.}}
\DoxyCodeLine{00463\ \ \ \ \ static\ Measure\ fromString(std::\textcolor{keywordtype}{string}\ const\&\ str);}
\DoxyCodeLine{00464\ }
\DoxyCodeLine{00465\ private:}
\DoxyCodeLine{00466\ \ \ \ \ Config\ mConfig\{\};}
\DoxyCodeLine{00467\ \ \ \ \ std::vector<std::vector<double>>\ mNameToMeasurements\{\};}
\DoxyCodeLine{00468\ \};}
\DoxyCodeLine{00469\ ANKERL\_NANOBENCH(IGNORE\_PADDED\_POP)}
\DoxyCodeLine{00470\ }
\DoxyCodeLine{00471\ }
\DoxyCodeLine{00488\ class\ Rng\ final\ \{}
\DoxyCodeLine{00489\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00493\ \ \ \ \ \textcolor{keyword}{using\ }result\_type\ =\ uint64\_t;}
\DoxyCodeLine{00494\ }
\DoxyCodeLine{00495\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{constexpr}\ uint64\_t(min)();}
\DoxyCodeLine{00496\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{constexpr}\ uint64\_t(max)();}
\DoxyCodeLine{00497\ }
\DoxyCodeLine{00503\ \ \ \ \ Rng(Rng\ \textcolor{keyword}{const}\&)\ =\ \textcolor{keyword}{delete};}
\DoxyCodeLine{00504\ }
\DoxyCodeLine{00508\ \ \ \ \ Rng\&\ operator=(Rng\ \textcolor{keyword}{const}\&)\ =\ \textcolor{keyword}{delete};}
\DoxyCodeLine{00509\ }
\DoxyCodeLine{00510\ \ \ \ \ \textcolor{comment}{//\ moving\ is\ ok}}
\DoxyCodeLine{00511\ \ \ \ \ Rng(Rng\&\&)\ noexcept\ =\ default;}
\DoxyCodeLine{00512\ \ \ \ \ Rng\&\ operator=(Rng\&\&)\ noexcept\ =\ default;}
\DoxyCodeLine{00513\ \ \ \ \ \string~Rng()\ noexcept\ =\ default;}
\DoxyCodeLine{00514\ }
\DoxyCodeLine{00522\ \ \ \ \ Rng();}
\DoxyCodeLine{00523\ }
\DoxyCodeLine{00540\ \ \ \ \ explicit\ Rng(uint64\_t\ seed)\ noexcept;}
\DoxyCodeLine{00541\ \ \ \ \ Rng(uint64\_t\ x,\ uint64\_t\ y)\ noexcept;}
\DoxyCodeLine{00542\ \ \ \ \ explicit\ Rng(std::vector<uint64\_t>\ const\&\ data);}
\DoxyCodeLine{00543\ }
\DoxyCodeLine{00547\ \ \ \ \ ANKERL\_NANOBENCH(NODISCARD)\ Rng\ copy()\ const\ noexcept;}
\DoxyCodeLine{00548\ }
\DoxyCodeLine{00556\ \ \ \ \ inline\ uint64\_t\ operator()()\ noexcept;}
\DoxyCodeLine{00557\ }
\DoxyCodeLine{00558\ \ \ \ \ \textcolor{comment}{//\ This\ is\ slightly\ biased.\ See}}
\DoxyCodeLine{00559\ }
\DoxyCodeLine{00574\ \ \ \ \ inline\ uint32\_t\ bounded(uint32\_t\ range)\ noexcept;}
\DoxyCodeLine{00575\ }
\DoxyCodeLine{00576\ \ \ \ \ \textcolor{comment}{//\ random\ double\ in\ range\ [0,\ 1(}}
\DoxyCodeLine{00577\ \ \ \ \ \textcolor{comment}{//\ see\ http://prng.di.unimi.it/}}
\DoxyCodeLine{00578\ }
\DoxyCodeLine{00585\ \ \ \ \ inline\ \textcolor{keywordtype}{double}\ uniform01()\ noexcept;}
\DoxyCodeLine{00586\ }
\DoxyCodeLine{00594\ \ \ \ \ template\ <typename\ Container>}
\DoxyCodeLine{00595\ \ \ \ \ \textcolor{keywordtype}{void}\ shuffle(Container\&\ container)\ noexcept;}
\DoxyCodeLine{00596\ }
\DoxyCodeLine{00603\ \ \ \ \ ANKERL\_NANOBENCH(NODISCARD)\ std::vector<uint64\_t>\ state()\ const;}
\DoxyCodeLine{00604\ }
\DoxyCodeLine{00605\ private:}
\DoxyCodeLine{00606\ \ \ \ \ static\ constexpr\ uint64\_t\ rotl(uint64\_t\ x,\ \textcolor{keywordtype}{unsigned}\ k)\ noexcept;}
\DoxyCodeLine{00607\ }
\DoxyCodeLine{00608\ \ \ \ \ uint64\_t\ mX;}
\DoxyCodeLine{00609\ \ \ \ \ uint64\_t\ mY;}
\DoxyCodeLine{00610\ \};}
\DoxyCodeLine{00611\ }
\DoxyCodeLine{00626\ ANKERL\_NANOBENCH(IGNORE\_PADDED\_PUSH)}
\DoxyCodeLine{00627\ class\ Bench\ \{}
\DoxyCodeLine{00628\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00632\ \ \ \ \ Bench();}
\DoxyCodeLine{00633\ }
\DoxyCodeLine{00634\ \ \ \ \ Bench(Bench\&\&\ other)\ \textcolor{keyword}{noexcept};}
\DoxyCodeLine{00635\ \ \ \ \ Bench\&\ operator=(Bench\&\&\ other)\ \textcolor{keyword}{noexcept}(ANKERL\_NANOBENCH(NOEXCEPT\_STRING\_MOVE));}
\DoxyCodeLine{00636\ \ \ \ \ Bench(Bench\ \textcolor{keyword}{const}\&\ other);}
\DoxyCodeLine{00637\ \ \ \ \ Bench\&\ operator=(Bench\ \textcolor{keyword}{const}\&\ other);}
\DoxyCodeLine{00638\ \ \ \ \ \string~Bench()\ noexcept;}
\DoxyCodeLine{00639\ }
\DoxyCodeLine{00658\ \ \ \ \ template\ <typename\ Op>}
\DoxyCodeLine{00659\ \ \ \ \ ANKERL\_NANOBENCH(NOINLINE)}
\DoxyCodeLine{00660\ \ \ \ \ Bench\&\ run(\textcolor{keywordtype}{char}\ const*\ benchmarkName,\ Op\&\&\ op);}
\DoxyCodeLine{00661\ }
\DoxyCodeLine{00662\ \ \ \ \ template\ <typename\ Op>}
\DoxyCodeLine{00663\ \ \ \ \ ANKERL\_NANOBENCH(NOINLINE)}
\DoxyCodeLine{00664\ \ \ \ \ Bench\&\ run(std::\textcolor{keywordtype}{string}\ const\&\ benchmarkName,\ Op\&\&\ op);}
\DoxyCodeLine{00665\ }
\DoxyCodeLine{00670\ \ \ \ \ template\ <typename\ Op>}
\DoxyCodeLine{00671\ \ \ \ \ ANKERL\_NANOBENCH(NOINLINE)}
\DoxyCodeLine{00672\ \ \ \ \ Bench\&\ run(Op\&\&\ op);}
\DoxyCodeLine{00673\ }
\DoxyCodeLine{00679\ \ \ \ \ Bench\&\ title(\textcolor{keywordtype}{char}\ const*\ benchmarkTitle);}
\DoxyCodeLine{00680\ \ \ \ \ Bench\&\ title(std::\textcolor{keywordtype}{string}\ const\&\ benchmarkTitle);}
\DoxyCodeLine{00681\ }
\DoxyCodeLine{00685\ \ \ \ \ ANKERL\_NANOBENCH(NODISCARD)\ std::\textcolor{keywordtype}{string}\ const\&\ title()\ const\ noexcept;}
\DoxyCodeLine{00686\ }
\DoxyCodeLine{00688\ \ \ \ \ Bench\&\ name(\textcolor{keywordtype}{char}\ const*\ benchmarkName);}
\DoxyCodeLine{00689\ \ \ \ \ Bench\&\ name(std::\textcolor{keywordtype}{string}\ const\&\ benchmarkName);}
\DoxyCodeLine{00690\ \ \ \ \ ANKERL\_NANOBENCH(NODISCARD)\ std::\textcolor{keywordtype}{string}\ const\&\ name()\ const\ noexcept;}
\DoxyCodeLine{00691\ }
\DoxyCodeLine{00704\ \ \ \ \ Bench\&\ context(\textcolor{keywordtype}{char}\ const*\ variableName,\ \textcolor{keywordtype}{char}\ const*\ variableValue);}
\DoxyCodeLine{00705\ \ \ \ \ Bench\&\ context(std::\textcolor{keywordtype}{string}\ const\&\ variableName,\ std::\textcolor{keywordtype}{string}\ const\&\ variableValue);}
\DoxyCodeLine{00706\ }
\DoxyCodeLine{00715\ \ \ \ \ Bench\&\ clearContext();}
\DoxyCodeLine{00716\ }
\DoxyCodeLine{00726\ \ \ \ \ template\ <typename\ T>}
\DoxyCodeLine{00727\ \ \ \ \ Bench\&\ batch(T\ b)\ noexcept;}
\DoxyCodeLine{00728\ \ \ \ \ ANKERL\_NANOBENCH(NODISCARD)\ \textcolor{keywordtype}{double}\ batch()\ const\ noexcept;}
\DoxyCodeLine{00729\ }
\DoxyCodeLine{00738\ \ \ \ \ Bench\&\ unit(\textcolor{keywordtype}{char}\ const*\ unit);}
\DoxyCodeLine{00739\ \ \ \ \ Bench\&\ unit(std::\textcolor{keywordtype}{string}\ const\&\ unit);}
\DoxyCodeLine{00740\ \ \ \ \ ANKERL\_NANOBENCH(NODISCARD)\ std::\textcolor{keywordtype}{string}\ const\&\ unit()\ const\ noexcept;}
\DoxyCodeLine{00741\ }
\DoxyCodeLine{00751\ \ \ \ \ Bench\&\ timeUnit(std::chrono::duration<\textcolor{keywordtype}{double}>\ const\&\ tu,\ std::\textcolor{keywordtype}{string}\ const\&\ tuName);}
\DoxyCodeLine{00752\ \ \ \ \ ANKERL\_NANOBENCH(NODISCARD)\ std::\textcolor{keywordtype}{string}\ const\&\ timeUnitName()\ const\ noexcept;}
\DoxyCodeLine{00753\ \ \ \ \ ANKERL\_NANOBENCH(NODISCARD)\ std::chrono::duration<\textcolor{keywordtype}{double}>\ const\&\ timeUnit()\ const\ noexcept;}
\DoxyCodeLine{00754\ }
\DoxyCodeLine{00762\ \ \ \ \ Bench\&\ output(std::ostream*\ outstream)\ noexcept;}
\DoxyCodeLine{00763\ \ \ \ \ ANKERL\_NANOBENCH(NODISCARD)\ std::ostream*\ output()\ const\ noexcept;}
\DoxyCodeLine{00764\ }
\DoxyCodeLine{00785\ \ \ \ \ Bench\&\ clockResolutionMultiple(\textcolor{keywordtype}{size\_t}\ multiple)\ noexcept;}
\DoxyCodeLine{00786\ \ \ \ \ ANKERL\_NANOBENCH(NODISCARD)\ \textcolor{keywordtype}{size\_t}\ clockResolutionMultiple()\ const\ noexcept;}
\DoxyCodeLine{00787\ }
\DoxyCodeLine{00803\ \ \ \ \ Bench\&\ epochs(\textcolor{keywordtype}{size\_t}\ numEpochs)\ noexcept;}
\DoxyCodeLine{00804\ \ \ \ \ ANKERL\_NANOBENCH(NODISCARD)\ \textcolor{keywordtype}{size\_t}\ epochs()\ const\ noexcept;}
\DoxyCodeLine{00805\ }
\DoxyCodeLine{00816\ \ \ \ \ Bench\&\ maxEpochTime(std::chrono::nanoseconds\ t)\ noexcept;}
\DoxyCodeLine{00817\ \ \ \ \ ANKERL\_NANOBENCH(NODISCARD)\ std::chrono::nanoseconds\ maxEpochTime()\ const\ noexcept;}
\DoxyCodeLine{00818\ }
\DoxyCodeLine{00829\ \ \ \ \ Bench\&\ minEpochTime(std::chrono::nanoseconds\ t)\ noexcept;}
\DoxyCodeLine{00830\ \ \ \ \ ANKERL\_NANOBENCH(NODISCARD)\ std::chrono::nanoseconds\ minEpochTime()\ const\ noexcept;}
\DoxyCodeLine{00831\ }
\DoxyCodeLine{00842\ \ \ \ \ Bench\&\ minEpochIterations(uint64\_t\ numIters)\ noexcept;}
\DoxyCodeLine{00843\ \ \ \ \ ANKERL\_NANOBENCH(NODISCARD)\ uint64\_t\ minEpochIterations()\ const\ noexcept;}
\DoxyCodeLine{00844\ }
\DoxyCodeLine{00851\ \ \ \ \ Bench\&\ epochIterations(uint64\_t\ numIters)\ noexcept;}
\DoxyCodeLine{00852\ \ \ \ \ ANKERL\_NANOBENCH(NODISCARD)\ uint64\_t\ epochIterations()\ const\ noexcept;}
\DoxyCodeLine{00853\ }
\DoxyCodeLine{00863\ \ \ \ \ Bench\&\ warmup(uint64\_t\ numWarmupIters)\ noexcept;}
\DoxyCodeLine{00864\ \ \ \ \ ANKERL\_NANOBENCH(NODISCARD)\ uint64\_t\ warmup()\ const\ noexcept;}
\DoxyCodeLine{00865\ }
\DoxyCodeLine{00883\ \ \ \ \ Bench\&\ relative(\textcolor{keywordtype}{bool}\ isRelativeEnabled)\ noexcept;}
\DoxyCodeLine{00884\ \ \ \ \ ANKERL\_NANOBENCH(NODISCARD)\ \textcolor{keywordtype}{bool}\ relative()\ const\ noexcept;}
\DoxyCodeLine{00885\ }
\DoxyCodeLine{00894\ \ \ \ \ Bench\&\ performanceCounters(\textcolor{keywordtype}{bool}\ showPerformanceCounters)\ noexcept;}
\DoxyCodeLine{00895\ \ \ \ \ ANKERL\_NANOBENCH(NODISCARD)\ \textcolor{keywordtype}{bool}\ performanceCounters()\ const\ noexcept;}
\DoxyCodeLine{00896\ }
\DoxyCodeLine{00905\ \ \ \ \ ANKERL\_NANOBENCH(NODISCARD)\ std::vector<Result>\ const\&\ results()\ const\ noexcept;}
\DoxyCodeLine{00906\ }
\DoxyCodeLine{00914\ \ \ \ \ template\ <typename\ Arg>}
\DoxyCodeLine{00915\ \ \ \ \ Bench\&\ doNotOptimizeAway(Arg\&\&\ arg);}
\DoxyCodeLine{00916\ }
\DoxyCodeLine{00931\ \ \ \ \ template\ <typename\ T>}
\DoxyCodeLine{00932\ \ \ \ \ Bench\&\ complexityN(T\ n)\ noexcept;}
\DoxyCodeLine{00933\ \ \ \ \ ANKERL\_NANOBENCH(NODISCARD)\ \textcolor{keywordtype}{double}\ complexityN()\ const\ noexcept;}
\DoxyCodeLine{00934\ }
\DoxyCodeLine{00966\ \ \ \ \ std::vector<BigO>\ complexityBigO()\ const;}
\DoxyCodeLine{00967\ }
\DoxyCodeLine{00991\ \ \ \ \ template\ <typename\ Op>}
\DoxyCodeLine{00992\ \ \ \ \ BigO\ complexityBigO(\textcolor{keywordtype}{char}\ const*\ name,\ Op\ op)\ const;}
\DoxyCodeLine{00993\ }
\DoxyCodeLine{00994\ \ \ \ \ template\ <typename\ Op>}
\DoxyCodeLine{00995\ \ \ \ \ BigO\ complexityBigO(std::\textcolor{keywordtype}{string}\ const\&\ name,\ Op\ op)\ const;}
\DoxyCodeLine{00996\ }
\DoxyCodeLine{01004\ \ \ \ \ Bench\&\ render(\textcolor{keywordtype}{char}\ const*\ templateContent,\ std::ostream\&\ os);}
\DoxyCodeLine{01005\ \ \ \ \ Bench\&\ render(std::\textcolor{keywordtype}{string}\ const\&\ templateContent,\ std::ostream\&\ os);}
\DoxyCodeLine{01006\ }
\DoxyCodeLine{01007\ \ \ \ \ Bench\&\ config(Config\ const\&\ benchmarkConfig);}
\DoxyCodeLine{01008\ \ \ \ \ ANKERL\_NANOBENCH(NODISCARD)\ Config\ const\&\ config()\ const\ noexcept;}
\DoxyCodeLine{01009\ }
\DoxyCodeLine{01010\ private:}
\DoxyCodeLine{01011\ \ \ \ \ Config\ mConfig\{\};}
\DoxyCodeLine{01012\ \ \ \ \ std::vector<Result>\ mResults\{\};}
\DoxyCodeLine{01013\ \};}
\DoxyCodeLine{01014\ ANKERL\_NANOBENCH(IGNORE\_PADDED\_POP)}
\DoxyCodeLine{01015\ }
\DoxyCodeLine{01016\ }
\DoxyCodeLine{01022\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Arg>}
\DoxyCodeLine{01023\ \textcolor{keywordtype}{void}\ doNotOptimizeAway(Arg\&\&\ arg);}
\DoxyCodeLine{01024\ }
\DoxyCodeLine{01025\ \textcolor{keyword}{namespace\ }detail\ \{}
\DoxyCodeLine{01026\ }
\DoxyCodeLine{01027\ \textcolor{preprocessor}{\#if\ defined(\_MSC\_VER)}}
\DoxyCodeLine{01028\ \textcolor{keywordtype}{void}\ doNotOptimizeAwaySink(\textcolor{keywordtype}{void}\ \textcolor{keyword}{const}*);}
\DoxyCodeLine{01029\ }
\DoxyCodeLine{01030\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{01031\ \textcolor{keywordtype}{void}\ doNotOptimizeAway(T\ \textcolor{keyword}{const}\&\ val);}
\DoxyCodeLine{01032\ }
\DoxyCodeLine{01033\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{01034\ }
\DoxyCodeLine{01035\ \textcolor{comment}{//\ These\ assembly\ magic\ is\ directly\ from\ what\ Google\ Benchmark\ is\ doing.\ I\ have\ previously\ used\ what\ facebook's\ folly\ was\ doing,\ but}}
\DoxyCodeLine{01036\ \textcolor{comment}{//\ this\ seemed\ to\ have\ compilation\ problems\ in\ some\ cases.\ Google\ Benchmark\ seemed\ to\ be\ the\ most\ well\ tested\ anyways.}}
\DoxyCodeLine{01037\ \textcolor{comment}{//\ see\ https://github.com/google/benchmark/blob/v1.7.1/include/benchmark/benchmark.h\#L443-\/L446}}
\DoxyCodeLine{01038\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{01039\ \textcolor{keywordtype}{void}\ doNotOptimizeAway(T\ \textcolor{keyword}{const}\&\ val)\ \{}
\DoxyCodeLine{01040\ \ \ \ \ \textcolor{comment}{//\ NOLINTNEXTLINE(hicpp-\/no-\/assembler)}}
\DoxyCodeLine{01041\ \ \ \ \ \textcolor{keyword}{asm}\ \textcolor{keyword}{volatile}(\textcolor{stringliteral}{"{}"{}}\ :\ :\ \textcolor{stringliteral}{"{}r,m"{}}(val)\ :\ \textcolor{stringliteral}{"{}memory"{}});}
\DoxyCodeLine{01042\ \}}
\DoxyCodeLine{01043\ }
\DoxyCodeLine{01044\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{01045\ \textcolor{keywordtype}{void}\ doNotOptimizeAway(T\&\ val)\ \{}
\DoxyCodeLine{01046\ \textcolor{preprocessor}{\#\ \ \ \ if\ defined(\_\_clang\_\_)}}
\DoxyCodeLine{01047\ \ \ \ \ \textcolor{comment}{//\ NOLINTNEXTLINE(hicpp-\/no-\/assembler)}}
\DoxyCodeLine{01048\ \ \ \ \ \textcolor{keyword}{asm}\ \textcolor{keyword}{volatile}(\textcolor{stringliteral}{"{}"{}}\ :\ \textcolor{stringliteral}{"{}+r,m"{}}(val)\ :\ :\ \textcolor{stringliteral}{"{}memory"{}});}
\DoxyCodeLine{01049\ \textcolor{preprocessor}{\#\ \ \ \ else}}
\DoxyCodeLine{01050\ \ \ \ \ \textcolor{comment}{//\ NOLINTNEXTLINE(hicpp-\/no-\/assembler)}}
\DoxyCodeLine{01051\ \ \ \ \ \textcolor{keyword}{asm}\ \textcolor{keyword}{volatile}(\textcolor{stringliteral}{"{}"{}}\ :\ \textcolor{stringliteral}{"{}+m,r"{}}(val)\ :\ :\ \textcolor{stringliteral}{"{}memory"{}});}
\DoxyCodeLine{01052\ \textcolor{preprocessor}{\#\ \ \ \ endif}}
\DoxyCodeLine{01053\ \}}
\DoxyCodeLine{01054\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01055\ }
\DoxyCodeLine{01056\ \textcolor{comment}{//\ internally\ used,\ but\ visible\ because\ run()\ is\ templated.}}
\DoxyCodeLine{01057\ \textcolor{comment}{//\ Not\ movable/copy-\/able,\ so\ we\ simply\ use\ a\ pointer\ instead\ of\ unique\_ptr.\ This\ saves\ us\ from}}
\DoxyCodeLine{01058\ \textcolor{comment}{//\ having\ to\ include\ <memory>,\ and\ the\ template\ instantiation\ overhead\ of\ unique\_ptr\ which\ is\ unfortunately\ quite\ significant.}}
\DoxyCodeLine{01059\ ANKERL\_NANOBENCH(IGNORE\_EFFCPP\_PUSH)}
\DoxyCodeLine{01060\ class\ IterationLogic\ \{}
\DoxyCodeLine{01061\ \textcolor{keyword}{public}:}
\DoxyCodeLine{01062\ \ \ \ \ \textcolor{keyword}{explicit}\ IterationLogic(Bench\ \textcolor{keyword}{const}\&\ bench);}
\DoxyCodeLine{01063\ \ \ \ \ IterationLogic(IterationLogic\&\&)\ =\ \textcolor{keyword}{delete};}
\DoxyCodeLine{01064\ \ \ \ \ IterationLogic\&\ operator=(IterationLogic\&\&)\ =\ \textcolor{keyword}{delete};}
\DoxyCodeLine{01065\ \ \ \ \ IterationLogic(IterationLogic\ \textcolor{keyword}{const}\&)\ =\ \textcolor{keyword}{delete};}
\DoxyCodeLine{01066\ \ \ \ \ IterationLogic\&\ operator=(IterationLogic\ \textcolor{keyword}{const}\&)\ =\ \textcolor{keyword}{delete};}
\DoxyCodeLine{01067\ \ \ \ \ \string~IterationLogic();}
\DoxyCodeLine{01068\ }
\DoxyCodeLine{01069\ \ \ \ \ ANKERL\_NANOBENCH(NODISCARD)\ uint64\_t\ numIters()\ const\ noexcept;}
\DoxyCodeLine{01070\ \ \ \ \ \textcolor{keywordtype}{void}\ add(std::chrono::nanoseconds\ elapsed,\ PerformanceCounters\ const\&\ pc)\ noexcept;}
\DoxyCodeLine{01071\ \ \ \ \ \textcolor{keywordtype}{void}\ moveResultTo(std::vector<Result>\&\ results)\ noexcept;}
\DoxyCodeLine{01072\ }
\DoxyCodeLine{01073\ private:}
\DoxyCodeLine{01074\ \ \ \ \ struct\ Impl;}
\DoxyCodeLine{01075\ \ \ \ \ Impl*\ mPimpl;}
\DoxyCodeLine{01076\ \};}
\DoxyCodeLine{01077\ ANKERL\_NANOBENCH(IGNORE\_EFFCPP\_POP)}
\DoxyCodeLine{01078\ }
\DoxyCodeLine{01079\ ANKERL\_NANOBENCH(IGNORE\_PADDED\_PUSH)}
\DoxyCodeLine{01080\ class\ PerformanceCounters\ \{}
\DoxyCodeLine{01081\ \textcolor{keyword}{public}:}
\DoxyCodeLine{01082\ \ \ \ \ PerformanceCounters(PerformanceCounters\ \textcolor{keyword}{const}\&)\ =\ \textcolor{keyword}{delete};}
\DoxyCodeLine{01083\ \ \ \ \ PerformanceCounters(PerformanceCounters\&\&)\ =\ \textcolor{keyword}{delete};}
\DoxyCodeLine{01084\ \ \ \ \ PerformanceCounters\&\ operator=(PerformanceCounters\ \textcolor{keyword}{const}\&)\ =\ \textcolor{keyword}{delete};}
\DoxyCodeLine{01085\ \ \ \ \ PerformanceCounters\&\ operator=(PerformanceCounters\&\&)\ =\ \textcolor{keyword}{delete};}
\DoxyCodeLine{01086\ }
\DoxyCodeLine{01087\ \ \ \ \ PerformanceCounters();}
\DoxyCodeLine{01088\ \ \ \ \ \string~PerformanceCounters();}
\DoxyCodeLine{01089\ }
\DoxyCodeLine{01090\ \ \ \ \ \textcolor{keywordtype}{void}\ beginMeasure();}
\DoxyCodeLine{01091\ \ \ \ \ \textcolor{keywordtype}{void}\ endMeasure();}
\DoxyCodeLine{01092\ \ \ \ \ \textcolor{keywordtype}{void}\ updateResults(uint64\_t\ numIters);}
\DoxyCodeLine{01093\ }
\DoxyCodeLine{01094\ \ \ \ \ ANKERL\_NANOBENCH(NODISCARD)\ PerfCountSet<uint64\_t>\ \textcolor{keyword}{const}\&\ val()\ const\ noexcept;}
\DoxyCodeLine{01095\ \ \ \ \ ANKERL\_NANOBENCH(NODISCARD)\ PerfCountSet<\textcolor{keywordtype}{bool}>\ const\&\ has()\ const\ noexcept;}
\DoxyCodeLine{01096\ }
\DoxyCodeLine{01097\ private:}
\DoxyCodeLine{01098\ \textcolor{preprocessor}{\#if\ ANKERL\_NANOBENCH(PERF\_COUNTERS)}}
\DoxyCodeLine{01099\ \ \ \ \ LinuxPerformanceCounters*\ mPc\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{01100\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01101\ \ \ \ \ PerfCountSet<uint64\_t>\ mVal\{\};}
\DoxyCodeLine{01102\ \ \ \ \ PerfCountSet<bool>\ mHas\{\};}
\DoxyCodeLine{01103\ \};}
\DoxyCodeLine{01104\ ANKERL\_NANOBENCH(IGNORE\_PADDED\_POP)}
\DoxyCodeLine{01105\ }
\DoxyCodeLine{01106\ \textcolor{comment}{//\ Gets\ the\ singleton}}
\DoxyCodeLine{01107\ PerformanceCounters\&\ performanceCounters();}
\DoxyCodeLine{01108\ }
\DoxyCodeLine{01109\ \}\ \textcolor{comment}{//\ namespace\ detail}}
\DoxyCodeLine{01110\ }
\DoxyCodeLine{01111\ class\ BigO\ \{}
\DoxyCodeLine{01112\ \textcolor{keyword}{public}:}
\DoxyCodeLine{01113\ \ \ \ \ \textcolor{keyword}{using\ }RangeMeasure\ =\ std::vector<std::pair<double,\ double>>;}
\DoxyCodeLine{01114\ }
\DoxyCodeLine{01115\ \ \ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Op>}
\DoxyCodeLine{01116\ \ \ \ \ \textcolor{keyword}{static}\ RangeMeasure\ mapRangeMeasure(RangeMeasure\ data,\ Op\ op)\ \{}
\DoxyCodeLine{01117\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\&\ rangeMeasure\ :\ data)\ \{}
\DoxyCodeLine{01118\ \ \ \ \ \ \ \ \ \ \ \ \ rangeMeasure.first\ =\ op(rangeMeasure.first);}
\DoxyCodeLine{01119\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01120\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ data;}
\DoxyCodeLine{01121\ \ \ \ \ \}}
\DoxyCodeLine{01122\ }
\DoxyCodeLine{01123\ \ \ \ \ \textcolor{keyword}{static}\ RangeMeasure\ collectRangeMeasure(std::vector<Result>\ \textcolor{keyword}{const}\&\ results);}
\DoxyCodeLine{01124\ }
\DoxyCodeLine{01125\ \ \ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Op>}
\DoxyCodeLine{01126\ \ \ \ \ BigO(\textcolor{keywordtype}{char}\ \textcolor{keyword}{const}*\ bigOName,\ RangeMeasure\ \textcolor{keyword}{const}\&\ rangeMeasure,\ Op\ rangeToN)}
\DoxyCodeLine{01127\ \ \ \ \ \ \ \ \ :\ BigO(bigOName,\ mapRangeMeasure(rangeMeasure,\ rangeToN))\ \{\}}
\DoxyCodeLine{01128\ }
\DoxyCodeLine{01129\ \ \ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Op>}
\DoxyCodeLine{01130\ \ \ \ \ BigO(std::string\ bigOName,\ RangeMeasure\ \textcolor{keyword}{const}\&\ rangeMeasure,\ Op\ rangeToN)}
\DoxyCodeLine{01131\ \ \ \ \ \ \ \ \ :\ BigO(std::move(bigOName),\ mapRangeMeasure(rangeMeasure,\ rangeToN))\ \{\}}
\DoxyCodeLine{01132\ }
\DoxyCodeLine{01133\ \ \ \ \ BigO(\textcolor{keywordtype}{char}\ \textcolor{keyword}{const}*\ bigOName,\ RangeMeasure\ \textcolor{keyword}{const}\&\ scaledRangeMeasure);}
\DoxyCodeLine{01134\ \ \ \ \ BigO(std::string\ bigOName,\ RangeMeasure\ \textcolor{keyword}{const}\&\ scaledRangeMeasure);}
\DoxyCodeLine{01135\ \ \ \ \ ANKERL\_NANOBENCH(NODISCARD)\ std::string\ \textcolor{keyword}{const}\&\ name()\ const\ noexcept;}
\DoxyCodeLine{01136\ \ \ \ \ ANKERL\_NANOBENCH(NODISCARD)\ \textcolor{keywordtype}{double}\ constant()\ const\ noexcept;}
\DoxyCodeLine{01137\ \ \ \ \ ANKERL\_NANOBENCH(NODISCARD)\ \textcolor{keywordtype}{double}\ normalizedRootMeanSquare()\ const\ noexcept;}
\DoxyCodeLine{01138\ \ \ \ \ ANKERL\_NANOBENCH(NODISCARD)\ \textcolor{keywordtype}{bool}\ operator<(BigO\ const\&\ other)\ const\ noexcept;}
\DoxyCodeLine{01139\ }
\DoxyCodeLine{01140\ private:}
\DoxyCodeLine{01141\ \ \ \ \ std::\textcolor{keywordtype}{string}\ mName\{\};}
\DoxyCodeLine{01142\ \ \ \ \ \textcolor{keywordtype}{double}\ mConstant\{\};}
\DoxyCodeLine{01143\ \ \ \ \ \textcolor{keywordtype}{double}\ mNormalizedRootMeanSquare\{\};}
\DoxyCodeLine{01144\ \};}
\DoxyCodeLine{01145\ std::ostream\&\ operator<<(std::ostream\&\ os,\ BigO\ \textcolor{keyword}{const}\&\ bigO);}
\DoxyCodeLine{01146\ std::ostream\&\ operator<<(std::ostream\&\ os,\ std::vector<ankerl::nanobench::BigO>\ \textcolor{keyword}{const}\&\ bigOs);}
\DoxyCodeLine{01147\ }
\DoxyCodeLine{01148\ \}\ \textcolor{comment}{//\ namespace\ nanobench}}
\DoxyCodeLine{01149\ \}\ \textcolor{comment}{//\ namespace\ ankerl}}
\DoxyCodeLine{01150\ }
\DoxyCodeLine{01151\ \textcolor{comment}{//\ implementation\ /////////////////////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{01152\ }
\DoxyCodeLine{01153\ \textcolor{keyword}{namespace\ }ankerl\ \{}
\DoxyCodeLine{01154\ \textcolor{keyword}{namespace\ }nanobench\ \{}
\DoxyCodeLine{01155\ }
\DoxyCodeLine{01156\ \textcolor{keyword}{constexpr}\ uint64\_t(Rng::min)()\ \{}
\DoxyCodeLine{01157\ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{01158\ \}}
\DoxyCodeLine{01159\ }
\DoxyCodeLine{01160\ \textcolor{keyword}{constexpr}\ uint64\_t(Rng::max)()\ \{}
\DoxyCodeLine{01161\ \ \ \ \ \textcolor{keywordflow}{return}\ (std::numeric\_limits<uint64\_t>::max)();}
\DoxyCodeLine{01162\ \}}
\DoxyCodeLine{01163\ }
\DoxyCodeLine{01164\ ANKERL\_NANOBENCH\_NO\_SANITIZE(\textcolor{stringliteral}{"{}integer"{}},\ \textcolor{stringliteral}{"{}undefined"{}})}
\DoxyCodeLine{01165\ uint64\_t\ Rng::operator()()\ noexcept\ \{}
\DoxyCodeLine{01166\ \ \ \ \ \textcolor{keyword}{auto}\ x\ =\ mX;}
\DoxyCodeLine{01167\ }
\DoxyCodeLine{01168\ \ \ \ \ mX\ =\ UINT64\_C(15241094284759029579)\ *\ mY;}
\DoxyCodeLine{01169\ \ \ \ \ mY\ =\ rotl(mY\ -\/\ x,\ 27);}
\DoxyCodeLine{01170\ }
\DoxyCodeLine{01171\ \ \ \ \ \textcolor{keywordflow}{return}\ x;}
\DoxyCodeLine{01172\ \}}
\DoxyCodeLine{01173\ }
\DoxyCodeLine{01174\ ANKERL\_NANOBENCH\_NO\_SANITIZE(\textcolor{stringliteral}{"{}integer"{}},\ \textcolor{stringliteral}{"{}undefined"{}})}
\DoxyCodeLine{01175\ uint32\_t\ Rng::bounded(uint32\_t\ range)\ noexcept\ \{}
\DoxyCodeLine{01176\ \ \ \ \ uint64\_t\ \textcolor{keyword}{const}\ r32\ =\ \textcolor{keyword}{static\_cast<}uint32\_t\textcolor{keyword}{>}(operator()());}
\DoxyCodeLine{01177\ \ \ \ \ \textcolor{keyword}{auto}\ multiresult\ =\ r32\ *\ range;}
\DoxyCodeLine{01178\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{static\_cast<}uint32\_t\textcolor{keyword}{>}(multiresult\ >>\ 32U);}
\DoxyCodeLine{01179\ \}}
\DoxyCodeLine{01180\ }
\DoxyCodeLine{01181\ \textcolor{keywordtype}{double}\ Rng::uniform01()\ noexcept\ \{}
\DoxyCodeLine{01182\ \ \ \ \ \textcolor{keyword}{auto}\ i\ =\ (UINT64\_C(0x3ff)\ <<\ 52U)\ |\ (\textcolor{keyword}{operator}()()\ >>\ 12U);}
\DoxyCodeLine{01183\ \ \ \ \ \textcolor{comment}{//\ can't\ use\ union\ in\ c++\ here\ for\ type\ puning,\ it's\ undefined\ behavior.}}
\DoxyCodeLine{01184\ \ \ \ \ \textcolor{comment}{//\ std::memcpy\ is\ optimized\ anyways.}}
\DoxyCodeLine{01185\ \ \ \ \ \textcolor{keywordtype}{double}\ d\{\};}
\DoxyCodeLine{01186\ \ \ \ \ std::memcpy(\&d,\ \&i,\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}));}
\DoxyCodeLine{01187\ \ \ \ \ \textcolor{keywordflow}{return}\ d\ -\/\ 1.0;}
\DoxyCodeLine{01188\ \}}
\DoxyCodeLine{01189\ }
\DoxyCodeLine{01190\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Container>}
\DoxyCodeLine{01191\ \textcolor{keywordtype}{void}\ Rng::shuffle(Container\&\ container)\ \textcolor{keyword}{noexcept}\ \{}
\DoxyCodeLine{01192\ \ \ \ \ \textcolor{keyword}{auto}\ i\ =\ container.size();}
\DoxyCodeLine{01193\ \ \ \ \ \textcolor{keywordflow}{while}\ (i\ >\ 1U)\ \{}
\DoxyCodeLine{01194\ \ \ \ \ \ \ \ \ \textcolor{keyword}{using\ }std::swap;}
\DoxyCodeLine{01195\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ n\ =\ operator()();}
\DoxyCodeLine{01196\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ using\ decltype(i)\ instead\ of\ size\_t\ to\ be\ compatible\ to\ containers\ with\ 32bit\ index\ (see\ \#80)}}
\DoxyCodeLine{01197\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ b1\ =\ \textcolor{keyword}{static\_cast<}decltype(i)\textcolor{keyword}{>}((\textcolor{keyword}{static\_cast<}uint32\_t\textcolor{keyword}{>}(n)\ *\ \textcolor{keyword}{static\_cast<}uint64\_t\textcolor{keyword}{>}(i))\ >>\ 32U);}
\DoxyCodeLine{01198\ \ \ \ \ \ \ \ \ swap(container[-\/-\/i],\ container[b1]);}
\DoxyCodeLine{01199\ }
\DoxyCodeLine{01200\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ b2\ =\ \textcolor{keyword}{static\_cast<}decltype(i)\textcolor{keyword}{>}(((n\ >>\ 32U)\ *\ \textcolor{keyword}{static\_cast<}uint64\_t\textcolor{keyword}{>}(i))\ >>\ 32U);}
\DoxyCodeLine{01201\ \ \ \ \ \ \ \ \ swap(container[-\/-\/i],\ container[b2]);}
\DoxyCodeLine{01202\ \ \ \ \ \}}
\DoxyCodeLine{01203\ \}}
\DoxyCodeLine{01204\ }
\DoxyCodeLine{01205\ ANKERL\_NANOBENCH\_NO\_SANITIZE(\textcolor{stringliteral}{"{}integer"{}},\ \textcolor{stringliteral}{"{}undefined"{}})}
\DoxyCodeLine{01206\ constexpr\ uint64\_t\ Rng::rotl(uint64\_t\ x,\ \textcolor{keywordtype}{unsigned}\ k)\ noexcept\ \{}
\DoxyCodeLine{01207\ \ \ \ \ \textcolor{keywordflow}{return}\ (x\ <<\ k)\ |\ (x\ >>\ (64U\ -\/\ k));}
\DoxyCodeLine{01208\ \}}
\DoxyCodeLine{01209\ }
\DoxyCodeLine{01210\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Op>}
\DoxyCodeLine{01211\ ANKERL\_NANOBENCH\_NO\_SANITIZE(\textcolor{stringliteral}{"{}integer"{}})}
\DoxyCodeLine{01212\ Bench\&\ Bench::run(Op\&\&\ op)\ \{}
\DoxyCodeLine{01213\ \ \ \ \ \textcolor{comment}{//\ It\ is\ important\ that\ this\ method\ is\ kept\ short\ so\ the\ compiler\ can\ do\ better\ optimizations/\ inlining\ of\ op()}}
\DoxyCodeLine{01214\ \ \ \ \ detail::IterationLogic\ iterationLogic(*\textcolor{keyword}{this});}
\DoxyCodeLine{01215\ \ \ \ \ \textcolor{keyword}{auto}\&\ pc\ =\ detail::performanceCounters();}
\DoxyCodeLine{01216\ }
\DoxyCodeLine{01217\ \ \ \ \ \textcolor{keywordflow}{while}\ (\textcolor{keyword}{auto}\ n\ =\ iterationLogic.numIters())\ \{}
\DoxyCodeLine{01218\ \ \ \ \ \ \ \ \ pc.beginMeasure();}
\DoxyCodeLine{01219\ \ \ \ \ \ \ \ \ Clock::time\_point\ \textcolor{keyword}{const}\ before\ =\ Clock::now();}
\DoxyCodeLine{01220\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{while}\ (n-\/-\/\ >\ 0)\ \{}
\DoxyCodeLine{01221\ \ \ \ \ \ \ \ \ \ \ \ \ op();}
\DoxyCodeLine{01222\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01223\ \ \ \ \ \ \ \ \ Clock::time\_point\ \textcolor{keyword}{const}\ after\ =\ Clock::now();}
\DoxyCodeLine{01224\ \ \ \ \ \ \ \ \ pc.endMeasure();}
\DoxyCodeLine{01225\ \ \ \ \ \ \ \ \ pc.updateResults(iterationLogic.numIters());}
\DoxyCodeLine{01226\ \ \ \ \ \ \ \ \ iterationLogic.add(after\ -\/\ before,\ pc);}
\DoxyCodeLine{01227\ \ \ \ \ \}}
\DoxyCodeLine{01228\ \ \ \ \ iterationLogic.moveResultTo(mResults);}
\DoxyCodeLine{01229\ \ \ \ \ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};}
\DoxyCodeLine{01230\ \}}
\DoxyCodeLine{01231\ }
\DoxyCodeLine{01232\ \textcolor{comment}{//\ Performs\ all\ evaluations.}}
\DoxyCodeLine{01233\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Op>}
\DoxyCodeLine{01234\ Bench\&\ Bench::run(\textcolor{keywordtype}{char}\ \textcolor{keyword}{const}*\ benchmarkName,\ Op\&\&\ op)\ \{}
\DoxyCodeLine{01235\ \ \ \ \ name(benchmarkName);}
\DoxyCodeLine{01236\ \ \ \ \ \textcolor{keywordflow}{return}\ run(std::forward<Op>(op));}
\DoxyCodeLine{01237\ \}}
\DoxyCodeLine{01238\ }
\DoxyCodeLine{01239\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Op>}
\DoxyCodeLine{01240\ Bench\&\ Bench::run(std::string\ \textcolor{keyword}{const}\&\ benchmarkName,\ Op\&\&\ op)\ \{}
\DoxyCodeLine{01241\ \ \ \ \ name(benchmarkName);}
\DoxyCodeLine{01242\ \ \ \ \ \textcolor{keywordflow}{return}\ run(std::forward<Op>(op));}
\DoxyCodeLine{01243\ \}}
\DoxyCodeLine{01244\ }
\DoxyCodeLine{01245\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Op>}
\DoxyCodeLine{01246\ BigO\ Bench::complexityBigO(\textcolor{keywordtype}{char}\ \textcolor{keyword}{const}*\ benchmarkName,\ Op\ op)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01247\ \ \ \ \ \textcolor{keywordflow}{return}\ BigO(benchmarkName,\ BigO::collectRangeMeasure(mResults),\ op);}
\DoxyCodeLine{01248\ \}}
\DoxyCodeLine{01249\ }
\DoxyCodeLine{01250\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Op>}
\DoxyCodeLine{01251\ BigO\ Bench::complexityBigO(std::string\ \textcolor{keyword}{const}\&\ benchmarkName,\ Op\ op)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01252\ \ \ \ \ \textcolor{keywordflow}{return}\ BigO(benchmarkName,\ BigO::collectRangeMeasure(mResults),\ op);}
\DoxyCodeLine{01253\ \}}
\DoxyCodeLine{01254\ }
\DoxyCodeLine{01255\ \textcolor{comment}{//\ Set\ the\ batch\ size,\ e.g.\ number\ of\ processed\ bytes,\ or\ some\ other\ metric\ for\ the\ size\ of\ the\ processed\ data\ in\ each\ iteration.}}
\DoxyCodeLine{01256\ \textcolor{comment}{//\ Any\ argument\ is\ cast\ to\ double.}}
\DoxyCodeLine{01257\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{01258\ Bench\&\ Bench::batch(T\ b)\ \textcolor{keyword}{noexcept}\ \{}
\DoxyCodeLine{01259\ \ \ \ \ mConfig.mBatch\ =\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{double}\textcolor{keyword}{>}(b);}
\DoxyCodeLine{01260\ \ \ \ \ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};}
\DoxyCodeLine{01261\ \}}
\DoxyCodeLine{01262\ }
\DoxyCodeLine{01263\ \textcolor{comment}{//\ Sets\ the\ computation\ complexity\ of\ the\ next\ run.\ Any\ argument\ is\ cast\ to\ double.}}
\DoxyCodeLine{01264\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{01265\ Bench\&\ Bench::complexityN(T\ n)\ \textcolor{keyword}{noexcept}\ \{}
\DoxyCodeLine{01266\ \ \ \ \ mConfig.mComplexityN\ =\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{double}\textcolor{keyword}{>}(n);}
\DoxyCodeLine{01267\ \ \ \ \ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};}
\DoxyCodeLine{01268\ \}}
\DoxyCodeLine{01269\ }
\DoxyCodeLine{01270\ \textcolor{comment}{//\ Convenience:\ makes\ sure\ none\ of\ the\ given\ arguments\ are\ optimized\ away\ by\ the\ compiler.}}
\DoxyCodeLine{01271\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Arg>}
\DoxyCodeLine{01272\ Bench\&\ Bench::doNotOptimizeAway(Arg\&\&\ arg)\ \{}
\DoxyCodeLine{01273\ \ \ \ \ detail::doNotOptimizeAway(std::forward<Arg>(arg));}
\DoxyCodeLine{01274\ \ \ \ \ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};}
\DoxyCodeLine{01275\ \}}
\DoxyCodeLine{01276\ }
\DoxyCodeLine{01277\ \textcolor{comment}{//\ Makes\ sure\ none\ of\ the\ given\ arguments\ are\ optimized\ away\ by\ the\ compiler.}}
\DoxyCodeLine{01278\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Arg>}
\DoxyCodeLine{01279\ \textcolor{keywordtype}{void}\ doNotOptimizeAway(Arg\&\&\ arg)\ \{}
\DoxyCodeLine{01280\ \ \ \ \ detail::doNotOptimizeAway(std::forward<Arg>(arg));}
\DoxyCodeLine{01281\ \}}
\DoxyCodeLine{01282\ }
\DoxyCodeLine{01283\ \textcolor{keyword}{namespace\ }detail\ \{}
\DoxyCodeLine{01284\ }
\DoxyCodeLine{01285\ \textcolor{preprocessor}{\#if\ defined(\_MSC\_VER)}}
\DoxyCodeLine{01286\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{01287\ \textcolor{keywordtype}{void}\ doNotOptimizeAway(T\ \textcolor{keyword}{const}\&\ val)\ \{}
\DoxyCodeLine{01288\ \ \ \ \ doNotOptimizeAwaySink(\&val);}
\DoxyCodeLine{01289\ \}}
\DoxyCodeLine{01290\ }
\DoxyCodeLine{01291\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01292\ }
\DoxyCodeLine{01293\ \}\ \textcolor{comment}{//\ namespace\ detail}}
\DoxyCodeLine{01294\ \}\ \textcolor{comment}{//\ namespace\ nanobench}}
\DoxyCodeLine{01295\ \}\ \textcolor{comment}{//\ namespace\ ankerl}}
\DoxyCodeLine{01296\ }
\DoxyCodeLine{01297\ \textcolor{preprocessor}{\#if\ defined(ANKERL\_NANOBENCH\_IMPLEMENT)}}
\DoxyCodeLine{01298\ }
\DoxyCodeLine{01300\ \textcolor{comment}{//\ implementation\ part\ -\/\ only\ visible\ in\ .cpp}}
\DoxyCodeLine{01302\ }
\DoxyCodeLine{01303\ \textcolor{preprocessor}{\#\ \ \ \ include\ <algorithm>}\ \textcolor{comment}{//\ sort,\ reverse}}
\DoxyCodeLine{01304\ \textcolor{preprocessor}{\#\ \ \ \ include\ <atomic>}\ \ \ \ \textcolor{comment}{//\ compare\_exchange\_strong\ in\ loop\ overhead}}
\DoxyCodeLine{01305\ \textcolor{preprocessor}{\#\ \ \ \ include\ <cstdlib>}\ \ \ \textcolor{comment}{//\ getenv}}
\DoxyCodeLine{01306\ \textcolor{preprocessor}{\#\ \ \ \ include\ <cstring>}\ \ \ \textcolor{comment}{//\ strstr,\ strncmp}}
\DoxyCodeLine{01307\ \textcolor{preprocessor}{\#\ \ \ \ include\ <fstream>}\ \ \ \textcolor{comment}{//\ ifstream\ to\ parse\ proc\ files}}
\DoxyCodeLine{01308\ \textcolor{preprocessor}{\#\ \ \ \ include\ <iomanip>}\ \ \ \textcolor{comment}{//\ setw,\ setprecision}}
\DoxyCodeLine{01309\ \textcolor{preprocessor}{\#\ \ \ \ include\ <iostream>}\ \ \textcolor{comment}{//\ cout}}
\DoxyCodeLine{01310\ \textcolor{preprocessor}{\#\ \ \ \ include\ <numeric>}\ \ \ \textcolor{comment}{//\ accumulate}}
\DoxyCodeLine{01311\ \textcolor{preprocessor}{\#\ \ \ \ include\ <random>}\ \ \ \ \textcolor{comment}{//\ random\_device}}
\DoxyCodeLine{01312\ \textcolor{preprocessor}{\#\ \ \ \ include\ <sstream>}\ \ \ \textcolor{comment}{//\ to\_s\ in\ Number}}
\DoxyCodeLine{01313\ \textcolor{preprocessor}{\#\ \ \ \ include\ <stdexcept>}\ \textcolor{comment}{//\ throw\ for\ rendering\ templates}}
\DoxyCodeLine{01314\ \textcolor{preprocessor}{\#\ \ \ \ include\ <tuple>}\ \ \ \ \ \textcolor{comment}{//\ std::tie}}
\DoxyCodeLine{01315\ \textcolor{preprocessor}{\#\ \ \ \ if\ defined(\_\_linux\_\_)}}
\DoxyCodeLine{01316\ \textcolor{preprocessor}{\#\ \ \ \ \ \ \ \ include\ <unistd.h>}\ \textcolor{comment}{//sysconf}}
\DoxyCodeLine{01317\ \textcolor{preprocessor}{\#\ \ \ \ endif}}
\DoxyCodeLine{01318\ \textcolor{preprocessor}{\#\ \ \ \ if\ ANKERL\_NANOBENCH(PERF\_COUNTERS)}}
\DoxyCodeLine{01319\ \textcolor{preprocessor}{\#\ \ \ \ \ \ \ \ include\ <map>}\ \textcolor{comment}{//\ map}}
\DoxyCodeLine{01320\ }
\DoxyCodeLine{01321\ \textcolor{preprocessor}{\#\ \ \ \ \ \ \ \ include\ <linux/perf\_event.h>}}
\DoxyCodeLine{01322\ \textcolor{preprocessor}{\#\ \ \ \ \ \ \ \ include\ <sys/ioctl.h>}}
\DoxyCodeLine{01323\ \textcolor{preprocessor}{\#\ \ \ \ \ \ \ \ include\ <sys/syscall.h>}}
\DoxyCodeLine{01324\ \textcolor{preprocessor}{\#\ \ \ \ endif}}
\DoxyCodeLine{01325\ }
\DoxyCodeLine{01326\ \textcolor{comment}{//\ declarations\ ///////////////////////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{01327\ }
\DoxyCodeLine{01328\ \textcolor{keyword}{namespace\ }ankerl\ \{}
\DoxyCodeLine{01329\ \textcolor{keyword}{namespace\ }nanobench\ \{}
\DoxyCodeLine{01330\ }
\DoxyCodeLine{01331\ \textcolor{comment}{//\ helper\ stuff\ that\ is\ only\ intended\ to\ be\ used\ internally}}
\DoxyCodeLine{01332\ \textcolor{keyword}{namespace\ }detail\ \{}
\DoxyCodeLine{01333\ }
\DoxyCodeLine{01334\ \textcolor{keyword}{struct\ }TableInfo;}
\DoxyCodeLine{01335\ }
\DoxyCodeLine{01336\ \textcolor{comment}{//\ formatting\ utilities}}
\DoxyCodeLine{01337\ \textcolor{keyword}{namespace\ }fmt\ \{}
\DoxyCodeLine{01338\ }
\DoxyCodeLine{01339\ \textcolor{keyword}{class\ }NumSep;}
\DoxyCodeLine{01340\ \textcolor{keyword}{class\ }StreamStateRestorer;}
\DoxyCodeLine{01341\ \textcolor{keyword}{class\ }Number;}
\DoxyCodeLine{01342\ \textcolor{keyword}{class\ }MarkDownColumn;}
\DoxyCodeLine{01343\ \textcolor{keyword}{class\ }MarkDownCode;}
\DoxyCodeLine{01344\ }
\DoxyCodeLine{01345\ \}\ \textcolor{comment}{//\ namespace\ fmt}}
\DoxyCodeLine{01346\ \}\ \textcolor{comment}{//\ namespace\ detail}}
\DoxyCodeLine{01347\ \}\ \textcolor{comment}{//\ namespace\ nanobench}}
\DoxyCodeLine{01348\ \}\ \textcolor{comment}{//\ namespace\ ankerl}}
\DoxyCodeLine{01349\ }
\DoxyCodeLine{01350\ \textcolor{comment}{//\ definitions\ ////////////////////////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{01351\ }
\DoxyCodeLine{01352\ \textcolor{keyword}{namespace\ }ankerl\ \{}
\DoxyCodeLine{01353\ \textcolor{keyword}{namespace\ }nanobench\ \{}
\DoxyCodeLine{01354\ }
\DoxyCodeLine{01355\ uint64\_t\ splitMix64(uint64\_t\&\ state)\ \textcolor{keyword}{noexcept};}
\DoxyCodeLine{01356\ }
\DoxyCodeLine{01357\ \textcolor{keyword}{namespace\ }detail\ \{}
\DoxyCodeLine{01358\ }
\DoxyCodeLine{01359\ \textcolor{comment}{//\ helpers\ to\ get\ double\ values}}
\DoxyCodeLine{01360\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{01361\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{double}\ d(T\ t)\ \textcolor{keyword}{noexcept}\ \{}
\DoxyCodeLine{01362\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{double}\textcolor{keyword}{>}(t);}
\DoxyCodeLine{01363\ \}}
\DoxyCodeLine{01364\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{double}\ d(Clock::duration\ duration)\ \textcolor{keyword}{noexcept}\ \{}
\DoxyCodeLine{01365\ \ \ \ \ \textcolor{keywordflow}{return}\ std::chrono::duration\_cast<std::chrono::duration<double>>(duration).count();}
\DoxyCodeLine{01366\ \}}
\DoxyCodeLine{01367\ }
\DoxyCodeLine{01368\ \textcolor{comment}{//\ Calculates\ clock\ resolution\ once,\ and\ remembers\ the\ result}}
\DoxyCodeLine{01369\ \textcolor{keyword}{inline}\ Clock::duration\ clockResolution()\ noexcept;}
\DoxyCodeLine{01370\ }
\DoxyCodeLine{01371\ \}\ \textcolor{comment}{//\ namespace\ detail}}
\DoxyCodeLine{01372\ }
\DoxyCodeLine{01373\ namespace\ templates\ \{}
\DoxyCodeLine{01374\ }
\DoxyCodeLine{01375\ \textcolor{keywordtype}{char}\ \textcolor{keyword}{const}*\ csv()\ noexcept\ \{}
\DoxyCodeLine{01376\ \ \ \ \ \textcolor{keywordflow}{return}\ R\textcolor{stringliteral}{"{}DELIM("{}title"{};"{}name"{};"{}unit"{};"{}batch"{};"{}elapsed"{};"{}error\ \%"{};"{}instructions"{};"{}branches"{};"{}branch\ misses"{};"{}total"{}}}
\DoxyCodeLine{01377\ \textcolor{stringliteral}{\{\{\#result\}\}"{}\{\{title\}\}"{};"{}\{\{name\}\}"{};"{}\{\{unit\}\}"{};\{\{batch\}\};\{\{median(elapsed)\}\};\{\{medianAbsolutePercentError(elapsed)\}\};\{\{median(instructions)\}\};\{\{median(branchinstructions)\}\};\{\{median(branchmisses)\}\};\{\{sumProduct(iterations,\ elapsed)\}\}}}
\DoxyCodeLine{01378\ \textcolor{stringliteral}{\{\{/result\}\})DELIM"{};}}
\DoxyCodeLine{01379\ \textcolor{stringliteral}{\}}}
\DoxyCodeLine{01380\ \textcolor{stringliteral}{}}
\DoxyCodeLine{01381\ \textcolor{stringliteral}{}\textcolor{keywordtype}{char}\ \textcolor{keyword}{const}*\ htmlBoxplot()\ noexcept\ \{}
\DoxyCodeLine{01382\ \ \ \ \ \textcolor{keywordflow}{return}\ R\textcolor{stringliteral}{"{}DELIM(<html>}}
\DoxyCodeLine{01383\ \textcolor{stringliteral}{}}
\DoxyCodeLine{01384\ \textcolor{stringliteral}{<head>}}
\DoxyCodeLine{01385\ \textcolor{stringliteral}{\ \ \ \ <script\ src="{}https://cdn.plot.ly/plotly-\/latest.min.js"{}></script>}}
\DoxyCodeLine{01386\ \textcolor{stringliteral}{</head>}}
\DoxyCodeLine{01387\ \textcolor{stringliteral}{}}
\DoxyCodeLine{01388\ \textcolor{stringliteral}{<body>}}
\DoxyCodeLine{01389\ \textcolor{stringliteral}{\ \ \ \ <div\ id="{}myDiv"{}></div>}}
\DoxyCodeLine{01390\ \textcolor{stringliteral}{\ \ \ \ <script>}}
\DoxyCodeLine{01391\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ var\ data\ =\ [}}
\DoxyCodeLine{01392\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \{\{\#result\}\}\{}}
\DoxyCodeLine{01393\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ name:\ '\{\{name\}\}',}}
\DoxyCodeLine{01394\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ y:\ [\{\{\#measurement\}\}\{\{elapsed\}\}\{\{\string^-\/last\}\},\ \{\{/last\}\}\{\{/measurement\}\}],}}
\DoxyCodeLine{01395\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \},}}
\DoxyCodeLine{01396\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \{\{/result\}\}}}
\DoxyCodeLine{01397\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ ];}}
\DoxyCodeLine{01398\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ var\ title\ =\ '\{\{title\}\}';}}
\DoxyCodeLine{01399\ \textcolor{stringliteral}{}}
\DoxyCodeLine{01400\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ data\ =\ data.map(a\ =>\ Object.assign(a,\ \{\ boxpoints:\ 'all',\ pointpos:\ 0,\ type:\ 'box'\ \}));}}
\DoxyCodeLine{01401\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ var\ layout\ =\ \{\ title:\ \{\ text:\ title\ \},\ showlegend:\ false,\ yaxis:\ \{\ title:\ 'time\ per\ unit',\ rangemode:\ 'tozero',\ autorange:\ true\ \}\ \};\ Plotly.newPlot('myDiv',\ data,\ layout,\ \{responsive:\ true\});}}
\DoxyCodeLine{01402\ \textcolor{stringliteral}{\ \ \ \ </script>}}
\DoxyCodeLine{01403\ \textcolor{stringliteral}{</body>}}
\DoxyCodeLine{01404\ \textcolor{stringliteral}{}}
\DoxyCodeLine{01405\ \textcolor{stringliteral}{</html>)DELIM"{};}}
\DoxyCodeLine{01406\ \textcolor{stringliteral}{\}}}
\DoxyCodeLine{01407\ \textcolor{stringliteral}{}}
\DoxyCodeLine{01408\ \textcolor{stringliteral}{}\textcolor{keywordtype}{char}\ \textcolor{keyword}{const}*\ pyperf()\ noexcept\ \{}
\DoxyCodeLine{01409\ \ \ \ \ \textcolor{keywordflow}{return}\ R\textcolor{stringliteral}{"{}DELIM(\{}}
\DoxyCodeLine{01410\ \textcolor{stringliteral}{\ \ \ \ "{}benchmarks"{}:\ [}}
\DoxyCodeLine{01411\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \{}}
\DoxyCodeLine{01412\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ "{}runs"{}:\ [}}
\DoxyCodeLine{01413\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}}
\DoxyCodeLine{01414\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ "{}values"{}:\ [}}
\DoxyCodeLine{01415\ \textcolor{stringliteral}{\{\{\#measurement\}\}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{\{elapsed\}\}\{\{\string^-\/last\}\},}}
\DoxyCodeLine{01416\ \textcolor{stringliteral}{\{\{/last\}\}\{\{/measurement\}\}}}
\DoxyCodeLine{01417\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ]}}
\DoxyCodeLine{01418\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}}
\DoxyCodeLine{01419\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ ]}}
\DoxyCodeLine{01420\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \}}}
\DoxyCodeLine{01421\ \textcolor{stringliteral}{\ \ \ \ ],}}
\DoxyCodeLine{01422\ \textcolor{stringliteral}{\ \ \ \ "{}metadata"{}:\ \{}}
\DoxyCodeLine{01423\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}loops"{}:\ \{\{sum(iterations)\}\},}}
\DoxyCodeLine{01424\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}inner\_loops"{}:\ \{\{batch\}\},}}
\DoxyCodeLine{01425\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}name"{}:\ "{}\{\{title\}\}"{},}}
\DoxyCodeLine{01426\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}unit"{}:\ "{}second"{}}}
\DoxyCodeLine{01427\ \textcolor{stringliteral}{\ \ \ \ \},}}
\DoxyCodeLine{01428\ \textcolor{stringliteral}{\ \ \ \ "{}version"{}:\ "{}1.0"{}}}
\DoxyCodeLine{01429\ \textcolor{stringliteral}{\})DELIM"{};}}
\DoxyCodeLine{01430\ \textcolor{stringliteral}{\}}}
\DoxyCodeLine{01431\ \textcolor{stringliteral}{}}
\DoxyCodeLine{01432\ \textcolor{stringliteral}{}\textcolor{keywordtype}{char}\ \textcolor{keyword}{const}*\ json()\ noexcept\ \{}
\DoxyCodeLine{01433\ \ \ \ \ \textcolor{keywordflow}{return}\ R\textcolor{stringliteral}{"{}DELIM(\{}}
\DoxyCodeLine{01434\ \textcolor{stringliteral}{\ \ \ \ "{}results"{}:\ [}}
\DoxyCodeLine{01435\ \textcolor{stringliteral}{\{\{\#result\}\}\ \ \ \ \ \ \ \ \{}}
\DoxyCodeLine{01436\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ "{}title"{}:\ "{}\{\{title\}\}"{},}}
\DoxyCodeLine{01437\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ "{}name"{}:\ "{}\{\{name\}\}"{},}}
\DoxyCodeLine{01438\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ "{}unit"{}:\ "{}\{\{unit\}\}"{},}}
\DoxyCodeLine{01439\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ "{}batch"{}:\ \{\{batch\}\},}}
\DoxyCodeLine{01440\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ "{}complexityN"{}:\ \{\{complexityN\}\},}}
\DoxyCodeLine{01441\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ "{}epochs"{}:\ \{\{epochs\}\},}}
\DoxyCodeLine{01442\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ "{}clockResolution"{}:\ \{\{clockResolution\}\},}}
\DoxyCodeLine{01443\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ "{}clockResolutionMultiple"{}:\ \{\{clockResolutionMultiple\}\},}}
\DoxyCodeLine{01444\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ "{}maxEpochTime"{}:\ \{\{maxEpochTime\}\},}}
\DoxyCodeLine{01445\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ "{}minEpochTime"{}:\ \{\{minEpochTime\}\},}}
\DoxyCodeLine{01446\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ "{}minEpochIterations"{}:\ \{\{minEpochIterations\}\},}}
\DoxyCodeLine{01447\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ "{}epochIterations"{}:\ \{\{epochIterations\}\},}}
\DoxyCodeLine{01448\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ "{}warmup"{}:\ \{\{warmup\}\},}}
\DoxyCodeLine{01449\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ "{}relative"{}:\ \{\{relative\}\},}}
\DoxyCodeLine{01450\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ "{}median(elapsed)"{}:\ \{\{median(elapsed)\}\},}}
\DoxyCodeLine{01451\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ "{}medianAbsolutePercentError(elapsed)"{}:\ \{\{medianAbsolutePercentError(elapsed)\}\},}}
\DoxyCodeLine{01452\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ "{}median(instructions)"{}:\ \{\{median(instructions)\}\},}}
\DoxyCodeLine{01453\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ "{}medianAbsolutePercentError(instructions)"{}:\ \{\{medianAbsolutePercentError(instructions)\}\},}}
\DoxyCodeLine{01454\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ "{}median(cpucycles)"{}:\ \{\{median(cpucycles)\}\},}}
\DoxyCodeLine{01455\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ "{}median(contextswitches)"{}:\ \{\{median(contextswitches)\}\},}}
\DoxyCodeLine{01456\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ "{}median(pagefaults)"{}:\ \{\{median(pagefaults)\}\},}}
\DoxyCodeLine{01457\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ "{}median(branchinstructions)"{}:\ \{\{median(branchinstructions)\}\},}}
\DoxyCodeLine{01458\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ "{}median(branchmisses)"{}:\ \{\{median(branchmisses)\}\},}}
\DoxyCodeLine{01459\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ "{}totalTime"{}:\ \{\{sumProduct(iterations,\ elapsed)\}\},}}
\DoxyCodeLine{01460\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ "{}measurements"{}:\ [}}
\DoxyCodeLine{01461\ \textcolor{stringliteral}{\{\{\#measurement\}\}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}}
\DoxyCodeLine{01462\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ "{}iterations"{}:\ \{\{iterations\}\},}}
\DoxyCodeLine{01463\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ "{}elapsed"{}:\ \{\{elapsed\}\},}}
\DoxyCodeLine{01464\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ "{}pagefaults"{}:\ \{\{pagefaults\}\},}}
\DoxyCodeLine{01465\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ "{}cpucycles"{}:\ \{\{cpucycles\}\},}}
\DoxyCodeLine{01466\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ "{}contextswitches"{}:\ \{\{contextswitches\}\},}}
\DoxyCodeLine{01467\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ "{}instructions"{}:\ \{\{instructions\}\},}}
\DoxyCodeLine{01468\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ "{}branchinstructions"{}:\ \{\{branchinstructions\}\},}}
\DoxyCodeLine{01469\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ "{}branchmisses"{}:\ \{\{branchmisses\}\}}}
\DoxyCodeLine{01470\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}\{\{\string^-\/last\}\},\{\{/-\/last\}\}}}
\DoxyCodeLine{01471\ \textcolor{stringliteral}{\{\{/measurement\}\}\ \ \ \ \ \ \ \ \ \ \ \ ]}}
\DoxyCodeLine{01472\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \}\{\{\string^-\/last\}\},\{\{/-\/last\}\}}}
\DoxyCodeLine{01473\ \textcolor{stringliteral}{\{\{/result\}\}\ \ \ \ ]}}
\DoxyCodeLine{01474\ \textcolor{stringliteral}{\})DELIM"{};}}
\DoxyCodeLine{01475\ \textcolor{stringliteral}{\}}}
\DoxyCodeLine{01476\ \textcolor{stringliteral}{}}
\DoxyCodeLine{01477\ \textcolor{stringliteral}{ANKERL\_NANOBENCH(IGNORE\_PADDED\_PUSH)}}
\DoxyCodeLine{01478\ \textcolor{stringliteral}{}\textcolor{keyword}{struct\ }Node\ \{}
\DoxyCodeLine{01479\ \ \ \ \ \textcolor{keyword}{enum\ class}\ Type\ \{\ tag,\ content,\ section,\ inverted\_section\ \};}
\DoxyCodeLine{01480\ }
\DoxyCodeLine{01481\ \ \ \ \ \textcolor{keywordtype}{char}\ \textcolor{keyword}{const}*\ begin;}
\DoxyCodeLine{01482\ \ \ \ \ \textcolor{keywordtype}{char}\ \textcolor{keyword}{const}*\ end;}
\DoxyCodeLine{01483\ \ \ \ \ std::vector<Node>\ children;}
\DoxyCodeLine{01484\ \ \ \ \ Type\ type;}
\DoxyCodeLine{01485\ }
\DoxyCodeLine{01486\ \ \ \ \ \textcolor{keyword}{template}\ <\textcolor{keywordtype}{size\_t}\ N>}
\DoxyCodeLine{01487\ \ \ \ \ \textcolor{comment}{//\ NOLINTNEXTLINE(hicpp-\/avoid-\/c-\/arrays,modernize-\/avoid-\/c-\/arrays,cppcoreguidelines-\/avoid-\/c-\/arrays)}}
\DoxyCodeLine{01488\ \ \ \ \ \textcolor{keywordtype}{bool}\ operator==(\textcolor{keywordtype}{char}\ \textcolor{keyword}{const}\ (\&str)[N])\ \textcolor{keyword}{const}\ \textcolor{keyword}{noexcept}\ \{}
\DoxyCodeLine{01489\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ NOLINTNEXTLINE(cppcoreguidelines-\/pro-\/bounds-\/array-\/to-\/pointer-\/decay)}}
\DoxyCodeLine{01490\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{size\_t}\textcolor{keyword}{>}(std::distance(begin,\ end)\ +\ 1)\ ==\ N\ \&\&\ 0\ ==\ strncmp(str,\ begin,\ N\ -\/\ 1);}
\DoxyCodeLine{01491\ \ \ \ \ \}}
\DoxyCodeLine{01492\ \};}
\DoxyCodeLine{01493\ ANKERL\_NANOBENCH(IGNORE\_PADDED\_POP)}
\DoxyCodeLine{01494\ }
\DoxyCodeLine{01495\ \textcolor{comment}{//\ NOLINTNEXTLINE(misc-\/no-\/recursion)}}
\DoxyCodeLine{01496\ \textcolor{keyword}{static}\ std::vector<Node>\ parseMustacheTemplate(\textcolor{keywordtype}{char}\ \textcolor{keyword}{const}**\ tpl)\ \{}
\DoxyCodeLine{01497\ \ \ \ \ std::vector<Node>\ nodes;}
\DoxyCodeLine{01498\ }
\DoxyCodeLine{01499\ \ \ \ \ \textcolor{keywordflow}{while}\ (\textcolor{keyword}{true})\ \{}
\DoxyCodeLine{01500\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ \textcolor{keyword}{const}*\ begin\ =\ std::strstr(*tpl,\ \textcolor{stringliteral}{"{}\{\{"{}});}
\DoxyCodeLine{01501\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ \textcolor{keyword}{const}*\ end\ =\ begin;}
\DoxyCodeLine{01502\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (begin\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{01503\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ NOLINTNEXTLINE(cppcoreguidelines-\/pro-\/bounds-\/pointer-\/arithmetic)}}
\DoxyCodeLine{01504\ \ \ \ \ \ \ \ \ \ \ \ \ begin\ +=\ 2;}
\DoxyCodeLine{01505\ \ \ \ \ \ \ \ \ \ \ \ \ end\ =\ std::strstr(begin,\ \textcolor{stringliteral}{"{}\}\}"{}});}
\DoxyCodeLine{01506\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01507\ }
\DoxyCodeLine{01508\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (begin\ ==\ \textcolor{keyword}{nullptr}\ ||\ end\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{01509\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ nothing\ found,\ finish\ node}}
\DoxyCodeLine{01510\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ NOLINTNEXTLINE(cppcoreguidelines-\/pro-\/bounds-\/pointer-\/arithmetic)}}
\DoxyCodeLine{01511\ \ \ \ \ \ \ \ \ \ \ \ \ nodes.emplace\_back(Node\{*tpl,\ *tpl\ +\ std::strlen(*tpl),\ std::vector<Node>\{\},\ Node::Type::content\});}
\DoxyCodeLine{01512\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ nodes;}
\DoxyCodeLine{01513\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01514\ }
\DoxyCodeLine{01515\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ NOLINTNEXTLINE(cppcoreguidelines-\/pro-\/bounds-\/pointer-\/arithmetic)}}
\DoxyCodeLine{01516\ \ \ \ \ \ \ \ \ nodes.emplace\_back(Node\{*tpl,\ begin\ -\/\ 2,\ std::vector<Node>\{\},\ Node::Type::content\});}
\DoxyCodeLine{01517\ }
\DoxyCodeLine{01518\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ we\ found\ a\ tag}}
\DoxyCodeLine{01519\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ NOLINTNEXTLINE(cppcoreguidelines-\/pro-\/bounds-\/pointer-\/arithmetic)}}
\DoxyCodeLine{01520\ \ \ \ \ \ \ \ \ *tpl\ =\ end\ +\ 2;}
\DoxyCodeLine{01521\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{switch}\ (*begin)\ \{}
\DoxyCodeLine{01522\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \textcolor{charliteral}{'/'}:}
\DoxyCodeLine{01523\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ finished!\ bail\ out}}
\DoxyCodeLine{01524\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ nodes;}
\DoxyCodeLine{01525\ }
\DoxyCodeLine{01526\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \textcolor{charliteral}{'\#'}:}
\DoxyCodeLine{01527\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ NOLINTNEXTLINE(cppcoreguidelines-\/pro-\/bounds-\/pointer-\/arithmetic)}}
\DoxyCodeLine{01528\ \ \ \ \ \ \ \ \ \ \ \ \ nodes.emplace\_back(Node\{begin\ +\ 1,\ end,\ parseMustacheTemplate(tpl),\ Node::Type::section\});}
\DoxyCodeLine{01529\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01530\ }
\DoxyCodeLine{01531\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \textcolor{charliteral}{'\string^'}:}
\DoxyCodeLine{01532\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ NOLINTNEXTLINE(cppcoreguidelines-\/pro-\/bounds-\/pointer-\/arithmetic)}}
\DoxyCodeLine{01533\ \ \ \ \ \ \ \ \ \ \ \ \ nodes.emplace\_back(Node\{begin\ +\ 1,\ end,\ parseMustacheTemplate(tpl),\ Node::Type::inverted\_section\});}
\DoxyCodeLine{01534\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01535\ }
\DoxyCodeLine{01536\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{01537\ \ \ \ \ \ \ \ \ \ \ \ \ nodes.emplace\_back(Node\{begin,\ end,\ std::vector<Node>\{\},\ Node::Type::tag\});}
\DoxyCodeLine{01538\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01539\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01540\ \ \ \ \ \}}
\DoxyCodeLine{01541\ \}}
\DoxyCodeLine{01542\ }
\DoxyCodeLine{01543\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{bool}\ generateFirstLast(Node\ \textcolor{keyword}{const}\&\ n,\ \textcolor{keywordtype}{size\_t}\ idx,\ \textcolor{keywordtype}{size\_t}\ size,\ std::ostream\&\ out)\ \{}
\DoxyCodeLine{01544\ \ \ \ \ ANKERL\_NANOBENCH\_LOG(\textcolor{stringliteral}{"{}n.type="{}}\ <<\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(n.type));}
\DoxyCodeLine{01545\ \ \ \ \ \textcolor{keywordtype}{bool}\ \textcolor{keyword}{const}\ matchFirst\ =\ n\ ==\ \textcolor{stringliteral}{"{}-\/first"{}};}
\DoxyCodeLine{01546\ \ \ \ \ \textcolor{keywordtype}{bool}\ \textcolor{keyword}{const}\ matchLast\ =\ n\ ==\ \textcolor{stringliteral}{"{}-\/last"{}};}
\DoxyCodeLine{01547\ \ \ \ \ \textcolor{keywordflow}{if}\ (!matchFirst\ \&\&\ !matchLast)\ \{}
\DoxyCodeLine{01548\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{01549\ \ \ \ \ \}}
\DoxyCodeLine{01550\ }
\DoxyCodeLine{01551\ \ \ \ \ \textcolor{keywordtype}{bool}\ doWrite\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{01552\ \ \ \ \ \textcolor{keywordflow}{if}\ (n.type\ ==\ Node::Type::section)\ \{}
\DoxyCodeLine{01553\ \ \ \ \ \ \ \ \ doWrite\ =\ (matchFirst\ \&\&\ idx\ ==\ 0)\ ||\ (matchLast\ \&\&\ idx\ ==\ size\ -\/\ 1);}
\DoxyCodeLine{01554\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (n.type\ ==\ Node::Type::inverted\_section)\ \{}
\DoxyCodeLine{01555\ \ \ \ \ \ \ \ \ doWrite\ =\ (matchFirst\ \&\&\ idx\ !=\ 0)\ ||\ (matchLast\ \&\&\ idx\ !=\ size\ -\/\ 1);}
\DoxyCodeLine{01556\ \ \ \ \ \}}
\DoxyCodeLine{01557\ }
\DoxyCodeLine{01558\ \ \ \ \ \textcolor{keywordflow}{if}\ (doWrite)\ \{}
\DoxyCodeLine{01559\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ \textcolor{keyword}{const}\&\ child\ :\ n.children)\ \{}
\DoxyCodeLine{01560\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (child.type\ ==\ Node::Type::content)\ \{}
\DoxyCodeLine{01561\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ out.write(child.begin,\ std::distance(child.begin,\ child.end));}
\DoxyCodeLine{01562\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01563\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01564\ \ \ \ \ \}}
\DoxyCodeLine{01565\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{01566\ \}}
\DoxyCodeLine{01567\ }
\DoxyCodeLine{01568\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{bool}\ matchCmdArgs(std::string\ \textcolor{keyword}{const}\&\ str,\ std::vector<std::string>\&\ matchResult)\ \{}
\DoxyCodeLine{01569\ \ \ \ \ matchResult.clear();}
\DoxyCodeLine{01570\ \ \ \ \ \textcolor{keyword}{auto}\ idxOpen\ =\ str.find(\textcolor{charliteral}{'('});}
\DoxyCodeLine{01571\ \ \ \ \ \textcolor{keyword}{auto}\ idxClose\ =\ str.find(\textcolor{charliteral}{')'},\ idxOpen);}
\DoxyCodeLine{01572\ \ \ \ \ \textcolor{keywordflow}{if}\ (idxClose\ ==\ std::string::npos)\ \{}
\DoxyCodeLine{01573\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{01574\ \ \ \ \ \}}
\DoxyCodeLine{01575\ }
\DoxyCodeLine{01576\ \ \ \ \ matchResult.emplace\_back(str.substr(0,\ idxOpen));}
\DoxyCodeLine{01577\ }
\DoxyCodeLine{01578\ \ \ \ \ \textcolor{comment}{//\ split\ by\ comma}}
\DoxyCodeLine{01579\ \ \ \ \ matchResult.emplace\_back();}
\DoxyCodeLine{01580\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ idxOpen\ +\ 1;\ i\ !=\ idxClose;\ ++i)\ \{}
\DoxyCodeLine{01581\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (str[i]\ ==\ \textcolor{charliteral}{'\ '}\ ||\ str[i]\ ==\ \textcolor{charliteral}{'\(\backslash\)t'})\ \{}
\DoxyCodeLine{01582\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ skip\ whitespace}}
\DoxyCodeLine{01583\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{01584\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01585\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (str[i]\ ==\ \textcolor{charliteral}{','})\ \{}
\DoxyCodeLine{01586\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ got\ a\ comma\ =>\ new\ string}}
\DoxyCodeLine{01587\ \ \ \ \ \ \ \ \ \ \ \ \ matchResult.emplace\_back();}
\DoxyCodeLine{01588\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{01589\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01590\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ no\ whitespace\ no\ comma,\ append}}
\DoxyCodeLine{01591\ \ \ \ \ \ \ \ \ matchResult.back()\ +=\ str[i];}
\DoxyCodeLine{01592\ \ \ \ \ \}}
\DoxyCodeLine{01593\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{01594\ \}}
\DoxyCodeLine{01595\ }
\DoxyCodeLine{01596\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{bool}\ generateConfigTag(Node\ \textcolor{keyword}{const}\&\ n,\ Config\ \textcolor{keyword}{const}\&\ config,\ std::ostream\&\ out)\ \{}
\DoxyCodeLine{01597\ \ \ \ \ \textcolor{keyword}{using\ }detail::d;}
\DoxyCodeLine{01598\ }
\DoxyCodeLine{01599\ \ \ \ \ \textcolor{keywordflow}{if}\ (n\ ==\ \textcolor{stringliteral}{"{}title"{}})\ \{}
\DoxyCodeLine{01600\ \ \ \ \ \ \ \ \ out\ <<\ config.mBenchmarkTitle;}
\DoxyCodeLine{01601\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{01602\ \ \ \ \ \}}
\DoxyCodeLine{01603\ \ \ \ \ \textcolor{keywordflow}{if}\ (n\ ==\ \textcolor{stringliteral}{"{}name"{}})\ \{}
\DoxyCodeLine{01604\ \ \ \ \ \ \ \ \ out\ <<\ config.mBenchmarkName;}
\DoxyCodeLine{01605\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{01606\ \ \ \ \ \}}
\DoxyCodeLine{01607\ \ \ \ \ \textcolor{keywordflow}{if}\ (n\ ==\ \textcolor{stringliteral}{"{}unit"{}})\ \{}
\DoxyCodeLine{01608\ \ \ \ \ \ \ \ \ out\ <<\ config.mUnit;}
\DoxyCodeLine{01609\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{01610\ \ \ \ \ \}}
\DoxyCodeLine{01611\ \ \ \ \ \textcolor{keywordflow}{if}\ (n\ ==\ \textcolor{stringliteral}{"{}batch"{}})\ \{}
\DoxyCodeLine{01612\ \ \ \ \ \ \ \ \ out\ <<\ config.mBatch;}
\DoxyCodeLine{01613\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{01614\ \ \ \ \ \}}
\DoxyCodeLine{01615\ \ \ \ \ \textcolor{keywordflow}{if}\ (n\ ==\ \textcolor{stringliteral}{"{}complexityN"{}})\ \{}
\DoxyCodeLine{01616\ \ \ \ \ \ \ \ \ out\ <<\ config.mComplexityN;}
\DoxyCodeLine{01617\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{01618\ \ \ \ \ \}}
\DoxyCodeLine{01619\ \ \ \ \ \textcolor{keywordflow}{if}\ (n\ ==\ \textcolor{stringliteral}{"{}epochs"{}})\ \{}
\DoxyCodeLine{01620\ \ \ \ \ \ \ \ \ out\ <<\ config.mNumEpochs;}
\DoxyCodeLine{01621\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{01622\ \ \ \ \ \}}
\DoxyCodeLine{01623\ \ \ \ \ \textcolor{keywordflow}{if}\ (n\ ==\ \textcolor{stringliteral}{"{}clockResolution"{}})\ \{}
\DoxyCodeLine{01624\ \ \ \ \ \ \ \ \ out\ <<\ d(detail::clockResolution());}
\DoxyCodeLine{01625\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{01626\ \ \ \ \ \}}
\DoxyCodeLine{01627\ \ \ \ \ \textcolor{keywordflow}{if}\ (n\ ==\ \textcolor{stringliteral}{"{}clockResolutionMultiple"{}})\ \{}
\DoxyCodeLine{01628\ \ \ \ \ \ \ \ \ out\ <<\ config.mClockResolutionMultiple;}
\DoxyCodeLine{01629\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{01630\ \ \ \ \ \}}
\DoxyCodeLine{01631\ \ \ \ \ \textcolor{keywordflow}{if}\ (n\ ==\ \textcolor{stringliteral}{"{}maxEpochTime"{}})\ \{}
\DoxyCodeLine{01632\ \ \ \ \ \ \ \ \ out\ <<\ d(config.mMaxEpochTime);}
\DoxyCodeLine{01633\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{01634\ \ \ \ \ \}}
\DoxyCodeLine{01635\ \ \ \ \ \textcolor{keywordflow}{if}\ (n\ ==\ \textcolor{stringliteral}{"{}minEpochTime"{}})\ \{}
\DoxyCodeLine{01636\ \ \ \ \ \ \ \ \ out\ <<\ d(config.mMinEpochTime);}
\DoxyCodeLine{01637\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{01638\ \ \ \ \ \}}
\DoxyCodeLine{01639\ \ \ \ \ \textcolor{keywordflow}{if}\ (n\ ==\ \textcolor{stringliteral}{"{}minEpochIterations"{}})\ \{}
\DoxyCodeLine{01640\ \ \ \ \ \ \ \ \ out\ <<\ config.mMinEpochIterations;}
\DoxyCodeLine{01641\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{01642\ \ \ \ \ \}}
\DoxyCodeLine{01643\ \ \ \ \ \textcolor{keywordflow}{if}\ (n\ ==\ \textcolor{stringliteral}{"{}epochIterations"{}})\ \{}
\DoxyCodeLine{01644\ \ \ \ \ \ \ \ \ out\ <<\ config.mEpochIterations;}
\DoxyCodeLine{01645\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{01646\ \ \ \ \ \}}
\DoxyCodeLine{01647\ \ \ \ \ \textcolor{keywordflow}{if}\ (n\ ==\ \textcolor{stringliteral}{"{}warmup"{}})\ \{}
\DoxyCodeLine{01648\ \ \ \ \ \ \ \ \ out\ <<\ config.mWarmup;}
\DoxyCodeLine{01649\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{01650\ \ \ \ \ \}}
\DoxyCodeLine{01651\ \ \ \ \ \textcolor{keywordflow}{if}\ (n\ ==\ \textcolor{stringliteral}{"{}relative"{}})\ \{}
\DoxyCodeLine{01652\ \ \ \ \ \ \ \ \ out\ <<\ config.mIsRelative;}
\DoxyCodeLine{01653\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{01654\ \ \ \ \ \}}
\DoxyCodeLine{01655\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{01656\ \}}
\DoxyCodeLine{01657\ }
\DoxyCodeLine{01658\ \textcolor{comment}{//\ NOLINTNEXTLINE(readability-\/function-\/cognitive-\/complexity)}}
\DoxyCodeLine{01659\ \textcolor{keyword}{static}\ std::ostream\&\ generateResultTag(Node\ \textcolor{keyword}{const}\&\ n,\ Result\ \textcolor{keyword}{const}\&\ r,\ std::ostream\&\ out)\ \{}
\DoxyCodeLine{01660\ \ \ \ \ \textcolor{keywordflow}{if}\ (generateConfigTag(n,\ r.config(),\ out))\ \{}
\DoxyCodeLine{01661\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ out;}
\DoxyCodeLine{01662\ \ \ \ \ \}}
\DoxyCodeLine{01663\ \ \ \ \ \textcolor{comment}{//\ match\ e.g.\ "{}median(elapsed)"{}}}
\DoxyCodeLine{01664\ \ \ \ \ \textcolor{comment}{//\ g++\ 4.8\ doesn't\ implement\ std::regex\ :(}}
\DoxyCodeLine{01665\ \ \ \ \ \textcolor{comment}{//\ static\ std::regex\ const\ regOpArg1("{}\string^([a-\/zA-\/Z]+)\(\backslash\)\(\backslash\)(([a-\/zA-\/Z]*)\(\backslash\)\(\backslash\))\$"{});}}
\DoxyCodeLine{01666\ \ \ \ \ \textcolor{comment}{//\ std::cmatch\ matchResult;}}
\DoxyCodeLine{01667\ \ \ \ \ \textcolor{comment}{//\ if\ (std::regex\_match(n.begin,\ n.end,\ matchResult,\ regOpArg1))\ \{}}
\DoxyCodeLine{01668\ \ \ \ \ std::vector<std::string>\ matchResult;}
\DoxyCodeLine{01669\ \ \ \ \ \textcolor{keywordflow}{if}\ (matchCmdArgs(std::string(n.begin,\ n.end),\ matchResult))\ \{}
\DoxyCodeLine{01670\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (matchResult.size()\ ==\ 2)\ \{}
\DoxyCodeLine{01671\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (matchResult[0]\ ==\ \textcolor{stringliteral}{"{}context"{}})\ \{}
\DoxyCodeLine{01672\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ out\ <<\ r.context(matchResult[1]);}
\DoxyCodeLine{01673\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01674\ }
\DoxyCodeLine{01675\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ m\ =\ Result::fromString(matchResult[1]);}
\DoxyCodeLine{01676\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (m\ ==\ Result::Measure::\_size)\ \{}
\DoxyCodeLine{01677\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ out\ <<\ 0.0;}
\DoxyCodeLine{01678\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01679\ }
\DoxyCodeLine{01680\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (matchResult[0]\ ==\ \textcolor{stringliteral}{"{}median"{}})\ \{}
\DoxyCodeLine{01681\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ out\ <<\ r.median(m);}
\DoxyCodeLine{01682\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01683\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (matchResult[0]\ ==\ \textcolor{stringliteral}{"{}average"{}})\ \{}
\DoxyCodeLine{01684\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ out\ <<\ r.average(m);}
\DoxyCodeLine{01685\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01686\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (matchResult[0]\ ==\ \textcolor{stringliteral}{"{}medianAbsolutePercentError"{}})\ \{}
\DoxyCodeLine{01687\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ out\ <<\ r.medianAbsolutePercentError(m);}
\DoxyCodeLine{01688\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01689\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (matchResult[0]\ ==\ \textcolor{stringliteral}{"{}sum"{}})\ \{}
\DoxyCodeLine{01690\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ out\ <<\ r.sum(m);}
\DoxyCodeLine{01691\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01692\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (matchResult[0]\ ==\ \textcolor{stringliteral}{"{}minimum"{}})\ \{}
\DoxyCodeLine{01693\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ out\ <<\ r.minimum(m);}
\DoxyCodeLine{01694\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01695\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (matchResult[0]\ ==\ \textcolor{stringliteral}{"{}maximum"{}})\ \{}
\DoxyCodeLine{01696\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ out\ <<\ r.maximum(m);}
\DoxyCodeLine{01697\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01698\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (matchResult.size()\ ==\ 3)\ \{}
\DoxyCodeLine{01699\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ m1\ =\ Result::fromString(matchResult[1]);}
\DoxyCodeLine{01700\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ m2\ =\ Result::fromString(matchResult[2]);}
\DoxyCodeLine{01701\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (m1\ ==\ Result::Measure::\_size\ ||\ m2\ ==\ Result::Measure::\_size)\ \{}
\DoxyCodeLine{01702\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ out\ <<\ 0.0;}
\DoxyCodeLine{01703\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01704\ }
\DoxyCodeLine{01705\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (matchResult[0]\ ==\ \textcolor{stringliteral}{"{}sumProduct"{}})\ \{}
\DoxyCodeLine{01706\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ out\ <<\ r.sumProduct(m1,\ m2);}
\DoxyCodeLine{01707\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01708\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01709\ \ \ \ \ \}}
\DoxyCodeLine{01710\ }
\DoxyCodeLine{01711\ \ \ \ \ \textcolor{comment}{//\ match\ e.g.\ "{}sumProduct(elapsed,\ iterations)"{}}}
\DoxyCodeLine{01712\ \ \ \ \ \textcolor{comment}{//\ static\ std::regex\ const\ regOpArg2("{}\string^([a-\/zA-\/Z]+)\(\backslash\)\(\backslash\)(([a-\/zA-\/Z]*)\(\backslash\)\(\backslash\)s*,\(\backslash\)\(\backslash\)s+([a-\/zA-\/Z]*)\(\backslash\)\(\backslash\))\$"{});}}
\DoxyCodeLine{01713\ }
\DoxyCodeLine{01714\ \ \ \ \ \textcolor{comment}{//\ nothing\ matches\ :(}}
\DoxyCodeLine{01715\ \ \ \ \ \textcolor{keywordflow}{throw}\ std::runtime\_error(\textcolor{stringliteral}{"{}command\ '"{}}\ +\ std::string(n.begin,\ n.end)\ +\ \textcolor{stringliteral}{"{}'\ not\ understood"{}});}
\DoxyCodeLine{01716\ \}}
\DoxyCodeLine{01717\ }
\DoxyCodeLine{01718\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ generateResultMeasurement(std::vector<Node>\ \textcolor{keyword}{const}\&\ nodes,\ \textcolor{keywordtype}{size\_t}\ idx,\ Result\ \textcolor{keyword}{const}\&\ r,\ std::ostream\&\ out)\ \{}
\DoxyCodeLine{01719\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ \textcolor{keyword}{const}\&\ n\ :\ nodes)\ \{}
\DoxyCodeLine{01720\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!generateFirstLast(n,\ idx,\ r.size(),\ out))\ \{}
\DoxyCodeLine{01721\ \ \ \ \ \ \ \ \ \ \ \ \ ANKERL\_NANOBENCH\_LOG(\textcolor{stringliteral}{"{}n.type="{}}\ <<\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(n.type));}
\DoxyCodeLine{01722\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{switch}\ (n.type)\ \{}
\DoxyCodeLine{01723\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Node::Type::content:}
\DoxyCodeLine{01724\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ out.write(n.begin,\ std::distance(n.begin,\ n.end));}
\DoxyCodeLine{01725\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01726\ }
\DoxyCodeLine{01727\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Node::Type::inverted\_section:}
\DoxyCodeLine{01728\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::runtime\_error(\textcolor{stringliteral}{"{}got\ a\ inverted\ section\ inside\ measurement"{}});}
\DoxyCodeLine{01729\ }
\DoxyCodeLine{01730\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Node::Type::section:}
\DoxyCodeLine{01731\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::runtime\_error(\textcolor{stringliteral}{"{}got\ a\ section\ inside\ measurement"{}});}
\DoxyCodeLine{01732\ }
\DoxyCodeLine{01733\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Node::Type::tag:\ \{}
\DoxyCodeLine{01734\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ m\ =\ Result::fromString(std::string(n.begin,\ n.end));}
\DoxyCodeLine{01735\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (m\ ==\ Result::Measure::\_size\ ||\ !r.has(m))\ \{}
\DoxyCodeLine{01736\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ out\ <<\ 0.0;}
\DoxyCodeLine{01737\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01738\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ out\ <<\ r.get(idx,\ m);}
\DoxyCodeLine{01739\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01740\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01741\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01742\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01743\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01744\ \ \ \ \ \}}
\DoxyCodeLine{01745\ \}}
\DoxyCodeLine{01746\ }
\DoxyCodeLine{01747\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ generateResult(std::vector<Node>\ \textcolor{keyword}{const}\&\ nodes,\ \textcolor{keywordtype}{size\_t}\ idx,\ std::vector<Result>\ \textcolor{keyword}{const}\&\ results,\ std::ostream\&\ out)\ \{}
\DoxyCodeLine{01748\ \ \ \ \ \textcolor{keyword}{auto}\ \textcolor{keyword}{const}\&\ r\ =\ results[idx];}
\DoxyCodeLine{01749\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ \textcolor{keyword}{const}\&\ n\ :\ nodes)\ \{}
\DoxyCodeLine{01750\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!generateFirstLast(n,\ idx,\ results.size(),\ out))\ \{}
\DoxyCodeLine{01751\ \ \ \ \ \ \ \ \ \ \ \ \ ANKERL\_NANOBENCH\_LOG(\textcolor{stringliteral}{"{}n.type="{}}\ <<\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(n.type));}
\DoxyCodeLine{01752\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{switch}\ (n.type)\ \{}
\DoxyCodeLine{01753\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Node::Type::content:}
\DoxyCodeLine{01754\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ out.write(n.begin,\ std::distance(n.begin,\ n.end));}
\DoxyCodeLine{01755\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01756\ }
\DoxyCodeLine{01757\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Node::Type::inverted\_section:}
\DoxyCodeLine{01758\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::runtime\_error(\textcolor{stringliteral}{"{}got\ a\ inverted\ section\ inside\ result"{}});}
\DoxyCodeLine{01759\ }
\DoxyCodeLine{01760\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Node::Type::section:}
\DoxyCodeLine{01761\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (n\ ==\ \textcolor{stringliteral}{"{}measurement"{}})\ \{}
\DoxyCodeLine{01762\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ r.size();\ ++i)\ \{}
\DoxyCodeLine{01763\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ generateResultMeasurement(n.children,\ i,\ r,\ out);}
\DoxyCodeLine{01764\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01765\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01766\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::runtime\_error(\textcolor{stringliteral}{"{}got\ a\ section\ inside\ result"{}});}
\DoxyCodeLine{01767\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01768\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01769\ }
\DoxyCodeLine{01770\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Node::Type::tag:}
\DoxyCodeLine{01771\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ generateResultTag(n,\ r,\ out);}
\DoxyCodeLine{01772\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01773\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01774\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01775\ \ \ \ \ \}}
\DoxyCodeLine{01776\ \}}
\DoxyCodeLine{01777\ }
\DoxyCodeLine{01778\ \}\ \textcolor{comment}{//\ namespace\ templates}}
\DoxyCodeLine{01779\ }
\DoxyCodeLine{01780\ \textcolor{comment}{//\ helper\ stuff\ that\ only\ intended\ to\ be\ used\ internally}}
\DoxyCodeLine{01781\ \textcolor{keyword}{namespace\ }detail\ \{}
\DoxyCodeLine{01782\ }
\DoxyCodeLine{01783\ \textcolor{keywordtype}{char}\ \textcolor{keyword}{const}*\ getEnv(\textcolor{keywordtype}{char}\ \textcolor{keyword}{const}*\ name);}
\DoxyCodeLine{01784\ \textcolor{keywordtype}{bool}\ isEndlessRunning(std::string\ \textcolor{keyword}{const}\&\ name);}
\DoxyCodeLine{01785\ \textcolor{keywordtype}{bool}\ isWarningsEnabled();}
\DoxyCodeLine{01786\ }
\DoxyCodeLine{01787\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{01788\ T\ parseFile(std::string\ \textcolor{keyword}{const}\&\ filename,\ \textcolor{keywordtype}{bool}*\ fail);}
\DoxyCodeLine{01789\ }
\DoxyCodeLine{01790\ \textcolor{keywordtype}{void}\ gatherStabilityInformation(std::vector<std::string>\&\ warnings,\ std::vector<std::string>\&\ recommendations);}
\DoxyCodeLine{01791\ \textcolor{keywordtype}{void}\ printStabilityInformationOnce(std::ostream*\ outStream);}
\DoxyCodeLine{01792\ }
\DoxyCodeLine{01793\ \textcolor{comment}{//\ remembers\ the\ last\ table\ settings\ used.\ When\ it\ changes,\ a\ new\ table\ header\ is\ automatically\ written\ for\ the\ new\ entry.}}
\DoxyCodeLine{01794\ uint64\_t\&\ singletonHeaderHash()\ noexcept;}
\DoxyCodeLine{01795\ }
\DoxyCodeLine{01796\ \textcolor{comment}{//\ determines\ resolution\ of\ the\ given\ clock.\ This\ is\ done\ by\ measuring\ multiple\ times\ and\ returning\ the\ minimum\ time\ difference.}}
\DoxyCodeLine{01797\ Clock::duration\ calcClockResolution(\textcolor{keywordtype}{size\_t}\ numEvaluations)\ noexcept;}
\DoxyCodeLine{01798\ }
\DoxyCodeLine{01799\ \textcolor{comment}{//\ formatting\ utilities}}
\DoxyCodeLine{01800\ namespace\ fmt\ \{}
\DoxyCodeLine{01801\ }
\DoxyCodeLine{01802\ \textcolor{comment}{//\ adds\ thousands\ separator\ to\ numbers}}
\DoxyCodeLine{01803\ ANKERL\_NANOBENCH(IGNORE\_PADDED\_PUSH)}
\DoxyCodeLine{01804\ \textcolor{keyword}{class\ }NumSep\ :\ \textcolor{keyword}{public}\ std::numpunct<char>\ \{}
\DoxyCodeLine{01805\ \textcolor{keyword}{public}:}
\DoxyCodeLine{01806\ \ \ \ \ \textcolor{keyword}{explicit}\ NumSep(\textcolor{keywordtype}{char}\ sep);}
\DoxyCodeLine{01807\ \ \ \ \ \textcolor{keywordtype}{char}\ do\_thousands\_sep()\ \textcolor{keyword}{const\ override};}
\DoxyCodeLine{01808\ \ \ \ \ std::string\ do\_grouping()\ \textcolor{keyword}{const\ override};}
\DoxyCodeLine{01809\ }
\DoxyCodeLine{01810\ \textcolor{keyword}{private}:}
\DoxyCodeLine{01811\ \ \ \ \ \textcolor{keywordtype}{char}\ mSep;}
\DoxyCodeLine{01812\ \};}
\DoxyCodeLine{01813\ ANKERL\_NANOBENCH(IGNORE\_PADDED\_POP)}
\DoxyCodeLine{01814\ }
\DoxyCodeLine{01815\ \textcolor{comment}{//\ RAII\ to\ save\ \&\ restore\ a\ stream's\ state}}
\DoxyCodeLine{01816\ ANKERL\_NANOBENCH(IGNORE\_PADDED\_PUSH)}
\DoxyCodeLine{01817\ \textcolor{keyword}{class\ }StreamStateRestorer\ \{}
\DoxyCodeLine{01818\ \textcolor{keyword}{public}:}
\DoxyCodeLine{01819\ \ \ \ \ \textcolor{keyword}{explicit}\ StreamStateRestorer(std::ostream\&\ s);}
\DoxyCodeLine{01820\ \ \ \ \ \string~StreamStateRestorer();}
\DoxyCodeLine{01821\ }
\DoxyCodeLine{01822\ \ \ \ \ \textcolor{comment}{//\ sets\ back\ all\ stream\ info\ that\ we\ remembered\ at\ construction}}
\DoxyCodeLine{01823\ \ \ \ \ \textcolor{keywordtype}{void}\ restore();}
\DoxyCodeLine{01824\ }
\DoxyCodeLine{01825\ \ \ \ \ \textcolor{comment}{//\ don't\ allow\ copying\ /\ moving}}
\DoxyCodeLine{01826\ \ \ \ \ StreamStateRestorer(StreamStateRestorer\ \textcolor{keyword}{const}\&)\ =\ \textcolor{keyword}{delete};}
\DoxyCodeLine{01827\ \ \ \ \ StreamStateRestorer\&\ operator=(StreamStateRestorer\ \textcolor{keyword}{const}\&)\ =\ \textcolor{keyword}{delete};}
\DoxyCodeLine{01828\ \ \ \ \ StreamStateRestorer(StreamStateRestorer\&\&)\ =\ \textcolor{keyword}{delete};}
\DoxyCodeLine{01829\ \ \ \ \ StreamStateRestorer\&\ operator=(StreamStateRestorer\&\&)\ =\ \textcolor{keyword}{delete};}
\DoxyCodeLine{01830\ }
\DoxyCodeLine{01831\ \textcolor{keyword}{private}:}
\DoxyCodeLine{01832\ \ \ \ \ std::ostream\&\ mStream;}
\DoxyCodeLine{01833\ \ \ \ \ std::locale\ mLocale;}
\DoxyCodeLine{01834\ \ \ \ \ std::streamsize\ \textcolor{keyword}{const}\ mPrecision;}
\DoxyCodeLine{01835\ \ \ \ \ std::streamsize\ \textcolor{keyword}{const}\ mWidth;}
\DoxyCodeLine{01836\ \ \ \ \ std::ostream::char\_type\ \textcolor{keyword}{const}\ mFill;}
\DoxyCodeLine{01837\ \ \ \ \ std::ostream::fmtflags\ \textcolor{keyword}{const}\ mFmtFlags;}
\DoxyCodeLine{01838\ \};}
\DoxyCodeLine{01839\ ANKERL\_NANOBENCH(IGNORE\_PADDED\_POP)}
\DoxyCodeLine{01840\ }
\DoxyCodeLine{01841\ \textcolor{comment}{//\ Number\ formatter}}
\DoxyCodeLine{01842\ \textcolor{keyword}{class\ }Number\ \{}
\DoxyCodeLine{01843\ \textcolor{keyword}{public}:}
\DoxyCodeLine{01844\ \ \ \ \ Number(\textcolor{keywordtype}{int}\ width,\ \textcolor{keywordtype}{int}\ precision,\ \textcolor{keywordtype}{double}\ value);}
\DoxyCodeLine{01845\ \ \ \ \ Number(\textcolor{keywordtype}{int}\ width,\ \textcolor{keywordtype}{int}\ precision,\ int64\_t\ value);}
\DoxyCodeLine{01846\ \ \ \ \ ANKERL\_NANOBENCH(NODISCARD)\ std::string\ to\_s()\ \textcolor{keyword}{const};}
\DoxyCodeLine{01847\ }
\DoxyCodeLine{01848\ \textcolor{keyword}{private}:}
\DoxyCodeLine{01849\ \ \ \ \ \textcolor{keyword}{friend}\ std::ostream\&\ operator<<(std::ostream\&\ os,\ Number\ \textcolor{keyword}{const}\&\ n);}
\DoxyCodeLine{01850\ \ \ \ \ std::ostream\&\ write(std::ostream\&\ os)\ \textcolor{keyword}{const};}
\DoxyCodeLine{01851\ }
\DoxyCodeLine{01852\ \ \ \ \ \textcolor{keywordtype}{int}\ mWidth;}
\DoxyCodeLine{01853\ \ \ \ \ \textcolor{keywordtype}{int}\ mPrecision;}
\DoxyCodeLine{01854\ \ \ \ \ \textcolor{keywordtype}{double}\ mValue;}
\DoxyCodeLine{01855\ \};}
\DoxyCodeLine{01856\ }
\DoxyCodeLine{01857\ \textcolor{comment}{//\ helper\ replacement\ for\ std::to\_string\ of\ signed/unsigned\ numbers\ so\ we\ are\ locale\ independent}}
\DoxyCodeLine{01858\ std::string\ to\_s(uint64\_t\ n);}
\DoxyCodeLine{01859\ }
\DoxyCodeLine{01860\ std::ostream\&\ operator<<(std::ostream\&\ os,\ Number\ \textcolor{keyword}{const}\&\ n);}
\DoxyCodeLine{01861\ }
\DoxyCodeLine{01862\ \textcolor{keyword}{class\ }MarkDownColumn\ \{}
\DoxyCodeLine{01863\ \textcolor{keyword}{public}:}
\DoxyCodeLine{01864\ \ \ \ \ MarkDownColumn(\textcolor{keywordtype}{int}\ w,\ \textcolor{keywordtype}{int}\ prec,\ std::string\ tit,\ std::string\ suff,\ \textcolor{keywordtype}{double}\ val)\ \textcolor{keyword}{noexcept};}
\DoxyCodeLine{01865\ \ \ \ \ ANKERL\_NANOBENCH(NODISCARD)\ std::string\ title()\ \textcolor{keyword}{const};}
\DoxyCodeLine{01866\ \ \ \ \ ANKERL\_NANOBENCH(NODISCARD)\ std::string\ separator()\ \textcolor{keyword}{const};}
\DoxyCodeLine{01867\ \ \ \ \ ANKERL\_NANOBENCH(NODISCARD)\ std::string\ invalid()\ \textcolor{keyword}{const};}
\DoxyCodeLine{01868\ \ \ \ \ ANKERL\_NANOBENCH(NODISCARD)\ std::string\ value()\ \textcolor{keyword}{const};}
\DoxyCodeLine{01869\ }
\DoxyCodeLine{01870\ \textcolor{keyword}{private}:}
\DoxyCodeLine{01871\ \ \ \ \ \textcolor{keywordtype}{int}\ mWidth;}
\DoxyCodeLine{01872\ \ \ \ \ \textcolor{keywordtype}{int}\ mPrecision;}
\DoxyCodeLine{01873\ \ \ \ \ std::string\ mTitle;}
\DoxyCodeLine{01874\ \ \ \ \ std::string\ mSuffix;}
\DoxyCodeLine{01875\ \ \ \ \ \textcolor{keywordtype}{double}\ mValue;}
\DoxyCodeLine{01876\ \};}
\DoxyCodeLine{01877\ }
\DoxyCodeLine{01878\ \textcolor{comment}{//\ Formats\ any\ text\ as\ markdown\ code,\ escaping\ backticks.}}
\DoxyCodeLine{01879\ \textcolor{keyword}{class\ }MarkDownCode\ \{}
\DoxyCodeLine{01880\ \textcolor{keyword}{public}:}
\DoxyCodeLine{01881\ \ \ \ \ \textcolor{keyword}{explicit}\ MarkDownCode(std::string\ \textcolor{keyword}{const}\&\ what);}
\DoxyCodeLine{01882\ }
\DoxyCodeLine{01883\ \textcolor{keyword}{private}:}
\DoxyCodeLine{01884\ \ \ \ \ \textcolor{keyword}{friend}\ std::ostream\&\ operator<<(std::ostream\&\ os,\ MarkDownCode\ \textcolor{keyword}{const}\&\ mdCode);}
\DoxyCodeLine{01885\ \ \ \ \ std::ostream\&\ write(std::ostream\&\ os)\ \textcolor{keyword}{const};}
\DoxyCodeLine{01886\ }
\DoxyCodeLine{01887\ \ \ \ \ std::string\ mWhat\{\};}
\DoxyCodeLine{01888\ \};}
\DoxyCodeLine{01889\ }
\DoxyCodeLine{01890\ std::ostream\&\ operator<<(std::ostream\&\ os,\ MarkDownCode\ \textcolor{keyword}{const}\&\ mdCode);}
\DoxyCodeLine{01891\ }
\DoxyCodeLine{01892\ \}\ \textcolor{comment}{//\ namespace\ fmt}}
\DoxyCodeLine{01893\ \}\ \textcolor{comment}{//\ namespace\ detail}}
\DoxyCodeLine{01894\ \}\ \textcolor{comment}{//\ namespace\ nanobench}}
\DoxyCodeLine{01895\ \}\ \textcolor{comment}{//\ namespace\ ankerl}}
\DoxyCodeLine{01896\ }
\DoxyCodeLine{01897\ \textcolor{comment}{//\ implementation\ /////////////////////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{01898\ }
\DoxyCodeLine{01899\ \textcolor{keyword}{namespace\ }ankerl\ \{}
\DoxyCodeLine{01900\ \textcolor{keyword}{namespace\ }nanobench\ \{}
\DoxyCodeLine{01901\ }
\DoxyCodeLine{01902\ \textcolor{comment}{//\ NOLINTNEXTLINE(readability-\/function-\/cognitive-\/complexity)}}
\DoxyCodeLine{01903\ \textcolor{keywordtype}{void}\ render(\textcolor{keywordtype}{char}\ \textcolor{keyword}{const}*\ mustacheTemplate,\ std::vector<Result>\ \textcolor{keyword}{const}\&\ results,\ std::ostream\&\ out)\ \{}
\DoxyCodeLine{01904\ \ \ \ \ detail::fmt::StreamStateRestorer\ \textcolor{keyword}{const}\ restorer(out);}
\DoxyCodeLine{01905\ }
\DoxyCodeLine{01906\ \ \ \ \ out.precision(std::numeric\_limits<double>::digits10);}
\DoxyCodeLine{01907\ \ \ \ \ \textcolor{keyword}{auto}\ nodes\ =\ templates::parseMustacheTemplate(\&mustacheTemplate);}
\DoxyCodeLine{01908\ }
\DoxyCodeLine{01909\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ \textcolor{keyword}{const}\&\ n\ :\ nodes)\ \{}
\DoxyCodeLine{01910\ \ \ \ \ \ \ \ \ ANKERL\_NANOBENCH\_LOG(\textcolor{stringliteral}{"{}n.type="{}}\ <<\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(n.type));}
\DoxyCodeLine{01911\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{switch}\ (n.type)\ \{}
\DoxyCodeLine{01912\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ templates::Node::Type::content:}
\DoxyCodeLine{01913\ \ \ \ \ \ \ \ \ \ \ \ \ out.write(n.begin,\ std::distance(n.begin,\ n.end));}
\DoxyCodeLine{01914\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01915\ }
\DoxyCodeLine{01916\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ templates::Node::Type::inverted\_section:}
\DoxyCodeLine{01917\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::runtime\_error(\textcolor{stringliteral}{"{}unknown\ list\ '"{}}\ +\ std::string(n.begin,\ n.end)\ +\ \textcolor{stringliteral}{"{}'"{}});}
\DoxyCodeLine{01918\ }
\DoxyCodeLine{01919\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ templates::Node::Type::section:}
\DoxyCodeLine{01920\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (n\ ==\ \textcolor{stringliteral}{"{}result"{}})\ \{}
\DoxyCodeLine{01921\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ nbResults\ =\ results.size();}
\DoxyCodeLine{01922\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ nbResults;\ ++i)\ \{}
\DoxyCodeLine{01923\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ generateResult(n.children,\ i,\ results,\ out);}
\DoxyCodeLine{01924\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01925\ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (n\ ==\ \textcolor{stringliteral}{"{}measurement"{}})\ \{}
\DoxyCodeLine{01926\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (results.size()\ !=\ 1)\ \{}
\DoxyCodeLine{01927\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::runtime\_error(}
\DoxyCodeLine{01928\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}render:\ can\ only\ use\ section\ 'measurement'\ here\ if\ there\ is\ a\ single\ result,\ but\ there\ are\ "{}}\ +}
\DoxyCodeLine{01929\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ detail::fmt::to\_s(results.size()));}
\DoxyCodeLine{01930\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01931\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ when\ we\ only\ have\ a\ single\ result,\ we\ can\ immediately\ go\ into\ its\ measurement.}}
\DoxyCodeLine{01932\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ \textcolor{keyword}{const}\&\ r\ =\ results.front();}
\DoxyCodeLine{01933\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ r.size();\ ++i)\ \{}
\DoxyCodeLine{01934\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ generateResultMeasurement(n.children,\ i,\ r,\ out);}
\DoxyCodeLine{01935\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01936\ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01937\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::runtime\_error(\textcolor{stringliteral}{"{}render:\ unknown\ section\ '"{}}\ +\ std::string(n.begin,\ n.end)\ +\ \textcolor{stringliteral}{"{}'"{}});}
\DoxyCodeLine{01938\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01939\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01940\ }
\DoxyCodeLine{01941\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ templates::Node::Type::tag:}
\DoxyCodeLine{01942\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (results.size()\ ==\ 1)\ \{}
\DoxyCodeLine{01943\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ result\ \&\ config\ are\ both\ supported\ there}}
\DoxyCodeLine{01944\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ generateResultTag(n,\ results.front(),\ out);}
\DoxyCodeLine{01945\ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01946\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ This\ just\ uses\ the\ last\ result's\ config.}}
\DoxyCodeLine{01947\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!generateConfigTag(n,\ results.back().config(),\ out))\ \{}
\DoxyCodeLine{01948\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::runtime\_error(\textcolor{stringliteral}{"{}unknown\ tag\ '"{}}\ +\ std::string(n.begin,\ n.end)\ +\ \textcolor{stringliteral}{"{}'"{}});}
\DoxyCodeLine{01949\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01950\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01951\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01952\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01953\ \ \ \ \ \}}
\DoxyCodeLine{01954\ \}}
\DoxyCodeLine{01955\ }
\DoxyCodeLine{01956\ \textcolor{keywordtype}{void}\ render(std::string\ \textcolor{keyword}{const}\&\ mustacheTemplate,\ std::vector<Result>\ \textcolor{keyword}{const}\&\ results,\ std::ostream\&\ out)\ \{}
\DoxyCodeLine{01957\ \ \ \ \ render(mustacheTemplate.c\_str(),\ results,\ out);}
\DoxyCodeLine{01958\ \}}
\DoxyCodeLine{01959\ }
\DoxyCodeLine{01960\ \textcolor{keywordtype}{void}\ render(\textcolor{keywordtype}{char}\ \textcolor{keyword}{const}*\ mustacheTemplate,\ \textcolor{keyword}{const}\ Bench\&\ bench,\ std::ostream\&\ out)\ \{}
\DoxyCodeLine{01961\ \ \ \ \ render(mustacheTemplate,\ bench.results(),\ out);}
\DoxyCodeLine{01962\ \}}
\DoxyCodeLine{01963\ }
\DoxyCodeLine{01964\ \textcolor{keywordtype}{void}\ render(std::string\ \textcolor{keyword}{const}\&\ mustacheTemplate,\ \textcolor{keyword}{const}\ Bench\&\ bench,\ std::ostream\&\ out)\ \{}
\DoxyCodeLine{01965\ \ \ \ \ render(mustacheTemplate.c\_str(),\ bench.results(),\ out);}
\DoxyCodeLine{01966\ \}}
\DoxyCodeLine{01967\ }
\DoxyCodeLine{01968\ \textcolor{keyword}{namespace\ }detail\ \{}
\DoxyCodeLine{01969\ }
\DoxyCodeLine{01970\ PerformanceCounters\&\ performanceCounters()\ \{}
\DoxyCodeLine{01971\ \textcolor{preprocessor}{\#\ \ \ \ if\ defined(\_\_clang\_\_)}}
\DoxyCodeLine{01972\ \textcolor{preprocessor}{\#\ \ \ \ \ \ \ \ pragma\ clang\ diagnostic\ push}}
\DoxyCodeLine{01973\ \textcolor{preprocessor}{\#\ \ \ \ \ \ \ \ pragma\ clang\ diagnostic\ ignored\ "{}-\/Wexit-\/time-\/destructors"{}}}
\DoxyCodeLine{01974\ \textcolor{preprocessor}{\#\ \ \ \ endif}}
\DoxyCodeLine{01975\ \ \ \ \ \textcolor{keyword}{static}\ PerformanceCounters\ pc;}
\DoxyCodeLine{01976\ \textcolor{preprocessor}{\#\ \ \ \ if\ defined(\_\_clang\_\_)}}
\DoxyCodeLine{01977\ \textcolor{preprocessor}{\#\ \ \ \ \ \ \ \ pragma\ clang\ diagnostic\ pop}}
\DoxyCodeLine{01978\ \textcolor{preprocessor}{\#\ \ \ \ endif}}
\DoxyCodeLine{01979\ \ \ \ \ \textcolor{keywordflow}{return}\ pc;}
\DoxyCodeLine{01980\ \}}
\DoxyCodeLine{01981\ }
\DoxyCodeLine{01982\ \textcolor{comment}{//\ Windows\ version\ of\ doNotOptimizeAway}}
\DoxyCodeLine{01983\ \textcolor{comment}{//\ see\ https://github.com/google/benchmark/blob/v1.7.1/include/benchmark/benchmark.h\#L514}}
\DoxyCodeLine{01984\ \textcolor{comment}{//\ see\ https://github.com/facebook/folly/blob/v2023.01.30.00/folly/lang/Hint-\/inl.h\#L54-\/L58}}
\DoxyCodeLine{01985\ \textcolor{comment}{//\ see\ https://learn.microsoft.com/en-\/us/cpp/preprocessor/optimize}}
\DoxyCodeLine{01986\ \textcolor{preprocessor}{\#\ \ \ \ if\ defined(\_MSC\_VER)}}
\DoxyCodeLine{01987\ \textcolor{preprocessor}{\#\ \ \ \ \ \ \ \ pragma\ optimize("{}"{},\ off)}}
\DoxyCodeLine{01988\ \textcolor{keywordtype}{void}\ doNotOptimizeAwaySink(\textcolor{keywordtype}{void}\ \textcolor{keyword}{const}*)\ \{\}}
\DoxyCodeLine{01989\ \textcolor{preprocessor}{\#\ \ \ \ \ \ \ \ pragma\ optimize("{}"{},\ on)}}
\DoxyCodeLine{01990\ \textcolor{preprocessor}{\#\ \ \ \ endif}}
\DoxyCodeLine{01991\ }
\DoxyCodeLine{01992\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{01993\ T\ parseFile(std::string\ \textcolor{keyword}{const}\&\ filename,\ \textcolor{keywordtype}{bool}*\ fail)\ \{}
\DoxyCodeLine{01994\ \ \ \ \ std::ifstream\ fin(filename);\ \textcolor{comment}{//\ NOLINT(misc-\/const-\/correctness)}}
\DoxyCodeLine{01995\ \ \ \ \ T\ num\{\};}
\DoxyCodeLine{01996\ \ \ \ \ fin\ >>\ num;}
\DoxyCodeLine{01997\ \ \ \ \ \textcolor{keywordflow}{if}\ (fail\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{01998\ \ \ \ \ \ \ \ \ *fail\ =\ fin.fail();}
\DoxyCodeLine{01999\ \ \ \ \ \}}
\DoxyCodeLine{02000\ \ \ \ \ \textcolor{keywordflow}{return}\ num;}
\DoxyCodeLine{02001\ \}}
\DoxyCodeLine{02002\ }
\DoxyCodeLine{02003\ \textcolor{keywordtype}{char}\ \textcolor{keyword}{const}*\ getEnv(\textcolor{keywordtype}{char}\ \textcolor{keyword}{const}*\ name)\ \{}
\DoxyCodeLine{02004\ \textcolor{preprocessor}{\#\ \ \ \ if\ defined(\_MSC\_VER)}}
\DoxyCodeLine{02005\ \textcolor{preprocessor}{\#\ \ \ \ \ \ \ \ pragma\ warning(push)}}
\DoxyCodeLine{02006\ \textcolor{preprocessor}{\#\ \ \ \ \ \ \ \ pragma\ warning(disable\ :\ 4996)\ }\textcolor{comment}{//\ getenv':\ This\ function\ or\ variable\ may\ be\ unsafe.}}
\DoxyCodeLine{02007\ \textcolor{preprocessor}{\#\ \ \ \ endif}}
\DoxyCodeLine{02008\ \ \ \ \ \textcolor{keywordflow}{return}\ std::getenv(name);\ \textcolor{comment}{//\ NOLINT(concurrency-\/mt-\/unsafe)}}
\DoxyCodeLine{02009\ \textcolor{preprocessor}{\#\ \ \ \ if\ defined(\_MSC\_VER)}}
\DoxyCodeLine{02010\ \textcolor{preprocessor}{\#\ \ \ \ \ \ \ \ pragma\ warning(pop)}}
\DoxyCodeLine{02011\ \textcolor{preprocessor}{\#\ \ \ \ endif}}
\DoxyCodeLine{02012\ \}}
\DoxyCodeLine{02013\ }
\DoxyCodeLine{02014\ \textcolor{keywordtype}{bool}\ isEndlessRunning(std::string\ \textcolor{keyword}{const}\&\ name)\ \{}
\DoxyCodeLine{02015\ \ \ \ \ \textcolor{keyword}{auto}\ \textcolor{keyword}{const}*\ \textcolor{keyword}{const}\ endless\ =\ getEnv(\textcolor{stringliteral}{"{}NANOBENCH\_ENDLESS"{}});}
\DoxyCodeLine{02016\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr}\ !=\ endless\ \&\&\ endless\ ==\ name;}
\DoxyCodeLine{02017\ \}}
\DoxyCodeLine{02018\ }
\DoxyCodeLine{02019\ \textcolor{comment}{//\ True\ when\ environment\ variable\ NANOBENCH\_SUPPRESS\_WARNINGS\ is\ either\ not\ set\ at\ all,\ or\ set\ to\ "{}0"{}}}
\DoxyCodeLine{02020\ \textcolor{keywordtype}{bool}\ isWarningsEnabled()\ \{}
\DoxyCodeLine{02021\ \ \ \ \ \textcolor{keyword}{auto}\ \textcolor{keyword}{const}*\ \textcolor{keyword}{const}\ suppression\ =\ getEnv(\textcolor{stringliteral}{"{}NANOBENCH\_SUPPRESS\_WARNINGS"{}});}
\DoxyCodeLine{02022\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr}\ ==\ suppression\ ||\ suppression\ ==\ std::string(\textcolor{stringliteral}{"{}0"{}});}
\DoxyCodeLine{02023\ \}}
\DoxyCodeLine{02024\ }
\DoxyCodeLine{02025\ \textcolor{keywordtype}{void}\ gatherStabilityInformation(std::vector<std::string>\&\ warnings,\ std::vector<std::string>\&\ recommendations)\ \{}
\DoxyCodeLine{02026\ \ \ \ \ warnings.clear();}
\DoxyCodeLine{02027\ \ \ \ \ recommendations.clear();}
\DoxyCodeLine{02028\ }
\DoxyCodeLine{02029\ \textcolor{preprocessor}{\#\ \ \ \ if\ defined(DEBUG)}}
\DoxyCodeLine{02030\ \ \ \ \ warnings.emplace\_back(\textcolor{stringliteral}{"{}DEBUG\ defined"{}});}
\DoxyCodeLine{02031\ \ \ \ \ \textcolor{keywordtype}{bool}\ \textcolor{keyword}{const}\ recommendCheckFlags\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{02032\ \textcolor{preprocessor}{\#\ \ \ \ else}}
\DoxyCodeLine{02033\ \ \ \ \ \textcolor{keywordtype}{bool}\ \textcolor{keyword}{const}\ recommendCheckFlags\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{02034\ \textcolor{preprocessor}{\#\ \ \ \ endif}}
\DoxyCodeLine{02035\ }
\DoxyCodeLine{02036\ \ \ \ \ \textcolor{keywordtype}{bool}\ recommendPyPerf\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{02037\ \textcolor{preprocessor}{\#\ \ \ \ if\ defined(\_\_linux\_\_)}}
\DoxyCodeLine{02038\ \ \ \ \ \textcolor{keyword}{auto}\ nprocs\ =\ sysconf(\_SC\_NPROCESSORS\_CONF);}
\DoxyCodeLine{02039\ \ \ \ \ \textcolor{keywordflow}{if}\ (nprocs\ <=\ 0)\ \{}
\DoxyCodeLine{02040\ \ \ \ \ \ \ \ \ warnings.emplace\_back(\textcolor{stringliteral}{"{}couldn't\ figure\ out\ number\ of\ processors\ -\/\ no\ governor,\ turbo\ check\ possible"{}});}
\DoxyCodeLine{02041\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{02042\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ check\ frequency\ scaling}}
\DoxyCodeLine{02043\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{long}\ \textcolor{keywordtype}{id}\ =\ 0;\ \textcolor{keywordtype}{id}\ <\ nprocs;\ ++id)\ \{}
\DoxyCodeLine{02044\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ idStr\ =\ detail::fmt::to\_s(\textcolor{keyword}{static\_cast<}uint64\_t\textcolor{keyword}{>}(\textcolor{keywordtype}{id}));}
\DoxyCodeLine{02045\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ sysCpu\ =\ \textcolor{stringliteral}{"{}/sys/devices/system/cpu/cpu"{}}\ +\ idStr;}
\DoxyCodeLine{02046\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ minFreq\ =\ parseFile<int64\_t>(sysCpu\ +\ \textcolor{stringliteral}{"{}/cpufreq/scaling\_min\_freq"{}},\ \textcolor{keyword}{nullptr});}
\DoxyCodeLine{02047\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ maxFreq\ =\ parseFile<int64\_t>(sysCpu\ +\ \textcolor{stringliteral}{"{}/cpufreq/scaling\_max\_freq"{}},\ \textcolor{keyword}{nullptr});}
\DoxyCodeLine{02048\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (minFreq\ !=\ maxFreq)\ \{}
\DoxyCodeLine{02049\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ minMHz\ =\ d(minFreq)\ /\ 1000.0;}
\DoxyCodeLine{02050\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ maxMHz\ =\ d(maxFreq)\ /\ 1000.0;}
\DoxyCodeLine{02051\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ warnings.emplace\_back(\textcolor{stringliteral}{"{}CPU\ frequency\ scaling\ enabled:\ CPU\ "{}}\ +\ idStr\ +\ \textcolor{stringliteral}{"{}\ between\ "{}}\ +}
\DoxyCodeLine{02052\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ detail::fmt::Number(1,\ 1,\ minMHz).to\_s()\ +\ \textcolor{stringliteral}{"{}\ and\ "{}}\ +\ detail::fmt::Number(1,\ 1,\ maxMHz).to\_s()\ +}
\DoxyCodeLine{02053\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}\ MHz"{}});}
\DoxyCodeLine{02054\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ recommendPyPerf\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{02055\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02056\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02057\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02058\ }
\DoxyCodeLine{02059\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ fail\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{02060\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ currentGovernor\ =\ parseFile<std::string>(\textcolor{stringliteral}{"{}/sys/devices/system/cpu/cpu0/cpufreq/scaling\_governor"{}},\ \&fail);}
\DoxyCodeLine{02061\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!fail\ \&\&\ \textcolor{stringliteral}{"{}performance"{}}\ !=\ currentGovernor)\ \{}
\DoxyCodeLine{02062\ \ \ \ \ \ \ \ \ \ \ \ \ warnings.emplace\_back(\textcolor{stringliteral}{"{}CPU\ governor\ is\ '"{}}\ +\ currentGovernor\ +\ \textcolor{stringliteral}{"{}'\ but\ should\ be\ 'performance'"{}});}
\DoxyCodeLine{02063\ \ \ \ \ \ \ \ \ \ \ \ \ recommendPyPerf\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{02064\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02065\ }
\DoxyCodeLine{02066\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ noTurbo\ =\ parseFile<int>(\textcolor{stringliteral}{"{}/sys/devices/system/cpu/intel\_pstate/no\_turbo"{}},\ \&fail);}
\DoxyCodeLine{02067\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!fail\ \&\&\ noTurbo\ ==\ 0)\ \{}
\DoxyCodeLine{02068\ \ \ \ \ \ \ \ \ \ \ \ \ warnings.emplace\_back(\textcolor{stringliteral}{"{}Turbo\ is\ enabled,\ CPU\ frequency\ will\ fluctuate"{}});}
\DoxyCodeLine{02069\ \ \ \ \ \ \ \ \ \ \ \ \ recommendPyPerf\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{02070\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02071\ \ \ \ \ \}}
\DoxyCodeLine{02072\ \textcolor{preprocessor}{\#\ \ \ \ endif}}
\DoxyCodeLine{02073\ }
\DoxyCodeLine{02074\ \ \ \ \ \textcolor{keywordflow}{if}\ (recommendCheckFlags)\ \{}
\DoxyCodeLine{02075\ \ \ \ \ \ \ \ \ recommendations.emplace\_back(\textcolor{stringliteral}{"{}Make\ sure\ you\ compile\ for\ Release"{}});}
\DoxyCodeLine{02076\ \ \ \ \ \}}
\DoxyCodeLine{02077\ \ \ \ \ \textcolor{keywordflow}{if}\ (recommendPyPerf)\ \{}
\DoxyCodeLine{02078\ \ \ \ \ \ \ \ \ recommendations.emplace\_back(\textcolor{stringliteral}{"{}Use\ 'pyperf\ system\ tune'\ before\ benchmarking.\ See\ https://github.com/psf/pyperf"{}});}
\DoxyCodeLine{02079\ \ \ \ \ \}}
\DoxyCodeLine{02080\ \}}
\DoxyCodeLine{02081\ }
\DoxyCodeLine{02082\ \textcolor{keywordtype}{void}\ printStabilityInformationOnce(std::ostream*\ outStream)\ \{}
\DoxyCodeLine{02083\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{bool}\ shouldPrint\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{02084\ \ \ \ \ \textcolor{keywordflow}{if}\ (shouldPrint\ \&\&\ (\textcolor{keyword}{nullptr}\ !=\ outStream)\ \&\&\ isWarningsEnabled())\ \{}
\DoxyCodeLine{02085\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\&\ os\ =\ *outStream;}
\DoxyCodeLine{02086\ \ \ \ \ \ \ \ \ shouldPrint\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{02087\ \ \ \ \ \ \ \ \ std::vector<std::string>\ warnings;}
\DoxyCodeLine{02088\ \ \ \ \ \ \ \ \ std::vector<std::string>\ recommendations;}
\DoxyCodeLine{02089\ \ \ \ \ \ \ \ \ gatherStabilityInformation(warnings,\ recommendations);}
\DoxyCodeLine{02090\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (warnings.empty())\ \{}
\DoxyCodeLine{02091\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{02092\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02093\ }
\DoxyCodeLine{02094\ \ \ \ \ \ \ \ \ os\ <<\ \textcolor{stringliteral}{"{}Warning,\ results\ might\ be\ unstable:"{}}\ <<\ std::endl;}
\DoxyCodeLine{02095\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ \textcolor{keyword}{const}\&\ w\ :\ warnings)\ \{}
\DoxyCodeLine{02096\ \ \ \ \ \ \ \ \ \ \ \ \ os\ <<\ \textcolor{stringliteral}{"{}*\ "{}}\ <<\ w\ <<\ std::endl;}
\DoxyCodeLine{02097\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02098\ }
\DoxyCodeLine{02099\ \ \ \ \ \ \ \ \ os\ <<\ std::endl\ <<\ \textcolor{stringliteral}{"{}Recommendations"{}}\ <<\ std::endl;}
\DoxyCodeLine{02100\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ \textcolor{keyword}{const}\&\ r\ :\ recommendations)\ \{}
\DoxyCodeLine{02101\ \ \ \ \ \ \ \ \ \ \ \ \ os\ <<\ \textcolor{stringliteral}{"{}*\ "{}}\ <<\ r\ <<\ std::endl;}
\DoxyCodeLine{02102\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02103\ \ \ \ \ \}}
\DoxyCodeLine{02104\ \}}
\DoxyCodeLine{02105\ }
\DoxyCodeLine{02106\ \textcolor{comment}{//\ remembers\ the\ last\ table\ settings\ used.\ When\ it\ changes,\ a\ new\ table\ header\ is\ automatically\ written\ for\ the\ new\ entry.}}
\DoxyCodeLine{02107\ uint64\_t\&\ singletonHeaderHash()\ noexcept\ \{}
\DoxyCodeLine{02108\ \ \ \ \ \textcolor{keyword}{static}\ uint64\_t\ sHeaderHash\{\};}
\DoxyCodeLine{02109\ \ \ \ \ \textcolor{keywordflow}{return}\ sHeaderHash;}
\DoxyCodeLine{02110\ \}}
\DoxyCodeLine{02111\ }
\DoxyCodeLine{02112\ ANKERL\_NANOBENCH\_NO\_SANITIZE(\textcolor{stringliteral}{"{}integer"{}},\ \textcolor{stringliteral}{"{}undefined"{}})}
\DoxyCodeLine{02113\ inline\ uint64\_t\ hash\_combine(uint64\_t\ seed,\ uint64\_t\ val)\ \{}
\DoxyCodeLine{02114\ \ \ \ \ \textcolor{keywordflow}{return}\ seed\ \string^\ (val\ +\ UINT64\_C(0x9e3779b9)\ +\ (seed\ <<\ 6U)\ +\ (seed\ >>\ 2U));}
\DoxyCodeLine{02115\ \}}
\DoxyCodeLine{02116\ }
\DoxyCodeLine{02117\ \textcolor{comment}{//\ determines\ resolution\ of\ the\ given\ clock.\ This\ is\ done\ by\ measuring\ multiple\ times\ and\ returning\ the\ minimum\ time\ difference.}}
\DoxyCodeLine{02118\ Clock::duration\ calcClockResolution(\textcolor{keywordtype}{size\_t}\ numEvaluations)\ \textcolor{keyword}{noexcept}\ \{}
\DoxyCodeLine{02119\ \ \ \ \ \textcolor{keyword}{auto}\ bestDuration\ =\ Clock::duration::max();}
\DoxyCodeLine{02120\ \ \ \ \ Clock::time\_point\ tBegin;}
\DoxyCodeLine{02121\ \ \ \ \ Clock::time\_point\ tEnd;}
\DoxyCodeLine{02122\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ numEvaluations;\ ++i)\ \{}
\DoxyCodeLine{02123\ \ \ \ \ \ \ \ \ tBegin\ =\ Clock::now();}
\DoxyCodeLine{02124\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{do}\ \{}
\DoxyCodeLine{02125\ \ \ \ \ \ \ \ \ \ \ \ \ tEnd\ =\ Clock::now();}
\DoxyCodeLine{02126\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{while}\ (tBegin\ ==\ tEnd);}
\DoxyCodeLine{02127\ \ \ \ \ \ \ \ \ bestDuration\ =\ (std::min)(bestDuration,\ tEnd\ -\/\ tBegin);}
\DoxyCodeLine{02128\ \ \ \ \ \}}
\DoxyCodeLine{02129\ \ \ \ \ \textcolor{keywordflow}{return}\ bestDuration;}
\DoxyCodeLine{02130\ \}}
\DoxyCodeLine{02131\ }
\DoxyCodeLine{02132\ \textcolor{comment}{//\ Calculates\ clock\ resolution\ once,\ and\ remembers\ the\ result}}
\DoxyCodeLine{02133\ Clock::duration\ clockResolution()\ noexcept\ \{}
\DoxyCodeLine{02134\ \ \ \ \ \textcolor{keyword}{static}\ Clock::duration\ \textcolor{keyword}{const}\ sResolution\ =\ calcClockResolution(20);}
\DoxyCodeLine{02135\ \ \ \ \ \textcolor{keywordflow}{return}\ sResolution;}
\DoxyCodeLine{02136\ \}}
\DoxyCodeLine{02137\ }
\DoxyCodeLine{02138\ ANKERL\_NANOBENCH(IGNORE\_PADDED\_PUSH)}
\DoxyCodeLine{02139\ \textcolor{keyword}{struct\ }IterationLogic::Impl\ \{}
\DoxyCodeLine{02140\ \ \ \ \ \textcolor{keyword}{enum\ class}\ State\ \{\ warmup,\ upscaling\_runtime,\ measuring,\ endless\ \};}
\DoxyCodeLine{02141\ }
\DoxyCodeLine{02142\ \ \ \ \ \textcolor{keyword}{explicit}\ Impl(Bench\ \textcolor{keyword}{const}\&\ bench)}
\DoxyCodeLine{02143\ \ \ \ \ \ \ \ \ :\ mBench(bench)}
\DoxyCodeLine{02144\ \ \ \ \ \ \ \ \ ,\ mResult(bench.config())\ \{}
\DoxyCodeLine{02145\ \ \ \ \ \ \ \ \ printStabilityInformationOnce(mBench.output());}
\DoxyCodeLine{02146\ }
\DoxyCodeLine{02147\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ determine\ target\ runtime\ per\ epoch}}
\DoxyCodeLine{02148\ \ \ \ \ \ \ \ \ mTargetRuntimePerEpoch\ =\ detail::clockResolution()\ *\ mBench.clockResolutionMultiple();}
\DoxyCodeLine{02149\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (mTargetRuntimePerEpoch\ >\ mBench.maxEpochTime())\ \{}
\DoxyCodeLine{02150\ \ \ \ \ \ \ \ \ \ \ \ \ mTargetRuntimePerEpoch\ =\ mBench.maxEpochTime();}
\DoxyCodeLine{02151\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02152\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (mTargetRuntimePerEpoch\ <\ mBench.minEpochTime())\ \{}
\DoxyCodeLine{02153\ \ \ \ \ \ \ \ \ \ \ \ \ mTargetRuntimePerEpoch\ =\ mBench.minEpochTime();}
\DoxyCodeLine{02154\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02155\ }
\DoxyCodeLine{02156\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (isEndlessRunning(mBench.name()))\ \{}
\DoxyCodeLine{02157\ \ \ \ \ \ \ \ \ \ \ \ \ std::cerr\ <<\ \textcolor{stringliteral}{"{}NANOBENCH\_ENDLESS\ set:\ running\ '"{}}\ <<\ mBench.name()\ <<\ \textcolor{stringliteral}{"{}'\ endlessly"{}}\ <<\ std::endl;}
\DoxyCodeLine{02158\ \ \ \ \ \ \ \ \ \ \ \ \ mNumIters\ =\ (std::numeric\_limits<uint64\_t>::max)();}
\DoxyCodeLine{02159\ \ \ \ \ \ \ \ \ \ \ \ \ mState\ =\ State::endless;}
\DoxyCodeLine{02160\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (0\ !=\ mBench.warmup())\ \{}
\DoxyCodeLine{02161\ \ \ \ \ \ \ \ \ \ \ \ \ mNumIters\ =\ mBench.warmup();}
\DoxyCodeLine{02162\ \ \ \ \ \ \ \ \ \ \ \ \ mState\ =\ State::warmup;}
\DoxyCodeLine{02163\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (0\ !=\ mBench.epochIterations())\ \{}
\DoxyCodeLine{02164\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ exact\ number\ of\ iterations}}
\DoxyCodeLine{02165\ \ \ \ \ \ \ \ \ \ \ \ \ mNumIters\ =\ mBench.epochIterations();}
\DoxyCodeLine{02166\ \ \ \ \ \ \ \ \ \ \ \ \ mState\ =\ State::measuring;}
\DoxyCodeLine{02167\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{02168\ \ \ \ \ \ \ \ \ \ \ \ \ mNumIters\ =\ mBench.minEpochIterations();}
\DoxyCodeLine{02169\ \ \ \ \ \ \ \ \ \ \ \ \ mState\ =\ State::upscaling\_runtime;}
\DoxyCodeLine{02170\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02171\ \ \ \ \ \}}
\DoxyCodeLine{02172\ }
\DoxyCodeLine{02173\ \ \ \ \ \textcolor{comment}{//\ directly\ calculates\ new\ iters\ based\ on\ elapsed\&iters,\ and\ adds\ a\ 10\%\ noise.\ Makes\ sure\ we\ don't\ underflow.}}
\DoxyCodeLine{02174\ \ \ \ \ ANKERL\_NANOBENCH(NODISCARD)\ uint64\_t\ calcBestNumIters(std::chrono::nanoseconds\ elapsed,\ uint64\_t\ iters)\ \textcolor{keyword}{noexcept}\ \{}
\DoxyCodeLine{02175\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ doubleElapsed\ =\ d(elapsed);}
\DoxyCodeLine{02176\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ doubleTargetRuntimePerEpoch\ =\ d(mTargetRuntimePerEpoch);}
\DoxyCodeLine{02177\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ doubleNewIters\ =\ doubleTargetRuntimePerEpoch\ /\ doubleElapsed\ *\ d(iters);}
\DoxyCodeLine{02178\ }
\DoxyCodeLine{02179\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ doubleMinEpochIters\ =\ d(mBench.minEpochIterations());}
\DoxyCodeLine{02180\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (doubleNewIters\ <\ doubleMinEpochIters)\ \{}
\DoxyCodeLine{02181\ \ \ \ \ \ \ \ \ \ \ \ \ doubleNewIters\ =\ doubleMinEpochIters;}
\DoxyCodeLine{02182\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02183\ \ \ \ \ \ \ \ \ doubleNewIters\ *=\ 1.0\ +\ 0.2\ *\ mRng.uniform01();}
\DoxyCodeLine{02184\ }
\DoxyCodeLine{02185\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ +0.5\ for\ correct\ rounding\ when\ casting}}
\DoxyCodeLine{02186\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ NOLINTNEXTLINE(bugprone-\/incorrect-\/roundings)}}
\DoxyCodeLine{02187\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{static\_cast<}uint64\_t\textcolor{keyword}{>}(doubleNewIters\ +\ 0.5);}
\DoxyCodeLine{02188\ \ \ \ \ \}}
\DoxyCodeLine{02189\ }
\DoxyCodeLine{02190\ \ \ \ \ ANKERL\_NANOBENCH\_NO\_SANITIZE(\textcolor{stringliteral}{"{}integer"{}},\ \textcolor{stringliteral}{"{}undefined"{}})\ void\ upscale(std::chrono::nanoseconds\ elapsed)\ \{}
\DoxyCodeLine{02191\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (elapsed\ *\ 10\ <\ mTargetRuntimePerEpoch)\ \{}
\DoxyCodeLine{02192\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ we\ are\ far\ below\ the\ target\ runtime.\ Multiply\ iterations\ by\ 10\ (with\ overflow\ check)}}
\DoxyCodeLine{02193\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (mNumIters\ *\ 10\ <\ mNumIters)\ \{}
\DoxyCodeLine{02194\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ overflow\ :-\/(}}
\DoxyCodeLine{02195\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ showResult(\textcolor{stringliteral}{"{}iterations\ overflow.\ Maybe\ your\ code\ got\ optimized\ away?"{}});}
\DoxyCodeLine{02196\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mNumIters\ =\ 0;}
\DoxyCodeLine{02197\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{02198\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02199\ \ \ \ \ \ \ \ \ \ \ \ \ mNumIters\ *=\ 10;}
\DoxyCodeLine{02200\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{02201\ \ \ \ \ \ \ \ \ \ \ \ \ mNumIters\ =\ calcBestNumIters(elapsed,\ mNumIters);}
\DoxyCodeLine{02202\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02203\ \ \ \ \ \}}
\DoxyCodeLine{02204\ }
\DoxyCodeLine{02205\ \ \ \ \ \textcolor{keywordtype}{void}\ add(std::chrono::nanoseconds\ elapsed,\ PerformanceCounters\ \textcolor{keyword}{const}\&\ pc)\ \textcolor{keyword}{noexcept}\ \{}
\DoxyCodeLine{02206\ \textcolor{preprocessor}{\#\ \ \ \ if\ defined(ANKERL\_NANOBENCH\_LOG\_ENABLED)}}
\DoxyCodeLine{02207\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ oldIters\ =\ mNumIters;}
\DoxyCodeLine{02208\ \textcolor{preprocessor}{\#\ \ \ \ endif}}
\DoxyCodeLine{02209\ }
\DoxyCodeLine{02210\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{switch}\ (mState)\ \{}
\DoxyCodeLine{02211\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ State::warmup:}
\DoxyCodeLine{02212\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (isCloseEnoughForMeasurements(elapsed))\ \{}
\DoxyCodeLine{02213\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ if\ elapsed\ is\ close\ enough,\ we\ can\ skip\ upscaling\ and\ go\ right\ to\ measurements}}
\DoxyCodeLine{02214\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ still,\ we\ don't\ add\ the\ result\ to\ the\ measurements.}}
\DoxyCodeLine{02215\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mState\ =\ State::measuring;}
\DoxyCodeLine{02216\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mNumIters\ =\ calcBestNumIters(elapsed,\ mNumIters);}
\DoxyCodeLine{02217\ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{02218\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ not\ close\ enough:\ switch\ to\ upscaling}}
\DoxyCodeLine{02219\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mState\ =\ State::upscaling\_runtime;}
\DoxyCodeLine{02220\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ upscale(elapsed);}
\DoxyCodeLine{02221\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02222\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02223\ }
\DoxyCodeLine{02224\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ State::upscaling\_runtime:}
\DoxyCodeLine{02225\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (isCloseEnoughForMeasurements(elapsed))\ \{}
\DoxyCodeLine{02226\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ if\ we\ are\ close\ enough,\ add\ measurement\ and\ switch\ to\ always\ measuring}}
\DoxyCodeLine{02227\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mState\ =\ State::measuring;}
\DoxyCodeLine{02228\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mTotalElapsed\ +=\ elapsed;}
\DoxyCodeLine{02229\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mTotalNumIters\ +=\ mNumIters;}
\DoxyCodeLine{02230\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mResult.add(elapsed,\ mNumIters,\ pc);}
\DoxyCodeLine{02231\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mNumIters\ =\ calcBestNumIters(mTotalElapsed,\ mTotalNumIters);}
\DoxyCodeLine{02232\ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{02233\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ upscale(elapsed);}
\DoxyCodeLine{02234\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02235\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02236\ }
\DoxyCodeLine{02237\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ State::measuring:}
\DoxyCodeLine{02238\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ just\ add\ measurements\ -\/\ no\ questions\ asked.\ Even\ when\ runtime\ is\ low.\ But\ we\ can't\ ignore}}
\DoxyCodeLine{02239\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ that\ fluctuation,\ or\ else\ we\ would\ bias\ the\ result}}
\DoxyCodeLine{02240\ \ \ \ \ \ \ \ \ \ \ \ \ mTotalElapsed\ +=\ elapsed;}
\DoxyCodeLine{02241\ \ \ \ \ \ \ \ \ \ \ \ \ mTotalNumIters\ +=\ mNumIters;}
\DoxyCodeLine{02242\ \ \ \ \ \ \ \ \ \ \ \ \ mResult.add(elapsed,\ mNumIters,\ pc);}
\DoxyCodeLine{02243\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (0\ !=\ mBench.epochIterations())\ \{}
\DoxyCodeLine{02244\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mNumIters\ =\ mBench.epochIterations();}
\DoxyCodeLine{02245\ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{02246\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mNumIters\ =\ calcBestNumIters(mTotalElapsed,\ mTotalNumIters);}
\DoxyCodeLine{02247\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02248\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02249\ }
\DoxyCodeLine{02250\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ State::endless:}
\DoxyCodeLine{02251\ \ \ \ \ \ \ \ \ \ \ \ \ mNumIters\ =\ (std::numeric\_limits<uint64\_t>::max)();}
\DoxyCodeLine{02252\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02253\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02254\ }
\DoxyCodeLine{02255\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\textcolor{keyword}{static\_cast<}uint64\_t\textcolor{keyword}{>}(mResult.size())\ ==\ mBench.epochs())\ \{}
\DoxyCodeLine{02256\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ we\ got\ all\ the\ results\ that\ we\ need,\ finish\ it}}
\DoxyCodeLine{02257\ \ \ \ \ \ \ \ \ \ \ \ \ showResult(\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{02258\ \ \ \ \ \ \ \ \ \ \ \ \ mNumIters\ =\ 0;}
\DoxyCodeLine{02259\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02260\ }
\DoxyCodeLine{02261\ \ \ \ \ \ \ \ \ ANKERL\_NANOBENCH\_LOG(mBench.name()\ <<\ \textcolor{stringliteral}{"{}:\ "{}}\ <<\ detail::fmt::Number(20,\ 3,\ d(elapsed.count()))\ <<\ \textcolor{stringliteral}{"{}\ elapsed,\ "{}}}
\DoxyCodeLine{02262\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ detail::fmt::Number(20,\ 3,\ d(mTargetRuntimePerEpoch.count()))\ <<\ \textcolor{stringliteral}{"{}\ target.\ oldIters="{}}}
\DoxyCodeLine{02263\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ oldIters\ <<\ \textcolor{stringliteral}{"{},\ mNumIters="{}}\ <<\ mNumIters\ <<\ \textcolor{stringliteral}{"{},\ mState="{}}\ <<\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(mState));}
\DoxyCodeLine{02264\ \ \ \ \ \}}
\DoxyCodeLine{02265\ }
\DoxyCodeLine{02266\ \ \ \ \ \textcolor{comment}{//\ NOLINTNEXTLINE(readability-\/function-\/cognitive-\/complexity)}}
\DoxyCodeLine{02267\ \ \ \ \ \textcolor{keywordtype}{void}\ showResult(std::string\ \textcolor{keyword}{const}\&\ errorMessage)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{02268\ \ \ \ \ \ \ \ \ ANKERL\_NANOBENCH\_LOG(errorMessage);}
\DoxyCodeLine{02269\ }
\DoxyCodeLine{02270\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (mBench.output()\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{02271\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ prepare\ column\ data\ ///////}}
\DoxyCodeLine{02272\ \ \ \ \ \ \ \ \ \ \ \ \ std::vector<fmt::MarkDownColumn>\ columns;}
\DoxyCodeLine{02273\ }
\DoxyCodeLine{02274\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ rMedian\ =\ mResult.median(Result::Measure::elapsed);}
\DoxyCodeLine{02275\ }
\DoxyCodeLine{02276\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (mBench.relative())\ \{}
\DoxyCodeLine{02277\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ d\ =\ 100.0;}
\DoxyCodeLine{02278\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!mBench.results().empty())\ \{}
\DoxyCodeLine{02279\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ d\ =\ rMedian\ <=\ 0.0\ ?\ 0.0\ :\ mBench.results().front().median(Result::Measure::elapsed)\ /\ rMedian\ *\ 100.0;}
\DoxyCodeLine{02280\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02281\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ columns.emplace\_back(11,\ 1,\ \textcolor{stringliteral}{"{}relative"{}},\ \textcolor{stringliteral}{"{}\%"{}},\ d);}
\DoxyCodeLine{02282\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02283\ }
\DoxyCodeLine{02284\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (mBench.complexityN()\ >\ 0)\ \{}
\DoxyCodeLine{02285\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ columns.emplace\_back(14,\ 0,\ \textcolor{stringliteral}{"{}complexityN"{}},\ \textcolor{stringliteral}{"{}"{}},\ mBench.complexityN());}
\DoxyCodeLine{02286\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02287\ }
\DoxyCodeLine{02288\ \ \ \ \ \ \ \ \ \ \ \ \ columns.emplace\_back(22,\ 2,\ mBench.timeUnitName()\ +\ \textcolor{stringliteral}{"{}/"{}}\ +\ mBench.unit(),\ \textcolor{stringliteral}{"{}"{}},}
\DoxyCodeLine{02289\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ rMedian\ /\ (mBench.timeUnit().count()\ *\ mBench.batch()));}
\DoxyCodeLine{02290\ \ \ \ \ \ \ \ \ \ \ \ \ columns.emplace\_back(22,\ 2,\ mBench.unit()\ +\ \textcolor{stringliteral}{"{}/s"{}},\ \textcolor{stringliteral}{"{}"{}},\ rMedian\ <=\ 0.0\ ?\ 0.0\ :\ mBench.batch()\ /\ rMedian);}
\DoxyCodeLine{02291\ }
\DoxyCodeLine{02292\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ \textcolor{keyword}{const}\ rErrorMedian\ =\ mResult.medianAbsolutePercentError(Result::Measure::elapsed);}
\DoxyCodeLine{02293\ \ \ \ \ \ \ \ \ \ \ \ \ columns.emplace\_back(10,\ 1,\ \textcolor{stringliteral}{"{}err\%"{}},\ \textcolor{stringliteral}{"{}\%"{}},\ rErrorMedian\ *\ 100.0);}
\DoxyCodeLine{02294\ }
\DoxyCodeLine{02295\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ rInsMedian\ =\ -\/1.0;}
\DoxyCodeLine{02296\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (mBench.performanceCounters()\ \&\&\ mResult.has(Result::Measure::instructions))\ \{}
\DoxyCodeLine{02297\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ rInsMedian\ =\ mResult.median(Result::Measure::instructions);}
\DoxyCodeLine{02298\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ columns.emplace\_back(18,\ 2,\ \textcolor{stringliteral}{"{}ins/"{}}\ +\ mBench.unit(),\ \textcolor{stringliteral}{"{}"{}},\ rInsMedian\ /\ mBench.batch());}
\DoxyCodeLine{02299\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02300\ }
\DoxyCodeLine{02301\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ rCycMedian\ =\ -\/1.0;}
\DoxyCodeLine{02302\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (mBench.performanceCounters()\ \&\&\ mResult.has(Result::Measure::cpucycles))\ \{}
\DoxyCodeLine{02303\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ rCycMedian\ =\ mResult.median(Result::Measure::cpucycles);}
\DoxyCodeLine{02304\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ columns.emplace\_back(18,\ 2,\ \textcolor{stringliteral}{"{}cyc/"{}}\ +\ mBench.unit(),\ \textcolor{stringliteral}{"{}"{}},\ rCycMedian\ /\ mBench.batch());}
\DoxyCodeLine{02305\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02306\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (rInsMedian\ >\ 0.0\ \&\&\ rCycMedian\ >\ 0.0)\ \{}
\DoxyCodeLine{02307\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ columns.emplace\_back(9,\ 3,\ \textcolor{stringliteral}{"{}IPC"{}},\ \textcolor{stringliteral}{"{}"{}},\ rCycMedian\ <=\ 0.0\ ?\ 0.0\ :\ rInsMedian\ /\ rCycMedian);}
\DoxyCodeLine{02308\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02309\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (mBench.performanceCounters()\ \&\&\ mResult.has(Result::Measure::branchinstructions))\ \{}
\DoxyCodeLine{02310\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ \textcolor{keyword}{const}\ rBraMedian\ =\ mResult.median(Result::Measure::branchinstructions);}
\DoxyCodeLine{02311\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ columns.emplace\_back(17,\ 2,\ \textcolor{stringliteral}{"{}bra/"{}}\ +\ mBench.unit(),\ \textcolor{stringliteral}{"{}"{}},\ rBraMedian\ /\ mBench.batch());}
\DoxyCodeLine{02312\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (mResult.has(Result::Measure::branchmisses))\ \{}
\DoxyCodeLine{02313\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ p\ =\ 0.0;}
\DoxyCodeLine{02314\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (rBraMedian\ >=\ 1e-\/9)\ \{}
\DoxyCodeLine{02315\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ p\ =\ 100.0\ *\ mResult.median(Result::Measure::branchmisses)\ /\ rBraMedian;}
\DoxyCodeLine{02316\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02317\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ columns.emplace\_back(10,\ 1,\ \textcolor{stringliteral}{"{}miss\%"{}},\ \textcolor{stringliteral}{"{}\%"{}},\ p);}
\DoxyCodeLine{02318\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02319\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02320\ }
\DoxyCodeLine{02321\ \ \ \ \ \ \ \ \ \ \ \ \ columns.emplace\_back(12,\ 2,\ \textcolor{stringliteral}{"{}total"{}},\ \textcolor{stringliteral}{"{}"{}},\ mResult.sumProduct(Result::Measure::iterations,\ Result::Measure::elapsed));}
\DoxyCodeLine{02322\ }
\DoxyCodeLine{02323\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ write\ everything}}
\DoxyCodeLine{02324\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\&\ os\ =\ *mBench.output();}
\DoxyCodeLine{02325\ }
\DoxyCodeLine{02326\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ combine\ all\ elements\ that\ are\ relevant\ for\ printing\ the\ header}}
\DoxyCodeLine{02327\ \ \ \ \ \ \ \ \ \ \ \ \ uint64\_t\ hash\ =\ 0;}
\DoxyCodeLine{02328\ \ \ \ \ \ \ \ \ \ \ \ \ hash\ =\ hash\_combine(std::hash<std::string>\{\}(mBench.unit()),\ hash);}
\DoxyCodeLine{02329\ \ \ \ \ \ \ \ \ \ \ \ \ hash\ =\ hash\_combine(std::hash<std::string>\{\}(mBench.title()),\ hash);}
\DoxyCodeLine{02330\ \ \ \ \ \ \ \ \ \ \ \ \ hash\ =\ hash\_combine(std::hash<std::string>\{\}(mBench.timeUnitName()),\ hash);}
\DoxyCodeLine{02331\ \ \ \ \ \ \ \ \ \ \ \ \ hash\ =\ hash\_combine(std::hash<double>\{\}(mBench.timeUnit().count()),\ hash);}
\DoxyCodeLine{02332\ \ \ \ \ \ \ \ \ \ \ \ \ hash\ =\ hash\_combine(std::hash<bool>\{\}(mBench.relative()),\ hash);}
\DoxyCodeLine{02333\ \ \ \ \ \ \ \ \ \ \ \ \ hash\ =\ hash\_combine(std::hash<bool>\{\}(mBench.performanceCounters()),\ hash);}
\DoxyCodeLine{02334\ }
\DoxyCodeLine{02335\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (hash\ !=\ singletonHeaderHash())\ \{}
\DoxyCodeLine{02336\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ singletonHeaderHash()\ =\ hash;}
\DoxyCodeLine{02337\ }
\DoxyCodeLine{02338\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ no\ result\ yet,\ print\ header}}
\DoxyCodeLine{02339\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ os\ <<\ std::endl;}
\DoxyCodeLine{02340\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ \textcolor{keyword}{const}\&\ col\ :\ columns)\ \{}
\DoxyCodeLine{02341\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ os\ <<\ col.title();}
\DoxyCodeLine{02342\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02343\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ os\ <<\ \textcolor{stringliteral}{"{}|\ "{}}\ <<\ mBench.title()\ <<\ std::endl;}
\DoxyCodeLine{02344\ }
\DoxyCodeLine{02345\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ \textcolor{keyword}{const}\&\ col\ :\ columns)\ \{}
\DoxyCodeLine{02346\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ os\ <<\ col.separator();}
\DoxyCodeLine{02347\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02348\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ os\ <<\ \textcolor{stringliteral}{"{}|:"{}}\ <<\ std::string(mBench.title().size()\ +\ 1U,\ \textcolor{charliteral}{'-\/'})\ <<\ std::endl;}
\DoxyCodeLine{02349\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02350\ }
\DoxyCodeLine{02351\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!errorMessage.empty())\ \{}
\DoxyCodeLine{02352\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ \textcolor{keyword}{const}\&\ col\ :\ columns)\ \{}
\DoxyCodeLine{02353\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ os\ <<\ col.invalid();}
\DoxyCodeLine{02354\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02355\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ os\ <<\ \textcolor{stringliteral}{"{}|\ :boom:\ "{}}\ <<\ fmt::MarkDownCode(mBench.name())\ <<\ \textcolor{stringliteral}{"{}\ ("{}}\ <<\ errorMessage\ <<\ \textcolor{charliteral}{')'}\ <<\ std::endl;}
\DoxyCodeLine{02356\ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{02357\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ \textcolor{keyword}{const}\&\ col\ :\ columns)\ \{}
\DoxyCodeLine{02358\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ os\ <<\ col.value();}
\DoxyCodeLine{02359\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02360\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ os\ <<\ \textcolor{stringliteral}{"{}|\ "{}};}
\DoxyCodeLine{02361\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ showUnstable\ =\ isWarningsEnabled()\ \&\&\ rErrorMedian\ >=\ 0.05;}
\DoxyCodeLine{02362\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (showUnstable)\ \{}
\DoxyCodeLine{02363\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ os\ <<\ \textcolor{stringliteral}{"{}:wavy\_dash:\ "{}};}
\DoxyCodeLine{02364\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02365\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ os\ <<\ fmt::MarkDownCode(mBench.name());}
\DoxyCodeLine{02366\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (showUnstable)\ \{}
\DoxyCodeLine{02367\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ avgIters\ =\ d(mTotalNumIters)\ /\ d(mBench.epochs());}
\DoxyCodeLine{02368\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ NOLINTNEXTLINE(bugprone-\/incorrect-\/roundings)}}
\DoxyCodeLine{02369\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ suggestedIters\ =\ \textcolor{keyword}{static\_cast<}uint64\_t\textcolor{keyword}{>}(avgIters\ *\ 10\ +\ 0.5);}
\DoxyCodeLine{02370\ }
\DoxyCodeLine{02371\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ os\ <<\ \textcolor{stringliteral}{"{}\ (Unstable\ with\ \string~"{}}\ <<\ detail::fmt::Number(1,\ 1,\ avgIters)}
\DoxyCodeLine{02372\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\ iters.\ Increase\ \`{}minEpochIterations`\ to\ e.g.\ "{}}\ <<\ suggestedIters\ <<\ \textcolor{stringliteral}{"{})"{}};}
\DoxyCodeLine{02373\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02374\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ os\ <<\ std::endl;}
\DoxyCodeLine{02375\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02376\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02377\ \ \ \ \ \}}
\DoxyCodeLine{02378\ }
\DoxyCodeLine{02379\ \ \ \ \ ANKERL\_NANOBENCH(NODISCARD)\ \textcolor{keywordtype}{bool}\ isCloseEnoughForMeasurements(std::chrono::nanoseconds\ elapsed)\ \textcolor{keyword}{const}\ \textcolor{keyword}{noexcept}\ \{}
\DoxyCodeLine{02380\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ elapsed\ *\ 3\ >=\ mTargetRuntimePerEpoch\ *\ 2;}
\DoxyCodeLine{02381\ \ \ \ \ \}}
\DoxyCodeLine{02382\ }
\DoxyCodeLine{02383\ \ \ \ \ uint64\_t\ mNumIters\ =\ 1;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ NOLINT(misc-\/non-\/private-\/member-\/variables-\/in-\/classes)}}
\DoxyCodeLine{02384\ \ \ \ \ Bench\ \textcolor{keyword}{const}\&\ mBench;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ NOLINT(misc-\/non-\/private-\/member-\/variables-\/in-\/classes)}}
\DoxyCodeLine{02385\ \ \ \ \ std::chrono::nanoseconds\ mTargetRuntimePerEpoch\{\};\ \textcolor{comment}{//\ NOLINT(misc-\/non-\/private-\/member-\/variables-\/in-\/classes)}}
\DoxyCodeLine{02386\ \ \ \ \ Result\ mResult;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ NOLINT(misc-\/non-\/private-\/member-\/variables-\/in-\/classes)}}
\DoxyCodeLine{02387\ \ \ \ \ Rng\ mRng\{123\};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ NOLINT(misc-\/non-\/private-\/member-\/variables-\/in-\/classes)}}
\DoxyCodeLine{02388\ \ \ \ \ std::chrono::nanoseconds\ mTotalElapsed\{\};\ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ NOLINT(misc-\/non-\/private-\/member-\/variables-\/in-\/classes)}}
\DoxyCodeLine{02389\ \ \ \ \ uint64\_t\ mTotalNumIters\ =\ 0;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ NOLINT(misc-\/non-\/private-\/member-\/variables-\/in-\/classes)}}
\DoxyCodeLine{02390\ \ \ \ \ State\ mState\ =\ State::upscaling\_runtime;\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ NOLINT(misc-\/non-\/private-\/member-\/variables-\/in-\/classes)}}
\DoxyCodeLine{02391\ \};}
\DoxyCodeLine{02392\ ANKERL\_NANOBENCH(IGNORE\_PADDED\_POP)}
\DoxyCodeLine{02393\ }
\DoxyCodeLine{02394\ IterationLogic::IterationLogic(Bench\ \textcolor{keyword}{const}\&\ bench)}
\DoxyCodeLine{02395\ \ \ \ \ :\ mPimpl(new\ Impl(bench))\ \{\}}
\DoxyCodeLine{02396\ }
\DoxyCodeLine{02397\ IterationLogic::\string~IterationLogic()\ \{}
\DoxyCodeLine{02398\ \ \ \ \ \textcolor{keyword}{delete}\ mPimpl;}
\DoxyCodeLine{02399\ \}}
\DoxyCodeLine{02400\ }
\DoxyCodeLine{02401\ uint64\_t\ IterationLogic::numIters()\ const\ noexcept\ \{}
\DoxyCodeLine{02402\ \ \ \ \ ANKERL\_NANOBENCH\_LOG(mPimpl-\/>mBench.name()\ <<\ \textcolor{stringliteral}{"{}:\ mNumIters="{}}\ <<\ mPimpl-\/>mNumIters);}
\DoxyCodeLine{02403\ \ \ \ \ \textcolor{keywordflow}{return}\ mPimpl-\/>mNumIters;}
\DoxyCodeLine{02404\ \}}
\DoxyCodeLine{02405\ }
\DoxyCodeLine{02406\ \textcolor{keywordtype}{void}\ IterationLogic::add(std::chrono::nanoseconds\ elapsed,\ PerformanceCounters\ \textcolor{keyword}{const}\&\ pc)\ \textcolor{keyword}{noexcept}\ \{}
\DoxyCodeLine{02407\ \ \ \ \ mPimpl-\/>add(elapsed,\ pc);}
\DoxyCodeLine{02408\ \}}
\DoxyCodeLine{02409\ }
\DoxyCodeLine{02410\ \textcolor{keywordtype}{void}\ IterationLogic::moveResultTo(std::vector<Result>\&\ results)\ \textcolor{keyword}{noexcept}\ \{}
\DoxyCodeLine{02411\ \ \ \ \ results.emplace\_back(std::move(mPimpl-\/>mResult));}
\DoxyCodeLine{02412\ \}}
\DoxyCodeLine{02413\ }
\DoxyCodeLine{02414\ \textcolor{preprocessor}{\#\ \ \ \ if\ ANKERL\_NANOBENCH(PERF\_COUNTERS)}}
\DoxyCodeLine{02415\ }
\DoxyCodeLine{02416\ ANKERL\_NANOBENCH(IGNORE\_PADDED\_PUSH)}
\DoxyCodeLine{02417\ \textcolor{keyword}{class\ }LinuxPerformanceCounters\ \{}
\DoxyCodeLine{02418\ \textcolor{keyword}{public}:}
\DoxyCodeLine{02419\ \ \ \ \ \textcolor{keyword}{struct\ }Target\ \{}
\DoxyCodeLine{02420\ \ \ \ \ \ \ \ \ Target(uint64\_t*\ targetValue\_,\ \textcolor{keywordtype}{bool}\ correctMeasuringOverhead\_,\ \textcolor{keywordtype}{bool}\ correctLoopOverhead\_)}
\DoxyCodeLine{02421\ \ \ \ \ \ \ \ \ \ \ \ \ :\ targetValue(targetValue\_)}
\DoxyCodeLine{02422\ \ \ \ \ \ \ \ \ \ \ \ \ ,\ correctMeasuringOverhead(correctMeasuringOverhead\_)}
\DoxyCodeLine{02423\ \ \ \ \ \ \ \ \ \ \ \ \ ,\ correctLoopOverhead(correctLoopOverhead\_)\ \{\}}
\DoxyCodeLine{02424\ }
\DoxyCodeLine{02425\ \ \ \ \ \ \ \ \ uint64\_t*\ targetValue\{\};\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ NOLINT(misc-\/non-\/private-\/member-\/variables-\/in-\/classes)}}
\DoxyCodeLine{02426\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ correctMeasuringOverhead\{\};\ \textcolor{comment}{//\ NOLINT(misc-\/non-\/private-\/member-\/variables-\/in-\/classes)}}
\DoxyCodeLine{02427\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ correctLoopOverhead\{\};\ \ \ \ \ \ \textcolor{comment}{//\ NOLINT(misc-\/non-\/private-\/member-\/variables-\/in-\/classes)}}
\DoxyCodeLine{02428\ \ \ \ \ \};}
\DoxyCodeLine{02429\ }
\DoxyCodeLine{02430\ \ \ \ \ LinuxPerformanceCounters()\ =\ \textcolor{keywordflow}{default};}
\DoxyCodeLine{02431\ \ \ \ \ LinuxPerformanceCounters(LinuxPerformanceCounters\ \textcolor{keyword}{const}\&)\ =\ \textcolor{keyword}{delete};}
\DoxyCodeLine{02432\ \ \ \ \ LinuxPerformanceCounters(LinuxPerformanceCounters\&\&)\ =\ \textcolor{keyword}{delete};}
\DoxyCodeLine{02433\ \ \ \ \ LinuxPerformanceCounters\&\ operator=(LinuxPerformanceCounters\ \textcolor{keyword}{const}\&)\ =\ \textcolor{keyword}{delete};}
\DoxyCodeLine{02434\ \ \ \ \ LinuxPerformanceCounters\&\ operator=(LinuxPerformanceCounters\&\&)\ =\ \textcolor{keyword}{delete};}
\DoxyCodeLine{02435\ \ \ \ \ \string~LinuxPerformanceCounters();}
\DoxyCodeLine{02436\ }
\DoxyCodeLine{02437\ \ \ \ \ \textcolor{comment}{//\ quick\ operation}}
\DoxyCodeLine{02438\ \ \ \ \ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ start()\ \{\}}
\DoxyCodeLine{02439\ }
\DoxyCodeLine{02440\ \ \ \ \ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ stop()\ \{\}}
\DoxyCodeLine{02441\ }
\DoxyCodeLine{02442\ \ \ \ \ \textcolor{keywordtype}{bool}\ monitor(perf\_sw\_ids\ swId,\ Target\ target);}
\DoxyCodeLine{02443\ \ \ \ \ \textcolor{keywordtype}{bool}\ monitor(perf\_hw\_id\ hwId,\ Target\ target);}
\DoxyCodeLine{02444\ }
\DoxyCodeLine{02445\ \ \ \ \ ANKERL\_NANOBENCH(NODISCARD)\ \textcolor{keywordtype}{bool}\ hasError()\ const\ noexcept\ \{}
\DoxyCodeLine{02446\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ mHasError;}
\DoxyCodeLine{02447\ \ \ \ \ \}}
\DoxyCodeLine{02448\ }
\DoxyCodeLine{02449\ \ \ \ \ \textcolor{comment}{//\ Just\ reading\ data\ is\ faster\ than\ enable\ \&\ disabling.}}
\DoxyCodeLine{02450\ \ \ \ \ \textcolor{comment}{//\ we\ subtract\ data\ ourselves.}}
\DoxyCodeLine{02451\ \ \ \ \ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ beginMeasure()\ \{}
\DoxyCodeLine{02452\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (mHasError)\ \{}
\DoxyCodeLine{02453\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{02454\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02455\ }
\DoxyCodeLine{02456\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ NOLINTNEXTLINE(hicpp-\/signed-\/bitwise,cppcoreguidelines-\/pro-\/type-\/vararg)}}
\DoxyCodeLine{02457\ \ \ \ \ \ \ \ \ mHasError\ =\ -\/1\ ==\ ioctl(mFd,\ PERF\_EVENT\_IOC\_RESET,\ PERF\_IOC\_FLAG\_GROUP);}
\DoxyCodeLine{02458\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (mHasError)\ \{}
\DoxyCodeLine{02459\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{02460\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02461\ }
\DoxyCodeLine{02462\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ NOLINTNEXTLINE(hicpp-\/signed-\/bitwise,cppcoreguidelines-\/pro-\/type-\/vararg)}}
\DoxyCodeLine{02463\ \ \ \ \ \ \ \ \ mHasError\ =\ -\/1\ ==\ ioctl(mFd,\ PERF\_EVENT\_IOC\_ENABLE,\ PERF\_IOC\_FLAG\_GROUP);}
\DoxyCodeLine{02464\ \ \ \ \ \}}
\DoxyCodeLine{02465\ }
\DoxyCodeLine{02466\ \ \ \ \ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ endMeasure()\ \{}
\DoxyCodeLine{02467\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (mHasError)\ \{}
\DoxyCodeLine{02468\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{02469\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02470\ }
\DoxyCodeLine{02471\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ NOLINTNEXTLINE(hicpp-\/signed-\/bitwise,cppcoreguidelines-\/pro-\/type-\/vararg)}}
\DoxyCodeLine{02472\ \ \ \ \ \ \ \ \ mHasError\ =\ (-\/1\ ==\ ioctl(mFd,\ PERF\_EVENT\_IOC\_DISABLE,\ PERF\_IOC\_FLAG\_GROUP));}
\DoxyCodeLine{02473\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (mHasError)\ \{}
\DoxyCodeLine{02474\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{02475\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02476\ }
\DoxyCodeLine{02477\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ \textcolor{keyword}{const}\ numBytes\ =\ \textcolor{keyword}{sizeof}(uint64\_t)\ *\ mCounters.size();}
\DoxyCodeLine{02478\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ ret\ =\ read(mFd,\ mCounters.data(),\ numBytes);}
\DoxyCodeLine{02479\ \ \ \ \ \ \ \ \ mHasError\ =\ ret\ !=\ \textcolor{keyword}{static\_cast<}ssize\_t\textcolor{keyword}{>}(numBytes);}
\DoxyCodeLine{02480\ \ \ \ \ \}}
\DoxyCodeLine{02481\ }
\DoxyCodeLine{02482\ \ \ \ \ \textcolor{keywordtype}{void}\ updateResults(uint64\_t\ numIters);}
\DoxyCodeLine{02483\ }
\DoxyCodeLine{02484\ \ \ \ \ \textcolor{comment}{//\ rounded\ integer\ division}}
\DoxyCodeLine{02485\ \ \ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{02486\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{inline}\ T\ divRounded(T\ a,\ T\ divisor)\ \{}
\DoxyCodeLine{02487\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ (a\ +\ divisor\ /\ 2)\ /\ divisor;}
\DoxyCodeLine{02488\ \ \ \ \ \}}
\DoxyCodeLine{02489\ }
\DoxyCodeLine{02490\ \ \ \ \ ANKERL\_NANOBENCH\_NO\_SANITIZE(\textcolor{stringliteral}{"{}integer"{}},\ \textcolor{stringliteral}{"{}undefined"{}})}
\DoxyCodeLine{02491\ \ \ \ \ static\ inline\ uint32\_t\ mix(uint32\_t\ x)\ noexcept\ \{}
\DoxyCodeLine{02492\ \ \ \ \ \ \ \ \ x\ \string^=\ x\ <<\ 13U;}
\DoxyCodeLine{02493\ \ \ \ \ \ \ \ \ x\ \string^=\ x\ >>\ 17U;}
\DoxyCodeLine{02494\ \ \ \ \ \ \ \ \ x\ \string^=\ x\ <<\ 5U;}
\DoxyCodeLine{02495\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ x;}
\DoxyCodeLine{02496\ \ \ \ \ \}}
\DoxyCodeLine{02497\ }
\DoxyCodeLine{02498\ \ \ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Op>}
\DoxyCodeLine{02499\ \ \ \ \ ANKERL\_NANOBENCH\_NO\_SANITIZE(\textcolor{stringliteral}{"{}integer"{}},\ \textcolor{stringliteral}{"{}undefined"{}})}
\DoxyCodeLine{02500\ \ \ \ \ void\ calibrate(Op\&\&\ op)\ \{}
\DoxyCodeLine{02501\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ clear\ current\ calibration\ data,}}
\DoxyCodeLine{02502\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\&\ v\ :\ mCalibratedOverhead)\ \{}
\DoxyCodeLine{02503\ \ \ \ \ \ \ \ \ \ \ \ \ v\ =\ UINT64\_C(0);}
\DoxyCodeLine{02504\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02505\ }
\DoxyCodeLine{02506\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ create\ new\ calibration\ data}}
\DoxyCodeLine{02507\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ newCalibration\ =\ mCalibratedOverhead;}
\DoxyCodeLine{02508\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\&\ v\ :\ newCalibration)\ \{}
\DoxyCodeLine{02509\ \ \ \ \ \ \ \ \ \ \ \ \ v\ =\ (std::numeric\_limits<uint64\_t>::max)();}
\DoxyCodeLine{02510\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02511\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ iter\ =\ 0;\ iter\ <\ 100;\ ++iter)\ \{}
\DoxyCodeLine{02512\ \ \ \ \ \ \ \ \ \ \ \ \ beginMeasure();}
\DoxyCodeLine{02513\ \ \ \ \ \ \ \ \ \ \ \ \ op();}
\DoxyCodeLine{02514\ \ \ \ \ \ \ \ \ \ \ \ \ endMeasure();}
\DoxyCodeLine{02515\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (mHasError)\ \{}
\DoxyCodeLine{02516\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{02517\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02518\ }
\DoxyCodeLine{02519\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ newCalibration.size();\ ++i)\ \{}
\DoxyCodeLine{02520\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ diff\ =\ mCounters[i];}
\DoxyCodeLine{02521\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (newCalibration[i]\ >\ diff)\ \{}
\DoxyCodeLine{02522\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ newCalibration[i]\ =\ diff;}
\DoxyCodeLine{02523\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02524\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02525\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02526\ }
\DoxyCodeLine{02527\ \ \ \ \ \ \ \ \ mCalibratedOverhead\ =\ std::move(newCalibration);}
\DoxyCodeLine{02528\ }
\DoxyCodeLine{02529\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02530\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ calibrate\ loop\ overhead.\ For\ branches\ \&\ instructions\ this\ makes\ sense,\ not\ so\ much\ for\ everything\ else\ like\ cycles.}}
\DoxyCodeLine{02531\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ marsaglia's\ xorshift:\ mov,\ sal/shr,\ xor.\ Times\ 3.}}
\DoxyCodeLine{02532\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ This\ has\ the\ nice\ property\ that\ the\ compiler\ doesn't\ seem\ to\ be\ able\ to\ optimize\ multiple\ calls\ any\ further.}}
\DoxyCodeLine{02533\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ see\ https://godbolt.org/z/49RVQ5}}
\DoxyCodeLine{02534\ \ \ \ \ \ \ \ \ \ \ \ \ uint64\_t\ \textcolor{keyword}{const}\ numIters\ =\ 100000U\ +\ (std::random\_device\{\}()\ \&\ 3U);}
\DoxyCodeLine{02535\ \ \ \ \ \ \ \ \ \ \ \ \ uint64\_t\ n\ =\ numIters;}
\DoxyCodeLine{02536\ \ \ \ \ \ \ \ \ \ \ \ \ uint32\_t\ x\ =\ 1234567;}
\DoxyCodeLine{02537\ }
\DoxyCodeLine{02538\ \ \ \ \ \ \ \ \ \ \ \ \ beginMeasure();}
\DoxyCodeLine{02539\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{while}\ (n-\/-\/\ >\ 0)\ \{}
\DoxyCodeLine{02540\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ x\ =\ mix(x);}
\DoxyCodeLine{02541\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02542\ \ \ \ \ \ \ \ \ \ \ \ \ endMeasure();}
\DoxyCodeLine{02543\ \ \ \ \ \ \ \ \ \ \ \ \ detail::doNotOptimizeAway(x);}
\DoxyCodeLine{02544\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ measure1\ =\ mCounters;}
\DoxyCodeLine{02545\ }
\DoxyCodeLine{02546\ \ \ \ \ \ \ \ \ \ \ \ \ n\ =\ numIters;}
\DoxyCodeLine{02547\ \ \ \ \ \ \ \ \ \ \ \ \ beginMeasure();}
\DoxyCodeLine{02548\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{while}\ (n-\/-\/\ >\ 0)\ \{}
\DoxyCodeLine{02549\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ we\ now\ run\ *twice*\ so\ we\ can\ easily\ calculate\ the\ overhead}}
\DoxyCodeLine{02550\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ x\ =\ mix(x);}
\DoxyCodeLine{02551\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ x\ =\ mix(x);}
\DoxyCodeLine{02552\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02553\ \ \ \ \ \ \ \ \ \ \ \ \ endMeasure();}
\DoxyCodeLine{02554\ \ \ \ \ \ \ \ \ \ \ \ \ detail::doNotOptimizeAway(x);}
\DoxyCodeLine{02555\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ measure2\ =\ mCounters;}
\DoxyCodeLine{02556\ }
\DoxyCodeLine{02557\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ mCounters.size();\ ++i)\ \{}
\DoxyCodeLine{02558\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ factor\ 2\ because\ we\ have\ two\ instructions\ per\ loop}}
\DoxyCodeLine{02559\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ m1\ =\ measure1[i]\ >\ mCalibratedOverhead[i]\ ?\ measure1[i]\ -\/\ mCalibratedOverhead[i]\ :\ 0;}
\DoxyCodeLine{02560\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ m2\ =\ measure2[i]\ >\ mCalibratedOverhead[i]\ ?\ measure2[i]\ -\/\ mCalibratedOverhead[i]\ :\ 0;}
\DoxyCodeLine{02561\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ overhead\ =\ m1\ *\ 2\ >\ m2\ ?\ m1\ *\ 2\ -\/\ m2\ :\ 0;}
\DoxyCodeLine{02562\ }
\DoxyCodeLine{02563\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mLoopOverhead[i]\ =\ divRounded(overhead,\ numIters);}
\DoxyCodeLine{02564\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02565\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02566\ \ \ \ \ \}}
\DoxyCodeLine{02567\ }
\DoxyCodeLine{02568\ \textcolor{keyword}{private}:}
\DoxyCodeLine{02569\ \ \ \ \ \textcolor{keywordtype}{bool}\ monitor(uint32\_t\ type,\ uint64\_t\ eventid,\ Target\ target);}
\DoxyCodeLine{02570\ }
\DoxyCodeLine{02571\ \ \ \ \ std::map<uint64\_t,\ Target>\ mIdToTarget\{\};}
\DoxyCodeLine{02572\ }
\DoxyCodeLine{02573\ \ \ \ \ \textcolor{comment}{//\ start\ with\ minimum\ size\ of\ 3\ for\ read\_format}}
\DoxyCodeLine{02574\ \ \ \ \ std::vector<uint64\_t>\ mCounters\{3\};}
\DoxyCodeLine{02575\ \ \ \ \ std::vector<uint64\_t>\ mCalibratedOverhead\{3\};}
\DoxyCodeLine{02576\ \ \ \ \ std::vector<uint64\_t>\ mLoopOverhead\{3\};}
\DoxyCodeLine{02577\ }
\DoxyCodeLine{02578\ \ \ \ \ uint64\_t\ mTimeEnabledNanos\ =\ 0;}
\DoxyCodeLine{02579\ \ \ \ \ uint64\_t\ mTimeRunningNanos\ =\ 0;}
\DoxyCodeLine{02580\ \ \ \ \ \textcolor{keywordtype}{int}\ mFd\ =\ -\/1;}
\DoxyCodeLine{02581\ \ \ \ \ \textcolor{keywordtype}{bool}\ mHasError\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{02582\ \};}
\DoxyCodeLine{02583\ ANKERL\_NANOBENCH(IGNORE\_PADDED\_POP)}
\DoxyCodeLine{02584\ }
\DoxyCodeLine{02585\ LinuxPerformanceCounters::\string~LinuxPerformanceCounters()\ \{}
\DoxyCodeLine{02586\ \ \ \ \ \textcolor{keywordflow}{if}\ (-\/1\ !=\ mFd)\ \{}
\DoxyCodeLine{02587\ \ \ \ \ \ \ \ \ close(mFd);}
\DoxyCodeLine{02588\ \ \ \ \ \}}
\DoxyCodeLine{02589\ \}}
\DoxyCodeLine{02590\ }
\DoxyCodeLine{02591\ \textcolor{keywordtype}{bool}\ LinuxPerformanceCounters::monitor(perf\_sw\_ids\ swId,\ LinuxPerformanceCounters::Target\ target)\ \{}
\DoxyCodeLine{02592\ \ \ \ \ \textcolor{keywordflow}{return}\ monitor(PERF\_TYPE\_SOFTWARE,\ swId,\ target);}
\DoxyCodeLine{02593\ \}}
\DoxyCodeLine{02594\ }
\DoxyCodeLine{02595\ \textcolor{keywordtype}{bool}\ LinuxPerformanceCounters::monitor(perf\_hw\_id\ hwId,\ LinuxPerformanceCounters::Target\ target)\ \{}
\DoxyCodeLine{02596\ \ \ \ \ \textcolor{keywordflow}{return}\ monitor(PERF\_TYPE\_HARDWARE,\ hwId,\ target);}
\DoxyCodeLine{02597\ \}}
\DoxyCodeLine{02598\ }
\DoxyCodeLine{02599\ \textcolor{comment}{//\ overflow\ is\ ok,\ it's\ checked}}
\DoxyCodeLine{02600\ ANKERL\_NANOBENCH\_NO\_SANITIZE(\textcolor{stringliteral}{"{}integer"{}},\ \textcolor{stringliteral}{"{}undefined"{}})}
\DoxyCodeLine{02601\ void\ LinuxPerformanceCounters::updateResults(uint64\_t\ numIters)\ \{}
\DoxyCodeLine{02602\ \ \ \ \ \textcolor{comment}{//\ clear\ old\ data}}
\DoxyCodeLine{02603\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\&\ id\_value\ :\ mIdToTarget)\ \{}
\DoxyCodeLine{02604\ \ \ \ \ \ \ \ \ *id\_value.second.targetValue\ =\ UINT64\_C(0);}
\DoxyCodeLine{02605\ \ \ \ \ \}}
\DoxyCodeLine{02606\ }
\DoxyCodeLine{02607\ \ \ \ \ \textcolor{keywordflow}{if}\ (mHasError)\ \{}
\DoxyCodeLine{02608\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{02609\ \ \ \ \ \}}
\DoxyCodeLine{02610\ }
\DoxyCodeLine{02611\ \ \ \ \ mTimeEnabledNanos\ =\ mCounters[1]\ -\/\ mCalibratedOverhead[1];}
\DoxyCodeLine{02612\ \ \ \ \ mTimeRunningNanos\ =\ mCounters[2]\ -\/\ mCalibratedOverhead[2];}
\DoxyCodeLine{02613\ }
\DoxyCodeLine{02614\ \ \ \ \ \textcolor{keywordflow}{for}\ (uint64\_t\ i\ =\ 0;\ i\ <\ mCounters[0];\ ++i)\ \{}
\DoxyCodeLine{02615\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ idx\ =\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{size\_t}\textcolor{keyword}{>}(3\ +\ i\ *\ 2\ +\ 0);}
\DoxyCodeLine{02616\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ \textcolor{keywordtype}{id}\ =\ mCounters[idx\ +\ 1U];}
\DoxyCodeLine{02617\ }
\DoxyCodeLine{02618\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ it\ =\ mIdToTarget.find(\textcolor{keywordtype}{id});}
\DoxyCodeLine{02619\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (it\ !=\ mIdToTarget.end())\ \{}
\DoxyCodeLine{02620\ }
\DoxyCodeLine{02621\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\&\ tgt\ =\ it-\/>second;}
\DoxyCodeLine{02622\ \ \ \ \ \ \ \ \ \ \ \ \ *tgt.targetValue\ =\ mCounters[idx];}
\DoxyCodeLine{02623\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (tgt.correctMeasuringOverhead)\ \{}
\DoxyCodeLine{02624\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (*tgt.targetValue\ >=\ mCalibratedOverhead[idx])\ \{}
\DoxyCodeLine{02625\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *tgt.targetValue\ -\/=\ mCalibratedOverhead[idx];}
\DoxyCodeLine{02626\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{02627\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *tgt.targetValue\ =\ 0U;}
\DoxyCodeLine{02628\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02629\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02630\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (tgt.correctLoopOverhead)\ \{}
\DoxyCodeLine{02631\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ correctionVal\ =\ mLoopOverhead[idx]\ *\ numIters;}
\DoxyCodeLine{02632\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (*tgt.targetValue\ >=\ correctionVal)\ \{}
\DoxyCodeLine{02633\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *tgt.targetValue\ -\/=\ correctionVal;}
\DoxyCodeLine{02634\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{02635\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *tgt.targetValue\ =\ 0U;}
\DoxyCodeLine{02636\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02637\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02638\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02639\ \ \ \ \ \}}
\DoxyCodeLine{02640\ \}}
\DoxyCodeLine{02641\ }
\DoxyCodeLine{02642\ \textcolor{keywordtype}{bool}\ LinuxPerformanceCounters::monitor(uint32\_t\ type,\ uint64\_t\ eventid,\ Target\ target)\ \{}
\DoxyCodeLine{02643\ \ \ \ \ *target.targetValue\ =\ (std::numeric\_limits<uint64\_t>::max)();}
\DoxyCodeLine{02644\ \ \ \ \ \textcolor{keywordflow}{if}\ (mHasError)\ \{}
\DoxyCodeLine{02645\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{02646\ \ \ \ \ \}}
\DoxyCodeLine{02647\ }
\DoxyCodeLine{02648\ \ \ \ \ \textcolor{keyword}{auto}\ pea\ =\ perf\_event\_attr();}
\DoxyCodeLine{02649\ \ \ \ \ std::memset(\&pea,\ 0,\ \textcolor{keyword}{sizeof}(perf\_event\_attr));}
\DoxyCodeLine{02650\ \ \ \ \ pea.type\ =\ type;}
\DoxyCodeLine{02651\ \ \ \ \ pea.size\ =\ \textcolor{keyword}{sizeof}(perf\_event\_attr);}
\DoxyCodeLine{02652\ \ \ \ \ pea.config\ =\ eventid;}
\DoxyCodeLine{02653\ \ \ \ \ pea.disabled\ =\ 1;\ \textcolor{comment}{//\ start\ counter\ as\ disabled}}
\DoxyCodeLine{02654\ \ \ \ \ pea.exclude\_kernel\ =\ 1;}
\DoxyCodeLine{02655\ \ \ \ \ pea.exclude\_hv\ =\ 1;}
\DoxyCodeLine{02656\ }
\DoxyCodeLine{02657\ \ \ \ \ \textcolor{comment}{//\ NOLINTNEXTLINE(hicpp-\/signed-\/bitwise)}}
\DoxyCodeLine{02658\ \ \ \ \ pea.read\_format\ =\ PERF\_FORMAT\_GROUP\ |\ PERF\_FORMAT\_ID\ |\ PERF\_FORMAT\_TOTAL\_TIME\_ENABLED\ |\ PERF\_FORMAT\_TOTAL\_TIME\_RUNNING;}
\DoxyCodeLine{02659\ }
\DoxyCodeLine{02660\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ pid\ =\ 0;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ the\ current\ process}}
\DoxyCodeLine{02661\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ cpu\ =\ -\/1;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ all\ CPUs}}
\DoxyCodeLine{02662\ \textcolor{preprocessor}{\#\ \ \ \ \ \ \ \ if\ defined(PERF\_FLAG\_FD\_CLOEXEC)\ }\textcolor{comment}{//\ since\ Linux\ 3.14}}
\DoxyCodeLine{02663\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{long}\ flags\ =\ PERF\_FLAG\_FD\_CLOEXEC;}
\DoxyCodeLine{02664\ \textcolor{preprocessor}{\#\ \ \ \ \ \ \ \ else}}
\DoxyCodeLine{02665\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{long}\ flags\ =\ 0;}
\DoxyCodeLine{02666\ \textcolor{preprocessor}{\#\ \ \ \ \ \ \ \ endif}}
\DoxyCodeLine{02667\ }
\DoxyCodeLine{02668\ \ \ \ \ \textcolor{comment}{//\ NOLINTNEXTLINE(cppcoreguidelines-\/pro-\/type-\/vararg)}}
\DoxyCodeLine{02669\ \ \ \ \ \textcolor{keyword}{auto}\ fd\ =\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(syscall(\_\_NR\_perf\_event\_open,\ \&pea,\ pid,\ cpu,\ mFd,\ flags));}
\DoxyCodeLine{02670\ \ \ \ \ \textcolor{keywordflow}{if}\ (-\/1\ ==\ fd)\ \{}
\DoxyCodeLine{02671\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{02672\ \ \ \ \ \}}
\DoxyCodeLine{02673\ \ \ \ \ \textcolor{keywordflow}{if}\ (-\/1\ ==\ mFd)\ \{}
\DoxyCodeLine{02674\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ first\ call:\ set\ to\ fd,\ and\ use\ this\ from\ now\ on}}
\DoxyCodeLine{02675\ \ \ \ \ \ \ \ \ mFd\ =\ fd;}
\DoxyCodeLine{02676\ \ \ \ \ \}}
\DoxyCodeLine{02677\ \ \ \ \ uint64\_t\ \textcolor{keywordtype}{id}\ =\ 0;}
\DoxyCodeLine{02678\ \ \ \ \ \textcolor{comment}{//\ NOLINTNEXTLINE(hicpp-\/signed-\/bitwise,cppcoreguidelines-\/pro-\/type-\/vararg)}}
\DoxyCodeLine{02679\ \ \ \ \ \textcolor{keywordflow}{if}\ (-\/1\ ==\ ioctl(fd,\ PERF\_EVENT\_IOC\_ID,\ \&\textcolor{keywordtype}{id}))\ \{}
\DoxyCodeLine{02680\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ couldn't\ get\ id}}
\DoxyCodeLine{02681\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{02682\ \ \ \ \ \}}
\DoxyCodeLine{02683\ }
\DoxyCodeLine{02684\ \ \ \ \ \textcolor{comment}{//\ insert\ into\ map,\ rely\ on\ the\ fact\ that\ map's\ references\ are\ constant.}}
\DoxyCodeLine{02685\ \ \ \ \ mIdToTarget.emplace(\textcolor{keywordtype}{id},\ target);}
\DoxyCodeLine{02686\ }
\DoxyCodeLine{02687\ \ \ \ \ \textcolor{comment}{//\ prepare\ readformat\ with\ the\ correct\ size\ (after\ the\ insert)}}
\DoxyCodeLine{02688\ \ \ \ \ \textcolor{keyword}{auto}\ size\ =\ 3\ +\ 2\ *\ mIdToTarget.size();}
\DoxyCodeLine{02689\ \ \ \ \ mCounters.resize(size);}
\DoxyCodeLine{02690\ \ \ \ \ mCalibratedOverhead.resize(size);}
\DoxyCodeLine{02691\ \ \ \ \ mLoopOverhead.resize(size);}
\DoxyCodeLine{02692\ }
\DoxyCodeLine{02693\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{02694\ \}}
\DoxyCodeLine{02695\ }
\DoxyCodeLine{02696\ PerformanceCounters::PerformanceCounters()}
\DoxyCodeLine{02697\ \ \ \ \ :\ mPc(new\ LinuxPerformanceCounters())}
\DoxyCodeLine{02698\ \ \ \ \ ,\ mVal()}
\DoxyCodeLine{02699\ \ \ \ \ ,\ mHas()\ \{}
\DoxyCodeLine{02700\ }
\DoxyCodeLine{02701\ \ \ \ \ \textcolor{comment}{//\ HW\ events}}
\DoxyCodeLine{02702\ \ \ \ \ mHas.cpuCycles\ =\ mPc-\/>monitor(PERF\_COUNT\_HW\_REF\_CPU\_CYCLES,\ LinuxPerformanceCounters::Target(\&mVal.cpuCycles,\ \textcolor{keyword}{true},\ \textcolor{keyword}{false}));}
\DoxyCodeLine{02703\ \ \ \ \ if\ (!mHas.cpuCycles)\ \{}
\DoxyCodeLine{02704\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Fallback\ to\ cycles\ counter,\ reference\ cycles\ not\ available\ in\ many\ systems.}}
\DoxyCodeLine{02705\ \ \ \ \ \ \ \ \ mHas.cpuCycles\ =\ mPc-\/>monitor(PERF\_COUNT\_HW\_CPU\_CYCLES,\ LinuxPerformanceCounters::Target(\&mVal.cpuCycles,\ true,\ false));}
\DoxyCodeLine{02706\ \ \ \ \ \}}
\DoxyCodeLine{02707\ \ \ \ \ mHas.instructions\ =\ mPc-\/>monitor(PERF\_COUNT\_HW\_INSTRUCTIONS,\ LinuxPerformanceCounters::Target(\&mVal.instructions,\ \textcolor{keyword}{true},\ \textcolor{keyword}{true}));}
\DoxyCodeLine{02708\ \ \ \ \ mHas.branchInstructions\ =}
\DoxyCodeLine{02709\ \ \ \ \ \ \ \ \ mPc-\/>monitor(PERF\_COUNT\_HW\_BRANCH\_INSTRUCTIONS,\ LinuxPerformanceCounters::Target(\&mVal.branchInstructions,\ \textcolor{keyword}{true},\ \textcolor{keyword}{false}));}
\DoxyCodeLine{02710\ \ \ \ \ mHas.branchMisses\ =\ mPc-\/>monitor(PERF\_COUNT\_HW\_BRANCH\_MISSES,\ LinuxPerformanceCounters::Target(\&mVal.branchMisses,\ \textcolor{keyword}{true},\ \textcolor{keyword}{false}));}
\DoxyCodeLine{02711\ \ \ \ \ \textcolor{comment}{//\ mHas.branchMisses\ =\ false;}}
\DoxyCodeLine{02712\ }
\DoxyCodeLine{02713\ \ \ \ \ \textcolor{comment}{//\ SW\ events}}
\DoxyCodeLine{02714\ \ \ \ \ mHas.pageFaults\ =\ mPc-\/>monitor(PERF\_COUNT\_SW\_PAGE\_FAULTS,\ LinuxPerformanceCounters::Target(\&mVal.pageFaults,\ \textcolor{keyword}{true},\ \textcolor{keyword}{false}));}
\DoxyCodeLine{02715\ \ \ \ \ mHas.contextSwitches\ =}
\DoxyCodeLine{02716\ \ \ \ \ \ \ \ \ mPc-\/>monitor(PERF\_COUNT\_SW\_CONTEXT\_SWITCHES,\ LinuxPerformanceCounters::Target(\&mVal.contextSwitches,\ \textcolor{keyword}{true},\ \textcolor{keyword}{false}));}
\DoxyCodeLine{02717\ }
\DoxyCodeLine{02718\ \ \ \ \ mPc-\/>start();}
\DoxyCodeLine{02719\ \ \ \ \ mPc-\/>calibrate([]\ \{}
\DoxyCodeLine{02720\ \ \ \ \ \ \ \ \ auto\ before\ =\ ankerl::nanobench::Clock::now();}
\DoxyCodeLine{02721\ \ \ \ \ \ \ \ \ auto\ after\ =\ ankerl::nanobench::Clock::now();}
\DoxyCodeLine{02722\ \ \ \ \ \ \ \ \ (void)before;}
\DoxyCodeLine{02723\ \ \ \ \ \ \ \ \ (void)after;}
\DoxyCodeLine{02724\ \ \ \ \ \});}
\DoxyCodeLine{02725\ }
\DoxyCodeLine{02726\ \ \ \ \ if\ (mPc-\/>hasError())\ \{}
\DoxyCodeLine{02727\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ something\ failed,\ don't\ monitor\ anything.}}
\DoxyCodeLine{02728\ \ \ \ \ \ \ \ \ mHas\ =\ PerfCountSet<bool>\{\};}
\DoxyCodeLine{02729\ \ \ \ \ \}}
\DoxyCodeLine{02730\ \}}
\DoxyCodeLine{02731\ }
\DoxyCodeLine{02732\ PerformanceCounters::\string~PerformanceCounters()\ \{}
\DoxyCodeLine{02733\ \ \ \ \ \textcolor{comment}{//\ no\ need\ to\ check\ for\ nullptr,\ delete\ nullptr\ has\ no\ effect}}
\DoxyCodeLine{02734\ \ \ \ \ \textcolor{keyword}{delete}\ mPc;}
\DoxyCodeLine{02735\ \}}
\DoxyCodeLine{02736\ }
\DoxyCodeLine{02737\ \textcolor{keywordtype}{void}\ PerformanceCounters::beginMeasure()\ \{}
\DoxyCodeLine{02738\ \ \ \ \ mPc-\/>beginMeasure();}
\DoxyCodeLine{02739\ \}}
\DoxyCodeLine{02740\ }
\DoxyCodeLine{02741\ \textcolor{keywordtype}{void}\ PerformanceCounters::endMeasure()\ \{}
\DoxyCodeLine{02742\ \ \ \ \ mPc-\/>endMeasure();}
\DoxyCodeLine{02743\ \}}
\DoxyCodeLine{02744\ }
\DoxyCodeLine{02745\ \textcolor{keywordtype}{void}\ PerformanceCounters::updateResults(uint64\_t\ numIters)\ \{}
\DoxyCodeLine{02746\ \ \ \ \ mPc-\/>updateResults(numIters);}
\DoxyCodeLine{02747\ \}}
\DoxyCodeLine{02748\ }
\DoxyCodeLine{02749\ \textcolor{preprocessor}{\#\ \ \ \ else}}
\DoxyCodeLine{02750\ }
\DoxyCodeLine{02751\ PerformanceCounters::PerformanceCounters()\ =\ \textcolor{keywordflow}{default};}
\DoxyCodeLine{02752\ PerformanceCounters::\string~PerformanceCounters()\ =\ \textcolor{keywordflow}{default};}
\DoxyCodeLine{02753\ \textcolor{keywordtype}{void}\ PerformanceCounters::beginMeasure()\ \{\}}
\DoxyCodeLine{02754\ \textcolor{keywordtype}{void}\ PerformanceCounters::endMeasure()\ \{\}}
\DoxyCodeLine{02755\ \textcolor{keywordtype}{void}\ PerformanceCounters::updateResults(uint64\_t)\ \{\}}
\DoxyCodeLine{02756\ }
\DoxyCodeLine{02757\ \textcolor{preprocessor}{\#\ \ \ \ endif}}
\DoxyCodeLine{02758\ }
\DoxyCodeLine{02759\ ANKERL\_NANOBENCH(NODISCARD)\ PerfCountSet<uint64\_t>\ \textcolor{keyword}{const}\&\ PerformanceCounters::val()\ const\ noexcept\ \{}
\DoxyCodeLine{02760\ \ \ \ \ \textcolor{keywordflow}{return}\ mVal;}
\DoxyCodeLine{02761\ \}}
\DoxyCodeLine{02762\ ANKERL\_NANOBENCH(NODISCARD)\ PerfCountSet<bool>\ \textcolor{keyword}{const}\&\ PerformanceCounters::has()\ const\ noexcept\ \{}
\DoxyCodeLine{02763\ \ \ \ \ \textcolor{keywordflow}{return}\ mHas;}
\DoxyCodeLine{02764\ \}}
\DoxyCodeLine{02765\ }
\DoxyCodeLine{02766\ \textcolor{comment}{//\ formatting\ utilities}}
\DoxyCodeLine{02767\ \textcolor{keyword}{namespace\ }fmt\ \{}
\DoxyCodeLine{02768\ }
\DoxyCodeLine{02769\ \textcolor{comment}{//\ adds\ thousands\ separator\ to\ numbers}}
\DoxyCodeLine{02770\ NumSep::NumSep(\textcolor{keywordtype}{char}\ sep)}
\DoxyCodeLine{02771\ \ \ \ \ :\ mSep(sep)\ \{\}}
\DoxyCodeLine{02772\ }
\DoxyCodeLine{02773\ \textcolor{keywordtype}{char}\ NumSep::do\_thousands\_sep()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{02774\ \ \ \ \ \textcolor{keywordflow}{return}\ mSep;}
\DoxyCodeLine{02775\ \}}
\DoxyCodeLine{02776\ }
\DoxyCodeLine{02777\ std::string\ NumSep::do\_grouping()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{02778\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}\(\backslash\)003"{}};}
\DoxyCodeLine{02779\ \}}
\DoxyCodeLine{02780\ }
\DoxyCodeLine{02781\ \textcolor{comment}{//\ RAII\ to\ save\ \&\ restore\ a\ stream's\ state}}
\DoxyCodeLine{02782\ StreamStateRestorer::StreamStateRestorer(std::ostream\&\ s)}
\DoxyCodeLine{02783\ \ \ \ \ :\ mStream(s)}
\DoxyCodeLine{02784\ \ \ \ \ ,\ mLocale(s.getloc())}
\DoxyCodeLine{02785\ \ \ \ \ ,\ mPrecision(s.precision())}
\DoxyCodeLine{02786\ \ \ \ \ ,\ mWidth(s.width())}
\DoxyCodeLine{02787\ \ \ \ \ ,\ mFill(s.fill())}
\DoxyCodeLine{02788\ \ \ \ \ ,\ mFmtFlags(s.flags())\ \{\}}
\DoxyCodeLine{02789\ }
\DoxyCodeLine{02790\ StreamStateRestorer::\string~StreamStateRestorer()\ \{}
\DoxyCodeLine{02791\ \ \ \ \ restore();}
\DoxyCodeLine{02792\ \}}
\DoxyCodeLine{02793\ }
\DoxyCodeLine{02794\ \textcolor{comment}{//\ sets\ back\ all\ stream\ info\ that\ we\ remembered\ at\ construction}}
\DoxyCodeLine{02795\ \textcolor{keywordtype}{void}\ StreamStateRestorer::restore()\ \{}
\DoxyCodeLine{02796\ \ \ \ \ mStream.imbue(mLocale);}
\DoxyCodeLine{02797\ \ \ \ \ mStream.precision(mPrecision);}
\DoxyCodeLine{02798\ \ \ \ \ mStream.width(mWidth);}
\DoxyCodeLine{02799\ \ \ \ \ mStream.fill(mFill);}
\DoxyCodeLine{02800\ \ \ \ \ mStream.flags(mFmtFlags);}
\DoxyCodeLine{02801\ \}}
\DoxyCodeLine{02802\ }
\DoxyCodeLine{02803\ Number::Number(\textcolor{keywordtype}{int}\ width,\ \textcolor{keywordtype}{int}\ precision,\ int64\_t\ value)}
\DoxyCodeLine{02804\ \ \ \ \ :\ mWidth(width)}
\DoxyCodeLine{02805\ \ \ \ \ ,\ mPrecision(precision)}
\DoxyCodeLine{02806\ \ \ \ \ ,\ mValue(d(value))\ \{\}}
\DoxyCodeLine{02807\ }
\DoxyCodeLine{02808\ Number::Number(\textcolor{keywordtype}{int}\ width,\ \textcolor{keywordtype}{int}\ precision,\ \textcolor{keywordtype}{double}\ value)}
\DoxyCodeLine{02809\ \ \ \ \ :\ mWidth(width)}
\DoxyCodeLine{02810\ \ \ \ \ ,\ mPrecision(precision)}
\DoxyCodeLine{02811\ \ \ \ \ ,\ mValue(value)\ \{\}}
\DoxyCodeLine{02812\ }
\DoxyCodeLine{02813\ std::ostream\&\ Number::write(std::ostream\&\ os)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{02814\ \ \ \ \ StreamStateRestorer\ \textcolor{keyword}{const}\ restorer(os);}
\DoxyCodeLine{02815\ \ \ \ \ os.imbue(std::locale(os.getloc(),\ \textcolor{keyword}{new}\ NumSep(\textcolor{charliteral}{','})));}
\DoxyCodeLine{02816\ \ \ \ \ os\ <<\ std::setw(mWidth)\ <<\ std::setprecision(mPrecision)\ <<\ std::fixed\ <<\ mValue;}
\DoxyCodeLine{02817\ \ \ \ \ \textcolor{keywordflow}{return}\ os;}
\DoxyCodeLine{02818\ \}}
\DoxyCodeLine{02819\ }
\DoxyCodeLine{02820\ std::string\ Number::to\_s()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{02821\ \ \ \ \ std::stringstream\ ss;}
\DoxyCodeLine{02822\ \ \ \ \ write(ss);}
\DoxyCodeLine{02823\ \ \ \ \ \textcolor{keywordflow}{return}\ ss.str();}
\DoxyCodeLine{02824\ \}}
\DoxyCodeLine{02825\ }
\DoxyCodeLine{02826\ std::string\ to\_s(uint64\_t\ n)\ \{}
\DoxyCodeLine{02827\ \ \ \ \ std::string\ str;}
\DoxyCodeLine{02828\ \ \ \ \ \textcolor{keywordflow}{do}\ \{}
\DoxyCodeLine{02829\ \ \ \ \ \ \ \ \ str\ +=\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{char}\textcolor{keyword}{>}(\textcolor{charliteral}{'0'}\ +\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{char}\textcolor{keyword}{>}(n\ \%\ 10));}
\DoxyCodeLine{02830\ \ \ \ \ \ \ \ \ n\ /=\ 10;}
\DoxyCodeLine{02831\ \ \ \ \ \}\ \textcolor{keywordflow}{while}\ (n\ !=\ 0);}
\DoxyCodeLine{02832\ \ \ \ \ std::reverse(str.begin(),\ str.end());}
\DoxyCodeLine{02833\ \ \ \ \ \textcolor{keywordflow}{return}\ str;}
\DoxyCodeLine{02834\ \}}
\DoxyCodeLine{02835\ }
\DoxyCodeLine{02836\ std::ostream\&\ operator<<(std::ostream\&\ os,\ Number\ \textcolor{keyword}{const}\&\ n)\ \{}
\DoxyCodeLine{02837\ \ \ \ \ \textcolor{keywordflow}{return}\ n.write(os);}
\DoxyCodeLine{02838\ \}}
\DoxyCodeLine{02839\ }
\DoxyCodeLine{02840\ MarkDownColumn::MarkDownColumn(\textcolor{keywordtype}{int}\ w,\ \textcolor{keywordtype}{int}\ prec,\ std::string\ tit,\ std::string\ suff,\ \textcolor{keywordtype}{double}\ val)\ noexcept}
\DoxyCodeLine{02841\ \ \ \ \ :\ mWidth(w)}
\DoxyCodeLine{02842\ \ \ \ \ ,\ mPrecision(prec)}
\DoxyCodeLine{02843\ \ \ \ \ ,\ mTitle(std::move(tit))}
\DoxyCodeLine{02844\ \ \ \ \ ,\ mSuffix(std::move(suff))}
\DoxyCodeLine{02845\ \ \ \ \ ,\ mValue(val)\ \{\}}
\DoxyCodeLine{02846\ }
\DoxyCodeLine{02847\ std::string\ MarkDownColumn::title()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{02848\ \ \ \ \ std::stringstream\ ss;}
\DoxyCodeLine{02849\ \ \ \ \ ss\ <<\ \textcolor{charliteral}{'|'}\ <<\ std::setw(mWidth\ -\/\ 2)\ <<\ std::right\ <<\ mTitle\ <<\ \textcolor{charliteral}{'\ '};}
\DoxyCodeLine{02850\ \ \ \ \ \textcolor{keywordflow}{return}\ ss.str();}
\DoxyCodeLine{02851\ \}}
\DoxyCodeLine{02852\ }
\DoxyCodeLine{02853\ std::string\ MarkDownColumn::separator()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{02854\ \ \ \ \ std::string\ sep(\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{size\_t}\textcolor{keyword}{>}(mWidth),\ \textcolor{charliteral}{'-\/'});}
\DoxyCodeLine{02855\ \ \ \ \ sep.front()\ =\ \textcolor{charliteral}{'|'};}
\DoxyCodeLine{02856\ \ \ \ \ sep.back()\ =\ \textcolor{charliteral}{':'};}
\DoxyCodeLine{02857\ \ \ \ \ \textcolor{keywordflow}{return}\ sep;}
\DoxyCodeLine{02858\ \}}
\DoxyCodeLine{02859\ }
\DoxyCodeLine{02860\ std::string\ MarkDownColumn::invalid()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{02861\ \ \ \ \ std::string\ sep(\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{size\_t}\textcolor{keyword}{>}(mWidth),\ \textcolor{charliteral}{'\ '});}
\DoxyCodeLine{02862\ \ \ \ \ sep.front()\ =\ \textcolor{charliteral}{'|'};}
\DoxyCodeLine{02863\ \ \ \ \ sep[sep.size()\ -\/\ 2]\ =\ \textcolor{charliteral}{'-\/'};}
\DoxyCodeLine{02864\ \ \ \ \ \textcolor{keywordflow}{return}\ sep;}
\DoxyCodeLine{02865\ \}}
\DoxyCodeLine{02866\ }
\DoxyCodeLine{02867\ std::string\ MarkDownColumn::value()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{02868\ \ \ \ \ std::stringstream\ ss;}
\DoxyCodeLine{02869\ \ \ \ \ \textcolor{keyword}{auto}\ width\ =\ mWidth\ -\/\ 2\ -\/\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(mSuffix.size());}
\DoxyCodeLine{02870\ \ \ \ \ ss\ <<\ \textcolor{charliteral}{'|'}\ <<\ Number(width,\ mPrecision,\ mValue)\ <<\ mSuffix\ <<\ \textcolor{charliteral}{'\ '};}
\DoxyCodeLine{02871\ \ \ \ \ \textcolor{keywordflow}{return}\ ss.str();}
\DoxyCodeLine{02872\ \}}
\DoxyCodeLine{02873\ }
\DoxyCodeLine{02874\ \textcolor{comment}{//\ Formats\ any\ text\ as\ markdown\ code,\ escaping\ backticks.}}
\DoxyCodeLine{02875\ MarkDownCode::MarkDownCode(std::string\ \textcolor{keyword}{const}\&\ what)\ \{}
\DoxyCodeLine{02876\ \ \ \ \ mWhat.reserve(what.size()\ +\ 2);}
\DoxyCodeLine{02877\ \ \ \ \ mWhat.push\_back(\textcolor{charliteral}{'`'});}
\DoxyCodeLine{02878\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{char}\ \textcolor{keyword}{const}\ c\ :\ what)\ \{}
\DoxyCodeLine{02879\ \ \ \ \ \ \ \ \ mWhat.push\_back(c);}
\DoxyCodeLine{02880\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\textcolor{charliteral}{'`'}\ ==\ c)\ \{}
\DoxyCodeLine{02881\ \ \ \ \ \ \ \ \ \ \ \ \ mWhat.push\_back(\textcolor{charliteral}{'`'});}
\DoxyCodeLine{02882\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02883\ \ \ \ \ \}}
\DoxyCodeLine{02884\ \ \ \ \ mWhat.push\_back(\textcolor{charliteral}{'`'});}
\DoxyCodeLine{02885\ \}}
\DoxyCodeLine{02886\ }
\DoxyCodeLine{02887\ std::ostream\&\ MarkDownCode::write(std::ostream\&\ os)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{02888\ \ \ \ \ \textcolor{keywordflow}{return}\ os\ <<\ mWhat;}
\DoxyCodeLine{02889\ \}}
\DoxyCodeLine{02890\ }
\DoxyCodeLine{02891\ std::ostream\&\ operator<<(std::ostream\&\ os,\ MarkDownCode\ \textcolor{keyword}{const}\&\ mdCode)\ \{}
\DoxyCodeLine{02892\ \ \ \ \ \textcolor{keywordflow}{return}\ mdCode.write(os);}
\DoxyCodeLine{02893\ \}}
\DoxyCodeLine{02894\ \}\ \textcolor{comment}{//\ namespace\ fmt}}
\DoxyCodeLine{02895\ \}\ \textcolor{comment}{//\ namespace\ detail}}
\DoxyCodeLine{02896\ }
\DoxyCodeLine{02897\ \textcolor{comment}{//\ provide\ implementation\ here\ so\ it's\ only\ generated\ once}}
\DoxyCodeLine{02898\ Config::Config()\ =\ \textcolor{keywordflow}{default};}
\DoxyCodeLine{02899\ Config::\string~Config()\ =\ \textcolor{keywordflow}{default};}
\DoxyCodeLine{02900\ Config\&\ Config::operator=(Config\ \textcolor{keyword}{const}\&)\ =\ \textcolor{keywordflow}{default};}
\DoxyCodeLine{02901\ Config\&\ Config::operator=(Config\&\&)\ noexcept(ANKERL\_NANOBENCH(NOEXCEPT\_STRING\_MOVE))\ =\ default;}
\DoxyCodeLine{02902\ Config::Config(Config\ const\&)\ =\ default;}
\DoxyCodeLine{02903\ Config::Config(Config\&\&)\ noexcept\ =\ default;}
\DoxyCodeLine{02904\ }
\DoxyCodeLine{02905\ \textcolor{comment}{//\ provide\ implementation\ here\ so\ it's\ only\ generated\ once}}
\DoxyCodeLine{02906\ Result::\string~Result()\ =\ default;}
\DoxyCodeLine{02907\ Result\&\ Result::operator=(Result\ const\&)\ =\ default;}
\DoxyCodeLine{02908\ Result\&\ Result::operator=(Result\&\&)\ noexcept(ANKERL\_NANOBENCH(NOEXCEPT\_STRING\_MOVE))\ =\ default;}
\DoxyCodeLine{02909\ Result::Result(Result\ const\&)\ =\ default;}
\DoxyCodeLine{02910\ Result::Result(Result\&\&)\ noexcept\ =\ default;}
\DoxyCodeLine{02911\ }
\DoxyCodeLine{02912\ namespace\ detail\ \{}
\DoxyCodeLine{02913\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{02914\ \textcolor{keyword}{inline}\ \textcolor{keyword}{constexpr}\ \textcolor{keyword}{typename}\ std::underlying\_type<T>::type\ u(T\ val)\ \textcolor{keyword}{noexcept}\ \{}
\DoxyCodeLine{02915\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{static\_cast<}typename\ std::underlying\_type<T>::type\textcolor{keyword}{>}(val);}
\DoxyCodeLine{02916\ \}}
\DoxyCodeLine{02917\ \}\ \textcolor{comment}{//\ namespace\ detail}}
\DoxyCodeLine{02918\ }
\DoxyCodeLine{02919\ \textcolor{comment}{//\ Result\ returned\ after\ a\ benchmark\ has\ finished.\ Can\ be\ used\ as\ a\ baseline\ for\ relative().}}
\DoxyCodeLine{02920\ Result::Result(Config\ benchmarkConfig)}
\DoxyCodeLine{02921\ \ \ \ \ :\ mConfig(std::move(benchmarkConfig))}
\DoxyCodeLine{02922\ \ \ \ \ ,\ mNameToMeasurements\{detail::u(Result::Measure::\_size)\}\ \{\}}
\DoxyCodeLine{02923\ }
\DoxyCodeLine{02924\ \textcolor{keywordtype}{void}\ Result::add(Clock::duration\ totalElapsed,\ uint64\_t\ iters,\ detail::PerformanceCounters\ \textcolor{keyword}{const}\&\ pc)\ \{}
\DoxyCodeLine{02925\ \ \ \ \ \textcolor{keyword}{using\ }detail::d;}
\DoxyCodeLine{02926\ \ \ \ \ \textcolor{keyword}{using\ }detail::u;}
\DoxyCodeLine{02927\ }
\DoxyCodeLine{02928\ \ \ \ \ \textcolor{keywordtype}{double}\ \textcolor{keyword}{const}\ dIters\ =\ d(iters);}
\DoxyCodeLine{02929\ \ \ \ \ mNameToMeasurements[u(Result::Measure::iterations)].push\_back(dIters);}
\DoxyCodeLine{02930\ }
\DoxyCodeLine{02931\ \ \ \ \ mNameToMeasurements[u(Result::Measure::elapsed)].push\_back(d(totalElapsed)\ /\ dIters);}
\DoxyCodeLine{02932\ \ \ \ \ \textcolor{keywordflow}{if}\ (pc.has().pageFaults)\ \{}
\DoxyCodeLine{02933\ \ \ \ \ \ \ \ \ mNameToMeasurements[u(Result::Measure::pagefaults)].push\_back(d(pc.val().pageFaults)\ /\ dIters);}
\DoxyCodeLine{02934\ \ \ \ \ \}}
\DoxyCodeLine{02935\ \ \ \ \ \textcolor{keywordflow}{if}\ (pc.has().cpuCycles)\ \{}
\DoxyCodeLine{02936\ \ \ \ \ \ \ \ \ mNameToMeasurements[u(Result::Measure::cpucycles)].push\_back(d(pc.val().cpuCycles)\ /\ dIters);}
\DoxyCodeLine{02937\ \ \ \ \ \}}
\DoxyCodeLine{02938\ \ \ \ \ \textcolor{keywordflow}{if}\ (pc.has().contextSwitches)\ \{}
\DoxyCodeLine{02939\ \ \ \ \ \ \ \ \ mNameToMeasurements[u(Result::Measure::contextswitches)].push\_back(d(pc.val().contextSwitches)\ /\ dIters);}
\DoxyCodeLine{02940\ \ \ \ \ \}}
\DoxyCodeLine{02941\ \ \ \ \ \textcolor{keywordflow}{if}\ (pc.has().instructions)\ \{}
\DoxyCodeLine{02942\ \ \ \ \ \ \ \ \ mNameToMeasurements[u(Result::Measure::instructions)].push\_back(d(pc.val().instructions)\ /\ dIters);}
\DoxyCodeLine{02943\ \ \ \ \ \}}
\DoxyCodeLine{02944\ \ \ \ \ \textcolor{keywordflow}{if}\ (pc.has().branchInstructions)\ \{}
\DoxyCodeLine{02945\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ branchInstructions\ =\ 0.0;}
\DoxyCodeLine{02946\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ correcting\ branches:\ remove\ branch\ introduced\ by\ the\ while\ (...)\ loop\ for\ each\ iteration.}}
\DoxyCodeLine{02947\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (pc.val().branchInstructions\ >\ iters\ +\ 1U)\ \{}
\DoxyCodeLine{02948\ \ \ \ \ \ \ \ \ \ \ \ \ branchInstructions\ =\ d(pc.val().branchInstructions\ -\/\ (iters\ +\ 1U));}
\DoxyCodeLine{02949\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02950\ \ \ \ \ \ \ \ \ mNameToMeasurements[u(Result::Measure::branchinstructions)].push\_back(branchInstructions\ /\ dIters);}
\DoxyCodeLine{02951\ }
\DoxyCodeLine{02952\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (pc.has().branchMisses)\ \{}
\DoxyCodeLine{02953\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ correcting\ branch\ misses}}
\DoxyCodeLine{02954\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ branchMisses\ =\ d(pc.val().branchMisses);}
\DoxyCodeLine{02955\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (branchMisses\ >\ branchInstructions)\ \{}
\DoxyCodeLine{02956\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ can't\ have\ branch\ misses\ when\ there\ were\ branches...}}
\DoxyCodeLine{02957\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ branchMisses\ =\ branchInstructions;}
\DoxyCodeLine{02958\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02959\ }
\DoxyCodeLine{02960\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ assuming\ at\ least\ one\ missed\ branch\ for\ the\ loop}}
\DoxyCodeLine{02961\ \ \ \ \ \ \ \ \ \ \ \ \ branchMisses\ -\/=\ 1.0;}
\DoxyCodeLine{02962\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (branchMisses\ <\ 1.0)\ \{}
\DoxyCodeLine{02963\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ branchMisses\ =\ 1.0;}
\DoxyCodeLine{02964\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02965\ \ \ \ \ \ \ \ \ \ \ \ \ mNameToMeasurements[u(Result::Measure::branchmisses)].push\_back(branchMisses\ /\ dIters);}
\DoxyCodeLine{02966\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02967\ \ \ \ \ \}}
\DoxyCodeLine{02968\ \}}
\DoxyCodeLine{02969\ }
\DoxyCodeLine{02970\ Config\ \textcolor{keyword}{const}\&\ Result::config()\ const\ noexcept\ \{}
\DoxyCodeLine{02971\ \ \ \ \ \textcolor{keywordflow}{return}\ mConfig;}
\DoxyCodeLine{02972\ \}}
\DoxyCodeLine{02973\ }
\DoxyCodeLine{02974\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{double}\ calcMedian(std::vector<double>\&\ data)\ \{}
\DoxyCodeLine{02975\ \ \ \ \ \textcolor{keywordflow}{if}\ (data.empty())\ \{}
\DoxyCodeLine{02976\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 0.0;}
\DoxyCodeLine{02977\ \ \ \ \ \}}
\DoxyCodeLine{02978\ \ \ \ \ std::sort(data.begin(),\ data.end());}
\DoxyCodeLine{02979\ }
\DoxyCodeLine{02980\ \ \ \ \ \textcolor{keyword}{auto}\ midIdx\ =\ data.size()\ /\ 2U;}
\DoxyCodeLine{02981\ \ \ \ \ \textcolor{keywordflow}{if}\ (1U\ ==\ (data.size()\ \&\ 1U))\ \{}
\DoxyCodeLine{02982\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ data[midIdx];}
\DoxyCodeLine{02983\ \ \ \ \ \}}
\DoxyCodeLine{02984\ \ \ \ \ \textcolor{keywordflow}{return}\ (data[midIdx\ -\/\ 1U]\ +\ data[midIdx])\ /\ 2U;}
\DoxyCodeLine{02985\ \}}
\DoxyCodeLine{02986\ }
\DoxyCodeLine{02987\ \textcolor{keywordtype}{double}\ Result::median(Measure\ m)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{02988\ \ \ \ \ \textcolor{comment}{//\ create\ a\ copy\ so\ we\ can\ sort}}
\DoxyCodeLine{02989\ \ \ \ \ \textcolor{keyword}{auto}\ data\ =\ mNameToMeasurements[detail::u(m)];}
\DoxyCodeLine{02990\ \ \ \ \ \textcolor{keywordflow}{return}\ calcMedian(data);}
\DoxyCodeLine{02991\ \}}
\DoxyCodeLine{02992\ }
\DoxyCodeLine{02993\ \textcolor{keywordtype}{double}\ Result::average(Measure\ m)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{02994\ \ \ \ \ \textcolor{keyword}{using\ }detail::d;}
\DoxyCodeLine{02995\ \ \ \ \ \textcolor{keyword}{auto}\ \textcolor{keyword}{const}\&\ data\ =\ mNameToMeasurements[detail::u(m)];}
\DoxyCodeLine{02996\ \ \ \ \ \textcolor{keywordflow}{if}\ (data.empty())\ \{}
\DoxyCodeLine{02997\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 0.0;}
\DoxyCodeLine{02998\ \ \ \ \ \}}
\DoxyCodeLine{02999\ }
\DoxyCodeLine{03000\ \ \ \ \ \textcolor{comment}{//\ create\ a\ copy\ so\ we\ can\ sort}}
\DoxyCodeLine{03001\ \ \ \ \ \textcolor{keywordflow}{return}\ sum(m)\ /\ d(data.size());}
\DoxyCodeLine{03002\ \}}
\DoxyCodeLine{03003\ }
\DoxyCodeLine{03004\ \textcolor{keywordtype}{double}\ Result::medianAbsolutePercentError(Measure\ m)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{03005\ \ \ \ \ \textcolor{comment}{//\ create\ copy}}
\DoxyCodeLine{03006\ \ \ \ \ \textcolor{keyword}{auto}\ data\ =\ mNameToMeasurements[detail::u(m)];}
\DoxyCodeLine{03007\ }
\DoxyCodeLine{03008\ \ \ \ \ \textcolor{comment}{//\ calculates\ MdAPE\ which\ is\ the\ median\ of\ percentage\ error}}
\DoxyCodeLine{03009\ \ \ \ \ \textcolor{comment}{//\ see\ https://support.numxl.com/hc/en-\/us/articles/115001223503-\/MdAPE-\/Median-\/Absolute-\/Percentage-\/Error}}
\DoxyCodeLine{03010\ \ \ \ \ \textcolor{keyword}{auto}\ med\ =\ calcMedian(data);}
\DoxyCodeLine{03011\ }
\DoxyCodeLine{03012\ \ \ \ \ \textcolor{comment}{//\ transform\ the\ data\ to\ absolute\ error}}
\DoxyCodeLine{03013\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\&\ x\ :\ data)\ \{}
\DoxyCodeLine{03014\ \ \ \ \ \ \ \ \ x\ =\ (x\ -\/\ med)\ /\ x;}
\DoxyCodeLine{03015\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (x\ <\ 0)\ \{}
\DoxyCodeLine{03016\ \ \ \ \ \ \ \ \ \ \ \ \ x\ =\ -\/x;}
\DoxyCodeLine{03017\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03018\ \ \ \ \ \}}
\DoxyCodeLine{03019\ \ \ \ \ \textcolor{keywordflow}{return}\ calcMedian(data);}
\DoxyCodeLine{03020\ \}}
\DoxyCodeLine{03021\ }
\DoxyCodeLine{03022\ \textcolor{keywordtype}{double}\ Result::sum(Measure\ m)\ \textcolor{keyword}{const}\ \textcolor{keyword}{noexcept}\ \{}
\DoxyCodeLine{03023\ \ \ \ \ \textcolor{keyword}{auto}\ \textcolor{keyword}{const}\&\ data\ =\ mNameToMeasurements[detail::u(m)];}
\DoxyCodeLine{03024\ \ \ \ \ \textcolor{keywordflow}{return}\ std::accumulate(data.begin(),\ data.end(),\ 0.0);}
\DoxyCodeLine{03025\ \}}
\DoxyCodeLine{03026\ }
\DoxyCodeLine{03027\ \textcolor{keywordtype}{double}\ Result::sumProduct(Measure\ m1,\ Measure\ m2)\ \textcolor{keyword}{const}\ \textcolor{keyword}{noexcept}\ \{}
\DoxyCodeLine{03028\ \ \ \ \ \textcolor{keyword}{auto}\ \textcolor{keyword}{const}\&\ data1\ =\ mNameToMeasurements[detail::u(m1)];}
\DoxyCodeLine{03029\ \ \ \ \ \textcolor{keyword}{auto}\ \textcolor{keyword}{const}\&\ data2\ =\ mNameToMeasurements[detail::u(m2)];}
\DoxyCodeLine{03030\ }
\DoxyCodeLine{03031\ \ \ \ \ \textcolor{keywordflow}{if}\ (data1.size()\ !=\ data2.size())\ \{}
\DoxyCodeLine{03032\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 0.0;}
\DoxyCodeLine{03033\ \ \ \ \ \}}
\DoxyCodeLine{03034\ }
\DoxyCodeLine{03035\ \ \ \ \ \textcolor{keywordtype}{double}\ result\ =\ 0.0;}
\DoxyCodeLine{03036\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0,\ s\ =\ data1.size();\ i\ !=\ s;\ ++i)\ \{}
\DoxyCodeLine{03037\ \ \ \ \ \ \ \ \ result\ +=\ data1[i]\ *\ data2[i];}
\DoxyCodeLine{03038\ \ \ \ \ \}}
\DoxyCodeLine{03039\ \ \ \ \ \textcolor{keywordflow}{return}\ result;}
\DoxyCodeLine{03040\ \}}
\DoxyCodeLine{03041\ }
\DoxyCodeLine{03042\ \textcolor{keywordtype}{bool}\ Result::has(Measure\ m)\ \textcolor{keyword}{const}\ \textcolor{keyword}{noexcept}\ \{}
\DoxyCodeLine{03043\ \ \ \ \ \textcolor{keywordflow}{return}\ !mNameToMeasurements[detail::u(m)].empty();}
\DoxyCodeLine{03044\ \}}
\DoxyCodeLine{03045\ }
\DoxyCodeLine{03046\ \textcolor{keywordtype}{double}\ Result::get(\textcolor{keywordtype}{size\_t}\ idx,\ Measure\ m)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{03047\ \ \ \ \ \textcolor{keyword}{auto}\ \textcolor{keyword}{const}\&\ data\ =\ mNameToMeasurements[detail::u(m)];}
\DoxyCodeLine{03048\ \ \ \ \ \textcolor{keywordflow}{return}\ data.at(idx);}
\DoxyCodeLine{03049\ \}}
\DoxyCodeLine{03050\ }
\DoxyCodeLine{03051\ \textcolor{keywordtype}{bool}\ Result::empty()\ const\ noexcept\ \{}
\DoxyCodeLine{03052\ \ \ \ \ \textcolor{keywordflow}{return}\ 0U\ ==\ size();}
\DoxyCodeLine{03053\ \}}
\DoxyCodeLine{03054\ }
\DoxyCodeLine{03055\ \textcolor{keywordtype}{size\_t}\ Result::size()\ const\ noexcept\ \{}
\DoxyCodeLine{03056\ \ \ \ \ \textcolor{keyword}{auto}\ \textcolor{keyword}{const}\&\ data\ =\ mNameToMeasurements[detail::u(Measure::elapsed)];}
\DoxyCodeLine{03057\ \ \ \ \ \textcolor{keywordflow}{return}\ data.size();}
\DoxyCodeLine{03058\ \}}
\DoxyCodeLine{03059\ }
\DoxyCodeLine{03060\ \textcolor{keywordtype}{double}\ Result::minimum(Measure\ m)\ \textcolor{keyword}{const}\ \textcolor{keyword}{noexcept}\ \{}
\DoxyCodeLine{03061\ \ \ \ \ \textcolor{keyword}{auto}\ \textcolor{keyword}{const}\&\ data\ =\ mNameToMeasurements[detail::u(m)];}
\DoxyCodeLine{03062\ \ \ \ \ \textcolor{keywordflow}{if}\ (data.empty())\ \{}
\DoxyCodeLine{03063\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 0.0;}
\DoxyCodeLine{03064\ \ \ \ \ \}}
\DoxyCodeLine{03065\ }
\DoxyCodeLine{03066\ \ \ \ \ \textcolor{comment}{//\ here\ its\ save\ to\ assume\ that\ at\ least\ one\ element\ is\ there}}
\DoxyCodeLine{03067\ \ \ \ \ \textcolor{keywordflow}{return}\ *std::min\_element(data.begin(),\ data.end());}
\DoxyCodeLine{03068\ \}}
\DoxyCodeLine{03069\ }
\DoxyCodeLine{03070\ \textcolor{keywordtype}{double}\ Result::maximum(Measure\ m)\ \textcolor{keyword}{const}\ \textcolor{keyword}{noexcept}\ \{}
\DoxyCodeLine{03071\ \ \ \ \ \textcolor{keyword}{auto}\ \textcolor{keyword}{const}\&\ data\ =\ mNameToMeasurements[detail::u(m)];}
\DoxyCodeLine{03072\ \ \ \ \ \textcolor{keywordflow}{if}\ (data.empty())\ \{}
\DoxyCodeLine{03073\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 0.0;}
\DoxyCodeLine{03074\ \ \ \ \ \}}
\DoxyCodeLine{03075\ }
\DoxyCodeLine{03076\ \ \ \ \ \textcolor{comment}{//\ here\ its\ save\ to\ assume\ that\ at\ least\ one\ element\ is\ there}}
\DoxyCodeLine{03077\ \ \ \ \ \textcolor{keywordflow}{return}\ *std::max\_element(data.begin(),\ data.end());}
\DoxyCodeLine{03078\ \}}
\DoxyCodeLine{03079\ }
\DoxyCodeLine{03080\ std::string\ \textcolor{keyword}{const}\&\ Result::context(\textcolor{keywordtype}{char}\ \textcolor{keyword}{const}*\ variableName)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{03081\ \ \ \ \ \textcolor{keywordflow}{return}\ mConfig.mContext.at(variableName);}
\DoxyCodeLine{03082\ \}}
\DoxyCodeLine{03083\ }
\DoxyCodeLine{03084\ std::string\ \textcolor{keyword}{const}\&\ Result::context(std::string\ \textcolor{keyword}{const}\&\ variableName)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{03085\ \ \ \ \ \textcolor{keywordflow}{return}\ mConfig.mContext.at(variableName);}
\DoxyCodeLine{03086\ \}}
\DoxyCodeLine{03087\ }
\DoxyCodeLine{03088\ Result::Measure\ Result::fromString(std::string\ \textcolor{keyword}{const}\&\ str)\ \{}
\DoxyCodeLine{03089\ \ \ \ \ \textcolor{keywordflow}{if}\ (str\ ==\ \textcolor{stringliteral}{"{}elapsed"{}})\ \{}
\DoxyCodeLine{03090\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ Measure::elapsed;}
\DoxyCodeLine{03091\ \ \ \ \ \}}
\DoxyCodeLine{03092\ \ \ \ \ \textcolor{keywordflow}{if}\ (str\ ==\ \textcolor{stringliteral}{"{}iterations"{}})\ \{}
\DoxyCodeLine{03093\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ Measure::iterations;}
\DoxyCodeLine{03094\ \ \ \ \ \}}
\DoxyCodeLine{03095\ \ \ \ \ \textcolor{keywordflow}{if}\ (str\ ==\ \textcolor{stringliteral}{"{}pagefaults"{}})\ \{}
\DoxyCodeLine{03096\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ Measure::pagefaults;}
\DoxyCodeLine{03097\ \ \ \ \ \}}
\DoxyCodeLine{03098\ \ \ \ \ \textcolor{keywordflow}{if}\ (str\ ==\ \textcolor{stringliteral}{"{}cpucycles"{}})\ \{}
\DoxyCodeLine{03099\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ Measure::cpucycles;}
\DoxyCodeLine{03100\ \ \ \ \ \}}
\DoxyCodeLine{03101\ \ \ \ \ \textcolor{keywordflow}{if}\ (str\ ==\ \textcolor{stringliteral}{"{}contextswitches"{}})\ \{}
\DoxyCodeLine{03102\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ Measure::contextswitches;}
\DoxyCodeLine{03103\ \ \ \ \ \}}
\DoxyCodeLine{03104\ \ \ \ \ \textcolor{keywordflow}{if}\ (str\ ==\ \textcolor{stringliteral}{"{}instructions"{}})\ \{}
\DoxyCodeLine{03105\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ Measure::instructions;}
\DoxyCodeLine{03106\ \ \ \ \ \}}
\DoxyCodeLine{03107\ \ \ \ \ \textcolor{keywordflow}{if}\ (str\ ==\ \textcolor{stringliteral}{"{}branchinstructions"{}})\ \{}
\DoxyCodeLine{03108\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ Measure::branchinstructions;}
\DoxyCodeLine{03109\ \ \ \ \ \}}
\DoxyCodeLine{03110\ \ \ \ \ \textcolor{keywordflow}{if}\ (str\ ==\ \textcolor{stringliteral}{"{}branchmisses"{}})\ \{}
\DoxyCodeLine{03111\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ Measure::branchmisses;}
\DoxyCodeLine{03112\ \ \ \ \ \}}
\DoxyCodeLine{03113\ \ \ \ \ \textcolor{comment}{//\ not\ found,\ return\ \_size}}
\DoxyCodeLine{03114\ \ \ \ \ \textcolor{keywordflow}{return}\ Measure::\_size;}
\DoxyCodeLine{03115\ \}}
\DoxyCodeLine{03116\ }
\DoxyCodeLine{03117\ \textcolor{comment}{//\ Configuration\ of\ a\ microbenchmark.}}
\DoxyCodeLine{03118\ Bench::Bench()\ \{}
\DoxyCodeLine{03119\ \ \ \ \ mConfig.mOut\ =\ \&std::cout;}
\DoxyCodeLine{03120\ \}}
\DoxyCodeLine{03121\ }
\DoxyCodeLine{03122\ Bench::Bench(Bench\&\&)\ noexcept\ =\ default;}
\DoxyCodeLine{03123\ Bench\&\ Bench::operator=(Bench\&\&)\ noexcept(ANKERL\_NANOBENCH(NOEXCEPT\_STRING\_MOVE))\ =\ default;}
\DoxyCodeLine{03124\ Bench::Bench(Bench\ const\&)\ =\ default;}
\DoxyCodeLine{03125\ Bench\&\ Bench::operator=(Bench\ const\&)\ =\ default;}
\DoxyCodeLine{03126\ Bench::\string~Bench()\ noexcept\ =\ default;}
\DoxyCodeLine{03127\ }
\DoxyCodeLine{03128\ \textcolor{keywordtype}{double}\ Bench::batch()\ const\ noexcept\ \{}
\DoxyCodeLine{03129\ \ \ \ \ \textcolor{keywordflow}{return}\ mConfig.mBatch;}
\DoxyCodeLine{03130\ \}}
\DoxyCodeLine{03131\ }
\DoxyCodeLine{03132\ \textcolor{keywordtype}{double}\ Bench::complexityN()\ const\ noexcept\ \{}
\DoxyCodeLine{03133\ \ \ \ \ \textcolor{keywordflow}{return}\ mConfig.mComplexityN;}
\DoxyCodeLine{03134\ \}}
\DoxyCodeLine{03135\ }
\DoxyCodeLine{03136\ \textcolor{comment}{//\ Set\ a\ baseline\ to\ compare\ it\ to.\ 100\%\ it\ is\ exactly\ as\ fast\ as\ the\ baseline,\ >100\%\ means\ it\ is\ faster\ than\ the\ baseline,\ <100\%}}
\DoxyCodeLine{03137\ \textcolor{comment}{//\ means\ it\ is\ slower\ than\ the\ baseline.}}
\DoxyCodeLine{03138\ Bench\&\ Bench::relative(\textcolor{keywordtype}{bool}\ isRelativeEnabled)\ \textcolor{keyword}{noexcept}\ \{}
\DoxyCodeLine{03139\ \ \ \ \ mConfig.mIsRelative\ =\ isRelativeEnabled;}
\DoxyCodeLine{03140\ \ \ \ \ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};}
\DoxyCodeLine{03141\ \}}
\DoxyCodeLine{03142\ \textcolor{keywordtype}{bool}\ Bench::relative()\ const\ noexcept\ \{}
\DoxyCodeLine{03143\ \ \ \ \ \textcolor{keywordflow}{return}\ mConfig.mIsRelative;}
\DoxyCodeLine{03144\ \}}
\DoxyCodeLine{03145\ }
\DoxyCodeLine{03146\ Bench\&\ Bench::performanceCounters(\textcolor{keywordtype}{bool}\ showPerformanceCounters)\ \textcolor{keyword}{noexcept}\ \{}
\DoxyCodeLine{03147\ \ \ \ \ mConfig.mShowPerformanceCounters\ =\ showPerformanceCounters;}
\DoxyCodeLine{03148\ \ \ \ \ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};}
\DoxyCodeLine{03149\ \}}
\DoxyCodeLine{03150\ \textcolor{keywordtype}{bool}\ Bench::performanceCounters()\ const\ noexcept\ \{}
\DoxyCodeLine{03151\ \ \ \ \ \textcolor{keywordflow}{return}\ mConfig.mShowPerformanceCounters;}
\DoxyCodeLine{03152\ \}}
\DoxyCodeLine{03153\ }
\DoxyCodeLine{03154\ \textcolor{comment}{//\ Operation\ unit.\ Defaults\ to\ "{}op"{},\ could\ be\ e.g.\ "{}byte"{}\ for\ string\ processing.}}
\DoxyCodeLine{03155\ \textcolor{comment}{//\ If\ u\ differs\ from\ currently\ set\ unit,\ the\ stored\ results\ will\ be\ cleared.}}
\DoxyCodeLine{03156\ \textcolor{comment}{//\ Use\ singular\ (byte,\ not\ bytes).}}
\DoxyCodeLine{03157\ Bench\&\ Bench::unit(\textcolor{keywordtype}{char}\ \textcolor{keyword}{const}*\ u)\ \{}
\DoxyCodeLine{03158\ \ \ \ \ \textcolor{keywordflow}{if}\ (u\ !=\ mConfig.mUnit)\ \{}
\DoxyCodeLine{03159\ \ \ \ \ \ \ \ \ mResults.clear();}
\DoxyCodeLine{03160\ \ \ \ \ \}}
\DoxyCodeLine{03161\ \ \ \ \ mConfig.mUnit\ =\ u;}
\DoxyCodeLine{03162\ \ \ \ \ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};}
\DoxyCodeLine{03163\ \}}
\DoxyCodeLine{03164\ }
\DoxyCodeLine{03165\ Bench\&\ Bench::unit(std::string\ \textcolor{keyword}{const}\&\ u)\ \{}
\DoxyCodeLine{03166\ \ \ \ \ \textcolor{keywordflow}{return}\ unit(u.c\_str());}
\DoxyCodeLine{03167\ \}}
\DoxyCodeLine{03168\ }
\DoxyCodeLine{03169\ std::string\ \textcolor{keyword}{const}\&\ Bench::unit()\ const\ noexcept\ \{}
\DoxyCodeLine{03170\ \ \ \ \ \textcolor{keywordflow}{return}\ mConfig.mUnit;}
\DoxyCodeLine{03171\ \}}
\DoxyCodeLine{03172\ }
\DoxyCodeLine{03173\ Bench\&\ Bench::timeUnit(std::chrono::duration<double>\ \textcolor{keyword}{const}\&\ tu,\ std::string\ \textcolor{keyword}{const}\&\ tuName)\ \{}
\DoxyCodeLine{03174\ \ \ \ \ mConfig.mTimeUnit\ =\ tu;}
\DoxyCodeLine{03175\ \ \ \ \ mConfig.mTimeUnitName\ =\ tuName;}
\DoxyCodeLine{03176\ \ \ \ \ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};}
\DoxyCodeLine{03177\ \}}
\DoxyCodeLine{03178\ }
\DoxyCodeLine{03179\ std::string\ \textcolor{keyword}{const}\&\ Bench::timeUnitName()\ const\ noexcept\ \{}
\DoxyCodeLine{03180\ \ \ \ \ \textcolor{keywordflow}{return}\ mConfig.mTimeUnitName;}
\DoxyCodeLine{03181\ \}}
\DoxyCodeLine{03182\ }
\DoxyCodeLine{03183\ std::chrono::duration<double>\ \textcolor{keyword}{const}\&\ Bench::timeUnit()\ const\ noexcept\ \{}
\DoxyCodeLine{03184\ \ \ \ \ \textcolor{keywordflow}{return}\ mConfig.mTimeUnit;}
\DoxyCodeLine{03185\ \}}
\DoxyCodeLine{03186\ }
\DoxyCodeLine{03187\ \textcolor{comment}{//\ If\ benchmarkTitle\ differs\ from\ currently\ set\ title,\ the\ stored\ results\ will\ be\ cleared.}}
\DoxyCodeLine{03188\ Bench\&\ Bench::title(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ benchmarkTitle)\ \{}
\DoxyCodeLine{03189\ \ \ \ \ \textcolor{keywordflow}{if}\ (benchmarkTitle\ !=\ mConfig.mBenchmarkTitle)\ \{}
\DoxyCodeLine{03190\ \ \ \ \ \ \ \ \ mResults.clear();}
\DoxyCodeLine{03191\ \ \ \ \ \}}
\DoxyCodeLine{03192\ \ \ \ \ mConfig.mBenchmarkTitle\ =\ benchmarkTitle;}
\DoxyCodeLine{03193\ \ \ \ \ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};}
\DoxyCodeLine{03194\ \}}
\DoxyCodeLine{03195\ Bench\&\ Bench::title(std::string\ \textcolor{keyword}{const}\&\ benchmarkTitle)\ \{}
\DoxyCodeLine{03196\ \ \ \ \ \textcolor{keywordflow}{if}\ (benchmarkTitle\ !=\ mConfig.mBenchmarkTitle)\ \{}
\DoxyCodeLine{03197\ \ \ \ \ \ \ \ \ mResults.clear();}
\DoxyCodeLine{03198\ \ \ \ \ \}}
\DoxyCodeLine{03199\ \ \ \ \ mConfig.mBenchmarkTitle\ =\ benchmarkTitle;}
\DoxyCodeLine{03200\ \ \ \ \ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};}
\DoxyCodeLine{03201\ \}}
\DoxyCodeLine{03202\ }
\DoxyCodeLine{03203\ std::string\ \textcolor{keyword}{const}\&\ Bench::title()\ const\ noexcept\ \{}
\DoxyCodeLine{03204\ \ \ \ \ \textcolor{keywordflow}{return}\ mConfig.mBenchmarkTitle;}
\DoxyCodeLine{03205\ \}}
\DoxyCodeLine{03206\ }
\DoxyCodeLine{03207\ Bench\&\ Bench::name(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ benchmarkName)\ \{}
\DoxyCodeLine{03208\ \ \ \ \ mConfig.mBenchmarkName\ =\ benchmarkName;}
\DoxyCodeLine{03209\ \ \ \ \ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};}
\DoxyCodeLine{03210\ \}}
\DoxyCodeLine{03211\ }
\DoxyCodeLine{03212\ Bench\&\ Bench::name(std::string\ \textcolor{keyword}{const}\&\ benchmarkName)\ \{}
\DoxyCodeLine{03213\ \ \ \ \ mConfig.mBenchmarkName\ =\ benchmarkName;}
\DoxyCodeLine{03214\ \ \ \ \ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};}
\DoxyCodeLine{03215\ \}}
\DoxyCodeLine{03216\ }
\DoxyCodeLine{03217\ std::string\ \textcolor{keyword}{const}\&\ Bench::name()\ const\ noexcept\ \{}
\DoxyCodeLine{03218\ \ \ \ \ \textcolor{keywordflow}{return}\ mConfig.mBenchmarkName;}
\DoxyCodeLine{03219\ \}}
\DoxyCodeLine{03220\ }
\DoxyCodeLine{03221\ Bench\&\ Bench::context(\textcolor{keywordtype}{char}\ \textcolor{keyword}{const}*\ variableName,\ \textcolor{keywordtype}{char}\ \textcolor{keyword}{const}*\ variableValue)\ \{}
\DoxyCodeLine{03222\ \ \ \ \ mConfig.mContext[variableName]\ =\ variableValue;}
\DoxyCodeLine{03223\ \ \ \ \ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};}
\DoxyCodeLine{03224\ \}}
\DoxyCodeLine{03225\ }
\DoxyCodeLine{03226\ Bench\&\ Bench::context(std::string\ \textcolor{keyword}{const}\&\ variableName,\ std::string\ \textcolor{keyword}{const}\&\ variableValue)\ \{}
\DoxyCodeLine{03227\ \ \ \ \ mConfig.mContext[variableName]\ =\ variableValue;}
\DoxyCodeLine{03228\ \ \ \ \ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};}
\DoxyCodeLine{03229\ \}}
\DoxyCodeLine{03230\ }
\DoxyCodeLine{03231\ Bench\&\ Bench::clearContext()\ \{}
\DoxyCodeLine{03232\ \ \ \ \ mConfig.mContext.clear();}
\DoxyCodeLine{03233\ \ \ \ \ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};}
\DoxyCodeLine{03234\ \}}
\DoxyCodeLine{03235\ }
\DoxyCodeLine{03236\ \textcolor{comment}{//\ Number\ of\ epochs\ to\ evaluate.\ The\ reported\ result\ will\ be\ the\ median\ of\ evaluation\ of\ each\ epoch.}}
\DoxyCodeLine{03237\ Bench\&\ Bench::epochs(\textcolor{keywordtype}{size\_t}\ numEpochs)\ \textcolor{keyword}{noexcept}\ \{}
\DoxyCodeLine{03238\ \ \ \ \ mConfig.mNumEpochs\ =\ numEpochs;}
\DoxyCodeLine{03239\ \ \ \ \ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};}
\DoxyCodeLine{03240\ \}}
\DoxyCodeLine{03241\ \textcolor{keywordtype}{size\_t}\ Bench::epochs()\ const\ noexcept\ \{}
\DoxyCodeLine{03242\ \ \ \ \ \textcolor{keywordflow}{return}\ mConfig.mNumEpochs;}
\DoxyCodeLine{03243\ \}}
\DoxyCodeLine{03244\ }
\DoxyCodeLine{03245\ \textcolor{comment}{//\ Desired\ evaluation\ time\ is\ a\ multiple\ of\ clock\ resolution.\ Default\ is\ to\ be\ 1000\ times\ above\ this\ measurement\ precision.}}
\DoxyCodeLine{03246\ Bench\&\ Bench::clockResolutionMultiple(\textcolor{keywordtype}{size\_t}\ multiple)\ \textcolor{keyword}{noexcept}\ \{}
\DoxyCodeLine{03247\ \ \ \ \ mConfig.mClockResolutionMultiple\ =\ multiple;}
\DoxyCodeLine{03248\ \ \ \ \ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};}
\DoxyCodeLine{03249\ \}}
\DoxyCodeLine{03250\ \textcolor{keywordtype}{size\_t}\ Bench::clockResolutionMultiple()\ const\ noexcept\ \{}
\DoxyCodeLine{03251\ \ \ \ \ \textcolor{keywordflow}{return}\ mConfig.mClockResolutionMultiple;}
\DoxyCodeLine{03252\ \}}
\DoxyCodeLine{03253\ }
\DoxyCodeLine{03254\ \textcolor{comment}{//\ Sets\ the\ maximum\ time\ each\ epoch\ should\ take.\ Default\ is\ 100ms.}}
\DoxyCodeLine{03255\ Bench\&\ Bench::maxEpochTime(std::chrono::nanoseconds\ t)\ \textcolor{keyword}{noexcept}\ \{}
\DoxyCodeLine{03256\ \ \ \ \ mConfig.mMaxEpochTime\ =\ t;}
\DoxyCodeLine{03257\ \ \ \ \ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};}
\DoxyCodeLine{03258\ \}}
\DoxyCodeLine{03259\ std::chrono::nanoseconds\ Bench::maxEpochTime()\ const\ noexcept\ \{}
\DoxyCodeLine{03260\ \ \ \ \ \textcolor{keywordflow}{return}\ mConfig.mMaxEpochTime;}
\DoxyCodeLine{03261\ \}}
\DoxyCodeLine{03262\ }
\DoxyCodeLine{03263\ \textcolor{comment}{//\ Sets\ the\ maximum\ time\ each\ epoch\ should\ take.\ Default\ is\ 100ms.}}
\DoxyCodeLine{03264\ Bench\&\ Bench::minEpochTime(std::chrono::nanoseconds\ t)\ \textcolor{keyword}{noexcept}\ \{}
\DoxyCodeLine{03265\ \ \ \ \ mConfig.mMinEpochTime\ =\ t;}
\DoxyCodeLine{03266\ \ \ \ \ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};}
\DoxyCodeLine{03267\ \}}
\DoxyCodeLine{03268\ std::chrono::nanoseconds\ Bench::minEpochTime()\ const\ noexcept\ \{}
\DoxyCodeLine{03269\ \ \ \ \ \textcolor{keywordflow}{return}\ mConfig.mMinEpochTime;}
\DoxyCodeLine{03270\ \}}
\DoxyCodeLine{03271\ }
\DoxyCodeLine{03272\ Bench\&\ Bench::minEpochIterations(uint64\_t\ numIters)\ \textcolor{keyword}{noexcept}\ \{}
\DoxyCodeLine{03273\ \ \ \ \ mConfig.mMinEpochIterations\ =\ (numIters\ ==\ 0)\ ?\ 1\ :\ numIters;}
\DoxyCodeLine{03274\ \ \ \ \ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};}
\DoxyCodeLine{03275\ \}}
\DoxyCodeLine{03276\ uint64\_t\ Bench::minEpochIterations()\ const\ noexcept\ \{}
\DoxyCodeLine{03277\ \ \ \ \ \textcolor{keywordflow}{return}\ mConfig.mMinEpochIterations;}
\DoxyCodeLine{03278\ \}}
\DoxyCodeLine{03279\ }
\DoxyCodeLine{03280\ Bench\&\ Bench::epochIterations(uint64\_t\ numIters)\ \textcolor{keyword}{noexcept}\ \{}
\DoxyCodeLine{03281\ \ \ \ \ mConfig.mEpochIterations\ =\ numIters;}
\DoxyCodeLine{03282\ \ \ \ \ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};}
\DoxyCodeLine{03283\ \}}
\DoxyCodeLine{03284\ uint64\_t\ Bench::epochIterations()\ const\ noexcept\ \{}
\DoxyCodeLine{03285\ \ \ \ \ \textcolor{keywordflow}{return}\ mConfig.mEpochIterations;}
\DoxyCodeLine{03286\ \}}
\DoxyCodeLine{03287\ }
\DoxyCodeLine{03288\ Bench\&\ Bench::warmup(uint64\_t\ numWarmupIters)\ \textcolor{keyword}{noexcept}\ \{}
\DoxyCodeLine{03289\ \ \ \ \ mConfig.mWarmup\ =\ numWarmupIters;}
\DoxyCodeLine{03290\ \ \ \ \ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};}
\DoxyCodeLine{03291\ \}}
\DoxyCodeLine{03292\ uint64\_t\ Bench::warmup()\ const\ noexcept\ \{}
\DoxyCodeLine{03293\ \ \ \ \ \textcolor{keywordflow}{return}\ mConfig.mWarmup;}
\DoxyCodeLine{03294\ \}}
\DoxyCodeLine{03295\ }
\DoxyCodeLine{03296\ Bench\&\ Bench::config(Config\ \textcolor{keyword}{const}\&\ benchmarkConfig)\ \{}
\DoxyCodeLine{03297\ \ \ \ \ mConfig\ =\ benchmarkConfig;}
\DoxyCodeLine{03298\ \ \ \ \ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};}
\DoxyCodeLine{03299\ \}}
\DoxyCodeLine{03300\ Config\ \textcolor{keyword}{const}\&\ Bench::config()\ const\ noexcept\ \{}
\DoxyCodeLine{03301\ \ \ \ \ \textcolor{keywordflow}{return}\ mConfig;}
\DoxyCodeLine{03302\ \}}
\DoxyCodeLine{03303\ }
\DoxyCodeLine{03304\ Bench\&\ Bench::output(std::ostream*\ outstream)\ \textcolor{keyword}{noexcept}\ \{}
\DoxyCodeLine{03305\ \ \ \ \ mConfig.mOut\ =\ outstream;}
\DoxyCodeLine{03306\ \ \ \ \ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};}
\DoxyCodeLine{03307\ \}}
\DoxyCodeLine{03308\ }
\DoxyCodeLine{03309\ ANKERL\_NANOBENCH(NODISCARD)\ std::ostream*\ Bench::output()\ const\ noexcept\ \{}
\DoxyCodeLine{03310\ \ \ \ \ \textcolor{keywordflow}{return}\ mConfig.mOut;}
\DoxyCodeLine{03311\ \}}
\DoxyCodeLine{03312\ }
\DoxyCodeLine{03313\ std::vector<Result>\ \textcolor{keyword}{const}\&\ Bench::results()\ const\ noexcept\ \{}
\DoxyCodeLine{03314\ \ \ \ \ \textcolor{keywordflow}{return}\ mResults;}
\DoxyCodeLine{03315\ \}}
\DoxyCodeLine{03316\ }
\DoxyCodeLine{03317\ Bench\&\ Bench::render(\textcolor{keywordtype}{char}\ \textcolor{keyword}{const}*\ templateContent,\ std::ostream\&\ os)\ \{}
\DoxyCodeLine{03318\ \ \ \ \ ::ankerl::nanobench::render(templateContent,\ *\textcolor{keyword}{this},\ os);}
\DoxyCodeLine{03319\ \ \ \ \ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};}
\DoxyCodeLine{03320\ \}}
\DoxyCodeLine{03321\ }
\DoxyCodeLine{03322\ Bench\&\ Bench::render(std::string\ \textcolor{keyword}{const}\&\ templateContent,\ std::ostream\&\ os)\ \{}
\DoxyCodeLine{03323\ \ \ \ \ ::ankerl::nanobench::render(templateContent,\ *\textcolor{keyword}{this},\ os);}
\DoxyCodeLine{03324\ \ \ \ \ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};}
\DoxyCodeLine{03325\ \}}
\DoxyCodeLine{03326\ }
\DoxyCodeLine{03327\ std::vector<BigO>\ Bench::complexityBigO()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{03328\ \ \ \ \ std::vector<BigO>\ bigOs;}
\DoxyCodeLine{03329\ \ \ \ \ \textcolor{keyword}{auto}\ rangeMeasure\ =\ BigO::collectRangeMeasure(mResults);}
\DoxyCodeLine{03330\ \ \ \ \ bigOs.emplace\_back(\textcolor{stringliteral}{"{}O(1)"{}},\ rangeMeasure,\ [](\textcolor{keywordtype}{double})\ \{}
\DoxyCodeLine{03331\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 1.0;}
\DoxyCodeLine{03332\ \ \ \ \ \});}
\DoxyCodeLine{03333\ \ \ \ \ bigOs.emplace\_back(\textcolor{stringliteral}{"{}O(n)"{}},\ rangeMeasure,\ [](\textcolor{keywordtype}{double}\ n)\ \{}
\DoxyCodeLine{03334\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ n;}
\DoxyCodeLine{03335\ \ \ \ \ \});}
\DoxyCodeLine{03336\ \ \ \ \ bigOs.emplace\_back(\textcolor{stringliteral}{"{}O(log\ n)"{}},\ rangeMeasure,\ [](\textcolor{keywordtype}{double}\ n)\ \{}
\DoxyCodeLine{03337\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ std::log2(n);}
\DoxyCodeLine{03338\ \ \ \ \ \});}
\DoxyCodeLine{03339\ \ \ \ \ bigOs.emplace\_back(\textcolor{stringliteral}{"{}O(n\ log\ n)"{}},\ rangeMeasure,\ [](\textcolor{keywordtype}{double}\ n)\ \{}
\DoxyCodeLine{03340\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ n\ *\ std::log2(n);}
\DoxyCodeLine{03341\ \ \ \ \ \});}
\DoxyCodeLine{03342\ \ \ \ \ bigOs.emplace\_back(\textcolor{stringliteral}{"{}O(n\string^2)"{}},\ rangeMeasure,\ [](\textcolor{keywordtype}{double}\ n)\ \{}
\DoxyCodeLine{03343\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ n\ *\ n;}
\DoxyCodeLine{03344\ \ \ \ \ \});}
\DoxyCodeLine{03345\ \ \ \ \ bigOs.emplace\_back(\textcolor{stringliteral}{"{}O(n\string^3)"{}},\ rangeMeasure,\ [](\textcolor{keywordtype}{double}\ n)\ \{}
\DoxyCodeLine{03346\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ n\ *\ n\ *\ n;}
\DoxyCodeLine{03347\ \ \ \ \ \});}
\DoxyCodeLine{03348\ \ \ \ \ std::sort(bigOs.begin(),\ bigOs.end());}
\DoxyCodeLine{03349\ \ \ \ \ \textcolor{keywordflow}{return}\ bigOs;}
\DoxyCodeLine{03350\ \}}
\DoxyCodeLine{03351\ }
\DoxyCodeLine{03352\ Rng::Rng()}
\DoxyCodeLine{03353\ \ \ \ \ :\ mX(0)}
\DoxyCodeLine{03354\ \ \ \ \ ,\ mY(0)\ \{}
\DoxyCodeLine{03355\ \ \ \ \ std::random\_device\ rd;}
\DoxyCodeLine{03356\ \ \ \ \ std::uniform\_int\_distribution<uint64\_t>\ dist;}
\DoxyCodeLine{03357\ \ \ \ \ \textcolor{keywordflow}{do}\ \{}
\DoxyCodeLine{03358\ \ \ \ \ \ \ \ \ mX\ =\ dist(rd);}
\DoxyCodeLine{03359\ \ \ \ \ \ \ \ \ mY\ =\ dist(rd);}
\DoxyCodeLine{03360\ \ \ \ \ \}\ \textcolor{keywordflow}{while}\ (mX\ ==\ 0\ \&\&\ mY\ ==\ 0);}
\DoxyCodeLine{03361\ \}}
\DoxyCodeLine{03362\ }
\DoxyCodeLine{03363\ ANKERL\_NANOBENCH\_NO\_SANITIZE(\textcolor{stringliteral}{"{}integer"{}},\ \textcolor{stringliteral}{"{}undefined"{}})}
\DoxyCodeLine{03364\ uint64\_t\ splitMix64(uint64\_t\&\ state)\ noexcept\ \{}
\DoxyCodeLine{03365\ \ \ \ \ uint64\_t\ z\ =\ (state\ +=\ UINT64\_C(0x9e3779b97f4a7c15));}
\DoxyCodeLine{03366\ \ \ \ \ z\ =\ (z\ \string^\ (z\ >>\ 30U))\ *\ UINT64\_C(0xbf58476d1ce4e5b9);}
\DoxyCodeLine{03367\ \ \ \ \ z\ =\ (z\ \string^\ (z\ >>\ 27U))\ *\ UINT64\_C(0x94d049bb133111eb);}
\DoxyCodeLine{03368\ \ \ \ \ \textcolor{keywordflow}{return}\ z\ \string^\ (z\ >>\ 31U);}
\DoxyCodeLine{03369\ \}}
\DoxyCodeLine{03370\ }
\DoxyCodeLine{03371\ \textcolor{comment}{//\ Seeded\ as\ described\ in\ romu\ paper\ (update\ april\ 2020)}}
\DoxyCodeLine{03372\ Rng::Rng(uint64\_t\ seed)\ noexcept}
\DoxyCodeLine{03373\ \ \ \ \ :\ mX(splitMix64(seed))}
\DoxyCodeLine{03374\ \ \ \ \ ,\ mY(splitMix64(seed))\ \{}
\DoxyCodeLine{03375\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ 10;\ ++i)\ \{}
\DoxyCodeLine{03376\ \ \ \ \ \ \ \ \ operator()();}
\DoxyCodeLine{03377\ \ \ \ \ \}}
\DoxyCodeLine{03378\ \}}
\DoxyCodeLine{03379\ }
\DoxyCodeLine{03380\ \textcolor{comment}{//\ only\ internally\ used\ to\ copy\ the\ RNG.}}
\DoxyCodeLine{03381\ Rng::Rng(uint64\_t\ x,\ uint64\_t\ y)\ noexcept}
\DoxyCodeLine{03382\ \ \ \ \ :\ mX(x)}
\DoxyCodeLine{03383\ \ \ \ \ ,\ mY(y)\ \{\}}
\DoxyCodeLine{03384\ }
\DoxyCodeLine{03385\ Rng\ Rng::copy()\ const\ noexcept\ \{}
\DoxyCodeLine{03386\ \ \ \ \ \textcolor{keywordflow}{return}\ Rng\{mX,\ mY\};}
\DoxyCodeLine{03387\ \}}
\DoxyCodeLine{03388\ }
\DoxyCodeLine{03389\ Rng::Rng(std::vector<uint64\_t>\ \textcolor{keyword}{const}\&\ data)}
\DoxyCodeLine{03390\ \ \ \ \ :\ mX(0)}
\DoxyCodeLine{03391\ \ \ \ \ ,\ mY(0)\ \{}
\DoxyCodeLine{03392\ \ \ \ \ \textcolor{keywordflow}{if}\ (data.size()\ !=\ 2)\ \{}
\DoxyCodeLine{03393\ \ \ \ \ \ \ \ \ throw\ std::runtime\_error(\textcolor{stringliteral}{"{}ankerl::nanobench::Rng::Rng:\ needed\ exactly\ 2\ entries\ in\ data,\ but\ got\ "{}}\ +}
\DoxyCodeLine{03394\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ detail::fmt::to\_s(data.size()));}
\DoxyCodeLine{03395\ \ \ \ \ \}}
\DoxyCodeLine{03396\ \ \ \ \ mX\ =\ data[0];}
\DoxyCodeLine{03397\ \ \ \ \ mY\ =\ data[1];}
\DoxyCodeLine{03398\ \}}
\DoxyCodeLine{03399\ }
\DoxyCodeLine{03400\ std::vector<uint64\_t>\ Rng::state()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{03401\ \ \ \ \ std::vector<uint64\_t>\ data(2);}
\DoxyCodeLine{03402\ \ \ \ \ data[0]\ =\ mX;}
\DoxyCodeLine{03403\ \ \ \ \ data[1]\ =\ mY;}
\DoxyCodeLine{03404\ \ \ \ \ \textcolor{keywordflow}{return}\ data;}
\DoxyCodeLine{03405\ \}}
\DoxyCodeLine{03406\ }
\DoxyCodeLine{03407\ BigO::RangeMeasure\ BigO::collectRangeMeasure(std::vector<Result>\ \textcolor{keyword}{const}\&\ results)\ \{}
\DoxyCodeLine{03408\ \ \ \ \ BigO::RangeMeasure\ rangeMeasure;}
\DoxyCodeLine{03409\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ \textcolor{keyword}{const}\&\ result\ :\ results)\ \{}
\DoxyCodeLine{03410\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (result.config().mComplexityN\ >\ 0.0)\ \{}
\DoxyCodeLine{03411\ \ \ \ \ \ \ \ \ \ \ \ \ rangeMeasure.emplace\_back(result.config().mComplexityN,\ result.median(Result::Measure::elapsed));}
\DoxyCodeLine{03412\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03413\ \ \ \ \ \}}
\DoxyCodeLine{03414\ \ \ \ \ \textcolor{keywordflow}{return}\ rangeMeasure;}
\DoxyCodeLine{03415\ \}}
\DoxyCodeLine{03416\ }
\DoxyCodeLine{03417\ BigO::BigO(std::string\ bigOName,\ RangeMeasure\ \textcolor{keyword}{const}\&\ rangeMeasure)}
\DoxyCodeLine{03418\ \ \ \ \ :\ mName(std::move(bigOName))\ \{}
\DoxyCodeLine{03419\ }
\DoxyCodeLine{03420\ \ \ \ \ \textcolor{comment}{//\ estimate\ the\ constant\ factor}}
\DoxyCodeLine{03421\ \ \ \ \ \textcolor{keywordtype}{double}\ sumRangeMeasure\ =\ 0.0;}
\DoxyCodeLine{03422\ \ \ \ \ \textcolor{keywordtype}{double}\ sumRangeRange\ =\ 0.0;}
\DoxyCodeLine{03423\ }
\DoxyCodeLine{03424\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ rm\ :\ rangeMeasure)\ \{}
\DoxyCodeLine{03425\ \ \ \ \ \ \ \ \ sumRangeMeasure\ +=\ rm.first\ *\ rm.second;}
\DoxyCodeLine{03426\ \ \ \ \ \ \ \ \ sumRangeRange\ +=\ rm.first\ *\ rm.first;}
\DoxyCodeLine{03427\ \ \ \ \ \}}
\DoxyCodeLine{03428\ \ \ \ \ mConstant\ =\ sumRangeMeasure\ /\ sumRangeRange;}
\DoxyCodeLine{03429\ }
\DoxyCodeLine{03430\ \ \ \ \ \textcolor{comment}{//\ calculate\ root\ mean\ square}}
\DoxyCodeLine{03431\ \ \ \ \ \textcolor{keywordtype}{double}\ err\ =\ 0.0;}
\DoxyCodeLine{03432\ \ \ \ \ \textcolor{keywordtype}{double}\ sumMeasure\ =\ 0.0;}
\DoxyCodeLine{03433\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ rm\ :\ rangeMeasure)\ \{}
\DoxyCodeLine{03434\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ diff\ =\ mConstant\ *\ rm.first\ -\/\ rm.second;}
\DoxyCodeLine{03435\ \ \ \ \ \ \ \ \ err\ +=\ diff\ *\ diff;}
\DoxyCodeLine{03436\ }
\DoxyCodeLine{03437\ \ \ \ \ \ \ \ \ sumMeasure\ +=\ rm.second;}
\DoxyCodeLine{03438\ \ \ \ \ \}}
\DoxyCodeLine{03439\ }
\DoxyCodeLine{03440\ \ \ \ \ \textcolor{keyword}{auto}\ n\ =\ detail::d(rangeMeasure.size());}
\DoxyCodeLine{03441\ \ \ \ \ \textcolor{keyword}{auto}\ mean\ =\ sumMeasure\ /\ n;}
\DoxyCodeLine{03442\ \ \ \ \ mNormalizedRootMeanSquare\ =\ std::sqrt(err\ /\ n)\ /\ mean;}
\DoxyCodeLine{03443\ \}}
\DoxyCodeLine{03444\ }
\DoxyCodeLine{03445\ BigO::BigO(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ bigOName,\ RangeMeasure\ \textcolor{keyword}{const}\&\ rangeMeasure)}
\DoxyCodeLine{03446\ \ \ \ \ :\ BigO(std::string(bigOName),\ rangeMeasure)\ \{\}}
\DoxyCodeLine{03447\ }
\DoxyCodeLine{03448\ std::string\ \textcolor{keyword}{const}\&\ BigO::name()\ const\ noexcept\ \{}
\DoxyCodeLine{03449\ \ \ \ \ \textcolor{keywordflow}{return}\ mName;}
\DoxyCodeLine{03450\ \}}
\DoxyCodeLine{03451\ }
\DoxyCodeLine{03452\ \textcolor{keywordtype}{double}\ BigO::constant()\ const\ noexcept\ \{}
\DoxyCodeLine{03453\ \ \ \ \ \textcolor{keywordflow}{return}\ mConstant;}
\DoxyCodeLine{03454\ \}}
\DoxyCodeLine{03455\ }
\DoxyCodeLine{03456\ \textcolor{keywordtype}{double}\ BigO::normalizedRootMeanSquare()\ const\ noexcept\ \{}
\DoxyCodeLine{03457\ \ \ \ \ \textcolor{keywordflow}{return}\ mNormalizedRootMeanSquare;}
\DoxyCodeLine{03458\ \}}
\DoxyCodeLine{03459\ }
\DoxyCodeLine{03460\ \textcolor{keywordtype}{bool}\ BigO::operator<(BigO\ \textcolor{keyword}{const}\&\ other)\ \textcolor{keyword}{const}\ \textcolor{keyword}{noexcept}\ \{}
\DoxyCodeLine{03461\ \ \ \ \ \textcolor{keywordflow}{return}\ std::tie(mNormalizedRootMeanSquare,\ mName)\ <\ std::tie(other.mNormalizedRootMeanSquare,\ other.mName);}
\DoxyCodeLine{03462\ \}}
\DoxyCodeLine{03463\ }
\DoxyCodeLine{03464\ std::ostream\&\ operator<<(std::ostream\&\ os,\ BigO\ \textcolor{keyword}{const}\&\ bigO)\ \{}
\DoxyCodeLine{03465\ \ \ \ \ \textcolor{keywordflow}{return}\ os\ <<\ bigO.constant()\ <<\ \textcolor{stringliteral}{"{}\ *\ "{}}\ <<\ bigO.name()\ <<\ \textcolor{stringliteral}{"{},\ rms="{}}\ <<\ bigO.normalizedRootMeanSquare();}
\DoxyCodeLine{03466\ \}}
\DoxyCodeLine{03467\ }
\DoxyCodeLine{03468\ std::ostream\&\ operator<<(std::ostream\&\ os,\ std::vector<ankerl::nanobench::BigO>\ \textcolor{keyword}{const}\&\ bigOs)\ \{}
\DoxyCodeLine{03469\ \ \ \ \ detail::fmt::StreamStateRestorer\ \textcolor{keyword}{const}\ restorer(os);}
\DoxyCodeLine{03470\ \ \ \ \ os\ <<\ std::endl\ <<\ \textcolor{stringliteral}{"{}|\ \ \ coefficient\ |\ \ \ err\%\ |\ complexity"{}}\ <<\ std::endl\ <<\ \textcolor{stringliteral}{"{}|-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/:|-\/-\/-\/-\/-\/-\/-\/:|-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/"{}}\ <<\ std::endl;}
\DoxyCodeLine{03471\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ \textcolor{keyword}{const}\&\ bigO\ :\ bigOs)\ \{}
\DoxyCodeLine{03472\ \ \ \ \ \ \ \ \ os\ <<\ \textcolor{stringliteral}{"{}|"{}}\ <<\ std::setw(14)\ <<\ std::setprecision(7)\ <<\ std::scientific\ <<\ bigO.constant()\ <<\ \textcolor{stringliteral}{"{}\ "{}};}
\DoxyCodeLine{03473\ \ \ \ \ \ \ \ \ os\ <<\ \textcolor{stringliteral}{"{}|"{}}\ <<\ detail::fmt::Number(6,\ 1,\ bigO.normalizedRootMeanSquare()\ *\ 100.0)\ <<\ \textcolor{stringliteral}{"{}\%\ "{}};}
\DoxyCodeLine{03474\ \ \ \ \ \ \ \ \ os\ <<\ \textcolor{stringliteral}{"{}|\ "{}}\ <<\ bigO.name();}
\DoxyCodeLine{03475\ \ \ \ \ \ \ \ \ os\ <<\ std::endl;}
\DoxyCodeLine{03476\ \ \ \ \ \}}
\DoxyCodeLine{03477\ \ \ \ \ \textcolor{keywordflow}{return}\ os;}
\DoxyCodeLine{03478\ \}}
\DoxyCodeLine{03479\ }
\DoxyCodeLine{03480\ \}\ \textcolor{comment}{//\ namespace\ nanobench}}
\DoxyCodeLine{03481\ \}\ \textcolor{comment}{//\ namespace\ ankerl}}
\DoxyCodeLine{03482\ }
\DoxyCodeLine{03483\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//\ ANKERL\_NANOBENCH\_IMPLEMENT}}
\DoxyCodeLine{03484\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//\ ANKERL\_NANOBENCH\_H\_INCLUDED}}

\end{DoxyCode}
