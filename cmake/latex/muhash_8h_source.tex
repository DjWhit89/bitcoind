\doxysection{muhash.\+h}
\label{muhash_8h_source}\index{src/crypto/muhash.h@{src/crypto/muhash.h}}
\textbf{ Go to the documentation of this file.}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{//\ Copyright\ (c)\ 2017-\/present\ The\ Bitcoin\ Core\ developers}}
\DoxyCodeLine{00002\ \textcolor{comment}{//\ Distributed\ under\ the\ MIT\ software\ license,\ see\ the\ accompanying}}
\DoxyCodeLine{00003\ \textcolor{comment}{//\ file\ COPYING\ or\ http://www.opensource.org/licenses/mit-\/license.php.}}
\DoxyCodeLine{00004\ }
\DoxyCodeLine{00005\ \textcolor{preprocessor}{\#ifndef\ BITCOIN\_CRYPTO\_MUHASH\_H}}
\DoxyCodeLine{00006\ \textcolor{preprocessor}{\#define\ BITCOIN\_CRYPTO\_MUHASH\_H}}
\DoxyCodeLine{00007\ }
\DoxyCodeLine{00008\ \textcolor{preprocessor}{\#include\ <serialize.h>}}
\DoxyCodeLine{00009\ }
\DoxyCodeLine{00010\ \textcolor{preprocessor}{\#include\ <cstddef>}}
\DoxyCodeLine{00011\ \textcolor{preprocessor}{\#include\ <cstdint>}}
\DoxyCodeLine{00012\ \textcolor{preprocessor}{\#include\ <span>}}
\DoxyCodeLine{00013\ }
\DoxyCodeLine{00014\ \textcolor{keyword}{class\ }uint256;}
\DoxyCodeLine{00015\ }
\DoxyCodeLine{00016\ \textcolor{keyword}{class\ }Num3072}
\DoxyCodeLine{00017\ \{}
\DoxyCodeLine{00018\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00019\ \ \ \ \ \textcolor{keywordtype}{void}\ FullReduce();}
\DoxyCodeLine{00020\ \ \ \ \ \textcolor{keywordtype}{bool}\ IsOverflow()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00021\ \ \ \ \ Num3072\ GetInverse()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00022\ }
\DoxyCodeLine{00023\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00024\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{size\_t}\ BYTE\_SIZE\ =\ 384;}
\DoxyCodeLine{00025\ }
\DoxyCodeLine{00026\ \textcolor{preprocessor}{\#ifdef\ \_\_SIZEOF\_INT128\_\_}}
\DoxyCodeLine{00027\ \ \ \ \ \textcolor{keyword}{typedef}\ \textcolor{keywordtype}{unsigned}\ \_\_int128\ double\_limb\_t;}
\DoxyCodeLine{00028\ \ \ \ \ \textcolor{keyword}{typedef}\ \textcolor{keywordtype}{signed}\ \_\_int128\ signed\_double\_limb\_t;}
\DoxyCodeLine{00029\ \ \ \ \ \textcolor{keyword}{typedef}\ uint64\_t\ limb\_t;}
\DoxyCodeLine{00030\ \ \ \ \ \textcolor{keyword}{typedef}\ int64\_t\ signed\_limb\_t;}
\DoxyCodeLine{00031\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{int}\ LIMBS\ =\ 48;}
\DoxyCodeLine{00032\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{int}\ SIGNED\_LIMBS\ =\ 50;}
\DoxyCodeLine{00033\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{int}\ LIMB\_SIZE\ =\ 64;}
\DoxyCodeLine{00034\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{int}\ SIGNED\_LIMB\_SIZE\ =\ 62;}
\DoxyCodeLine{00035\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00036\ \ \ \ \ \textcolor{keyword}{typedef}\ uint64\_t\ double\_limb\_t;}
\DoxyCodeLine{00037\ \ \ \ \ \textcolor{keyword}{typedef}\ int64\_t\ signed\_double\_limb\_t;}
\DoxyCodeLine{00038\ \ \ \ \ \textcolor{keyword}{typedef}\ uint32\_t\ limb\_t;}
\DoxyCodeLine{00039\ \ \ \ \ \textcolor{keyword}{typedef}\ int32\_t\ signed\_limb\_t;}
\DoxyCodeLine{00040\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{int}\ LIMBS\ =\ 96;}
\DoxyCodeLine{00041\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{int}\ SIGNED\_LIMBS\ =\ 103;}
\DoxyCodeLine{00042\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{int}\ LIMB\_SIZE\ =\ 32;}
\DoxyCodeLine{00043\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{int}\ SIGNED\_LIMB\_SIZE\ =\ 30;}
\DoxyCodeLine{00044\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00045\ \ \ \ \ limb\_t\ limbs[LIMBS];}
\DoxyCodeLine{00046\ }
\DoxyCodeLine{00047\ \ \ \ \ \textcolor{comment}{//\ Sanity\ check\ for\ Num3072\ constants}}
\DoxyCodeLine{00048\ \ \ \ \ \textcolor{keyword}{static\_assert}(LIMB\_SIZE\ *\ LIMBS\ ==\ 3072,\ \textcolor{stringliteral}{"{}Num3072\ isn't\ 3072\ bits"{}});}
\DoxyCodeLine{00049\ \ \ \ \ \textcolor{keyword}{static\_assert}(\textcolor{keyword}{sizeof}(double\_limb\_t)\ ==\ \textcolor{keyword}{sizeof}(limb\_t)\ *\ 2,\ \textcolor{stringliteral}{"{}bad\ size\ for\ double\_limb\_t"{}});}
\DoxyCodeLine{00050\ \ \ \ \ \textcolor{keyword}{static\_assert}(\textcolor{keyword}{sizeof}(limb\_t)\ *\ 8\ ==\ LIMB\_SIZE,\ \textcolor{stringliteral}{"{}LIMB\_SIZE\ is\ incorrect"{}});}
\DoxyCodeLine{00051\ \ \ \ \ \textcolor{keyword}{static\_assert}(SIGNED\_LIMB\_SIZE\ *\ SIGNED\_LIMBS\ >\ 3072,\ \textcolor{stringliteral}{"{}SIGNED\_LIMBS\ *\ SIGNED\_LIMB\_SIZE\ is\ too\ small"{}});}
\DoxyCodeLine{00052\ \ \ \ \ \textcolor{keyword}{static\_assert}(3072\ /\ SIGNED\_LIMB\_SIZE\ ==\ SIGNED\_LIMBS\ -\/\ 1,\ \textcolor{stringliteral}{"{}Bit\ 3072\ must\ land\ in\ top\ signed\ limb"{}});}
\DoxyCodeLine{00053\ }
\DoxyCodeLine{00054\ \ \ \ \ \textcolor{comment}{//\ Hard\ coded\ values\ in\ MuHash3072\ constructor\ and\ Finalize}}
\DoxyCodeLine{00055\ \ \ \ \ \textcolor{keyword}{static\_assert}(\textcolor{keyword}{sizeof}(limb\_t)\ ==\ 4\ ||\ \textcolor{keyword}{sizeof}(limb\_t)\ ==\ 8,\ \textcolor{stringliteral}{"{}bad\ size\ for\ limb\_t"{}});}
\DoxyCodeLine{00056\ }
\DoxyCodeLine{00057\ \ \ \ \ \textcolor{keywordtype}{void}\ Multiply(\textcolor{keyword}{const}\ Num3072\&\ a);}
\DoxyCodeLine{00058\ \ \ \ \ \textcolor{keywordtype}{void}\ Divide(\textcolor{keyword}{const}\ Num3072\&\ a);}
\DoxyCodeLine{00059\ \ \ \ \ \textcolor{keywordtype}{void}\ SetToOne();}
\DoxyCodeLine{00060\ \ \ \ \ \textcolor{keywordtype}{void}\ ToBytes(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ (\&out)[BYTE\_SIZE]);}
\DoxyCodeLine{00061\ }
\DoxyCodeLine{00062\ \ \ \ \ Num3072()\ \{\ this-\/>SetToOne();\ \};}
\DoxyCodeLine{00063\ \ \ \ \ Num3072(\textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ (\&data)[BYTE\_SIZE]);}
\DoxyCodeLine{00064\ }
\DoxyCodeLine{00065\ \ \ \ \ SERIALIZE\_METHODS(Num3072,\ obj)}
\DoxyCodeLine{00066\ \ \ \ \ \{}
\DoxyCodeLine{00067\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\&\ limb\ :\ obj.limbs)\ \{}
\DoxyCodeLine{00068\ \ \ \ \ \ \ \ \ \ \ \ \ READWRITE(limb);}
\DoxyCodeLine{00069\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00070\ \ \ \ \ \}}
\DoxyCodeLine{00071\ \};}
\DoxyCodeLine{00072\ }
\DoxyCodeLine{00102\ \textcolor{keyword}{class\ }MuHash3072}
\DoxyCodeLine{00103\ \{}
\DoxyCodeLine{00104\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00105\ \ \ \ \ Num3072\ m\_numerator;}
\DoxyCodeLine{00106\ \ \ \ \ Num3072\ m\_denominator;}
\DoxyCodeLine{00107\ }
\DoxyCodeLine{00108\ \ \ \ \ Num3072\ ToNum3072(std::span<const\ unsigned\ char>\ in);}
\DoxyCodeLine{00109\ }
\DoxyCodeLine{00110\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00111\ \ \ \ \ \textcolor{comment}{/*\ The\ empty\ set.\ */}}
\DoxyCodeLine{00112\ \ \ \ \ MuHash3072()\ noexcept\ =\ default;}
\DoxyCodeLine{00113\ }
\DoxyCodeLine{00114\ \ \ \ \ \textcolor{comment}{/*\ A\ singleton\ with\ variable\ sized\ data\ in\ it.\ */}}
\DoxyCodeLine{00115\ \ \ \ \ explicit\ MuHash3072(std::span<const\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}>\ in)\ noexcept;}
\DoxyCodeLine{00116\ }
\DoxyCodeLine{00117\ \ \ \ \ \textcolor{comment}{/*\ Insert\ a\ single\ piece\ of\ data\ into\ the\ set.\ */}}
\DoxyCodeLine{00118\ \ \ \ \ MuHash3072\&\ Insert(std::span<const\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}>\ in)\ noexcept;}
\DoxyCodeLine{00119\ }
\DoxyCodeLine{00120\ \ \ \ \ \textcolor{comment}{/*\ Remove\ a\ single\ piece\ of\ data\ from\ the\ set.\ */}}
\DoxyCodeLine{00121\ \ \ \ \ MuHash3072\&\ Remove(std::span<const\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}>\ in)\ noexcept;}
\DoxyCodeLine{00122\ }
\DoxyCodeLine{00123\ \ \ \ \ \textcolor{comment}{/*\ Multiply\ (resulting\ in\ a\ hash\ for\ the\ union\ of\ the\ sets)\ */}}
\DoxyCodeLine{00124\ \ \ \ \ MuHash3072\&\ operator*=(const\ MuHash3072\&\ mul)\ noexcept;}
\DoxyCodeLine{00125\ }
\DoxyCodeLine{00126\ \ \ \ \ \textcolor{comment}{/*\ Divide\ (resulting\ in\ a\ hash\ for\ the\ difference\ of\ the\ sets)\ */}}
\DoxyCodeLine{00127\ \ \ \ \ MuHash3072\&\ operator/=(const\ MuHash3072\&\ div)\ noexcept;}
\DoxyCodeLine{00128\ }
\DoxyCodeLine{00129\ \ \ \ \ \textcolor{comment}{/*\ Finalize\ into\ a\ 32-\/byte\ hash.\ Does\ not\ change\ this\ object's\ value.\ */}}
\DoxyCodeLine{00130\ \ \ \ \ \textcolor{keywordtype}{void}\ Finalize(uint256\&\ out)\ noexcept;}
\DoxyCodeLine{00131\ }
\DoxyCodeLine{00132\ \ \ \ \ SERIALIZE\_METHODS(MuHash3072,\ obj)}
\DoxyCodeLine{00133\ \ \ \ \ \{}
\DoxyCodeLine{00134\ \ \ \ \ \ \ \ \ READWRITE(obj.m\_numerator);}
\DoxyCodeLine{00135\ \ \ \ \ \ \ \ \ READWRITE(obj.m\_denominator);}
\DoxyCodeLine{00136\ \ \ \ \ \}}
\DoxyCodeLine{00137\ \};}
\DoxyCodeLine{00138\ }
\DoxyCodeLine{00139\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//\ BITCOIN\_CRYPTO\_MUHASH\_H}}

\end{DoxyCode}
