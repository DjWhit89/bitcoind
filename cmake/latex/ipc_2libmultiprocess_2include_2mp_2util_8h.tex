\doxysection{src/ipc/libmultiprocess/include/mp/util.h File Reference}
\label{ipc_2libmultiprocess_2include_2mp_2util_8h}\index{src/ipc/libmultiprocess/include/mp/util.h@{src/ipc/libmultiprocess/include/mp/util.h}}
{\ttfamily \#include $<$capnp/schema.\+h$>$}\newline
{\ttfamily \#include $<$cassert$>$}\newline
{\ttfamily \#include $<$cstddef$>$}\newline
{\ttfamily \#include $<$cstring$>$}\newline
{\ttfamily \#include $<$functional$>$}\newline
{\ttfamily \#include $<$kj/string-\/tree.\+h$>$}\newline
{\ttfamily \#include $<$mutex$>$}\newline
{\ttfamily \#include $<$string$>$}\newline
{\ttfamily \#include $<$tuple$>$}\newline
{\ttfamily \#include $<$type\+\_\+traits$>$}\newline
{\ttfamily \#include $<$utility$>$}\newline
{\ttfamily \#include $<$variant$>$}\newline
{\ttfamily \#include $<$vector$>$}\newline
\doxysubsubsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \textbf{ Type\+List$<$ Types $>$}
\begin{DoxyCompactList}\small\item\em Generic utility functions used by capnp code. \end{DoxyCompactList}\item 
struct \textbf{ Split$<$ 0, \+\_\+\+Second, \+\_\+\+First, true $>$}
\begin{DoxyCompactList}\small\item\em Specialization of above (base case). \end{DoxyCompactList}\item 
struct \textbf{ Split$<$ index, Type\+List$<$ Type, \+\_\+\+Second... $>$, Type\+List$<$ \+\_\+\+First... $>$, false $>$}
\begin{DoxyCompactList}\small\item\em Specialization of above (recursive case). \end{DoxyCompactList}\item 
struct \textbf{ \+\_\+\+Require$<$ Sfinae\+Expr, Result\+\_\+ $>$}
\begin{DoxyCompactList}\small\item\em SFINAE helper, see using \doxyref{Require}{p.}{namespacemp_ac29fd06630f0d8696d1c55dc964dcb9a} below. \end{DoxyCompactList}\item 
struct \textbf{ Priority$<$ priority $>$}
\item 
struct \textbf{ Priority$<$ 0 $>$}
\begin{DoxyCompactList}\small\item\em Specialization of above (base case). \end{DoxyCompactList}\item 
struct \textbf{ Ptr\+Or\+Value$<$ T $>$}
\begin{DoxyCompactList}\small\item\em Convenient wrapper around std\+::variant$<$\+T$\ast$, T$>$. \end{DoxyCompactList}\item 
class \textbf{ Lock}
\item 
struct \textbf{ Guarded\+Ref$<$ T $>$}
\item 
struct \textbf{ Unlock\+Guard$<$ Lock $>$}
\begin{DoxyCompactList}\small\item\em Analog to std\+::lock\+\_\+guard that unlocks instead of locks. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Namespaces}
\begin{DoxyCompactItemize}
\item 
namespace \textbf{ mp}
\begin{DoxyCompactList}\small\item\em Functions to serialize / deserialize common bitcoin types. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \textbf{ MP\+\_\+\+TSA}(x)
\item 
\#define \textbf{ MP\+\_\+\+CAPABILITY}(x)
\item 
\#define \textbf{ MP\+\_\+\+SCOPED\+\_\+\+CAPABILITY}~\textbf{ MP\+\_\+\+TSA}(scoped\+\_\+lockable)
\item 
\#define \textbf{ MP\+\_\+\+REQUIRES}(x)
\item 
\#define \textbf{ MP\+\_\+\+ACQUIRE}(...)
\item 
\#define \textbf{ MP\+\_\+\+RELEASE}(...)
\item 
\#define \textbf{ MP\+\_\+\+ASSERT\+\_\+\+CAPABILITY}(x)
\item 
\#define \textbf{ MP\+\_\+\+GUARDED\+\_\+\+BY}(x)
\item 
\#define \textbf{ MP\+\_\+\+NO\+\_\+\+TSA}~\textbf{ MP\+\_\+\+TSA}(no\+\_\+thread\+\_\+safety\+\_\+analysis)
\end{DoxyCompactItemize}
\doxysubsubsection*{Typedefs}
\begin{DoxyCompactItemize}
\item 
{\footnotesize template$<$typename Callable$>$ }\\using \textbf{ Result\+Of} = decltype(std\+::declval$<$Callable$>$()())
\begin{DoxyCompactList}\small\item\em Type helper giving return type of a callable type. \end{DoxyCompactList}\item 
{\footnotesize template$<$typename \textbf{ T}$>$ }\\using \textbf{ Remove\+Cv\+Ref} = std\+::remove\+\_\+cv\+\_\+t$<$std\+::remove\+\_\+reference\+\_\+t$<$\textbf{ T}$>$$>$
\begin{DoxyCompactList}\small\item\em Substitutue for std\+::remove\+\_\+cvref\+\_\+t. \end{DoxyCompactList}\item 
{\footnotesize template$<$typename \textbf{ T}$>$ }\\using \textbf{ Decay} = std\+::decay\+\_\+t$<$\textbf{ T}$>$
\begin{DoxyCompactList}\small\item\em Type helper abbreviating std\+::decay. \end{DoxyCompactList}\item 
{\footnotesize template$<$typename Sfinae\+Expr, typename Result = void$>$ }\\using \textbf{ Require} = typename \textbf{ \+\_\+\+Require}$<$Sfinae\+Expr, Result$>$\+::\+Result
\begin{DoxyCompactList}\small\item\em SFINAE helper, basically the same as to C++17\textquotesingle{}s void\+\_\+t, but allowing types other than void to be returned. \end{DoxyCompactList}\item 
using \textbf{ Fd\+To\+Args\+Fn} = std\+::function$<$std\+::vector$<$std\+::string$>$(int fd)$>$
\begin{DoxyCompactList}\small\item\em Callback type used by Spawn\+Process below. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
{\footnotesize template$<$template$<$ typename... $>$ class Class, typename... Types, typename... Args$>$ }\\Class$<$ Types..., std\+::remove\+\_\+reference\+\_\+t$<$ Args $>$... $>$ \textbf{ Make} (Args \&\&... \textbf{ args})
\item 
{\footnotesize template$<$typename \textbf{ T}$>$ }\\const char $\ast$ \textbf{ Type\+Name} ()
\begin{DoxyCompactList}\small\item\em Return capnp type name with filename prefix removed. \end{DoxyCompactList}\item 
class \textbf{ MP\+\_\+\+CAPABILITY} ("{}mutex"{}) \textbf{ Mutex}
\item 
{\footnotesize template$<$class U$>$ }\\\textbf{ Guarded\+Ref} (\textbf{ Mutex} \&, U \&) -\/$>$ Guarded\+Ref$<$ U $>$
\item 
{\footnotesize template$<$typename \textbf{ Lock}, typename Callback$>$ }\\void \textbf{ Unlock} (\textbf{ Lock} \&lock, Callback \&\&callback)
\item 
std\+::string \textbf{ Thread\+Name} (const char $\ast$exe\+\_\+name)
\begin{DoxyCompactList}\small\item\em \doxyref{Format}{p.}{struct_format} current thread name as "{}\{exe\+\_\+name\}-\/\{\$pid\}/\{thread\+\_\+name\}-\/\{\$tid\}"{}. \end{DoxyCompactList}\item 
std\+::string \textbf{ Log\+Escape} (const kj\+::\+String\+Tree \&string, size\+\_\+t max\+\_\+size)
\item 
int \textbf{ Spawn\+Process} (int \&pid, \textbf{ Fd\+To\+Args\+Fn} \&\&fd\+\_\+to\+\_\+args)
\item 
void \textbf{ Exec\+Process} (const std\+::vector$<$ std\+::string $>$ \&\textbf{ args})
\begin{DoxyCompactList}\small\item\em Call execvp with vector args. \end{DoxyCompactList}\item 
int \textbf{ Wait\+Process} (int pid)
\begin{DoxyCompactList}\small\item\em Wait for a process to exit and return its exit code. \end{DoxyCompactList}\item 
char $\ast$ \textbf{ Char\+Cast} (char $\ast$c)
\item 
char $\ast$ \textbf{ Char\+Cast} (unsigned char $\ast$c)
\item 
const char $\ast$ \textbf{ Char\+Cast} (const char $\ast$c)
\item 
const char $\ast$ \textbf{ Char\+Cast} (const unsigned char $\ast$c)
\end{DoxyCompactItemize}


\label{doc-define-members}
\doxysubsection{Macro Definition Documentation}
\index{util.h@{util.h}!MP\_ACQUIRE@{MP\_ACQUIRE}}
\index{MP\_ACQUIRE@{MP\_ACQUIRE}!util.h@{util.h}}
\doxysubsubsection{MP\_ACQUIRE}
{\footnotesize\ttfamily \label{ipc_2libmultiprocess_2include_2mp_2util_8h_a882ce554809b67863b45c972e7ed19e8} 
\#define MP\+\_\+\+ACQUIRE(\begin{DoxyParamCaption}\item[{}]{}...{}\end{DoxyParamCaption})}

{\bfseries Value\+:}
\begin{DoxyCode}{0}
\DoxyCodeLine{MP\_TSA(acquire\_capability(\_\_VA\_ARGS\_\_))}

\end{DoxyCode}
\index{util.h@{util.h}!MP\_ASSERT\_CAPABILITY@{MP\_ASSERT\_CAPABILITY}}
\index{MP\_ASSERT\_CAPABILITY@{MP\_ASSERT\_CAPABILITY}!util.h@{util.h}}
\doxysubsubsection{MP\_ASSERT\_CAPABILITY}
{\footnotesize\ttfamily \label{ipc_2libmultiprocess_2include_2mp_2util_8h_ae75e51222e61870c565fd7a9b5bbdf5d} 
\#define MP\+\_\+\+ASSERT\+\_\+\+CAPABILITY(\begin{DoxyParamCaption}\item[{}]{x}{}\end{DoxyParamCaption})}

{\bfseries Value\+:}
\begin{DoxyCode}{0}
\DoxyCodeLine{MP\_TSA(assert\_capability(x))}

\end{DoxyCode}
\index{util.h@{util.h}!MP\_CAPABILITY@{MP\_CAPABILITY}}
\index{MP\_CAPABILITY@{MP\_CAPABILITY}!util.h@{util.h}}
\doxysubsubsection{MP\_CAPABILITY}
{\footnotesize\ttfamily \label{ipc_2libmultiprocess_2include_2mp_2util_8h_aa3feb300aeff2dc93bde3ff8db17e3eb} 
\#define MP\+\_\+\+CAPABILITY(\begin{DoxyParamCaption}\item[{}]{x}{}\end{DoxyParamCaption})}

{\bfseries Value\+:}
\begin{DoxyCode}{0}
\DoxyCodeLine{MP\_TSA(capability(x))}

\end{DoxyCode}
\index{util.h@{util.h}!MP\_GUARDED\_BY@{MP\_GUARDED\_BY}}
\index{MP\_GUARDED\_BY@{MP\_GUARDED\_BY}!util.h@{util.h}}
\doxysubsubsection{MP\_GUARDED\_BY}
{\footnotesize\ttfamily \label{ipc_2libmultiprocess_2include_2mp_2util_8h_a14631e653704dabeb569935f66827ebb} 
\#define MP\+\_\+\+GUARDED\+\_\+\+BY(\begin{DoxyParamCaption}\item[{}]{x}{}\end{DoxyParamCaption})}

{\bfseries Value\+:}
\begin{DoxyCode}{0}
\DoxyCodeLine{MP\_TSA(guarded\_by(x))}

\end{DoxyCode}
\index{util.h@{util.h}!MP\_NO\_TSA@{MP\_NO\_TSA}}
\index{MP\_NO\_TSA@{MP\_NO\_TSA}!util.h@{util.h}}
\doxysubsubsection{MP\_NO\_TSA}
{\footnotesize\ttfamily \label{ipc_2libmultiprocess_2include_2mp_2util_8h_a24f90b18e6edcf5858a822cda265e92e} 
\#define MP\+\_\+\+NO\+\_\+\+TSA~\textbf{ MP\+\_\+\+TSA}(no\+\_\+thread\+\_\+safety\+\_\+analysis)}

\index{util.h@{util.h}!MP\_RELEASE@{MP\_RELEASE}}
\index{MP\_RELEASE@{MP\_RELEASE}!util.h@{util.h}}
\doxysubsubsection{MP\_RELEASE}
{\footnotesize\ttfamily \label{ipc_2libmultiprocess_2include_2mp_2util_8h_a0fdb0c11aa98963e9ef8a150ea1c10f4} 
\#define MP\+\_\+\+RELEASE(\begin{DoxyParamCaption}\item[{}]{}...{}\end{DoxyParamCaption})}

{\bfseries Value\+:}
\begin{DoxyCode}{0}
\DoxyCodeLine{MP\_TSA(release\_capability(\_\_VA\_ARGS\_\_))}

\end{DoxyCode}
\index{util.h@{util.h}!MP\_REQUIRES@{MP\_REQUIRES}}
\index{MP\_REQUIRES@{MP\_REQUIRES}!util.h@{util.h}}
\doxysubsubsection{MP\_REQUIRES}
{\footnotesize\ttfamily \label{ipc_2libmultiprocess_2include_2mp_2util_8h_a6b530c2b9c91ae9a26983477097f38dd} 
\#define MP\+\_\+\+REQUIRES(\begin{DoxyParamCaption}\item[{}]{x}{}\end{DoxyParamCaption})}

{\bfseries Value\+:}
\begin{DoxyCode}{0}
\DoxyCodeLine{MP\_TSA(requires\_capability(x))}

\end{DoxyCode}
\index{util.h@{util.h}!MP\_SCOPED\_CAPABILITY@{MP\_SCOPED\_CAPABILITY}}
\index{MP\_SCOPED\_CAPABILITY@{MP\_SCOPED\_CAPABILITY}!util.h@{util.h}}
\doxysubsubsection{MP\_SCOPED\_CAPABILITY}
{\footnotesize\ttfamily \label{ipc_2libmultiprocess_2include_2mp_2util_8h_a69c4557b327652671a5d6670ddb4aa0e} 
\#define MP\+\_\+\+SCOPED\+\_\+\+CAPABILITY~\textbf{ MP\+\_\+\+TSA}(scoped\+\_\+lockable)}

\index{util.h@{util.h}!MP\_TSA@{MP\_TSA}}
\index{MP\_TSA@{MP\_TSA}!util.h@{util.h}}
\doxysubsubsection{MP\_TSA}
{\footnotesize\ttfamily \label{ipc_2libmultiprocess_2include_2mp_2util_8h_a0a9e4232907734e9f1ccf86b450de916} 
\#define MP\+\_\+\+TSA(\begin{DoxyParamCaption}\item[{}]{x}{}\end{DoxyParamCaption})}

