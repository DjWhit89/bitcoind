\doxysection{assumptions.\+h}
\label{secp256k1_2src_2assumptions_8h_source}\index{src/secp256k1/src/assumptions.h@{src/secp256k1/src/assumptions.h}}
\textbf{ Go to the documentation of this file.}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{/***********************************************************************}}
\DoxyCodeLine{00002\ \textcolor{comment}{\ *\ Copyright\ (c)\ 2020\ Pieter\ Wuille\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *}}
\DoxyCodeLine{00003\ \textcolor{comment}{\ *\ Distributed\ under\ the\ MIT\ software\ license,\ see\ the\ accompanying\ \ \ \ *}}
\DoxyCodeLine{00004\ \textcolor{comment}{\ *\ file\ COPYING\ or\ https://www.opensource.org/licenses/mit-\/license.php.*}}
\DoxyCodeLine{00005\ \textcolor{comment}{\ ***********************************************************************/}}
\DoxyCodeLine{00006\ }
\DoxyCodeLine{00007\ \textcolor{preprocessor}{\#ifndef\ SECP256K1\_ASSUMPTIONS\_H}}
\DoxyCodeLine{00008\ \textcolor{preprocessor}{\#define\ SECP256K1\_ASSUMPTIONS\_H}}
\DoxyCodeLine{00009\ }
\DoxyCodeLine{00010\ \textcolor{preprocessor}{\#include\ <limits.h>}}
\DoxyCodeLine{00011\ }
\DoxyCodeLine{00012\ \textcolor{preprocessor}{\#include\ "{}util.h"{}}}
\DoxyCodeLine{00013\ \textcolor{preprocessor}{\#if\ defined(SECP256K1\_INT128\_NATIVE)}}
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#include\ "{}int128\_native.h"{}}}
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00016\ }
\DoxyCodeLine{00017\ \textcolor{comment}{/*\ This\ library,\ like\ most\ software,\ relies\ on\ a\ number\ of\ compiler\ implementation\ defined\ (but\ not\ undefined)}}
\DoxyCodeLine{00018\ \textcolor{comment}{\ \ \ behaviours.\ Although\ the\ behaviours\ we\ require\ are\ essentially\ universal\ we\ test\ them\ specifically\ here\ to}}
\DoxyCodeLine{00019\ \textcolor{comment}{\ \ \ reduce\ the\ odds\ of\ experiencing\ an\ unwelcome\ surprise.}}
\DoxyCodeLine{00020\ \textcolor{comment}{*/}}
\DoxyCodeLine{00021\ }
\DoxyCodeLine{00022\ \textcolor{preprocessor}{\#if\ defined(\_\_has\_attribute)}}
\DoxyCodeLine{00023\ \textcolor{preprocessor}{\#\ if\ \_\_has\_attribute(\_\_unavailable\_\_)}}
\DoxyCodeLine{00024\ \_\_attribute\_\_((\_\_unavailable\_\_(\textcolor{stringliteral}{"{}Don't\ call\ this\ function.\ It\ only\ exists\ because\ STATIC\_ASSERT\ cannot\ be\ used\ outside\ a\ function."{}})))}
\DoxyCodeLine{00025\ \textcolor{preprocessor}{\#\ endif}}
\DoxyCodeLine{00026\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00027\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ secp256k1\_assumption\_checker(\textcolor{keywordtype}{void})\ \{}
\DoxyCodeLine{00028\ \ \ \ \ \textcolor{comment}{/*\ Bytes\ are\ 8\ bits.\ */}}
\DoxyCodeLine{00029\ \ \ \ \ STATIC\_ASSERT(CHAR\_BIT\ ==\ 8);}
\DoxyCodeLine{00030\ }
\DoxyCodeLine{00031\ \ \ \ \ \textcolor{comment}{/*\ No\ integer\ promotion\ for\ uint32\_t.\ This\ ensures\ that\ we\ can\ multiply\ uintXX\_t\ values\ where\ XX\ >=\ 32}}
\DoxyCodeLine{00032\ \textcolor{comment}{\ \ \ \ \ \ \ without\ signed\ overflow,\ which\ would\ be\ undefined\ behaviour.\ */}}
\DoxyCodeLine{00033\ \ \ \ \ STATIC\_ASSERT(UINT\_MAX\ <=\ UINT32\_MAX);}
\DoxyCodeLine{00034\ }
\DoxyCodeLine{00035\ \ \ \ \ \textcolor{comment}{/*\ Conversions\ from\ unsigned\ to\ signed\ outside\ of\ the\ bounds\ of\ the\ signed\ type\ are}}
\DoxyCodeLine{00036\ \textcolor{comment}{\ \ \ \ \ \ \ implementation-\/defined.\ Verify\ that\ they\ function\ as\ reinterpreting\ the\ lower}}
\DoxyCodeLine{00037\ \textcolor{comment}{\ \ \ \ \ \ \ bits\ of\ the\ input\ in\ two's\ complement\ notation.\ Do\ this\ for\ conversions:}}
\DoxyCodeLine{00038\ \textcolor{comment}{\ \ \ \ \ \ \ -\/\ from\ uint(N)\_t\ to\ int(N)\_t\ with\ negative\ result}}
\DoxyCodeLine{00039\ \textcolor{comment}{\ \ \ \ \ \ \ -\/\ from\ uint(2N)\_t\ to\ int(N)\_t\ with\ negative\ result}}
\DoxyCodeLine{00040\ \textcolor{comment}{\ \ \ \ \ \ \ -\/\ from\ int(2N)\_t\ to\ int(N)\_t\ with\ negative\ result}}
\DoxyCodeLine{00041\ \textcolor{comment}{\ \ \ \ \ \ \ -\/\ from\ int(2N)\_t\ to\ int(N)\_t\ with\ positive\ result\ */}}
\DoxyCodeLine{00042\ }
\DoxyCodeLine{00043\ \ \ \ \ \textcolor{comment}{/*\ To\ int8\_t.\ */}}
\DoxyCodeLine{00044\ \ \ \ \ STATIC\_ASSERT(((int8\_t)(uint8\_t)0xAB\ ==\ (int8\_t)-\/(int8\_t)0x55));}
\DoxyCodeLine{00045\ \ \ \ \ STATIC\_ASSERT((int8\_t)(uint16\_t)0xABCD\ ==\ (int8\_t)-\/(int8\_t)0x33);}
\DoxyCodeLine{00046\ \ \ \ \ STATIC\_ASSERT((int8\_t)(int16\_t)(uint16\_t)0xCDEF\ ==\ (int8\_t)(uint8\_t)0xEF);}
\DoxyCodeLine{00047\ \ \ \ \ STATIC\_ASSERT((int8\_t)(int16\_t)(uint16\_t)0x9234\ ==\ (int8\_t)(uint8\_t)0x34);}
\DoxyCodeLine{00048\ }
\DoxyCodeLine{00049\ \ \ \ \ \textcolor{comment}{/*\ To\ int16\_t.\ */}}
\DoxyCodeLine{00050\ \ \ \ \ STATIC\_ASSERT((int16\_t)(uint16\_t)0xBCDE\ ==\ (int16\_t)-\/(int16\_t)0x4322);}
\DoxyCodeLine{00051\ \ \ \ \ STATIC\_ASSERT((int16\_t)(uint32\_t)0xA1B2C3D4\ ==\ (int16\_t)-\/(int16\_t)0x3C2C);}
\DoxyCodeLine{00052\ \ \ \ \ STATIC\_ASSERT((int16\_t)(int32\_t)(uint32\_t)0xC1D2E3F4\ ==\ (int16\_t)(uint16\_t)0xE3F4);}
\DoxyCodeLine{00053\ \ \ \ \ STATIC\_ASSERT((int16\_t)(int32\_t)(uint32\_t)0x92345678\ ==\ (int16\_t)(uint16\_t)0x5678);}
\DoxyCodeLine{00054\ }
\DoxyCodeLine{00055\ \ \ \ \ \textcolor{comment}{/*\ To\ int32\_t.\ */}}
\DoxyCodeLine{00056\ \ \ \ \ STATIC\_ASSERT((int32\_t)(uint32\_t)0xB2C3D4E5\ ==\ (int32\_t)-\/(int32\_t)0x4D3C2B1B);}
\DoxyCodeLine{00057\ \ \ \ \ STATIC\_ASSERT((int32\_t)(uint64\_t)0xA123B456C789D012ULL\ ==\ (int32\_t)-\/(int32\_t)0x38762FEE);}
\DoxyCodeLine{00058\ \ \ \ \ STATIC\_ASSERT((int32\_t)(int64\_t)(uint64\_t)0xC1D2E3F4A5B6C7D8ULL\ ==\ (int32\_t)(uint32\_t)0xA5B6C7D8);}
\DoxyCodeLine{00059\ \ \ \ \ STATIC\_ASSERT((int32\_t)(int64\_t)(uint64\_t)0xABCDEF0123456789ULL\ ==\ (int32\_t)(uint32\_t)0x23456789);}
\DoxyCodeLine{00060\ }
\DoxyCodeLine{00061\ \ \ \ \ \textcolor{comment}{/*\ To\ int64\_t.\ */}}
\DoxyCodeLine{00062\ \ \ \ \ STATIC\_ASSERT((int64\_t)(uint64\_t)0xB123C456D789E012ULL\ ==\ (int64\_t)-\/(int64\_t)0x4EDC3BA928761FEEULL);}
\DoxyCodeLine{00063\ \textcolor{preprocessor}{\#if\ defined(SECP256K1\_INT128\_NATIVE)}}
\DoxyCodeLine{00064\ \ \ \ \ STATIC\_ASSERT((int64\_t)(((uint128\_t)0xA1234567B8901234ULL\ <<\ 64)\ +\ 0xC5678901D2345678ULL)\ ==\ (int64\_t)-\/(int64\_t)0x3A9876FE2DCBA988ULL);}
\DoxyCodeLine{00065\ \ \ \ \ STATIC\_ASSERT(((int64\_t)(int128\_t)(((uint128\_t)0xB1C2D3E4F5A6B7C8ULL\ <<\ 64)\ +\ 0xD9E0F1A2B3C4D5E6ULL))\ ==\ (int64\_t)(uint64\_t)0xD9E0F1A2B3C4D5E6ULL);}
\DoxyCodeLine{00066\ \ \ \ \ STATIC\_ASSERT(((int64\_t)(int128\_t)(((uint128\_t)0xABCDEF0123456789ULL\ <<\ 64)\ +\ 0x0123456789ABCDEFULL))\ ==\ (int64\_t)(uint64\_t)0x0123456789ABCDEFULL);}
\DoxyCodeLine{00067\ }
\DoxyCodeLine{00068\ \ \ \ \ \textcolor{comment}{/*\ To\ int128\_t.\ */}}
\DoxyCodeLine{00069\ \ \ \ \ STATIC\_ASSERT((int128\_t)(((uint128\_t)0xB1234567C8901234ULL\ <<\ 64)\ +\ 0xD5678901E2345678ULL)\ ==\ (int128\_t)(-\/(int128\_t)0x8E1648B3F50E80DCULL\ *\ 0x8E1648B3F50E80DDULL\ +\ 0x5EA688D5482F9464ULL));}
\DoxyCodeLine{00070\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00071\ }
\DoxyCodeLine{00072\ \ \ \ \ \textcolor{comment}{/*\ Right\ shift\ on\ negative\ signed\ values\ is\ implementation\ defined.\ Verify\ that\ it}}
\DoxyCodeLine{00073\ \textcolor{comment}{\ \ \ \ \ \ \ acts\ as\ a\ right\ shift\ in\ two's\ complement\ with\ sign\ extension\ (i.e\ duplicating}}
\DoxyCodeLine{00074\ \textcolor{comment}{\ \ \ \ \ \ \ the\ top\ bit\ into\ newly\ added\ bits).\ */}}
\DoxyCodeLine{00075\ \ \ \ \ STATIC\_ASSERT((((int8\_t)0xE8)\ >>\ 2)\ ==\ (int8\_t)(uint8\_t)0xFA);}
\DoxyCodeLine{00076\ \ \ \ \ STATIC\_ASSERT((((int16\_t)0xE9AC)\ >>\ 4)\ ==\ (int16\_t)(uint16\_t)0xFE9A);}
\DoxyCodeLine{00077\ \ \ \ \ STATIC\_ASSERT((((int32\_t)0x937C918A)\ >>\ 9)\ ==\ (int32\_t)(uint32\_t)0xFFC9BE48);}
\DoxyCodeLine{00078\ \ \ \ \ STATIC\_ASSERT((((int64\_t)0xA8B72231DF9CF4B9ULL)\ >>\ 19)\ ==\ (int64\_t)(uint64\_t)0xFFFFF516E4463BF3ULL);}
\DoxyCodeLine{00079\ \textcolor{preprocessor}{\#if\ defined(SECP256K1\_INT128\_NATIVE)}}
\DoxyCodeLine{00080\ \ \ \ \ STATIC\_ASSERT((((int128\_t)(((uint128\_t)0xCD833A65684A0DBCULL\ <<\ 64)\ +\ 0xB349312F71EA7637ULL))\ >>\ 39)\ ==\ (int128\_t)(((uint128\_t)0xFFFFFFFFFF9B0674ULL\ <<\ 64)\ +\ 0xCAD0941B79669262ULL));}
\DoxyCodeLine{00081\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00082\ }
\DoxyCodeLine{00083\ \ \ \ \ \textcolor{comment}{/*\ This\ function\ is\ not\ supposed\ to\ be\ called.\ */}}
\DoxyCodeLine{00084\ \ \ \ \ VERIFY\_CHECK(0);}
\DoxyCodeLine{00085\ \}}
\DoxyCodeLine{00086\ }
\DoxyCodeLine{00087\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{/*\ SECP256K1\_ASSUMPTIONS\_H\ */}\textcolor{preprocessor}{}}

\end{DoxyCode}
