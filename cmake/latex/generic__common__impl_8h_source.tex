\doxysection{generic\+\_\+common\+\_\+impl.\+h}
\label{generic__common__impl_8h_source}\index{src/minisketch/src/fields/generic\_common\_impl.h@{src/minisketch/src/fields/generic\_common\_impl.h}}
\textbf{ Go to the documentation of this file.}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{/**********************************************************************}}
\DoxyCodeLine{00002\ \textcolor{comment}{\ *\ Copyright\ (c)\ 2018\ Pieter\ Wuille,\ Greg\ Maxwell,\ Gleb\ Naumenko\ \ \ \ \ \ *}}
\DoxyCodeLine{00003\ \textcolor{comment}{\ *\ Distributed\ under\ the\ MIT\ software\ license,\ see\ the\ accompanying\ \ \ *}}
\DoxyCodeLine{00004\ \textcolor{comment}{\ *\ file\ LICENSE\ or\ http://www.opensource.org/licenses/mit-\/license.php.*}}
\DoxyCodeLine{00005\ \textcolor{comment}{\ **********************************************************************/}}
\DoxyCodeLine{00006\ }
\DoxyCodeLine{00007\ \textcolor{preprocessor}{\#ifndef\ \_MINISKETCH\_FIELDS\_GENERIC\_COMMON\_IMPL\_H\_}}
\DoxyCodeLine{00008\ \textcolor{preprocessor}{\#define\ \_MINISKETCH\_FIELDS\_GENERIC\_COMMON\_IMPL\_H\_\ 1}}
\DoxyCodeLine{00009\ }
\DoxyCodeLine{00010\ \textcolor{preprocessor}{\#include\ <stdint.h>}}
\DoxyCodeLine{00011\ }
\DoxyCodeLine{00012\ \textcolor{preprocessor}{\#include\ "{}../int\_utils.h"{}}}
\DoxyCodeLine{00013\ \textcolor{preprocessor}{\#include\ "{}../lintrans.h"{}}}
\DoxyCodeLine{00014\ }
\DoxyCodeLine{00015\ \textcolor{keyword}{namespace\ }\{}
\DoxyCodeLine{00016\ }
\DoxyCodeLine{00018\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ I,\ \textcolor{keywordtype}{int}\ B,\ u\textcolor{keywordtype}{int}32\_t\ MOD,\ \textcolor{keyword}{typename}\ F,\ \textcolor{keyword}{typename}\ T,\ const\ F*\ SQR,\ const\ F*\ QRT>\ \textcolor{keyword}{class\ }Field}
\DoxyCodeLine{00019\ \{}
\DoxyCodeLine{00020\ \ \ \ \ \textcolor{keyword}{typedef}\ BitsInt<I,\ B>\ O;}
\DoxyCodeLine{00021\ \ \ \ \ \textcolor{keyword}{typedef}\ LFSR<O,\ MOD>\ L;}
\DoxyCodeLine{00022\ }
\DoxyCodeLine{00023\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00024\ \ \ \ \ \textcolor{keyword}{typedef}\ I\ Elem;}
\DoxyCodeLine{00025\ \ \ \ \ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{int}\ Bits()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ B;\ \}}
\DoxyCodeLine{00026\ }
\DoxyCodeLine{00027\ \ \ \ \ \textcolor{keyword}{constexpr}\ \textcolor{keyword}{inline}\ Elem\ Mul2(Elem\ val)\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ L::Call(val);\ \}}
\DoxyCodeLine{00028\ }
\DoxyCodeLine{00029\ \ \ \ \ \textcolor{keyword}{class\ }Multiplier}
\DoxyCodeLine{00030\ \ \ \ \ \{}
\DoxyCodeLine{00031\ \ \ \ \ \ \ \ \ T\ table;}
\DoxyCodeLine{00032\ \ \ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00033\ \ \ \ \ \ \ \ \ \textcolor{keyword}{explicit}\ Multiplier(\textcolor{keyword}{const}\ Field\&,\ Elem\ a)\ \{\ table.template\ Build<L::Call>(a);\ \}}
\DoxyCodeLine{00034\ \ \ \ \ \ \ \ \ \textcolor{keyword}{constexpr}\ \textcolor{keyword}{inline}\ Elem\ operator()(Elem\ a)\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ table.template\ Map<O>(a);\ \}}
\DoxyCodeLine{00035\ \ \ \ \ \};}
\DoxyCodeLine{00036\ }
\DoxyCodeLine{00037\ \ \ \ \ Elem\ Mul(Elem\ a,\ Elem\ b)\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ GFMul<I,\ B,\ L,\ O>(a,\ b);\ \}}
\DoxyCodeLine{00038\ }
\DoxyCodeLine{00040\ \ \ \ \ \textcolor{keyword}{inline}\ \textcolor{keyword}{constexpr}\ Elem\ Sqr(Elem\ a)\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ SQR-\/>template\ Map<O>(a);\ \}}
\DoxyCodeLine{00041\ }
\DoxyCodeLine{00043\ \ \ \ \ \textcolor{keyword}{inline}\ \textcolor{keyword}{constexpr}\ Elem\ Qrt(Elem\ a)\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ QRT-\/>template\ Map<O>(a);\ \}}
\DoxyCodeLine{00044\ }
\DoxyCodeLine{00046\ \ \ \ \ Elem\ Inv(Elem\ a)\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ InvExtGCD<I,\ O,\ B,\ MOD>(a);\ \}}
\DoxyCodeLine{00047\ }
\DoxyCodeLine{00049\ \ \ \ \ Elem\ FromSeed(uint64\_t\ seed)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00050\ \ \ \ \ \ \ \ \ uint64\_t\ k0\ =\ 0x496e744669656c64ull;\ \textcolor{comment}{//\ "{}IntField"{}}}
\DoxyCodeLine{00051\ \ \ \ \ \ \ \ \ uint64\_t\ k1\ =\ seed;}
\DoxyCodeLine{00052\ \ \ \ \ \ \ \ \ uint64\_t\ count\ =\ ((uint64\_t)B)\ <<\ 32;}
\DoxyCodeLine{00053\ \ \ \ \ \ \ \ \ Elem\ ret;}
\DoxyCodeLine{00054\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{do}\ \{}
\DoxyCodeLine{00055\ \ \ \ \ \ \ \ \ \ \ \ \ ret\ =\ O::Mask(I(SipHash(k0,\ k1,\ count++)));}
\DoxyCodeLine{00056\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{while}(ret\ ==\ 0);}
\DoxyCodeLine{00057\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ ret;}
\DoxyCodeLine{00058\ \ \ \ \ \}}
\DoxyCodeLine{00059\ }
\DoxyCodeLine{00060\ \ \ \ \ Elem\ Deserialize(BitReader\&\ in)\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ in.template\ Read<B,\ I>();\ \}}
\DoxyCodeLine{00061\ }
\DoxyCodeLine{00062\ \ \ \ \ \textcolor{keywordtype}{void}\ Serialize(BitWriter\&\ out,\ Elem\ val)\textcolor{keyword}{\ const\ }\{\ out.template\ Write<B,\ I>(val);\ \}}
\DoxyCodeLine{00063\ }
\DoxyCodeLine{00064\ \ \ \ \ \textcolor{keyword}{constexpr}\ Elem\ FromUint64(uint64\_t\ x)\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ O::Mask(I(x));\ \}}
\DoxyCodeLine{00065\ \ \ \ \ \textcolor{keyword}{constexpr}\ uint64\_t\ ToUint64(Elem\ val)\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ uint64\_t(val);\ \}}
\DoxyCodeLine{00066\ \};}
\DoxyCodeLine{00067\ }
\DoxyCodeLine{00068\ \}}
\DoxyCodeLine{00069\ }
\DoxyCodeLine{00070\ \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}
