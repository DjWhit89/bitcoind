\doxysection{Disconnected\+Block\+Transactions Class Reference}
\label{class_disconnected_block_transactions}\index{DisconnectedBlockTransactions@{DisconnectedBlockTransactions}}


{\ttfamily \#include $<$disconnected\+\_\+transactions.\+h$>$}

\doxysubsubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\textbf{ Disconnected\+Block\+Transactions} (size\+\_\+t max\+\_\+mem\+\_\+usage)
\item 
\textbf{ $\sim$\+Disconnected\+Block\+Transactions} ()
\item 
size\+\_\+t \textbf{ Dynamic\+Memory\+Usage} () const
\item 
std\+::vector$<$ \textbf{ CTransaction\+Ref} $>$ \textbf{ Add\+Transactions\+From\+Block} (const std\+::vector$<$ \textbf{ CTransaction\+Ref} $>$ \&vtx)
\item 
void \textbf{ remove\+For\+Block} (const std\+::vector$<$ \textbf{ CTransaction\+Ref} $>$ \&vtx)
\item 
size\+\_\+t \textbf{ size} () const
\item 
void \textbf{ clear} ()
\item 
std\+::list$<$ \textbf{ CTransaction\+Ref} $>$ \textbf{ take} ()
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
\doxyref{Disconnected\+Block\+Transactions}{p.}{class_disconnected_block_transactions}

During the reorg, it\textquotesingle{}s desirable to re-\/add previously confirmed transactions to the mempool, so that anything not re-\/confirmed in the new chain is available to be mined. However, it\textquotesingle{}s more efficient to wait until the reorg is complete and process all still-\/unconfirmed transactions at that time, since we expect most confirmed transactions to (typically) still be confirmed in the new chain, and re-\/accepting to the memory pool is expensive (and therefore better to not do in the middle of reorg-\/processing). Instead, store the disconnected transactions (in order!) as we go, remove any that are included in blocks in the new chain, and then process the remaining still-\/unconfirmed transactions at the end.

Order of queued\+Tx\+: The front of the list should be the most recently-\/confirmed transactions (transactions at the end of vtx of blocks closer to the tip). If memory usage grows too large, we trim from the front of the list. After trimming, transactions can be re-\/added to the mempool from the back of the list to the front without running into missing inputs. 

\label{doc-constructors}
\doxysubsection{Constructor \& Destructor Documentation}
\index{DisconnectedBlockTransactions@{DisconnectedBlockTransactions}!DisconnectedBlockTransactions@{DisconnectedBlockTransactions}}
\index{DisconnectedBlockTransactions@{DisconnectedBlockTransactions}!DisconnectedBlockTransactions@{DisconnectedBlockTransactions}}
\doxysubsubsection{DisconnectedBlockTransactions()}
{\footnotesize\ttfamily \label{class_disconnected_block_transactions_a13817160d490deb50d7e0a8e0471b5bc} 
\textbf{ Disconnected\+Block\+Transactions} (\begin{DoxyParamCaption}\item[{size\+\_\+t}]{max\+\_\+mem\+\_\+usage}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}

\index{DisconnectedBlockTransactions@{DisconnectedBlockTransactions}!````~DisconnectedBlockTransactions@{$\sim$DisconnectedBlockTransactions}}
\index{````~DisconnectedBlockTransactions@{$\sim$DisconnectedBlockTransactions}!DisconnectedBlockTransactions@{DisconnectedBlockTransactions}}
\doxysubsubsection{$\sim$DisconnectedBlockTransactions()}
{\footnotesize\ttfamily \label{class_disconnected_block_transactions_a1711b70ebe3e390d39f38cb7a99cb45e} 
$\sim$\textbf{ Disconnected\+Block\+Transactions} (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption})}



\label{doc-func-members}
\doxysubsection{Member Function Documentation}
\index{DisconnectedBlockTransactions@{DisconnectedBlockTransactions}!AddTransactionsFromBlock@{AddTransactionsFromBlock}}
\index{AddTransactionsFromBlock@{AddTransactionsFromBlock}!DisconnectedBlockTransactions@{DisconnectedBlockTransactions}}
\doxysubsubsection{AddTransactionsFromBlock()}
{\footnotesize\ttfamily \label{class_disconnected_block_transactions_a00c7a433e2c25308bca9255e5cf4b0eb} 
std\+::vector$<$ \textbf{ CTransaction\+Ref} $>$ Add\+Transactions\+From\+Block (\begin{DoxyParamCaption}\item[{const std\+::vector$<$ \textbf{ CTransaction\+Ref} $>$ \&}]{vtx}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [nodiscard]}}

Add transactions from the block, iterating through vtx in reverse order. Callers should call this function for blocks in descending order by block height. We assume that callers never pass multiple transactions with the same txid, otherwise things can go very wrong in remove\+For\+Block due to queued\+Tx containing an item without a corresponding entry in iters\+\_\+by\+\_\+txid. \begin{DoxyReturn}{Returns}
vector of transactions that were evicted for size-\/limiting. 
\end{DoxyReturn}
\index{DisconnectedBlockTransactions@{DisconnectedBlockTransactions}!clear@{clear}}
\index{clear@{clear}!DisconnectedBlockTransactions@{DisconnectedBlockTransactions}}
\doxysubsubsection{clear()}
{\footnotesize\ttfamily \label{class_disconnected_block_transactions_ac8bb3912a3ce86b15842e79d0b421204} 
void clear (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption})}

\index{DisconnectedBlockTransactions@{DisconnectedBlockTransactions}!DynamicMemoryUsage@{DynamicMemoryUsage}}
\index{DynamicMemoryUsage@{DynamicMemoryUsage}!DisconnectedBlockTransactions@{DisconnectedBlockTransactions}}
\doxysubsubsection{DynamicMemoryUsage()}
{\footnotesize\ttfamily \label{class_disconnected_block_transactions_afcc22204abc15aeefd5d1f7396e909a4} 
size\+\_\+t Dynamic\+Memory\+Usage (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption}) const}

\index{DisconnectedBlockTransactions@{DisconnectedBlockTransactions}!removeForBlock@{removeForBlock}}
\index{removeForBlock@{removeForBlock}!DisconnectedBlockTransactions@{DisconnectedBlockTransactions}}
\doxysubsubsection{removeForBlock()}
{\footnotesize\ttfamily \label{class_disconnected_block_transactions_a27f308ba123752de7162c1fb47613227} 
void remove\+For\+Block (\begin{DoxyParamCaption}\item[{const std\+::vector$<$ \textbf{ CTransaction\+Ref} $>$ \&}]{vtx}{}\end{DoxyParamCaption})}

Remove any entries that are in this block. \index{DisconnectedBlockTransactions@{DisconnectedBlockTransactions}!size@{size}}
\index{size@{size}!DisconnectedBlockTransactions@{DisconnectedBlockTransactions}}
\doxysubsubsection{size()}
{\footnotesize\ttfamily \label{class_disconnected_block_transactions_a259cb5a711406a8c3e5d937eb9350cca} 
size\+\_\+t size (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}

\index{DisconnectedBlockTransactions@{DisconnectedBlockTransactions}!take@{take}}
\index{take@{take}!DisconnectedBlockTransactions@{DisconnectedBlockTransactions}}
\doxysubsubsection{take()}
{\footnotesize\ttfamily \label{class_disconnected_block_transactions_a4c515d69876e67351a7cdbb6d261dc21} 
std\+::list$<$ \textbf{ CTransaction\+Ref} $>$ take (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption})}

Clear all data structures and return the list of transactions. 

The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
src/kernel/\textbf{ disconnected\+\_\+transactions.\+h}\item 
src/kernel/\textbf{ disconnected\+\_\+transactions.\+cpp}\end{DoxyCompactItemize}
