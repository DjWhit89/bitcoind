\doxysection{src/key.cpp File Reference}
\label{key_8cpp}\index{src/key.cpp@{src/key.cpp}}
{\ttfamily \#include $<$key.\+h$>$}\newline
{\ttfamily \#include $<$crypto/common.\+h$>$}\newline
{\ttfamily \#include $<$crypto/hmac\+\_\+sha512.\+h$>$}\newline
{\ttfamily \#include $<$hash.\+h$>$}\newline
{\ttfamily \#include $<$random.\+h$>$}\newline
{\ttfamily \#include $<$secp256k1.\+h$>$}\newline
{\ttfamily \#include $<$secp256k1\+\_\+ellswift.\+h$>$}\newline
{\ttfamily \#include $<$secp256k1\+\_\+extrakeys.\+h$>$}\newline
{\ttfamily \#include $<$secp256k1\+\_\+musig.\+h$>$}\newline
{\ttfamily \#include $<$secp256k1\+\_\+recovery.\+h$>$}\newline
{\ttfamily \#include $<$secp256k1\+\_\+schnorrsig.\+h$>$}\newline
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \textbf{ ec\+\_\+seckey\+\_\+import\+\_\+der} (const \textbf{ secp256k1\+\_\+context} $\ast$ctx, unsigned char $\ast$out32, const unsigned char $\ast$seckey, size\+\_\+t seckeylen)
\item 
int \textbf{ ec\+\_\+seckey\+\_\+export\+\_\+der} (const \textbf{ secp256k1\+\_\+context} $\ast$ctx, unsigned char $\ast$seckey, size\+\_\+t $\ast$seckeylen, const unsigned char $\ast$key32, bool compressed)
\item 
bool \textbf{ Sig\+Has\+LowR} (const \textbf{ secp256k1\+\_\+ecdsa\+\_\+signature} $\ast$sig)
\item 
\textbf{ CKey} \textbf{ Generate\+Random\+Key} (bool compressed) noexcept
\item 
bool \textbf{ ECC\+\_\+\+Init\+Sanity\+Check} ()
\end{DoxyCompactItemize}


\label{doc-func-members}
\doxysubsection{Function Documentation}
\index{key.cpp@{key.cpp}!ec\_seckey\_export\_der@{ec\_seckey\_export\_der}}
\index{ec\_seckey\_export\_der@{ec\_seckey\_export\_der}!key.cpp@{key.cpp}}
\doxysubsubsection{ec\_seckey\_export\_der()}
{\footnotesize\ttfamily \label{key_8cpp_a8dfc834bbe7d6fb7715c07826c1b1507} 
int ec\+\_\+seckey\+\_\+export\+\_\+der (\begin{DoxyParamCaption}\item[{const \textbf{ secp256k1\+\_\+context} $\ast$}]{ctx}{, }\item[{unsigned char $\ast$}]{seckey}{, }\item[{size\+\_\+t $\ast$}]{seckeylen}{, }\item[{const unsigned char $\ast$}]{key32}{, }\item[{bool}]{compressed}{}\end{DoxyParamCaption})}

This serializes to a DER encoding of the ECPrivate\+Key type from section C.\+4 of SEC 1 {\texttt{https\+://www.\+secg.\+org/sec1-\/v2.\+pdf}}. The optional parameters and public\+Key fields are included.

seckey must point to an output buffer of length at least \doxyref{CKey\+::\+SIZE}{p.}{class_c_key_a0760cd6fcc3f45a64b0402a4cc9b9ce3} bytes. seckeylen must initially be set to the size of the seckey buffer. Upon return it will be set to the number of bytes used in the buffer. key32 must point to a 32-\/byte raw private key. \index{key.cpp@{key.cpp}!ec\_seckey\_import\_der@{ec\_seckey\_import\_der}}
\index{ec\_seckey\_import\_der@{ec\_seckey\_import\_der}!key.cpp@{key.cpp}}
\doxysubsubsection{ec\_seckey\_import\_der()}
{\footnotesize\ttfamily \label{key_8cpp_acb3e61a21bab4d7e4f38985463982b73} 
int ec\+\_\+seckey\+\_\+import\+\_\+der (\begin{DoxyParamCaption}\item[{const \textbf{ secp256k1\+\_\+context} $\ast$}]{ctx}{, }\item[{unsigned char $\ast$}]{out32}{, }\item[{const unsigned char $\ast$}]{seckey}{, }\item[{size\+\_\+t}]{seckeylen}{}\end{DoxyParamCaption})}

These functions are taken from the libsecp256k1 distribution and are very ugly. This parses a format loosely based on a DER encoding of the ECPrivate\+Key type from section C.\+4 of SEC 1 {\texttt{https\+://www.\+secg.\+org/sec1-\/v2.\+pdf}}, with the following caveats\+:


\begin{DoxyItemize}
\item The octet-\/length of the SEQUENCE must be encoded as 1 or 2 octets. It is not required to be encoded as one octet if it is less than 256, as DER would require.
\item The octet-\/length of the SEQUENCE must not be greater than the remaining length of the key encoding, but need not match it (i.\+e. the encoding may contain junk after the encoded SEQUENCE).
\item The private\+Key OCTET STRING is zero-\/filled on the left to 32 octets.
\item Anything after the encoding of the private\+Key OCTET STRING is ignored, whether or not it is validly encoded DER.
\end{DoxyItemize}

out32 must point to an output buffer of length at least 32 bytes. \index{key.cpp@{key.cpp}!ECC\_InitSanityCheck@{ECC\_InitSanityCheck}}
\index{ECC\_InitSanityCheck@{ECC\_InitSanityCheck}!key.cpp@{key.cpp}}
\doxysubsubsection{ECC\_InitSanityCheck()}
{\footnotesize\ttfamily \label{key_8cpp_adc8d142f5bcd2ca6646462fb45a7945d} 
bool ECC\+\_\+\+Init\+Sanity\+Check (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption})}

Check that required EC support is available at runtime. \index{key.cpp@{key.cpp}!GenerateRandomKey@{GenerateRandomKey}}
\index{GenerateRandomKey@{GenerateRandomKey}!key.cpp@{key.cpp}}
\doxysubsubsection{GenerateRandomKey()}
{\footnotesize\ttfamily \label{key_8cpp_aeb5c90c6e6a817f5ed4876d9722ae37f} 
\textbf{ CKey} Generate\+Random\+Key (\begin{DoxyParamCaption}\item[{bool}]{compressed}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [noexcept]}}

\index{key.cpp@{key.cpp}!SigHasLowR@{SigHasLowR}}
\index{SigHasLowR@{SigHasLowR}!key.cpp@{key.cpp}}
\doxysubsubsection{SigHasLowR()}
{\footnotesize\ttfamily \label{key_8cpp_ac9ec599027c6b68a87ebd788be2a611c} 
bool Sig\+Has\+LowR (\begin{DoxyParamCaption}\item[{const \textbf{ secp256k1\+\_\+ecdsa\+\_\+signature} $\ast$}]{sig}{}\end{DoxyParamCaption})}

