\doxysection{src/secp256k1/src/modules/schnorrsig/main\+\_\+impl.h File Reference}
\label{schnorrsig_2main__impl_8h}\index{src/secp256k1/src/modules/schnorrsig/main\_impl.h@{src/secp256k1/src/modules/schnorrsig/main\_impl.h}}
{\ttfamily \#include "{}../../../include/secp256k1.\+h"{}}\newline
{\ttfamily \#include "{}../../../include/secp256k1\+\_\+schnorrsig.\+h"{}}\newline
{\ttfamily \#include "{}../../hash.\+h"{}}\newline
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \textbf{ secp256k1\+\_\+schnorrsig\+\_\+sign32} (const \textbf{ secp256k1\+\_\+context} $\ast$ctx, unsigned char $\ast$sig64, const unsigned char $\ast$msg32, const \textbf{ secp256k1\+\_\+keypair} $\ast$keypair, const unsigned char $\ast$aux\+\_\+rand32)
\item 
int \textbf{ secp256k1\+\_\+schnorrsig\+\_\+sign} (const \textbf{ secp256k1\+\_\+context} $\ast$ctx, unsigned char $\ast$sig64, const unsigned char $\ast$msg32, const \textbf{ secp256k1\+\_\+keypair} $\ast$keypair, const unsigned char $\ast$aux\+\_\+rand32)
\item 
int \textbf{ secp256k1\+\_\+schnorrsig\+\_\+sign\+\_\+custom} (const \textbf{ secp256k1\+\_\+context} $\ast$ctx, unsigned char $\ast$sig64, const unsigned char $\ast$msg, size\+\_\+t msglen, const \textbf{ secp256k1\+\_\+keypair} $\ast$keypair, \textbf{ secp256k1\+\_\+schnorrsig\+\_\+extraparams} $\ast$extraparams)
\item 
int \textbf{ secp256k1\+\_\+schnorrsig\+\_\+verify} (const \textbf{ secp256k1\+\_\+context} $\ast$ctx, const unsigned char $\ast$sig64, const unsigned char $\ast$msg, size\+\_\+t msglen, const \textbf{ secp256k1\+\_\+xonly\+\_\+pubkey} $\ast$pubkey)
\end{DoxyCompactItemize}
\doxysubsubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
const \textbf{ secp256k1\+\_\+nonce\+\_\+function\+\_\+hardened} \textbf{ secp256k1\+\_\+nonce\+\_\+function\+\_\+bip340} = nonce\+\_\+function\+\_\+bip340
\end{DoxyCompactItemize}


\label{doc-func-members}
\doxysubsection{Function Documentation}
\index{main\_impl.h@{main\_impl.h}!secp256k1\_schnorrsig\_sign@{secp256k1\_schnorrsig\_sign}}
\index{secp256k1\_schnorrsig\_sign@{secp256k1\_schnorrsig\_sign}!main\_impl.h@{main\_impl.h}}
\doxysubsubsection{secp256k1\_schnorrsig\_sign()}
{\footnotesize\ttfamily \label{schnorrsig_2main__impl_8h_a221c526a09b8faa406e15824eb92cf1b} 
int secp256k1\+\_\+schnorrsig\+\_\+sign (\begin{DoxyParamCaption}\item[{const \textbf{ secp256k1\+\_\+context} $\ast$}]{ctx}{, }\item[{unsigned char $\ast$}]{sig64}{, }\item[{const unsigned char $\ast$}]{msg32}{, }\item[{const \textbf{ secp256k1\+\_\+keypair} $\ast$}]{keypair}{, }\item[{const unsigned char $\ast$}]{aux\+\_\+rand32}{}\end{DoxyParamCaption})}

Same as secp256k1\+\_\+schnorrsig\+\_\+sign32, but DEPRECATED. Will be removed in future versions. \index{main\_impl.h@{main\_impl.h}!secp256k1\_schnorrsig\_sign32@{secp256k1\_schnorrsig\_sign32}}
\index{secp256k1\_schnorrsig\_sign32@{secp256k1\_schnorrsig\_sign32}!main\_impl.h@{main\_impl.h}}
\doxysubsubsection{secp256k1\_schnorrsig\_sign32()}
{\footnotesize\ttfamily \label{schnorrsig_2main__impl_8h_a5bc69eb5f207ec82d3331594b2b9151e} 
int secp256k1\+\_\+schnorrsig\+\_\+sign32 (\begin{DoxyParamCaption}\item[{const \textbf{ secp256k1\+\_\+context} $\ast$}]{ctx}{, }\item[{unsigned char $\ast$}]{sig64}{, }\item[{const unsigned char $\ast$}]{msg32}{, }\item[{const \textbf{ secp256k1\+\_\+keypair} $\ast$}]{keypair}{, }\item[{const unsigned char $\ast$}]{aux\+\_\+rand32}{}\end{DoxyParamCaption})}

Create a Schnorr signature.

Does {\itshape not} strictly follow BIP-\/340 because it does not verify the resulting signature. Instead, you can manually use secp256k1\+\_\+schnorrsig\+\_\+verify and abort if it fails.

This function only signs 32-\/byte messages. If you have messages of a different size (or the same size but without a context-\/specific tag prefix), it is recommended to create a 32-\/byte message hash with secp256k1\+\_\+tagged\+\_\+sha256 and then sign the hash. Tagged hashing allows providing an context-\/specific tag for domain separation. This prevents signatures from being valid in multiple contexts by accident.

Returns 1 on success, 0 on failure. Args\+: ctx\+: pointer to a context object (not secp256k1\+\_\+context\+\_\+static). Out\+: sig64\+: pointer to a 64-\/byte array to store the serialized signature. In\+: msg32\+: the 32-\/byte message being signed. keypair\+: pointer to an initialized keypair. aux\+\_\+rand32\+: 32 bytes of fresh randomness. While recommended to provide this, it is only supplemental to security and can be NULL. A NULL argument is treated the same as an all-\/zero one. See BIP-\/340 "{}\+Default Signing"{} for a full explanation of this argument and for guidance if randomness is expensive. \index{main\_impl.h@{main\_impl.h}!secp256k1\_schnorrsig\_sign\_custom@{secp256k1\_schnorrsig\_sign\_custom}}
\index{secp256k1\_schnorrsig\_sign\_custom@{secp256k1\_schnorrsig\_sign\_custom}!main\_impl.h@{main\_impl.h}}
\doxysubsubsection{secp256k1\_schnorrsig\_sign\_custom()}
{\footnotesize\ttfamily \label{schnorrsig_2main__impl_8h_a4b12030197ede3e4cef1e2118c40fd33} 
int secp256k1\+\_\+schnorrsig\+\_\+sign\+\_\+custom (\begin{DoxyParamCaption}\item[{const \textbf{ secp256k1\+\_\+context} $\ast$}]{ctx}{, }\item[{unsigned char $\ast$}]{sig64}{, }\item[{const unsigned char $\ast$}]{msg}{, }\item[{size\+\_\+t}]{msglen}{, }\item[{const \textbf{ secp256k1\+\_\+keypair} $\ast$}]{keypair}{, }\item[{\textbf{ secp256k1\+\_\+schnorrsig\+\_\+extraparams} $\ast$}]{extraparams}{}\end{DoxyParamCaption})}

Create a Schnorr signature with a more flexible API.

Same arguments as secp256k1\+\_\+schnorrsig\+\_\+sign except that it allows signing variable length messages and accepts a pointer to an extraparams object that allows customizing signing by passing additional arguments.

Equivalent to secp256k1\+\_\+schnorrsig\+\_\+sign32(..., aux\+\_\+rand32) if msglen is 32 and extraparams is initialized as follows\+: 
\begin{DoxyCode}{0}
\DoxyCodeLine{secp256k1\_schnorrsig\_extraparams\ extraparams\ =\ SECP256K1\_SCHNORRSIG\_EXTRAPARAMS\_INIT;}
\DoxyCodeLine{extraparams.ndata\ =\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}*)aux\_rand32;}

\end{DoxyCode}


Returns 1 on success, 0 on failure. Args\+: ctx\+: pointer to a context object (not secp256k1\+\_\+context\+\_\+static). Out\+: sig64\+: pointer to a 64-\/byte array to store the serialized signature. In\+: msg\+: the message being signed. Can only be NULL if msglen is 0. msglen\+: length of the message. keypair\+: pointer to an initialized keypair. extraparams\+: pointer to an extraparams object (can be NULL). \index{main\_impl.h@{main\_impl.h}!secp256k1\_schnorrsig\_verify@{secp256k1\_schnorrsig\_verify}}
\index{secp256k1\_schnorrsig\_verify@{secp256k1\_schnorrsig\_verify}!main\_impl.h@{main\_impl.h}}
\doxysubsubsection{secp256k1\_schnorrsig\_verify()}
{\footnotesize\ttfamily \label{schnorrsig_2main__impl_8h_ab4b9ea2608b3c6e0dadad4c42a48d85f} 
int secp256k1\+\_\+schnorrsig\+\_\+verify (\begin{DoxyParamCaption}\item[{const \textbf{ secp256k1\+\_\+context} $\ast$}]{ctx}{, }\item[{const unsigned char $\ast$}]{sig64}{, }\item[{const unsigned char $\ast$}]{msg}{, }\item[{size\+\_\+t}]{msglen}{, }\item[{const \textbf{ secp256k1\+\_\+xonly\+\_\+pubkey} $\ast$}]{pubkey}{}\end{DoxyParamCaption})}

Verify a Schnorr signature.

Returns\+: 1\+: correct signature 0\+: incorrect signature Args\+: ctx\+: pointer to a context object. In\+: sig64\+: pointer to the 64-\/byte signature to verify. msg\+: the message being verified. Can only be NULL if msglen is 0. msglen\+: length of the message pubkey\+: pointer to an x-\/only public key to verify with 

\label{doc-var-members}
\doxysubsection{Variable Documentation}
\index{main\_impl.h@{main\_impl.h}!secp256k1\_nonce\_function\_bip340@{secp256k1\_nonce\_function\_bip340}}
\index{secp256k1\_nonce\_function\_bip340@{secp256k1\_nonce\_function\_bip340}!main\_impl.h@{main\_impl.h}}
\doxysubsubsection{secp256k1\_nonce\_function\_bip340}
{\footnotesize\ttfamily \label{schnorrsig_2main__impl_8h_aa1fa704630945408ebce25083c7977e1} 
const \textbf{ secp256k1\+\_\+nonce\+\_\+function\+\_\+hardened} secp256k1\+\_\+nonce\+\_\+function\+\_\+bip340 = nonce\+\_\+function\+\_\+bip340}

