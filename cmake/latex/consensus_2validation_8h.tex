\doxysection{src/consensus/validation.h File Reference}
\label{consensus_2validation_8h}\index{src/consensus/validation.h@{src/consensus/validation.h}}
{\ttfamily \#include $<$string$>$}\newline
{\ttfamily \#include $<$consensus/consensus.\+h$>$}\newline
{\ttfamily \#include $<$primitives/transaction.\+h$>$}\newline
{\ttfamily \#include $<$primitives/block.\+h$>$}\newline
\doxysubsubsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
class \textbf{ Validation\+State$<$ Result $>$}
\item 
class \textbf{ Tx\+Validation\+State}
\item 
class \textbf{ Block\+Validation\+State}
\end{DoxyCompactItemize}
\doxysubsubsection*{Enumerations}
\begin{DoxyCompactItemize}
\item 
enum class \textbf{ Tx\+Validation\+Result} \{ \newline
\textbf{ TX\+\_\+\+RESULT\+\_\+\+UNSET} = 0
, \textbf{ TX\+\_\+\+CONSENSUS}
, \textbf{ TX\+\_\+\+INPUTS\+\_\+\+NOT\+\_\+\+STANDARD}
, \textbf{ TX\+\_\+\+NOT\+\_\+\+STANDARD}
, \newline
\textbf{ TX\+\_\+\+MISSING\+\_\+\+INPUTS}
, \textbf{ TX\+\_\+\+PREMATURE\+\_\+\+SPEND}
, \textbf{ TX\+\_\+\+WITNESS\+\_\+\+MUTATED}
, \textbf{ TX\+\_\+\+WITNESS\+\_\+\+STRIPPED}
, \newline
\textbf{ TX\+\_\+\+CONFLICT}
, \textbf{ TX\+\_\+\+MEMPOOL\+\_\+\+POLICY}
, \textbf{ TX\+\_\+\+NO\+\_\+\+MEMPOOL}
, \textbf{ TX\+\_\+\+RECONSIDERABLE}
, \newline
\textbf{ TX\+\_\+\+UNKNOWN}
 \}
\item 
enum class \textbf{ Block\+Validation\+Result} \{ \newline
\textbf{ BLOCK\+\_\+\+RESULT\+\_\+\+UNSET} = 0
, \textbf{ BLOCK\+\_\+\+CONSENSUS}
, \textbf{ BLOCK\+\_\+\+CACHED\+\_\+\+INVALID}
, \textbf{ BLOCK\+\_\+\+INVALID\+\_\+\+HEADER}
, \newline
\textbf{ BLOCK\+\_\+\+MUTATED}
, \textbf{ BLOCK\+\_\+\+MISSING\+\_\+\+PREV}
, \textbf{ BLOCK\+\_\+\+INVALID\+\_\+\+PREV}
, \textbf{ BLOCK\+\_\+\+TIME\+\_\+\+FUTURE}
, \newline
\textbf{ BLOCK\+\_\+\+HEADER\+\_\+\+LOW\+\_\+\+WORK}
 \}
\end{DoxyCompactItemize}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \textbf{ Get\+Witness\+Commitment\+Index} (const \textbf{ CBlock} \&block)
\end{DoxyCompactItemize}


\label{doc-enum-members}
\doxysubsection{Enumeration Type Documentation}
\index{validation.h@{validation.h}!BlockValidationResult@{BlockValidationResult}}
\index{BlockValidationResult@{BlockValidationResult}!validation.h@{validation.h}}
\doxysubsubsection{BlockValidationResult}
{\footnotesize\ttfamily \label{consensus_2validation_8h_ab12ebe934df246179ab286448e7ef580} 
enum class \textbf{ Block\+Validation\+Result}\hspace{0.3cm}{\ttfamily [strong]}}

A "{}reason"{} why a block was invalid, suitable for determining whether the provider of the block should be banned/ignored/disconnected/etc. These are much more granular than the rejection codes, which may be more useful for some other use-\/cases. \begin{DoxyEnumFields}[2]{Enumerator}
\raisebox{\heightof{T}}[0pt][0pt]{\index{BLOCK\_RESULT\_UNSET@{BLOCK\_RESULT\_UNSET}!validation.h@{validation.h}}\index{validation.h@{validation.h}!BLOCK\_RESULT\_UNSET@{BLOCK\_RESULT\_UNSET}}}\label{consensus_2validation_8h_ab12ebe934df246179ab286448e7ef580af1d64fcb3663d9ed3a1481fac607b54b} 
BLOCK\+\_\+\+RESULT\+\_\+\+UNSET&initial value. Block has not yet been rejected \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{BLOCK\_CONSENSUS@{BLOCK\_CONSENSUS}!validation.h@{validation.h}}\index{validation.h@{validation.h}!BLOCK\_CONSENSUS@{BLOCK\_CONSENSUS}}}\label{consensus_2validation_8h_ab12ebe934df246179ab286448e7ef580a6d95354aa8213c32922ccc6fa949befb} 
BLOCK\+\_\+\+CONSENSUS&invalid by consensus rules (excluding any below reasons) \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{BLOCK\_CACHED\_INVALID@{BLOCK\_CACHED\_INVALID}!validation.h@{validation.h}}\index{validation.h@{validation.h}!BLOCK\_CACHED\_INVALID@{BLOCK\_CACHED\_INVALID}}}\label{consensus_2validation_8h_ab12ebe934df246179ab286448e7ef580a66107f1a16fc14f7b8dff8becdf353b8} 
BLOCK\+\_\+\+CACHED\+\_\+\+INVALID&this block was cached as being invalid and we didn\textquotesingle{}t store the reason why \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{BLOCK\_INVALID\_HEADER@{BLOCK\_INVALID\_HEADER}!validation.h@{validation.h}}\index{validation.h@{validation.h}!BLOCK\_INVALID\_HEADER@{BLOCK\_INVALID\_HEADER}}}\label{consensus_2validation_8h_ab12ebe934df246179ab286448e7ef580a5ba8236eb864c026cf09cd1d7d145bb9} 
BLOCK\+\_\+\+INVALID\+\_\+\+HEADER&invalid proof of work or time too old \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{BLOCK\_MUTATED@{BLOCK\_MUTATED}!validation.h@{validation.h}}\index{validation.h@{validation.h}!BLOCK\_MUTATED@{BLOCK\_MUTATED}}}\label{consensus_2validation_8h_ab12ebe934df246179ab286448e7ef580aa74bec7838a1da98fe1e6e0620d31170} 
BLOCK\+\_\+\+MUTATED&the block\textquotesingle{}s data didn\textquotesingle{}t match the data committed to by the PoW \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{BLOCK\_MISSING\_PREV@{BLOCK\_MISSING\_PREV}!validation.h@{validation.h}}\index{validation.h@{validation.h}!BLOCK\_MISSING\_PREV@{BLOCK\_MISSING\_PREV}}}\label{consensus_2validation_8h_ab12ebe934df246179ab286448e7ef580a75fe58bb96b5b8a9992cfc163cd38435} 
BLOCK\+\_\+\+MISSING\+\_\+\+PREV&We don\textquotesingle{}t have the previous block the checked one is built on. \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{BLOCK\_INVALID\_PREV@{BLOCK\_INVALID\_PREV}!validation.h@{validation.h}}\index{validation.h@{validation.h}!BLOCK\_INVALID\_PREV@{BLOCK\_INVALID\_PREV}}}\label{consensus_2validation_8h_ab12ebe934df246179ab286448e7ef580a9bd09980f054effc42d4dac919472ead} 
BLOCK\+\_\+\+INVALID\+\_\+\+PREV&A block this one builds on is invalid. \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{BLOCK\_TIME\_FUTURE@{BLOCK\_TIME\_FUTURE}!validation.h@{validation.h}}\index{validation.h@{validation.h}!BLOCK\_TIME\_FUTURE@{BLOCK\_TIME\_FUTURE}}}\label{consensus_2validation_8h_ab12ebe934df246179ab286448e7ef580aaec42241441df64f66774cd2cc142830} 
BLOCK\+\_\+\+TIME\+\_\+\+FUTURE&block timestamp was $>$ 2 hours in the future (or our clock is bad) \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{BLOCK\_HEADER\_LOW\_WORK@{BLOCK\_HEADER\_LOW\_WORK}!validation.h@{validation.h}}\index{validation.h@{validation.h}!BLOCK\_HEADER\_LOW\_WORK@{BLOCK\_HEADER\_LOW\_WORK}}}\label{consensus_2validation_8h_ab12ebe934df246179ab286448e7ef580a5a70bd865d41ac7d01f874abc5124e99} 
BLOCK\+\_\+\+HEADER\+\_\+\+LOW\+\_\+\+WORK&the block header may be on a too-\/little-\/work chain \\
\hline

\end{DoxyEnumFields}
\index{validation.h@{validation.h}!TxValidationResult@{TxValidationResult}}
\index{TxValidationResult@{TxValidationResult}!validation.h@{validation.h}}
\doxysubsubsection{TxValidationResult}
{\footnotesize\ttfamily \label{consensus_2validation_8h_af79c18cdf56a2455d281427abb70f89f} 
enum class \textbf{ Tx\+Validation\+Result}\hspace{0.3cm}{\ttfamily [strong]}}

A "{}reason"{} why a transaction was invalid, suitable for determining whether the provider of the transaction should be banned/ignored/disconnected/etc. \begin{DoxyEnumFields}[2]{Enumerator}
\raisebox{\heightof{T}}[0pt][0pt]{\index{TX\_RESULT\_UNSET@{TX\_RESULT\_UNSET}!validation.h@{validation.h}}\index{validation.h@{validation.h}!TX\_RESULT\_UNSET@{TX\_RESULT\_UNSET}}}\label{consensus_2validation_8h_af79c18cdf56a2455d281427abb70f89face9077815b8b186782275db957aaa16e} 
TX\+\_\+\+RESULT\+\_\+\+UNSET&initial value. Tx has not yet been rejected \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{TX\_CONSENSUS@{TX\_CONSENSUS}!validation.h@{validation.h}}\index{validation.h@{validation.h}!TX\_CONSENSUS@{TX\_CONSENSUS}}}\label{consensus_2validation_8h_af79c18cdf56a2455d281427abb70f89fad623c6a3361887cbd2cf1fe3c2bfb261} 
TX\+\_\+\+CONSENSUS&invalid by consensus rules \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{TX\_INPUTS\_NOT\_STANDARD@{TX\_INPUTS\_NOT\_STANDARD}!validation.h@{validation.h}}\index{validation.h@{validation.h}!TX\_INPUTS\_NOT\_STANDARD@{TX\_INPUTS\_NOT\_STANDARD}}}\label{consensus_2validation_8h_af79c18cdf56a2455d281427abb70f89fa73a40891d562a317762127a2d0b3ed1c} 
TX\+\_\+\+INPUTS\+\_\+\+NOT\+\_\+\+STANDARD&inputs (covered by txid) failed policy rules \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{TX\_NOT\_STANDARD@{TX\_NOT\_STANDARD}!validation.h@{validation.h}}\index{validation.h@{validation.h}!TX\_NOT\_STANDARD@{TX\_NOT\_STANDARD}}}\label{consensus_2validation_8h_af79c18cdf56a2455d281427abb70f89faa87feca81b39bdb75c3fdf1af3895847} 
TX\+\_\+\+NOT\+\_\+\+STANDARD&otherwise didn\textquotesingle{}t meet our local policy rules \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{TX\_MISSING\_INPUTS@{TX\_MISSING\_INPUTS}!validation.h@{validation.h}}\index{validation.h@{validation.h}!TX\_MISSING\_INPUTS@{TX\_MISSING\_INPUTS}}}\label{consensus_2validation_8h_af79c18cdf56a2455d281427abb70f89fa16d3efb22890f6c8dd36c8e0e81dd796} 
TX\+\_\+\+MISSING\+\_\+\+INPUTS&transaction was missing some of its inputs \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{TX\_PREMATURE\_SPEND@{TX\_PREMATURE\_SPEND}!validation.h@{validation.h}}\index{validation.h@{validation.h}!TX\_PREMATURE\_SPEND@{TX\_PREMATURE\_SPEND}}}\label{consensus_2validation_8h_af79c18cdf56a2455d281427abb70f89fa4c15966c8a24612f3cd0214361ee04b9} 
TX\+\_\+\+PREMATURE\+\_\+\+SPEND&transaction spends a coinbase too early, or violates locktime/sequence locks \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{TX\_WITNESS\_MUTATED@{TX\_WITNESS\_MUTATED}!validation.h@{validation.h}}\index{validation.h@{validation.h}!TX\_WITNESS\_MUTATED@{TX\_WITNESS\_MUTATED}}}\label{consensus_2validation_8h_af79c18cdf56a2455d281427abb70f89fabd05fa801151b35239c6276029d1496c} 
TX\+\_\+\+WITNESS\+\_\+\+MUTATED&Transaction might have a witness prior to Seg\+Wit activation, or witness may have been malleated (which includes non-\/standard witnesses). \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{TX\_WITNESS\_STRIPPED@{TX\_WITNESS\_STRIPPED}!validation.h@{validation.h}}\index{validation.h@{validation.h}!TX\_WITNESS\_STRIPPED@{TX\_WITNESS\_STRIPPED}}}\label{consensus_2validation_8h_af79c18cdf56a2455d281427abb70f89fa7d22472f2e6c5609db513454c8b8426f} 
TX\+\_\+\+WITNESS\+\_\+\+STRIPPED&Transaction is missing a witness. \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{TX\_CONFLICT@{TX\_CONFLICT}!validation.h@{validation.h}}\index{validation.h@{validation.h}!TX\_CONFLICT@{TX\_CONFLICT}}}\label{consensus_2validation_8h_af79c18cdf56a2455d281427abb70f89fa90e46dc7656bfd1beccba4ba1842c7aa} 
TX\+\_\+\+CONFLICT&Tx already in mempool or conflicts with a tx in the chain (if it conflicts with another tx in mempool, we use MEMPOOL\+\_\+\+POLICY as it failed to reach the RBF threshold) Currently this is only used if the transaction already exists in the mempool or on chain. \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{TX\_MEMPOOL\_POLICY@{TX\_MEMPOOL\_POLICY}!validation.h@{validation.h}}\index{validation.h@{validation.h}!TX\_MEMPOOL\_POLICY@{TX\_MEMPOOL\_POLICY}}}\label{consensus_2validation_8h_af79c18cdf56a2455d281427abb70f89fa2dbed613ade117d8c58d8d230618efe4} 
TX\+\_\+\+MEMPOOL\+\_\+\+POLICY&violated mempool\textquotesingle{}s fee/size/descendant/\+RBF/etc limits \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{TX\_NO\_MEMPOOL@{TX\_NO\_MEMPOOL}!validation.h@{validation.h}}\index{validation.h@{validation.h}!TX\_NO\_MEMPOOL@{TX\_NO\_MEMPOOL}}}\label{consensus_2validation_8h_af79c18cdf56a2455d281427abb70f89fabf7c24f91e2c3c9b6d53aee4ba84e5ca} 
TX\+\_\+\+NO\+\_\+\+MEMPOOL&this node does not have a mempool so can\textquotesingle{}t validate the transaction \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{TX\_RECONSIDERABLE@{TX\_RECONSIDERABLE}!validation.h@{validation.h}}\index{validation.h@{validation.h}!TX\_RECONSIDERABLE@{TX\_RECONSIDERABLE}}}\label{consensus_2validation_8h_af79c18cdf56a2455d281427abb70f89fada14c3503154c47fa98ac835983a5581} 
TX\+\_\+\+RECONSIDERABLE&fails some policy, but might be acceptable if submitted in a (different) package \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{TX\_UNKNOWN@{TX\_UNKNOWN}!validation.h@{validation.h}}\index{validation.h@{validation.h}!TX\_UNKNOWN@{TX\_UNKNOWN}}}\label{consensus_2validation_8h_af79c18cdf56a2455d281427abb70f89fa4442794a27caad913e53e2a50f1bf5fe} 
TX\+\_\+\+UNKNOWN&transaction was not validated because package failed \\
\hline

\end{DoxyEnumFields}


\label{doc-func-members}
\doxysubsection{Function Documentation}
\index{validation.h@{validation.h}!GetWitnessCommitmentIndex@{GetWitnessCommitmentIndex}}
\index{GetWitnessCommitmentIndex@{GetWitnessCommitmentIndex}!validation.h@{validation.h}}
\doxysubsubsection{GetWitnessCommitmentIndex()}
{\footnotesize\ttfamily \label{consensus_2validation_8h_ab56bfb1e9e2f9bf10d2595f6c85b3d2e} 
int Get\+Witness\+Commitment\+Index (\begin{DoxyParamCaption}\item[{const \textbf{ CBlock} \&}]{block}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}

Compute at which vout of the block\textquotesingle{}s coinbase transaction the witness commitment occurs, or -\/1 if not found 