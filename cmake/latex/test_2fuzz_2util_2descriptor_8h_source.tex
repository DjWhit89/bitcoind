\doxysection{descriptor.\+h}
\label{test_2fuzz_2util_2descriptor_8h_source}\index{src/test/fuzz/util/descriptor.h@{src/test/fuzz/util/descriptor.h}}
\textbf{ Go to the documentation of this file.}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{//\ Copyright\ (c)\ 2023-\/present\ The\ Bitcoin\ Core\ developers}}
\DoxyCodeLine{00002\ \textcolor{comment}{//\ Distributed\ under\ the\ MIT\ software\ license,\ see\ the\ accompanying}}
\DoxyCodeLine{00003\ \textcolor{comment}{//\ file\ COPYING\ or\ http://www.opensource.org/licenses/mit-\/license.php.}}
\DoxyCodeLine{00004\ }
\DoxyCodeLine{00005\ \textcolor{preprocessor}{\#ifndef\ BITCOIN\_TEST\_FUZZ\_UTIL\_DESCRIPTOR\_H}}
\DoxyCodeLine{00006\ \textcolor{preprocessor}{\#define\ BITCOIN\_TEST\_FUZZ\_UTIL\_DESCRIPTOR\_H}}
\DoxyCodeLine{00007\ }
\DoxyCodeLine{00008\ \textcolor{preprocessor}{\#include\ <key\_io.h>}}
\DoxyCodeLine{00009\ \textcolor{preprocessor}{\#include\ <util/strencodings.h>}}
\DoxyCodeLine{00010\ \textcolor{preprocessor}{\#include\ <script/descriptor.h>}}
\DoxyCodeLine{00011\ \textcolor{preprocessor}{\#include\ <test/fuzz/fuzz.h>}}
\DoxyCodeLine{00012\ }
\DoxyCodeLine{00013\ \textcolor{preprocessor}{\#include\ <functional>}}
\DoxyCodeLine{00014\ }
\DoxyCodeLine{00021\ \textcolor{keyword}{class\ }MockedDescriptorConverter\ \{}
\DoxyCodeLine{00022\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00024\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{constexpr}\ uint8\_t\ KEY\_TYPES\_COUNT\{6\};}
\DoxyCodeLine{00026\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{size\_t}\ TOTAL\_KEYS\_GENERATED\{std::numeric\_limits<uint8\_t>::max()\ +\ 1\};}
\DoxyCodeLine{00028\ \ \ \ \ std::array<std::string,\ TOTAL\_KEYS\_GENERATED>\ keys\_str;}
\DoxyCodeLine{00029\ }
\DoxyCodeLine{00030\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00031\ \ \ \ \ \textcolor{comment}{//\ We\ derive\ the\ type\ of\ key\ to\ generate\ from\ the\ 1-\/byte\ id\ parsed\ from\ hex.}}
\DoxyCodeLine{00032\ \ \ \ \ \textcolor{keywordtype}{bool}\ IdIsCompPubKey(uint8\_t\ idx)\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ idx\ \%\ KEY\_TYPES\_COUNT\ ==\ 0;\ \}}
\DoxyCodeLine{00033\ \ \ \ \ \textcolor{keywordtype}{bool}\ IdIsUnCompPubKey(uint8\_t\ idx)\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ idx\ \%\ KEY\_TYPES\_COUNT\ ==\ 1;\ \}}
\DoxyCodeLine{00034\ \ \ \ \ \textcolor{keywordtype}{bool}\ IdIsXOnlyPubKey(uint8\_t\ idx)\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ idx\ \%\ KEY\_TYPES\_COUNT\ ==\ 2;\ \}}
\DoxyCodeLine{00035\ \ \ \ \ \textcolor{keywordtype}{bool}\ IdIsConstPrivKey(uint8\_t\ idx)\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ idx\ \%\ KEY\_TYPES\_COUNT\ ==\ 3;\ \}}
\DoxyCodeLine{00036\ \ \ \ \ \textcolor{keywordtype}{bool}\ IdIsXpub(uint8\_t\ idx)\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ idx\ \%\ KEY\_TYPES\_COUNT\ ==\ 4;\ \}}
\DoxyCodeLine{00037\ \ \ \ \ \textcolor{keywordtype}{bool}\ IdIsXprv(uint8\_t\ idx)\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ idx\ \%\ KEY\_TYPES\_COUNT\ ==\ 5;\ \}}
\DoxyCodeLine{00038\ }
\DoxyCodeLine{00040\ \ \ \ \ \textcolor{keywordtype}{void}\ Init();}
\DoxyCodeLine{00041\ }
\DoxyCodeLine{00043\ \ \ \ \ std::optional<uint8\_t>\ IdxFromHex(std::string\_view\ hex\_characters)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00044\ }
\DoxyCodeLine{00046\ \ \ \ \ std::optional<std::string>\ GetDescriptor(std::string\_view\ mocked\_desc)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00047\ \};}
\DoxyCodeLine{00048\ }
\DoxyCodeLine{00050\ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{int}\ MAX\_DEPTH\{2\};}
\DoxyCodeLine{00051\ }
\DoxyCodeLine{00056\ \textcolor{keywordtype}{bool}\ HasDeepDerivPath(\textcolor{keyword}{const}\ FuzzBufferType\&\ buff,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ max\_depth\ =\ MAX\_DEPTH);}
\DoxyCodeLine{00057\ }
\DoxyCodeLine{00059\ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{int}\ MAX\_SUBS\{1'000\};}
\DoxyCodeLine{00061\ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{size\_t}\ MAX\_NESTED\_SUBS\{10'000\};}
\DoxyCodeLine{00062\ }
\DoxyCodeLine{00067\ \textcolor{keywordtype}{bool}\ HasTooManySubFrag(\textcolor{keyword}{const}\ FuzzBufferType\&\ buff,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ max\_subs\ =\ MAX\_SUBS,}
\DoxyCodeLine{00068\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ max\_nested\_subs\ =\ MAX\_NESTED\_SUBS);}
\DoxyCodeLine{00069\ }
\DoxyCodeLine{00071\ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{int}\ MAX\_WRAPPERS\{100\};}
\DoxyCodeLine{00072\ }
\DoxyCodeLine{00077\ \textcolor{keywordtype}{bool}\ HasTooManyWrappers(\textcolor{keyword}{const}\ FuzzBufferType\&\ buff,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ max\_wrappers\ =\ MAX\_WRAPPERS);}
\DoxyCodeLine{00078\ }
\DoxyCodeLine{00079\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//\ BITCOIN\_TEST\_FUZZ\_UTIL\_DESCRIPTOR\_H}}

\end{DoxyCode}
