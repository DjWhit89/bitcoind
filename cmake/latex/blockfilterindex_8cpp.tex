\doxysection{src/index/blockfilterindex.cpp File Reference}
\label{blockfilterindex_8cpp}\index{src/index/blockfilterindex.cpp@{src/index/blockfilterindex.cpp}}
{\ttfamily \#include $<$index/blockfilterindex.\+h$>$}\newline
{\ttfamily \#include $<$blockfilter.\+h$>$}\newline
{\ttfamily \#include $<$chain.\+h$>$}\newline
{\ttfamily \#include $<$common/args.\+h$>$}\newline
{\ttfamily \#include $<$dbwrapper.\+h$>$}\newline
{\ttfamily \#include $<$flatfile.\+h$>$}\newline
{\ttfamily \#include $<$hash.\+h$>$}\newline
{\ttfamily \#include $<$index/base.\+h$>$}\newline
{\ttfamily \#include $<$interfaces/chain.\+h$>$}\newline
{\ttfamily \#include $<$interfaces/types.\+h$>$}\newline
{\ttfamily \#include $<$logging.\+h$>$}\newline
{\ttfamily \#include $<$serialize.\+h$>$}\newline
{\ttfamily \#include $<$streams.\+h$>$}\newline
{\ttfamily \#include $<$sync.\+h$>$}\newline
{\ttfamily \#include $<$uint256.\+h$>$}\newline
{\ttfamily \#include $<$util/check.\+h$>$}\newline
{\ttfamily \#include $<$util/fs.\+h$>$}\newline
{\ttfamily \#include $<$util/hasher.\+h$>$}\newline
{\ttfamily \#include $<$util/syserror.\+h$>$}\newline
{\ttfamily \#include $<$cerrno$>$}\newline
{\ttfamily \#include $<$exception$>$}\newline
{\ttfamily \#include $<$ios$>$}\newline
{\ttfamily \#include $<$map$>$}\newline
{\ttfamily \#include $<$optional$>$}\newline
{\ttfamily \#include $<$span$>$}\newline
{\ttfamily \#include $<$stdexcept$>$}\newline
{\ttfamily \#include $<$string$>$}\newline
{\ttfamily \#include $<$tuple$>$}\newline
{\ttfamily \#include $<$utility$>$}\newline
{\ttfamily \#include $<$vector$>$}\newline
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\textbf{ Block\+Filter\+Index} $\ast$ \textbf{ Get\+Block\+Filter\+Index} (\textbf{ Block\+Filter\+Type} filter\+\_\+type)
\item 
void \textbf{ For\+Each\+Block\+Filter\+Index} (std\+::function$<$ void(\textbf{ Block\+Filter\+Index} \&)$>$ fn)
\item 
bool \textbf{ Init\+Block\+Filter\+Index} (std\+::function$<$ std\+::unique\+\_\+ptr$<$ \textbf{ interfaces\+::\+Chain} $>$()$>$ make\+\_\+chain, \textbf{ Block\+Filter\+Type} filter\+\_\+type, size\+\_\+t n\+\_\+cache\+\_\+size, bool f\+\_\+memory, bool f\+\_\+wipe)
\item 
bool \textbf{ Destroy\+Block\+Filter\+Index} (\textbf{ Block\+Filter\+Type} filter\+\_\+type)
\item 
void \textbf{ Destroy\+All\+Block\+Filter\+Indexes} ()
\end{DoxyCompactItemize}
\doxysubsubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
constexpr uint8\+\_\+t \textbf{ DB\+\_\+\+BLOCK\+\_\+\+HASH} \{\textquotesingle{}s\textquotesingle{}\}
\item 
constexpr uint8\+\_\+t \textbf{ DB\+\_\+\+BLOCK\+\_\+\+HEIGHT} \{\textquotesingle{}t\textquotesingle{}\}
\item 
constexpr uint8\+\_\+t \textbf{ DB\+\_\+\+FILTER\+\_\+\+POS} \{\textquotesingle{}P\textquotesingle{}\}
\item 
constexpr unsigned int \textbf{ MAX\+\_\+\+FLTR\+\_\+\+FILE\+\_\+\+SIZE} = 0x1000000
\item 
constexpr unsigned int \textbf{ FLTR\+\_\+\+FILE\+\_\+\+CHUNK\+\_\+\+SIZE} = 0x100000
\item 
constexpr size\+\_\+t \textbf{ CF\+\_\+\+HEADERS\+\_\+\+CACHE\+\_\+\+MAX\+\_\+\+SZ} \{2000\}
\end{DoxyCompactItemize}


\label{doc-func-members}
\doxysubsection{Function Documentation}
\index{blockfilterindex.cpp@{blockfilterindex.cpp}!DestroyAllBlockFilterIndexes@{DestroyAllBlockFilterIndexes}}
\index{DestroyAllBlockFilterIndexes@{DestroyAllBlockFilterIndexes}!blockfilterindex.cpp@{blockfilterindex.cpp}}
\doxysubsubsection{DestroyAllBlockFilterIndexes()}
{\footnotesize\ttfamily \label{blockfilterindex_8cpp_a5809c1c43a5b3c1d77f10e25a506a565} 
void Destroy\+All\+Block\+Filter\+Indexes (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption})}

Destroy all open block filter indexes. \index{blockfilterindex.cpp@{blockfilterindex.cpp}!DestroyBlockFilterIndex@{DestroyBlockFilterIndex}}
\index{DestroyBlockFilterIndex@{DestroyBlockFilterIndex}!blockfilterindex.cpp@{blockfilterindex.cpp}}
\doxysubsubsection{DestroyBlockFilterIndex()}
{\footnotesize\ttfamily \label{blockfilterindex_8cpp_a2b01ec52cf934f07ad0b840eb6f592ed} 
bool Destroy\+Block\+Filter\+Index (\begin{DoxyParamCaption}\item[{\textbf{ Block\+Filter\+Type}}]{filter\+\_\+type}{}\end{DoxyParamCaption})}

Destroy the block filter index with the given type. Returns false if no such index exists. This just releases the allocated memory and closes the database connection, it does not delete the index data. \index{blockfilterindex.cpp@{blockfilterindex.cpp}!ForEachBlockFilterIndex@{ForEachBlockFilterIndex}}
\index{ForEachBlockFilterIndex@{ForEachBlockFilterIndex}!blockfilterindex.cpp@{blockfilterindex.cpp}}
\doxysubsubsection{ForEachBlockFilterIndex()}
{\footnotesize\ttfamily \label{blockfilterindex_8cpp_aa52651271de1e684295aedd1166ebf14} 
void For\+Each\+Block\+Filter\+Index (\begin{DoxyParamCaption}\item[{std\+::function$<$ void(\textbf{ Block\+Filter\+Index} \&)$>$}]{fn}{}\end{DoxyParamCaption})}

Iterate over all running block filter indexes, invoking fn on each. \index{blockfilterindex.cpp@{blockfilterindex.cpp}!GetBlockFilterIndex@{GetBlockFilterIndex}}
\index{GetBlockFilterIndex@{GetBlockFilterIndex}!blockfilterindex.cpp@{blockfilterindex.cpp}}
\doxysubsubsection{GetBlockFilterIndex()}
{\footnotesize\ttfamily \label{blockfilterindex_8cpp_a7e5a7eafefd6511f8d95b2583bdb53b0} 
\textbf{ Block\+Filter\+Index} $\ast$ Get\+Block\+Filter\+Index (\begin{DoxyParamCaption}\item[{\textbf{ Block\+Filter\+Type}}]{filter\+\_\+type}{}\end{DoxyParamCaption})}

Get a block filter index by type. Returns nullptr if index has not been initialized or was already destroyed. \index{blockfilterindex.cpp@{blockfilterindex.cpp}!InitBlockFilterIndex@{InitBlockFilterIndex}}
\index{InitBlockFilterIndex@{InitBlockFilterIndex}!blockfilterindex.cpp@{blockfilterindex.cpp}}
\doxysubsubsection{InitBlockFilterIndex()}
{\footnotesize\ttfamily \label{blockfilterindex_8cpp_aca74aaaf3cd2da07d55e1b9354952c15} 
bool Init\+Block\+Filter\+Index (\begin{DoxyParamCaption}\item[{std\+::function$<$ std\+::unique\+\_\+ptr$<$ \textbf{ interfaces\+::\+Chain} $>$()$>$}]{make\+\_\+chain}{, }\item[{\textbf{ Block\+Filter\+Type}}]{filter\+\_\+type}{, }\item[{size\+\_\+t}]{n\+\_\+cache\+\_\+size}{, }\item[{bool}]{f\+\_\+memory}{ = {\ttfamily false}, }\item[{bool}]{f\+\_\+wipe}{ = {\ttfamily false}}\end{DoxyParamCaption})}

Initialize a block filter index for the given type if one does not already exist. Returns true if a new index is created and false if one has already been initialized. 

\label{doc-var-members}
\doxysubsection{Variable Documentation}
\index{blockfilterindex.cpp@{blockfilterindex.cpp}!CF\_HEADERS\_CACHE\_MAX\_SZ@{CF\_HEADERS\_CACHE\_MAX\_SZ}}
\index{CF\_HEADERS\_CACHE\_MAX\_SZ@{CF\_HEADERS\_CACHE\_MAX\_SZ}!blockfilterindex.cpp@{blockfilterindex.cpp}}
\doxysubsubsection{CF\_HEADERS\_CACHE\_MAX\_SZ}
{\footnotesize\ttfamily \label{blockfilterindex_8cpp_ab55a01b8db4071d26b5051b63298c6dd} 
size\+\_\+t CF\+\_\+\+HEADERS\+\_\+\+CACHE\+\_\+\+MAX\+\_\+\+SZ \{2000\}\hspace{0.3cm}{\ttfamily [constexpr]}}

Maximum size of the cfheaders cache We have a limit to prevent a bug in filling this cache potentially turning into an OOM. At 2000 entries, this cache is big enough for a 2,000,000 length block chain, which we should be enough until $\sim$2047. \index{blockfilterindex.cpp@{blockfilterindex.cpp}!DB\_BLOCK\_HASH@{DB\_BLOCK\_HASH}}
\index{DB\_BLOCK\_HASH@{DB\_BLOCK\_HASH}!blockfilterindex.cpp@{blockfilterindex.cpp}}
\doxysubsubsection{DB\_BLOCK\_HASH}
{\footnotesize\ttfamily \label{blockfilterindex_8cpp_aa35d80382f5cad0ca2d8081b37db0ea6} 
uint8\+\_\+t DB\+\_\+\+BLOCK\+\_\+\+HASH \{\textquotesingle{}s\textquotesingle{}\}\hspace{0.3cm}{\ttfamily [constexpr]}}

\index{blockfilterindex.cpp@{blockfilterindex.cpp}!DB\_BLOCK\_HEIGHT@{DB\_BLOCK\_HEIGHT}}
\index{DB\_BLOCK\_HEIGHT@{DB\_BLOCK\_HEIGHT}!blockfilterindex.cpp@{blockfilterindex.cpp}}
\doxysubsubsection{DB\_BLOCK\_HEIGHT}
{\footnotesize\ttfamily \label{blockfilterindex_8cpp_ae0aa2e8634a01080040d4cd90cc0dcf8} 
uint8\+\_\+t DB\+\_\+\+BLOCK\+\_\+\+HEIGHT \{\textquotesingle{}t\textquotesingle{}\}\hspace{0.3cm}{\ttfamily [constexpr]}}

\index{blockfilterindex.cpp@{blockfilterindex.cpp}!DB\_FILTER\_POS@{DB\_FILTER\_POS}}
\index{DB\_FILTER\_POS@{DB\_FILTER\_POS}!blockfilterindex.cpp@{blockfilterindex.cpp}}
\doxysubsubsection{DB\_FILTER\_POS}
{\footnotesize\ttfamily \label{blockfilterindex_8cpp_a7f512d8cf4c51f3a48d9700c42249333} 
uint8\+\_\+t DB\+\_\+\+FILTER\+\_\+\+POS \{\textquotesingle{}P\textquotesingle{}\}\hspace{0.3cm}{\ttfamily [constexpr]}}

\index{blockfilterindex.cpp@{blockfilterindex.cpp}!FLTR\_FILE\_CHUNK\_SIZE@{FLTR\_FILE\_CHUNK\_SIZE}}
\index{FLTR\_FILE\_CHUNK\_SIZE@{FLTR\_FILE\_CHUNK\_SIZE}!blockfilterindex.cpp@{blockfilterindex.cpp}}
\doxysubsubsection{FLTR\_FILE\_CHUNK\_SIZE}
{\footnotesize\ttfamily \label{blockfilterindex_8cpp_a29ffa311c98393be54cd19fa3e9eff81} 
unsigned int FLTR\+\_\+\+FILE\+\_\+\+CHUNK\+\_\+\+SIZE = 0x100000\hspace{0.3cm}{\ttfamily [constexpr]}}

The pre-\/allocation chunk size for fltr?????.dat files \index{blockfilterindex.cpp@{blockfilterindex.cpp}!MAX\_FLTR\_FILE\_SIZE@{MAX\_FLTR\_FILE\_SIZE}}
\index{MAX\_FLTR\_FILE\_SIZE@{MAX\_FLTR\_FILE\_SIZE}!blockfilterindex.cpp@{blockfilterindex.cpp}}
\doxysubsubsection{MAX\_FLTR\_FILE\_SIZE}
{\footnotesize\ttfamily \label{blockfilterindex_8cpp_aa00aebf16bed05cda303598f0f1e1305} 
unsigned int MAX\+\_\+\+FLTR\+\_\+\+FILE\+\_\+\+SIZE = 0x1000000\hspace{0.3cm}{\ttfamily [constexpr]}}

