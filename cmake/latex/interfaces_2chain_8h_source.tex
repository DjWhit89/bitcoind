\doxysection{chain.\+h}
\label{interfaces_2chain_8h_source}\index{src/interfaces/chain.h@{src/interfaces/chain.h}}
\textbf{ Go to the documentation of this file.}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{//\ Copyright\ (c)\ 2018-\/present\ The\ Bitcoin\ Core\ developers}}
\DoxyCodeLine{00002\ \textcolor{comment}{//\ Distributed\ under\ the\ MIT\ software\ license,\ see\ the\ accompanying}}
\DoxyCodeLine{00003\ \textcolor{comment}{//\ file\ COPYING\ or\ http://www.opensource.org/licenses/mit-\/license.php.}}
\DoxyCodeLine{00004\ }
\DoxyCodeLine{00005\ \textcolor{preprocessor}{\#ifndef\ BITCOIN\_INTERFACES\_CHAIN\_H}}
\DoxyCodeLine{00006\ \textcolor{preprocessor}{\#define\ BITCOIN\_INTERFACES\_CHAIN\_H}}
\DoxyCodeLine{00007\ }
\DoxyCodeLine{00008\ \textcolor{preprocessor}{\#include\ <blockfilter.h>}}
\DoxyCodeLine{00009\ \textcolor{preprocessor}{\#include\ <common/settings.h>}}
\DoxyCodeLine{00010\ \textcolor{preprocessor}{\#include\ <kernel/chain.h>}\ \textcolor{comment}{//\ IWYU\ pragma:\ export}}
\DoxyCodeLine{00011\ \textcolor{preprocessor}{\#include\ <node/types.h>}}
\DoxyCodeLine{00012\ \textcolor{preprocessor}{\#include\ <primitives/transaction.h>}}
\DoxyCodeLine{00013\ \textcolor{preprocessor}{\#include\ <util/result.h>}}
\DoxyCodeLine{00014\ }
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#include\ <cstddef>}}
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#include\ <cstdint>}}
\DoxyCodeLine{00017\ \textcolor{preprocessor}{\#include\ <functional>}}
\DoxyCodeLine{00018\ \textcolor{preprocessor}{\#include\ <map>}}
\DoxyCodeLine{00019\ \textcolor{preprocessor}{\#include\ <memory>}}
\DoxyCodeLine{00020\ \textcolor{preprocessor}{\#include\ <optional>}}
\DoxyCodeLine{00021\ \textcolor{preprocessor}{\#include\ <string>}}
\DoxyCodeLine{00022\ \textcolor{preprocessor}{\#include\ <vector>}}
\DoxyCodeLine{00023\ }
\DoxyCodeLine{00024\ \textcolor{keyword}{class\ }ArgsManager;}
\DoxyCodeLine{00025\ \textcolor{keyword}{class\ }CBlock;}
\DoxyCodeLine{00026\ \textcolor{keyword}{class\ }CBlockUndo;}
\DoxyCodeLine{00027\ \textcolor{keyword}{class\ }CFeeRate;}
\DoxyCodeLine{00028\ \textcolor{keyword}{class\ }CRPCCommand;}
\DoxyCodeLine{00029\ \textcolor{keyword}{class\ }CScheduler;}
\DoxyCodeLine{00030\ \textcolor{keyword}{class\ }Coin;}
\DoxyCodeLine{00031\ \textcolor{keyword}{class\ }uint256;}
\DoxyCodeLine{00032\ \textcolor{keyword}{enum\ class}\ MemPoolRemovalReason;}
\DoxyCodeLine{00033\ \textcolor{keyword}{enum\ class}\ RBFTransactionState;}
\DoxyCodeLine{00034\ \textcolor{keyword}{struct\ }bilingual\_str;}
\DoxyCodeLine{00035\ \textcolor{keyword}{struct\ }CBlockLocator;}
\DoxyCodeLine{00036\ \textcolor{keyword}{struct\ }FeeCalculation;}
\DoxyCodeLine{00037\ \textcolor{keyword}{namespace\ }kernel\ \{}
\DoxyCodeLine{00038\ \textcolor{keyword}{struct\ }ChainstateRole;}
\DoxyCodeLine{00039\ \}\ \textcolor{comment}{//\ namespace\ kernel}}
\DoxyCodeLine{00040\ \textcolor{keyword}{namespace\ }node\ \{}
\DoxyCodeLine{00041\ \textcolor{keyword}{struct\ }NodeContext;}
\DoxyCodeLine{00042\ \}\ \textcolor{comment}{//\ namespace\ node}}
\DoxyCodeLine{00043\ }
\DoxyCodeLine{00044\ \textcolor{keyword}{namespace\ }interfaces\ \{}
\DoxyCodeLine{00045\ }
\DoxyCodeLine{00046\ \textcolor{keyword}{class\ }Handler;}
\DoxyCodeLine{00047\ \textcolor{keyword}{class\ }Wallet;}
\DoxyCodeLine{00048\ }
\DoxyCodeLine{00052\ \textcolor{keyword}{class\ }FoundBlock}
\DoxyCodeLine{00053\ \{}
\DoxyCodeLine{00054\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00055\ \ \ \ \ FoundBlock\&\ hash(uint256\&\ hash)\ \{\ m\_hash\ =\ \&hash;\ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};\ \}}
\DoxyCodeLine{00056\ \ \ \ \ FoundBlock\&\ height(\textcolor{keywordtype}{int}\&\ height)\ \{\ m\_height\ =\ \&height;\ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};\ \}}
\DoxyCodeLine{00057\ \ \ \ \ FoundBlock\&\ time(int64\_t\&\ time)\ \{\ m\_time\ =\ \&time;\ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};\ \}}
\DoxyCodeLine{00058\ \ \ \ \ FoundBlock\&\ maxTime(int64\_t\&\ max\_time)\ \{\ m\_max\_time\ =\ \&max\_time;\ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};\ \}}
\DoxyCodeLine{00059\ \ \ \ \ FoundBlock\&\ mtpTime(int64\_t\&\ mtp\_time)\ \{\ m\_mtp\_time\ =\ \&mtp\_time;\ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};\ \}}
\DoxyCodeLine{00061\ \ \ \ \ FoundBlock\&\ inActiveChain(\textcolor{keywordtype}{bool}\&\ in\_active\_chain)\ \{\ m\_in\_active\_chain\ =\ \&in\_active\_chain;\ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};\ \}}
\DoxyCodeLine{00063\ \ \ \ \ FoundBlock\&\ locator(CBlockLocator\&\ locator)\ \{\ m\_locator\ =\ \&locator;\ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};\ \}}
\DoxyCodeLine{00065\ \ \ \ \ FoundBlock\&\ nextBlock(\textcolor{keyword}{const}\ FoundBlock\&\ next\_block)\ \{\ m\_next\_block\ =\ \&next\_block;\ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};\ \}}
\DoxyCodeLine{00068\ \ \ \ \ FoundBlock\&\ data(CBlock\&\ data)\ \{\ m\_data\ =\ \&data;\ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};\ \}}
\DoxyCodeLine{00069\ }
\DoxyCodeLine{00070\ \ \ \ \ uint256*\ m\_hash\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00071\ \ \ \ \ \textcolor{keywordtype}{int}*\ m\_height\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00072\ \ \ \ \ int64\_t*\ m\_time\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00073\ \ \ \ \ int64\_t*\ m\_max\_time\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00074\ \ \ \ \ int64\_t*\ m\_mtp\_time\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00075\ \ \ \ \ \textcolor{keywordtype}{bool}*\ m\_in\_active\_chain\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00076\ \ \ \ \ CBlockLocator*\ m\_locator\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00077\ \ \ \ \ \textcolor{keyword}{const}\ FoundBlock*\ m\_next\_block\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00078\ \ \ \ \ CBlock*\ m\_data\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00079\ \ \ \ \ \textcolor{keyword}{mutable}\ \textcolor{keywordtype}{bool}\ found\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00080\ \};}
\DoxyCodeLine{00081\ }
\DoxyCodeLine{00086\ \textcolor{keyword}{enum\ class}\ SettingsAction\ \{}
\DoxyCodeLine{00087\ \ \ \ \ WRITE,}
\DoxyCodeLine{00088\ \ \ \ \ SKIP\_WRITE}
\DoxyCodeLine{00089\ \};}
\DoxyCodeLine{00090\ }
\DoxyCodeLine{00091\ \textcolor{keyword}{using\ }SettingsUpdate\ =\ std::function<std::optional<interfaces::SettingsAction>(common::SettingsValue\&)>;}
\DoxyCodeLine{00092\ }
\DoxyCodeLine{00117\ \textcolor{keyword}{class\ }Chain}
\DoxyCodeLine{00118\ \{}
\DoxyCodeLine{00119\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00120\ \ \ \ \ \textcolor{keyword}{virtual}\ \string~Chain()\ =\ \textcolor{keywordflow}{default};}
\DoxyCodeLine{00121\ }
\DoxyCodeLine{00125\ \ \ \ \ \textcolor{keyword}{virtual}\ std::optional<int>\ getHeight()\ =\ 0;}
\DoxyCodeLine{00126\ }
\DoxyCodeLine{00128\ \ \ \ \ \textcolor{keyword}{virtual}\ uint256\ getBlockHash(\textcolor{keywordtype}{int}\ height)\ =\ 0;}
\DoxyCodeLine{00129\ }
\DoxyCodeLine{00132\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{bool}\ haveBlockOnDisk(\textcolor{keywordtype}{int}\ height)\ =\ 0;}
\DoxyCodeLine{00133\ }
\DoxyCodeLine{00137\ \ \ \ \ \textcolor{keyword}{virtual}\ std::optional<int>\ findLocatorFork(\textcolor{keyword}{const}\ CBlockLocator\&\ locator)\ =\ 0;}
\DoxyCodeLine{00138\ }
\DoxyCodeLine{00140\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{bool}\ hasBlockFilterIndex(BlockFilterType\ filter\_type)\ =\ 0;}
\DoxyCodeLine{00141\ }
\DoxyCodeLine{00144\ \ \ \ \ \textcolor{keyword}{virtual}\ std::optional<bool>\ blockFilterMatchesAny(BlockFilterType\ filter\_type,\ \textcolor{keyword}{const}\ uint256\&\ block\_hash,\ \textcolor{keyword}{const}\ GCSFilter::ElementSet\&\ filter\_set)\ =\ 0;}
\DoxyCodeLine{00145\ }
\DoxyCodeLine{00148\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{bool}\ findBlock(\textcolor{keyword}{const}\ uint256\&\ hash,\ \textcolor{keyword}{const}\ FoundBlock\&\ block=\{\})\ =\ 0;}
\DoxyCodeLine{00149\ }
\DoxyCodeLine{00154\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{bool}\ findFirstBlockWithTimeAndHeight(int64\_t\ min\_time,\ \textcolor{keywordtype}{int}\ min\_height,\ \textcolor{keyword}{const}\ FoundBlock\&\ block=\{\})\ =\ 0;}
\DoxyCodeLine{00155\ }
\DoxyCodeLine{00158\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{bool}\ findAncestorByHeight(\textcolor{keyword}{const}\ uint256\&\ block\_hash,\ \textcolor{keywordtype}{int}\ ancestor\_height,\ \textcolor{keyword}{const}\ FoundBlock\&\ ancestor\_out=\{\})\ =\ 0;}
\DoxyCodeLine{00159\ }
\DoxyCodeLine{00162\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{bool}\ findAncestorByHash(\textcolor{keyword}{const}\ uint256\&\ block\_hash,}
\DoxyCodeLine{00163\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ uint256\&\ ancestor\_hash,}
\DoxyCodeLine{00164\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FoundBlock\&\ ancestor\_out=\{\})\ =\ 0;}
\DoxyCodeLine{00165\ }
\DoxyCodeLine{00168\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{bool}\ findCommonAncestor(\textcolor{keyword}{const}\ uint256\&\ block\_hash1,}
\DoxyCodeLine{00169\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ uint256\&\ block\_hash2,}
\DoxyCodeLine{00170\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FoundBlock\&\ ancestor\_out=\{\},}
\DoxyCodeLine{00171\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FoundBlock\&\ block1\_out=\{\},}
\DoxyCodeLine{00172\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ FoundBlock\&\ block2\_out=\{\})\ =\ 0;}
\DoxyCodeLine{00173\ }
\DoxyCodeLine{00177\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ findCoins(std::map<COutPoint,\ Coin>\&\ coins)\ =\ 0;}
\DoxyCodeLine{00178\ }
\DoxyCodeLine{00181\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{double}\ guessVerificationProgress(\textcolor{keyword}{const}\ uint256\&\ block\_hash)\ =\ 0;}
\DoxyCodeLine{00182\ }
\DoxyCodeLine{00186\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{bool}\ hasBlocks(\textcolor{keyword}{const}\ uint256\&\ block\_hash,\ \textcolor{keywordtype}{int}\ min\_height\ =\ 0,\ std::optional<int>\ max\_height\ =\ \{\})\ =\ 0;}
\DoxyCodeLine{00187\ }
\DoxyCodeLine{00189\ \ \ \ \ \textcolor{keyword}{virtual}\ RBFTransactionState\ isRBFOptIn(\textcolor{keyword}{const}\ CTransaction\&\ tx)\ =\ 0;}
\DoxyCodeLine{00190\ }
\DoxyCodeLine{00192\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{bool}\ isInMempool(\textcolor{keyword}{const}\ Txid\&\ txid)\ =\ 0;}
\DoxyCodeLine{00193\ }
\DoxyCodeLine{00195\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{bool}\ hasDescendantsInMempool(\textcolor{keyword}{const}\ Txid\&\ txid)\ =\ 0;}
\DoxyCodeLine{00196\ }
\DoxyCodeLine{00206\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{bool}\ broadcastTransaction(\textcolor{keyword}{const}\ CTransactionRef\&\ tx,}
\DoxyCodeLine{00207\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ CAmount\&\ max\_tx\_fee,}
\DoxyCodeLine{00208\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ node::TxBroadcast\ broadcast\_method,}
\DoxyCodeLine{00209\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::string\&\ err\_string)\ =\ 0;}
\DoxyCodeLine{00210\ }
\DoxyCodeLine{00212\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ getTransactionAncestry(\textcolor{keyword}{const}\ Txid\&\ txid,\ \textcolor{keywordtype}{size\_t}\&\ ancestors,\ \textcolor{keywordtype}{size\_t}\&\ cluster\_count,\ \textcolor{keywordtype}{size\_t}*\ ancestorsize\ =\ \textcolor{keyword}{nullptr},\ CAmount*\ ancestorfees\ =\ \textcolor{keyword}{nullptr})\ =\ 0;}
\DoxyCodeLine{00213\ }
\DoxyCodeLine{00215\ \ \ \ \ \textcolor{comment}{//\ \ feerate,\ including\ bumping\ its\ ancestors.\ For\ example,\ if\ the\ target\ feerate\ is\ 10sat/vbyte}}
\DoxyCodeLine{00216\ \ \ \ \ \textcolor{comment}{//\ \ and\ this\ outpoint\ refers\ to\ a\ mempool\ transaction\ at\ 3sat/vbyte,\ the\ bump\ fee\ includes\ the}}
\DoxyCodeLine{00217\ \ \ \ \ \textcolor{comment}{//\ \ cost\ to\ bump\ the\ mempool\ transaction\ to\ 10sat/vbyte\ (i.e.\ 7\ *\ mempooltx.vsize).\ If\ that}}
\DoxyCodeLine{00218\ \ \ \ \ \textcolor{comment}{//\ \ transaction\ also\ has,\ say,\ an\ unconfirmed\ parent\ with\ a\ feerate\ of\ 1sat/vbyte,\ the\ bump\ fee}}
\DoxyCodeLine{00219\ \ \ \ \ \textcolor{comment}{//\ \ includes\ the\ cost\ to\ bump\ the\ parent\ (i.e.\ 9\ *\ parentmempooltx.vsize).}}
\DoxyCodeLine{00220\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00221\ \ \ \ \ \textcolor{comment}{//\ \ If\ the\ outpoint\ comes\ from\ an\ unconfirmed\ transaction\ that\ is\ already\ above\ the\ target}}
\DoxyCodeLine{00222\ \ \ \ \ \textcolor{comment}{//\ \ feerate\ or\ bumped\ by\ its\ descendant(s)\ already,\ it\ does\ not\ need\ to\ be\ bumped.\ Its\ bump\ fee}}
\DoxyCodeLine{00223\ \ \ \ \ \textcolor{comment}{//\ \ is\ 0.\ Likewise,\ if\ any\ of\ the\ transaction's\ ancestors\ are\ already\ bumped\ by\ a\ transaction}}
\DoxyCodeLine{00224\ \ \ \ \ \textcolor{comment}{//\ \ in\ our\ mempool,\ they\ are\ not\ included\ in\ the\ transaction's\ bump\ fee.}}
\DoxyCodeLine{00225\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00226\ \ \ \ \ \textcolor{comment}{//\ \ Also\ supported\ is\ bump-\/fee\ calculation\ in\ the\ case\ of\ replacements.\ If\ an\ outpoint}}
\DoxyCodeLine{00227\ \ \ \ \ \textcolor{comment}{//\ \ conflicts\ with\ another\ transaction\ in\ the\ mempool,\ it\ is\ assumed\ that\ the\ goal\ is\ to\ replace}}
\DoxyCodeLine{00228\ \ \ \ \ \textcolor{comment}{//\ \ that\ transaction.\ As\ such,\ the\ calculation\ will\ exclude\ the\ to-\/be-\/replaced\ transaction,\ but}}
\DoxyCodeLine{00229\ \ \ \ \ \textcolor{comment}{//\ \ will\ include\ the\ fee-\/bumping\ cost.\ If\ bump\ fees\ of\ descendants\ of\ the\ to-\/be-\/replaced}}
\DoxyCodeLine{00230\ \ \ \ \ \textcolor{comment}{//\ \ transaction\ are\ requested,\ the\ value\ will\ be\ 0.\ Fee-\/related\ RBF\ rules\ are\ not\ included\ as}}
\DoxyCodeLine{00231\ \ \ \ \ \textcolor{comment}{//\ \ they\ are\ logically\ distinct.}}
\DoxyCodeLine{00232\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00233\ \ \ \ \ \textcolor{comment}{//\ \ Any\ outpoints\ that\ are\ otherwise\ unavailable\ from\ the\ mempool\ (e.g.\ UTXOs\ from\ confirmed}}
\DoxyCodeLine{00234\ \ \ \ \ \textcolor{comment}{//\ \ transactions\ or\ transactions\ not\ yet\ broadcast\ by\ the\ wallet)\ are\ given\ a\ bump\ fee\ of\ 0.}}
\DoxyCodeLine{00235\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00236\ \ \ \ \ \textcolor{comment}{//\ \ If\ multiple\ outpoints\ come\ from\ the\ same\ transaction\ (which\ would\ be\ very\ rare\ because}}
\DoxyCodeLine{00237\ \ \ \ \ \textcolor{comment}{//\ \ it\ means\ that\ one\ transaction\ has\ multiple\ change\ outputs\ or\ paid\ the\ same\ wallet\ using\ multiple}}
\DoxyCodeLine{00238\ \ \ \ \ \textcolor{comment}{//\ \ outputs\ in\ the\ same\ transaction)\ or\ have\ shared\ ancestry,\ the\ bump\ fees\ are\ calculated}}
\DoxyCodeLine{00239\ \ \ \ \ \textcolor{comment}{//\ \ independently,\ i.e.\ as\ if\ only\ one\ of\ them\ is\ spent.\ This\ may\ result\ in\ double-\/fee-\/bumping.\ This}}
\DoxyCodeLine{00240\ \ \ \ \ \textcolor{comment}{//\ \ caveat\ can\ be\ rectified\ per\ use\ of\ the\ sister-\/function\ CalculateCombinedBumpFee(…).}}
\DoxyCodeLine{00241\ \ \ \ \ \textcolor{keyword}{virtual}\ std::map<COutPoint,\ CAmount>\ calculateIndividualBumpFees(\textcolor{keyword}{const}\ std::vector<COutPoint>\&\ outpoints,\ \textcolor{keyword}{const}\ CFeeRate\&\ target\_feerate)\ =\ 0;}
\DoxyCodeLine{00242\ }
\DoxyCodeLine{00244\ \ \ \ \ \textcolor{comment}{//\ \ as\ in\ CalculateIndividualBumpFees(…).}}
\DoxyCodeLine{00245\ \ \ \ \ \textcolor{comment}{//\ \ Unlike\ CalculateIndividualBumpFees(…),\ this\ does\ not\ return\ individual}}
\DoxyCodeLine{00246\ \ \ \ \ \textcolor{comment}{//\ \ bump\ fees\ per\ outpoint,\ but\ a\ single\ bump\ fee\ for\ the\ shared\ ancestry.}}
\DoxyCodeLine{00247\ \ \ \ \ \textcolor{comment}{//\ \ The\ combined\ bump\ fee\ may\ be\ used\ to\ correct\ overestimation\ due\ to}}
\DoxyCodeLine{00248\ \ \ \ \ \textcolor{comment}{//\ \ shared\ ancestry\ by\ multiple\ UTXOs\ after\ coin\ selection.}}
\DoxyCodeLine{00249\ \ \ \ \ \textcolor{keyword}{virtual}\ std::optional<CAmount>\ calculateCombinedBumpFee(\textcolor{keyword}{const}\ std::vector<COutPoint>\&\ outpoints,\ \textcolor{keyword}{const}\ CFeeRate\&\ target\_feerate)\ =\ 0;}
\DoxyCodeLine{00250\ }
\DoxyCodeLine{00254\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ getPackageLimits(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\&\ limit\_ancestor\_count,\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\&\ limit\_descendant\_count)\ =\ 0;}
\DoxyCodeLine{00255\ }
\DoxyCodeLine{00257\ \ \ \ \ \textcolor{keyword}{virtual}\ util::Result<void>\ checkChainLimits(\textcolor{keyword}{const}\ CTransactionRef\&\ tx)\ =\ 0;}
\DoxyCodeLine{00258\ }
\DoxyCodeLine{00260\ \ \ \ \ \textcolor{keyword}{virtual}\ CFeeRate\ estimateSmartFee(\textcolor{keywordtype}{int}\ num\_blocks,\ \textcolor{keywordtype}{bool}\ conservative,\ FeeCalculation*\ calc\ =\ \textcolor{keyword}{nullptr})\ =\ 0;}
\DoxyCodeLine{00261\ }
\DoxyCodeLine{00263\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ estimateMaxBlocks()\ =\ 0;}
\DoxyCodeLine{00264\ }
\DoxyCodeLine{00266\ \ \ \ \ \textcolor{keyword}{virtual}\ CFeeRate\ mempoolMinFee()\ =\ 0;}
\DoxyCodeLine{00267\ }
\DoxyCodeLine{00269\ \ \ \ \ \textcolor{keyword}{virtual}\ CFeeRate\ relayMinFee()\ =\ 0;}
\DoxyCodeLine{00270\ }
\DoxyCodeLine{00272\ \ \ \ \ \textcolor{keyword}{virtual}\ CFeeRate\ relayIncrementalFee()\ =\ 0;}
\DoxyCodeLine{00273\ }
\DoxyCodeLine{00275\ \ \ \ \ \textcolor{keyword}{virtual}\ CFeeRate\ relayDustFee()\ =\ 0;}
\DoxyCodeLine{00276\ }
\DoxyCodeLine{00278\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{bool}\ havePruned()\ =\ 0;}
\DoxyCodeLine{00279\ }
\DoxyCodeLine{00281\ \ \ \ \ \textcolor{keyword}{virtual}\ std::optional<int>\ getPruneHeight()\ =\ 0;}
\DoxyCodeLine{00282\ }
\DoxyCodeLine{00284\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{bool}\ isReadyToBroadcast()\ =\ 0;}
\DoxyCodeLine{00285\ }
\DoxyCodeLine{00287\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{bool}\ isInitialBlockDownload()\ =\ 0;}
\DoxyCodeLine{00288\ }
\DoxyCodeLine{00290\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{bool}\ shutdownRequested()\ =\ 0;}
\DoxyCodeLine{00291\ }
\DoxyCodeLine{00293\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ initMessage(\textcolor{keyword}{const}\ std::string\&\ message)\ =\ 0;}
\DoxyCodeLine{00294\ }
\DoxyCodeLine{00296\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ initWarning(\textcolor{keyword}{const}\ bilingual\_str\&\ message)\ =\ 0;}
\DoxyCodeLine{00297\ }
\DoxyCodeLine{00299\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ initError(\textcolor{keyword}{const}\ bilingual\_str\&\ message)\ =\ 0;}
\DoxyCodeLine{00300\ }
\DoxyCodeLine{00302\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ showProgress(\textcolor{keyword}{const}\ std::string\&\ title,\ \textcolor{keywordtype}{int}\ progress,\ \textcolor{keywordtype}{bool}\ resume\_possible)\ =\ 0;}
\DoxyCodeLine{00303\ }
\DoxyCodeLine{00305\ \ \ \ \ \textcolor{keyword}{class\ }Notifications}
\DoxyCodeLine{00306\ \ \ \ \ \{}
\DoxyCodeLine{00307\ \ \ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00308\ \ \ \ \ \ \ \ \ \textcolor{keyword}{virtual}\ \string~Notifications()\ =\ \textcolor{keywordflow}{default};}
\DoxyCodeLine{00309\ \ \ \ \ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ transactionAddedToMempool(\textcolor{keyword}{const}\ CTransactionRef\&\ tx)\ \{\}}
\DoxyCodeLine{00310\ \ \ \ \ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ transactionRemovedFromMempool(\textcolor{keyword}{const}\ CTransactionRef\&\ tx,\ MemPoolRemovalReason\ reason)\ \{\}}
\DoxyCodeLine{00311\ \ \ \ \ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ blockConnected(\textcolor{keyword}{const}\ kernel::ChainstateRole\&\ role,\ \textcolor{keyword}{const}\ BlockInfo\&\ block)\ \{\}}
\DoxyCodeLine{00312\ \ \ \ \ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ blockDisconnected(\textcolor{keyword}{const}\ BlockInfo\&\ block)\ \{\}}
\DoxyCodeLine{00313\ \ \ \ \ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ updatedBlockTip()\ \{\}}
\DoxyCodeLine{00314\ \ \ \ \ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ chainStateFlushed(\textcolor{keyword}{const}\ kernel::ChainstateRole\&\ role,\ \textcolor{keyword}{const}\ CBlockLocator\&\ locator)\ \{\}}
\DoxyCodeLine{00315\ \ \ \ \ \};}
\DoxyCodeLine{00316\ }
\DoxyCodeLine{00318\ \ \ \ \ \textcolor{keyword}{struct\ }NotifyOptions}
\DoxyCodeLine{00319\ \ \ \ \ \{}
\DoxyCodeLine{00321\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ connect\_undo\_data\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00323\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ disconnect\_data\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00325\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ disconnect\_undo\_data\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00326\ \ \ \ \ \};}
\DoxyCodeLine{00327\ }
\DoxyCodeLine{00329\ \ \ \ \ \textcolor{keyword}{virtual}\ std::unique\_ptr<Handler>\ handleNotifications(std::shared\_ptr<Notifications>\ notifications)\ =\ 0;}
\DoxyCodeLine{00330\ }
\DoxyCodeLine{00333\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ waitForNotificationsIfTipChanged(\textcolor{keyword}{const}\ uint256\&\ old\_tip)\ =\ 0;}
\DoxyCodeLine{00334\ }
\DoxyCodeLine{00337\ \ \ \ \ \textcolor{keyword}{virtual}\ std::unique\_ptr<Handler>\ handleRpc(\textcolor{keyword}{const}\ CRPCCommand\&\ command)\ =\ 0;}
\DoxyCodeLine{00338\ }
\DoxyCodeLine{00340\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{bool}\ rpcEnableDeprecated(\textcolor{keyword}{const}\ std::string\&\ method)\ =\ 0;}
\DoxyCodeLine{00341\ }
\DoxyCodeLine{00343\ \ \ \ \ \textcolor{keyword}{virtual}\ common::SettingsValue\ getSetting(\textcolor{keyword}{const}\ std::string\&\ arg)\ =\ 0;}
\DoxyCodeLine{00344\ }
\DoxyCodeLine{00346\ \ \ \ \ \textcolor{keyword}{virtual}\ std::vector<common::SettingsValue>\ getSettingsList(\textcolor{keyword}{const}\ std::string\&\ arg)\ =\ 0;}
\DoxyCodeLine{00347\ }
\DoxyCodeLine{00349\ \ \ \ \ \textcolor{keyword}{virtual}\ common::SettingsValue\ getRwSetting(\textcolor{keyword}{const}\ std::string\&\ name)\ =\ 0;}
\DoxyCodeLine{00350\ }
\DoxyCodeLine{00356\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{bool}\ updateRwSetting(\textcolor{keyword}{const}\ std::string\&\ name,\ \textcolor{keyword}{const}\ SettingsUpdate\&\ update\_function)\ =\ 0;}
\DoxyCodeLine{00357\ }
\DoxyCodeLine{00362\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{bool}\ overwriteRwSetting(\textcolor{keyword}{const}\ std::string\&\ name,\ common::SettingsValue\ value,\ SettingsAction\ action\ =\ SettingsAction::WRITE)\ =\ 0;}
\DoxyCodeLine{00363\ }
\DoxyCodeLine{00367\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{bool}\ deleteRwSettings(\textcolor{keyword}{const}\ std::string\&\ name,\ SettingsAction\ action\ =\ SettingsAction::WRITE)\ =\ 0;}
\DoxyCodeLine{00368\ }
\DoxyCodeLine{00377\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ requestMempoolTransactions(Notifications\&\ notifications)\ =\ 0;}
\DoxyCodeLine{00378\ }
\DoxyCodeLine{00382\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{bool}\ hasAssumedValidChain()\ =\ 0;}
\DoxyCodeLine{00383\ }
\DoxyCodeLine{00386\ \ \ \ \ \textcolor{keyword}{virtual}\ node::NodeContext*\ context()\ \{\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};\ \}}
\DoxyCodeLine{00387\ \};}
\DoxyCodeLine{00388\ }
\DoxyCodeLine{00391\ \textcolor{keyword}{class\ }ChainClient}
\DoxyCodeLine{00392\ \{}
\DoxyCodeLine{00393\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00394\ \ \ \ \ \textcolor{keyword}{virtual}\ \string~ChainClient()\ =\ \textcolor{keywordflow}{default};}
\DoxyCodeLine{00395\ }
\DoxyCodeLine{00397\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ registerRpcs()\ =\ 0;}
\DoxyCodeLine{00398\ }
\DoxyCodeLine{00400\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{bool}\ verify()\ =\ 0;}
\DoxyCodeLine{00401\ }
\DoxyCodeLine{00403\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{bool}\ load()\ =\ 0;}
\DoxyCodeLine{00404\ }
\DoxyCodeLine{00406\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ start(CScheduler\&\ scheduler)\ =\ 0;}
\DoxyCodeLine{00407\ }
\DoxyCodeLine{00409\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ stop()\ =\ 0;}
\DoxyCodeLine{00410\ }
\DoxyCodeLine{00412\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ setMockTime(int64\_t\ time)\ =\ 0;}
\DoxyCodeLine{00413\ }
\DoxyCodeLine{00415\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ schedulerMockForward(std::chrono::seconds\ delta\_seconds)\ =\ 0;}
\DoxyCodeLine{00416\ \};}
\DoxyCodeLine{00417\ }
\DoxyCodeLine{00419\ std::unique\_ptr<Chain>\ MakeChain(node::NodeContext\&\ node);}
\DoxyCodeLine{00420\ }
\DoxyCodeLine{00421\ \}\ \textcolor{comment}{//\ namespace\ interfaces}}
\DoxyCodeLine{00422\ }
\DoxyCodeLine{00423\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//\ BITCOIN\_INTERFACES\_CHAIN\_H}}

\end{DoxyCode}
