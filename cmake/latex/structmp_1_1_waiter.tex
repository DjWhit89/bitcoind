\doxysection{Waiter Struct Reference}
\label{structmp_1_1_waiter}\index{Waiter@{Waiter}}


{\ttfamily \#include $<$proxy-\/io.\+h$>$}

\doxysubsubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\textbf{ Waiter} ()=default
\item 
{\footnotesize template$<$typename Fn$>$ }\\bool \textbf{ post} (Fn \&\&fn)
\item 
{\footnotesize template$<$class Predicate$>$ }\\void \textbf{ wait} (\textbf{ Lock} \&lock, Predicate pred)
\item 
std\+::optional$<$ kj\+::\+Function$<$ void()$>$ $>$ m\+\_\+fn \textbf{ MP\+\_\+\+GUARDED\+\_\+\+BY} (\textbf{ m\+\_\+mutex})
\end{DoxyCompactItemize}
\doxysubsubsection*{Data Fields}
\begin{DoxyCompactItemize}
\item 
\textbf{ Mutex} \textbf{ m\+\_\+mutex}
\item 
std\+::condition\+\_\+variable \textbf{ m\+\_\+cv}
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Single element task queue used to handle recursive capnp calls. (If server makes an callback into the client in the middle of a request, while client thread is blocked waiting for server response, this is what allows the client to run the request in the same thread, the same way code would run in single process, with the callback sharing same thread stack as the original call. 

\label{doc-constructors}
\doxysubsection{Constructor \& Destructor Documentation}
\index{Waiter@{Waiter}!Waiter@{Waiter}}
\index{Waiter@{Waiter}!Waiter@{Waiter}}
\doxysubsubsection{Waiter()}
{\footnotesize\ttfamily \label{structmp_1_1_waiter_aee95e52957a56b142aae7d97e4d81172} 
Waiter (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [default]}}



\label{doc-func-members}
\doxysubsection{Member Function Documentation}
\index{Waiter@{Waiter}!MP\_GUARDED\_BY@{MP\_GUARDED\_BY}}
\index{MP\_GUARDED\_BY@{MP\_GUARDED\_BY}!Waiter@{Waiter}}
\doxysubsubsection{MP\_GUARDED\_BY()}
{\footnotesize\ttfamily \label{structmp_1_1_waiter_a3923af766063ee5af4ebcb7477371791} 
std\+::optional$<$ kj\+::\+Function$<$ void()$>$ $>$ m\+\_\+fn MP\+\_\+\+GUARDED\+\_\+\+BY (\begin{DoxyParamCaption}\item[{\textbf{ m\+\_\+mutex}}]{}{}\end{DoxyParamCaption})}

\index{Waiter@{Waiter}!post@{post}}
\index{post@{post}!Waiter@{Waiter}}
\doxysubsubsection{post()}
{\footnotesize\ttfamily \label{structmp_1_1_waiter_aa406a75cf282d0ac5cb532edd2ba9fa7} 
template$<$typename Fn$>$ \\
bool post (\begin{DoxyParamCaption}\item[{Fn \&\&}]{fn}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}

\index{Waiter@{Waiter}!wait@{wait}}
\index{wait@{wait}!Waiter@{Waiter}}
\doxysubsubsection{wait()}
{\footnotesize\ttfamily \label{structmp_1_1_waiter_a365fb970e0590633a23f4a61df876c2b} 
template$<$class Predicate$>$ \\
void wait (\begin{DoxyParamCaption}\item[{\textbf{ Lock} \&}]{lock}{, }\item[{Predicate}]{pred}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



\label{doc-variable-members}
\doxysubsection{Field Documentation}
\index{Waiter@{Waiter}!m\_cv@{m\_cv}}
\index{m\_cv@{m\_cv}!Waiter@{Waiter}}
\doxysubsubsection{m\_cv}
{\footnotesize\ttfamily \label{structmp_1_1_waiter_accca0ab294feb9061406ae9c73a3ceb5} 
std\+::condition\+\_\+variable m\+\_\+cv}

\index{Waiter@{Waiter}!m\_mutex@{m\_mutex}}
\index{m\_mutex@{m\_mutex}!Waiter@{Waiter}}
\doxysubsubsection{m\_mutex}
{\footnotesize\ttfamily \label{structmp_1_1_waiter_a71aaf23d91d7b7a5611738c4f06e3577} 
\textbf{ Mutex} m\+\_\+mutex}

\doxyref{Mutex}{p.}{sync_8h_a326d1d46ce05b5316d8ebe2694a10a6e} mainly used internally by waiter class, but also used externally to guard access to related state. Specifically, since the thread\+\_\+local \doxyref{Thread\+Context}{p.}{structmp_1_1_thread_context} struct owns a \doxyref{Waiter}{p.}{structmp_1_1_waiter}, the \doxyref{Waiter\+::m\+\_\+mutex}{p.}{structmp_1_1_waiter_a71aaf23d91d7b7a5611738c4f06e3577} is used to guard access to other parts of the struct to avoid needing to deal with more mutexes than necessary. This mutex can be held at the same time as \doxyref{Event\+Loop\+::m\+\_\+mutex}{p.}{classmp_1_1_event_loop_a71aaf23d91d7b7a5611738c4f06e3577} as long as Waiter\+::mutex is locked first and \doxyref{Event\+Loop\+::m\+\_\+mutex}{p.}{classmp_1_1_event_loop_a71aaf23d91d7b7a5611738c4f06e3577} is locked second. 

The documentation for this struct was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
src/ipc/libmultiprocess/include/mp/\textbf{ proxy-\/io.\+h}\end{DoxyCompactItemize}
