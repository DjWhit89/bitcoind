\doxysection{src/common/signmessage.h File Reference}
\label{signmessage_8h}\index{src/common/signmessage.h@{src/common/signmessage.h}}
{\ttfamily \#include $<$uint256.\+h$>$}\newline
{\ttfamily \#include $<$string$>$}\newline
\doxysubsubsection*{Enumerations}
\begin{DoxyCompactItemize}
\item 
enum class \textbf{ Message\+Verification\+Result} \{ \newline
\textbf{ ERR\+\_\+\+INVALID\+\_\+\+ADDRESS}
, \textbf{ ERR\+\_\+\+ADDRESS\+\_\+\+NO\+\_\+\+KEY}
, \textbf{ ERR\+\_\+\+MALFORMED\+\_\+\+SIGNATURE}
, \textbf{ ERR\+\_\+\+PUBKEY\+\_\+\+NOT\+\_\+\+RECOVERED}
, \newline
\textbf{ ERR\+\_\+\+NOT\+\_\+\+SIGNED}
, \textbf{ OK}
 \}
\item 
enum class \textbf{ Signing\+Result} \{ \textbf{ OK}
, \textbf{ PRIVATE\+\_\+\+KEY\+\_\+\+NOT\+\_\+\+AVAILABLE}
, \textbf{ SIGNING\+\_\+\+FAILED}
 \}
\end{DoxyCompactItemize}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\textbf{ Message\+Verification\+Result} \textbf{ Message\+Verify} (const std\+::string \&address, const std\+::string \&signature, const std\+::string \&message)
\item 
bool \textbf{ Message\+Sign} (const \textbf{ CKey} \&privkey, const std\+::string \&message, std\+::string \&signature)
\item 
\textbf{ uint256} \textbf{ Message\+Hash} (const std\+::string \&message)
\item 
std\+::string \textbf{ Signing\+Result\+String} (const \textbf{ Signing\+Result} res)
\end{DoxyCompactItemize}
\doxysubsubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
const std\+::string \textbf{ MESSAGE\+\_\+\+MAGIC}
\end{DoxyCompactItemize}


\label{doc-enum-members}
\doxysubsection{Enumeration Type Documentation}
\index{signmessage.h@{signmessage.h}!MessageVerificationResult@{MessageVerificationResult}}
\index{MessageVerificationResult@{MessageVerificationResult}!signmessage.h@{signmessage.h}}
\doxysubsubsection{MessageVerificationResult}
{\footnotesize\ttfamily \label{signmessage_8h_a6768e6112e60fada6659fdf622b87fa9} 
enum class \textbf{ Message\+Verification\+Result}\hspace{0.3cm}{\ttfamily [strong]}}

The result of a signed message verification. Message verification takes as an input\+:
\begin{DoxyItemize}
\item address (with whose private key the message is supposed to have been signed)
\item signature
\item message 
\end{DoxyItemize}\begin{DoxyEnumFields}[2]{Enumerator}
\raisebox{\heightof{T}}[0pt][0pt]{\index{ERR\_INVALID\_ADDRESS@{ERR\_INVALID\_ADDRESS}!signmessage.h@{signmessage.h}}\index{signmessage.h@{signmessage.h}!ERR\_INVALID\_ADDRESS@{ERR\_INVALID\_ADDRESS}}}\label{signmessage_8h_a6768e6112e60fada6659fdf622b87fa9a1ca481342d643dede5f16ff597e07aec} 
ERR\+\_\+\+INVALID\+\_\+\+ADDRESS&The provided address is invalid. \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{ERR\_ADDRESS\_NO\_KEY@{ERR\_ADDRESS\_NO\_KEY}!signmessage.h@{signmessage.h}}\index{signmessage.h@{signmessage.h}!ERR\_ADDRESS\_NO\_KEY@{ERR\_ADDRESS\_NO\_KEY}}}\label{signmessage_8h_a6768e6112e60fada6659fdf622b87fa9a9cb26ad9e49599593d763f563494dfa9} 
ERR\+\_\+\+ADDRESS\+\_\+\+NO\+\_\+\+KEY&The provided address is valid but does not refer to a public key. \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{ERR\_MALFORMED\_SIGNATURE@{ERR\_MALFORMED\_SIGNATURE}!signmessage.h@{signmessage.h}}\index{signmessage.h@{signmessage.h}!ERR\_MALFORMED\_SIGNATURE@{ERR\_MALFORMED\_SIGNATURE}}}\label{signmessage_8h_a6768e6112e60fada6659fdf622b87fa9a136687654322d7630d48179214ce301c} 
ERR\+\_\+\+MALFORMED\+\_\+\+SIGNATURE&The provided signature couldn\textquotesingle{}t be parsed (maybe invalid base64). \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{ERR\_PUBKEY\_NOT\_RECOVERED@{ERR\_PUBKEY\_NOT\_RECOVERED}!signmessage.h@{signmessage.h}}\index{signmessage.h@{signmessage.h}!ERR\_PUBKEY\_NOT\_RECOVERED@{ERR\_PUBKEY\_NOT\_RECOVERED}}}\label{signmessage_8h_a6768e6112e60fada6659fdf622b87fa9afb203e482914ca50e84df1c18d3f6248} 
ERR\+\_\+\+PUBKEY\+\_\+\+NOT\+\_\+\+RECOVERED&A public key could not be recovered from the provided signature and message. \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{ERR\_NOT\_SIGNED@{ERR\_NOT\_SIGNED}!signmessage.h@{signmessage.h}}\index{signmessage.h@{signmessage.h}!ERR\_NOT\_SIGNED@{ERR\_NOT\_SIGNED}}}\label{signmessage_8h_a6768e6112e60fada6659fdf622b87fa9aac8621c43ff9897d7666bc57e042e38e} 
ERR\+\_\+\+NOT\+\_\+\+SIGNED&The message was not signed with the private key of the provided address. \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{OK@{OK}!signmessage.h@{signmessage.h}}\index{signmessage.h@{signmessage.h}!OK@{OK}}}\label{signmessage_8h_a6768e6112e60fada6659fdf622b87fa9ae0aa021e21dddbd6d8cecec71e9cf564} 
OK&The message verification was successful. \\
\hline

\end{DoxyEnumFields}
\index{signmessage.h@{signmessage.h}!SigningResult@{SigningResult}}
\index{SigningResult@{SigningResult}!signmessage.h@{signmessage.h}}
\doxysubsubsection{SigningResult}
{\footnotesize\ttfamily \label{signmessage_8h_a5f6c064c16999f3c857affb9e4b99a1e} 
enum class \textbf{ Signing\+Result}\hspace{0.3cm}{\ttfamily [strong]}}

\begin{DoxyEnumFields}[2]{Enumerator}
\raisebox{\heightof{T}}[0pt][0pt]{\index{OK@{OK}!signmessage.h@{signmessage.h}}\index{signmessage.h@{signmessage.h}!OK@{OK}}}\label{signmessage_8h_a5f6c064c16999f3c857affb9e4b99a1eae0aa021e21dddbd6d8cecec71e9cf564} 
OK&No error. \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{PRIVATE\_KEY\_NOT\_AVAILABLE@{PRIVATE\_KEY\_NOT\_AVAILABLE}!signmessage.h@{signmessage.h}}\index{signmessage.h@{signmessage.h}!PRIVATE\_KEY\_NOT\_AVAILABLE@{PRIVATE\_KEY\_NOT\_AVAILABLE}}}\label{signmessage_8h_a5f6c064c16999f3c857affb9e4b99a1ea0d40740008374242249a69a02909e6cb} 
PRIVATE\+\_\+\+KEY\+\_\+\+NOT\+\_\+\+AVAILABLE&\\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{SIGNING\_FAILED@{SIGNING\_FAILED}!signmessage.h@{signmessage.h}}\index{signmessage.h@{signmessage.h}!SIGNING\_FAILED@{SIGNING\_FAILED}}}\label{signmessage_8h_a5f6c064c16999f3c857affb9e4b99a1ea5949069cd0ebd438f332cab590a1b073} 
SIGNING\+\_\+\+FAILED&\\
\hline

\end{DoxyEnumFields}


\label{doc-func-members}
\doxysubsection{Function Documentation}
\index{signmessage.h@{signmessage.h}!MessageHash@{MessageHash}}
\index{MessageHash@{MessageHash}!signmessage.h@{signmessage.h}}
\doxysubsubsection{MessageHash()}
{\footnotesize\ttfamily \label{signmessage_8h_a1e46bfaa3d4a60127bc3567500ab33e0} 
\textbf{ uint256} Message\+Hash (\begin{DoxyParamCaption}\item[{const std\+::string \&}]{message}{}\end{DoxyParamCaption})}

Hashes a message for signing and verification in a manner that prevents inadvertently signing a transaction. \index{signmessage.h@{signmessage.h}!MessageSign@{MessageSign}}
\index{MessageSign@{MessageSign}!signmessage.h@{signmessage.h}}
\doxysubsubsection{MessageSign()}
{\footnotesize\ttfamily \label{signmessage_8h_a8f468cc4ed9c26654965d4725ca2328c} 
bool Message\+Sign (\begin{DoxyParamCaption}\item[{const \textbf{ CKey} \&}]{privkey}{, }\item[{const std\+::string \&}]{message}{, }\item[{std\+::string \&}]{signature}{}\end{DoxyParamCaption})}

Sign a message. 
\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{in}}  & {\em privkey} & Private key to sign with. \\
\hline
\mbox{\texttt{in}}  & {\em message} & The message to sign. \\
\hline
\mbox{\texttt{out}}  & {\em signature} & Signature, base64 encoded, only set if true is returned. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
true if signing was successful. 
\end{DoxyReturn}
\index{signmessage.h@{signmessage.h}!MessageVerify@{MessageVerify}}
\index{MessageVerify@{MessageVerify}!signmessage.h@{signmessage.h}}
\doxysubsubsection{MessageVerify()}
{\footnotesize\ttfamily \label{signmessage_8h_ae9b3748dda75a2b345247a4ecda4e411} 
\textbf{ Message\+Verification\+Result} Message\+Verify (\begin{DoxyParamCaption}\item[{const std\+::string \&}]{address}{, }\item[{const std\+::string \&}]{signature}{, }\item[{const std\+::string \&}]{message}{}\end{DoxyParamCaption})}

Verify a signed message. 
\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{in}}  & {\em address} & Signer\textquotesingle{}s bitcoin address, it must refer to a public key. \\
\hline
\mbox{\texttt{in}}  & {\em signature} & The signature in base64 format. \\
\hline
\mbox{\texttt{in}}  & {\em message} & The message that was signed. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
result code 
\end{DoxyReturn}
\index{signmessage.h@{signmessage.h}!SigningResultString@{SigningResultString}}
\index{SigningResultString@{SigningResultString}!signmessage.h@{signmessage.h}}
\doxysubsubsection{SigningResultString()}
{\footnotesize\ttfamily \label{signmessage_8h_ab31473fff0976e80fcd67166175c0c16} 
std\+::string Signing\+Result\+String (\begin{DoxyParamCaption}\item[{const \textbf{ Signing\+Result}}]{res}{}\end{DoxyParamCaption})}



\label{doc-var-members}
\doxysubsection{Variable Documentation}
\index{signmessage.h@{signmessage.h}!MESSAGE\_MAGIC@{MESSAGE\_MAGIC}}
\index{MESSAGE\_MAGIC@{MESSAGE\_MAGIC}!signmessage.h@{signmessage.h}}
\doxysubsubsection{MESSAGE\_MAGIC}
{\footnotesize\ttfamily \label{signmessage_8h_aabee2cd4984433ed008727913d550262} 
const std\+::string MESSAGE\+\_\+\+MAGIC\hspace{0.3cm}{\ttfamily [extern]}}

Text used to signify that a signed message follows and to prevent inadvertently signing a transaction. 