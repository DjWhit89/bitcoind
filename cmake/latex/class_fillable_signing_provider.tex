\doxysection{Fillable\+Signing\+Provider Class Reference}
\label{class_fillable_signing_provider}\index{FillableSigningProvider@{FillableSigningProvider}}


{\ttfamily \#include $<$signingprovider.\+h$>$}

Inheritance diagram for Fillable\+Signing\+Provider\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=3.000000cm]{class_fillable_signing_provider}
\end{center}
\end{figure}
\doxysubsubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
virtual bool \textbf{ Add\+Key\+Pub\+Key} (const \textbf{ CKey} \&key, const \textbf{ CPub\+Key} \&pubkey)
\item 
virtual bool \textbf{ Add\+Key} (const \textbf{ CKey} \&key)
\item 
virtual bool \textbf{ Get\+Pub\+Key} (const \textbf{ CKey\+ID} \&address, \textbf{ CPub\+Key} \&vch\+Pub\+Key\+Out) const override
\item 
virtual bool \textbf{ Have\+Key} (const \textbf{ CKey\+ID} \&address) const override
\item 
virtual std\+::set$<$ \textbf{ CKey\+ID} $>$ \textbf{ Get\+Keys} () const
\item 
virtual bool \textbf{ Get\+Key} (const \textbf{ CKey\+ID} \&address, \textbf{ CKey} \&key\+Out) const override
\item 
virtual bool \textbf{ Add\+CScript} (const \textbf{ CScript} \&redeem\+Script)
\item 
virtual bool \textbf{ Have\+CScript} (const \textbf{ CScript\+ID} \&hash) const override
\item 
virtual std\+::set$<$ \textbf{ CScript\+ID} $>$ \textbf{ Get\+CScripts} () const
\item 
virtual bool \textbf{ Get\+CScript} (const \textbf{ CScript\+ID} \&hash, \textbf{ CScript} \&redeem\+Script\+Out) const override
\end{DoxyCompactItemize}
\doxysubsection*{Public Member Functions inherited from \textbf{ Signing\+Provider}}
\begin{DoxyCompactItemize}
\item 
virtual \textbf{ $\sim$\+Signing\+Provider} ()=default
\item 
virtual bool \textbf{ Get\+Key\+Origin} (const \textbf{ CKey\+ID} \&keyid, \textbf{ Key\+Origin\+Info} \&info) const
\item 
virtual bool \textbf{ Get\+Taproot\+Spend\+Data} (const \textbf{ XOnly\+Pub\+Key} \&output\+\_\+key, \textbf{ Taproot\+Spend\+Data} \&spenddata) const
\item 
virtual bool \textbf{ Get\+Taproot\+Builder} (const \textbf{ XOnly\+Pub\+Key} \&output\+\_\+key, \textbf{ Taproot\+Builder} \&builder) const
\item 
virtual std\+::vector$<$ \textbf{ CPub\+Key} $>$ \textbf{ Get\+Mu\+Sig2\+Participant\+Pubkeys} (const \textbf{ CPub\+Key} \&pubkey) const
\item 
virtual std\+::map$<$ \textbf{ CPub\+Key}, std\+::vector$<$ \textbf{ CPub\+Key} $>$ $>$ \textbf{ Get\+All\+Mu\+Sig2\+Participant\+Pubkeys} () const
\item 
virtual void \textbf{ Set\+Mu\+Sig2\+Sec\+Nonce} (const \textbf{ uint256} \&id, \textbf{ Mu\+Sig2\+Sec\+Nonce} \&\&\textbf{ nonce}) const
\item 
virtual std\+::optional$<$ std\+::reference\+\_\+wrapper$<$ \textbf{ Mu\+Sig2\+Sec\+Nonce} $>$ $>$ \textbf{ Get\+Mu\+Sig2\+Sec\+Nonce} (const \textbf{ uint256} \&session\+\_\+id) const
\item 
virtual void \textbf{ Delete\+Mu\+Sig2\+Session} (const \textbf{ uint256} \&session\+\_\+id) const
\item 
bool \textbf{ Get\+Key\+By\+XOnly} (const \textbf{ XOnly\+Pub\+Key} \&pubkey, \textbf{ CKey} \&key) const
\item 
bool \textbf{ Get\+Pub\+Key\+By\+XOnly} (const \textbf{ XOnly\+Pub\+Key} \&pubkey, \textbf{ CPub\+Key} \&out) const
\item 
bool \textbf{ Get\+Key\+Origin\+By\+XOnly} (const \textbf{ XOnly\+Pub\+Key} \&pubkey, \textbf{ Key\+Origin\+Info} \&info) const
\end{DoxyCompactItemize}
\doxysubsubsection*{Data Fields}
\begin{DoxyCompactItemize}
\item 
\textbf{ Recursive\+Mutex} \textbf{ cs\+\_\+\+Key\+Store}
\end{DoxyCompactItemize}
\doxysubsubsection*{Protected Types}
\begin{DoxyCompactItemize}
\item 
using \textbf{ Key\+Map} = std\+::map$<$\textbf{ CKey\+ID}, \textbf{ CKey}$>$
\item 
using \textbf{ Script\+Map} = std\+::map$<$\textbf{ CScript\+ID}, \textbf{ CScript}$>$
\end{DoxyCompactItemize}
\doxysubsubsection*{Protected Member Functions}
\begin{DoxyCompactItemize}
\item 
\textbf{ Key\+Map} map\+Keys \textbf{ GUARDED\+\_\+\+BY} (\textbf{ cs\+\_\+\+Key\+Store})
\item 
\textbf{ Script\+Map} map\+Scripts \textbf{ GUARDED\+\_\+\+BY} (\textbf{ cs\+\_\+\+Key\+Store})
\item 
void \textbf{ Implicitly\+Learn\+Related\+Key\+Scripts} (const \textbf{ CPub\+Key} \&pubkey) \textbf{ EXCLUSIVE\+\_\+\+LOCKS\+\_\+\+REQUIRED}(\textbf{ cs\+\_\+\+Key\+Store})
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Fillable signing provider that keeps keys in an address-\/$>$secret map 

\label{doc-typedef-members}
\doxysubsection{Member Typedef Documentation}
\index{FillableSigningProvider@{FillableSigningProvider}!KeyMap@{KeyMap}}
\index{KeyMap@{KeyMap}!FillableSigningProvider@{FillableSigningProvider}}
\doxysubsubsection{KeyMap}
{\footnotesize\ttfamily \label{class_fillable_signing_provider_abb6d99b9d04444ba00111e8c5a0890d9} 
using \textbf{ Key\+Map} = std\+::map$<$\textbf{ CKey\+ID}, \textbf{ CKey}$>$\hspace{0.3cm}{\ttfamily [protected]}}

\index{FillableSigningProvider@{FillableSigningProvider}!ScriptMap@{ScriptMap}}
\index{ScriptMap@{ScriptMap}!FillableSigningProvider@{FillableSigningProvider}}
\doxysubsubsection{ScriptMap}
{\footnotesize\ttfamily \label{class_fillable_signing_provider_aa6c4127eb1a35f55136d9e7a1c9876f0} 
using \textbf{ Script\+Map} = std\+::map$<$\textbf{ CScript\+ID}, \textbf{ CScript}$>$\hspace{0.3cm}{\ttfamily [protected]}}



\label{doc-func-members}
\doxysubsection{Member Function Documentation}
\index{FillableSigningProvider@{FillableSigningProvider}!AddCScript@{AddCScript}}
\index{AddCScript@{AddCScript}!FillableSigningProvider@{FillableSigningProvider}}
\doxysubsubsection{AddCScript()}
{\footnotesize\ttfamily \label{class_fillable_signing_provider_a8257be7589bc86beab11d5237e957d4b} 
bool Add\+CScript (\begin{DoxyParamCaption}\item[{const \textbf{ CScript} \&}]{redeem\+Script}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}

\index{FillableSigningProvider@{FillableSigningProvider}!AddKey@{AddKey}}
\index{AddKey@{AddKey}!FillableSigningProvider@{FillableSigningProvider}}
\doxysubsubsection{AddKey()}
{\footnotesize\ttfamily \label{class_fillable_signing_provider_a82103fc85f16d100da2455121901aba7} 
virtual bool Add\+Key (\begin{DoxyParamCaption}\item[{const \textbf{ CKey} \&}]{key}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [virtual]}}

\index{FillableSigningProvider@{FillableSigningProvider}!AddKeyPubKey@{AddKeyPubKey}}
\index{AddKeyPubKey@{AddKeyPubKey}!FillableSigningProvider@{FillableSigningProvider}}
\doxysubsubsection{AddKeyPubKey()}
{\footnotesize\ttfamily \label{class_fillable_signing_provider_a808b1207e61f00a06107036c09eca611} 
bool Add\+Key\+Pub\+Key (\begin{DoxyParamCaption}\item[{const \textbf{ CKey} \&}]{key}{, }\item[{const \textbf{ CPub\+Key} \&}]{pubkey}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}

\index{FillableSigningProvider@{FillableSigningProvider}!GetCScript@{GetCScript}}
\index{GetCScript@{GetCScript}!FillableSigningProvider@{FillableSigningProvider}}
\doxysubsubsection{GetCScript()}
{\footnotesize\ttfamily \label{class_fillable_signing_provider_a391be24fcb31f039412aff737039d505} 
bool Get\+CScript (\begin{DoxyParamCaption}\item[{const \textbf{ CScript\+ID} \&}]{hash}{, }\item[{\textbf{ CScript} \&}]{redeem\+Script\+Out}{}\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Reimplemented from \textbf{ Signing\+Provider} \doxyref{}{p.}{class_signing_provider_a375a2e74144c11516a5782d9ebc7c776}.

\index{FillableSigningProvider@{FillableSigningProvider}!GetCScripts@{GetCScripts}}
\index{GetCScripts@{GetCScripts}!FillableSigningProvider@{FillableSigningProvider}}
\doxysubsubsection{GetCScripts()}
{\footnotesize\ttfamily \label{class_fillable_signing_provider_a801239b1380ffa8ded76689e5b2f8d1d} 
std\+::set$<$ \textbf{ CScript\+ID} $>$ Get\+CScripts (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [virtual]}}

\index{FillableSigningProvider@{FillableSigningProvider}!GetKey@{GetKey}}
\index{GetKey@{GetKey}!FillableSigningProvider@{FillableSigningProvider}}
\doxysubsubsection{GetKey()}
{\footnotesize\ttfamily \label{class_fillable_signing_provider_a255a187c6bac2bbed75fa7f9f605361b} 
bool Get\+Key (\begin{DoxyParamCaption}\item[{const \textbf{ CKey\+ID} \&}]{address}{, }\item[{\textbf{ CKey} \&}]{key\+Out}{}\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Reimplemented from \textbf{ Signing\+Provider} \doxyref{}{p.}{class_signing_provider_a3704982f70765d351e289e3e329d1203}.



Reimplemented in \textbf{ Legacy\+Data\+SPKM} \doxyref{}{p.}{classwallet_1_1_legacy_data_s_p_k_m_a255a187c6bac2bbed75fa7f9f605361b}.

\index{FillableSigningProvider@{FillableSigningProvider}!GetKeys@{GetKeys}}
\index{GetKeys@{GetKeys}!FillableSigningProvider@{FillableSigningProvider}}
\doxysubsubsection{GetKeys()}
{\footnotesize\ttfamily \label{class_fillable_signing_provider_aa675e749b3535803d2783062a8fbf4f3} 
std\+::set$<$ \textbf{ CKey\+ID} $>$ Get\+Keys (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [virtual]}}

\index{FillableSigningProvider@{FillableSigningProvider}!GetPubKey@{GetPubKey}}
\index{GetPubKey@{GetPubKey}!FillableSigningProvider@{FillableSigningProvider}}
\doxysubsubsection{GetPubKey()}
{\footnotesize\ttfamily \label{class_fillable_signing_provider_ac0baae1468399cc0d85d5ca777c15633} 
bool Get\+Pub\+Key (\begin{DoxyParamCaption}\item[{const \textbf{ CKey\+ID} \&}]{address}{, }\item[{\textbf{ CPub\+Key} \&}]{vch\+Pub\+Key\+Out}{}\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Reimplemented from \textbf{ Signing\+Provider} \doxyref{}{p.}{class_signing_provider_a176f28791cca9bb7467bc56bac22909d}.



Reimplemented in \textbf{ Legacy\+Data\+SPKM} \doxyref{}{p.}{classwallet_1_1_legacy_data_s_p_k_m_ac0baae1468399cc0d85d5ca777c15633}.

\index{FillableSigningProvider@{FillableSigningProvider}!GUARDED\_BY@{GUARDED\_BY}}
\index{GUARDED\_BY@{GUARDED\_BY}!FillableSigningProvider@{FillableSigningProvider}}
\doxysubsubsection{GUARDED\_BY()\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily \label{class_fillable_signing_provider_a89da54f85600e6b49e99116ca7364701} 
\textbf{ Script\+Map} map\+Scripts GUARDED\+\_\+\+BY (\begin{DoxyParamCaption}\item[{\textbf{ cs\+\_\+\+Key\+Store}}]{}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}

Map of script id to scripts known by the signing provider.

This map originally just held P2\+SH redeem\+Scripts, and was used by wallet code to look up script ids referenced in "{}\+OP\+\_\+\+HASH160 $<$script id$>$ \+OP\+\_\+\+EQUAL"{} P2\+SH outputs. Later in 605e8473a7d it was extended to hold P2\+WSH witness\+Scripts as well, and used to look up nested scripts referenced in "{}\+OP\+\_\+0 $<$script hash$>$"{} P2\+WSH outputs. Later in commits f4691ab3a9d and 248f3a76a82, it was extended once again to hold segwit "{}\+OP\+\_\+0 $<$key or script hash$>$"{} script\+Pub\+Keys, in order to give the wallet a way to distinguish between segwit outputs that it generated addresses for and wanted to receive payments from, and segwit outputs that it never generated addresses for, but it could spend just because of having keys. (Before segwit activation it was also important to not treat segwit outputs to arbitrary wallet keys as payments, because these could be spent by anyone without even needing to sign with the keys.)

Some of the scripts stored in map\+Scripts are memory-\/only and intentionally not saved to disk. Specifically, scripts added by Implicitly\+Learn\+Related\+Key\+Scripts(pubkey) calls are not written to disk so future wallet code can have flexibility to be more selective about what transaction outputs it recognizes as payments, instead of having to treat all outputs spending to keys it knows as payments. By contrast, map\+Scripts entries added by Add\+CScript(script), Learn\+Related\+Scripts(pubkey, type), and Learn\+All\+Related\+Scripts(pubkey) calls are saved because they are all intentionally used to receive payments.

The Fillable\+Signing\+Provider\+::map\+Scripts script map should not be confused with Legacy\+Script\+Pub\+Key\+Man\+::set\+Watch\+Only script set. The two collections can hold the same scripts, but they serve different purposes. The set\+Watch\+Only script set is intended to expand the set of outputs the wallet considers payments. Every output with a script it contains is considered to belong to the wallet, regardless of whether the script is solvable or signable. By contrast, the scripts in map\+Scripts are only used for solving, and to restrict which outputs are considered payments by the wallet. An output with a script in map\+Scripts, unlike set\+Watch\+Only, is not automatically considered to belong to the wallet if it can\textquotesingle{}t be solved and signed for. \index{FillableSigningProvider@{FillableSigningProvider}!GUARDED\_BY@{GUARDED\_BY}}
\index{GUARDED\_BY@{GUARDED\_BY}!FillableSigningProvider@{FillableSigningProvider}}
\doxysubsubsection{GUARDED\_BY()\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily \label{class_fillable_signing_provider_aec3ecf374e8208f019a8881ae74408cf} 
\textbf{ Key\+Map} map\+Keys GUARDED\+\_\+\+BY (\begin{DoxyParamCaption}\item[{\textbf{ cs\+\_\+\+Key\+Store}}]{}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}

Map of key id to unencrypted private keys known by the signing provider. Map may be empty if the provider has another source of keys, like an encrypted store. \index{FillableSigningProvider@{FillableSigningProvider}!HaveCScript@{HaveCScript}}
\index{HaveCScript@{HaveCScript}!FillableSigningProvider@{FillableSigningProvider}}
\doxysubsubsection{HaveCScript()}
{\footnotesize\ttfamily \label{class_fillable_signing_provider_a58cb7ca0f5d838001fd6f69447219963} 
bool Have\+CScript (\begin{DoxyParamCaption}\item[{const \textbf{ CScript\+ID} \&}]{hash}{}\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Reimplemented from \textbf{ Signing\+Provider} \doxyref{}{p.}{class_signing_provider_ab5c91616b05293f6bbc2505ad7fc745e}.

\index{FillableSigningProvider@{FillableSigningProvider}!HaveKey@{HaveKey}}
\index{HaveKey@{HaveKey}!FillableSigningProvider@{FillableSigningProvider}}
\doxysubsubsection{HaveKey()}
{\footnotesize\ttfamily \label{class_fillable_signing_provider_a25aee14df3601a0cae72852121cfa80a} 
bool Have\+Key (\begin{DoxyParamCaption}\item[{const \textbf{ CKey\+ID} \&}]{address}{}\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Reimplemented from \textbf{ Signing\+Provider} \doxyref{}{p.}{class_signing_provider_a7c2a4b3c01c8b1f948f5519f39ce9e7e}.



Reimplemented in \textbf{ Legacy\+Data\+SPKM} \doxyref{}{p.}{classwallet_1_1_legacy_data_s_p_k_m_a25aee14df3601a0cae72852121cfa80a}.

\index{FillableSigningProvider@{FillableSigningProvider}!ImplicitlyLearnRelatedKeyScripts@{ImplicitlyLearnRelatedKeyScripts}}
\index{ImplicitlyLearnRelatedKeyScripts@{ImplicitlyLearnRelatedKeyScripts}!FillableSigningProvider@{FillableSigningProvider}}
\doxysubsubsection{ImplicitlyLearnRelatedKeyScripts()}
{\footnotesize\ttfamily \label{class_fillable_signing_provider_a73e5121a48abdfe949731827fa97f1f3} 
void Implicitly\+Learn\+Related\+Key\+Scripts (\begin{DoxyParamCaption}\item[{const \textbf{ CPub\+Key} \&}]{pubkey}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}



\label{doc-variable-members}
\doxysubsection{Field Documentation}
\index{FillableSigningProvider@{FillableSigningProvider}!cs\_KeyStore@{cs\_KeyStore}}
\index{cs\_KeyStore@{cs\_KeyStore}!FillableSigningProvider@{FillableSigningProvider}}
\doxysubsubsection{cs\_KeyStore}
{\footnotesize\ttfamily \label{class_fillable_signing_provider_a03bc5e9dccecd885e00eeefdad774c7f} 
\textbf{ Recursive\+Mutex} cs\+\_\+\+Key\+Store\hspace{0.3cm}{\ttfamily [mutable]}}



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
src/script/\textbf{ signingprovider.\+h}\item 
src/script/\textbf{ signingprovider.\+cpp}\end{DoxyCompactItemize}
