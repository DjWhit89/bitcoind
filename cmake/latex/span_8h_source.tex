\doxysection{span.\+h}
\label{span_8h_source}\index{src/span.h@{src/span.h}}
\textbf{ Go to the documentation of this file.}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{//\ Copyright\ (c)\ 2018-\/present\ The\ Bitcoin\ Core\ developers}}
\DoxyCodeLine{00002\ \textcolor{comment}{//\ Distributed\ under\ the\ MIT\ software\ license,\ see\ the\ accompanying}}
\DoxyCodeLine{00003\ \textcolor{comment}{//\ file\ COPYING\ or\ http://www.opensource.org/licenses/mit-\/license.php.}}
\DoxyCodeLine{00004\ }
\DoxyCodeLine{00005\ \textcolor{preprocessor}{\#ifndef\ BITCOIN\_SPAN\_H}}
\DoxyCodeLine{00006\ \textcolor{preprocessor}{\#define\ BITCOIN\_SPAN\_H}}
\DoxyCodeLine{00007\ }
\DoxyCodeLine{00008\ \textcolor{preprocessor}{\#include\ <cassert>}}
\DoxyCodeLine{00009\ \textcolor{preprocessor}{\#include\ <cstddef>}}
\DoxyCodeLine{00010\ \textcolor{preprocessor}{\#include\ <span>}}
\DoxyCodeLine{00011\ \textcolor{preprocessor}{\#include\ <type\_traits>}}
\DoxyCodeLine{00012\ \textcolor{preprocessor}{\#include\ <utility>}}
\DoxyCodeLine{00013\ }
\DoxyCodeLine{00072\ }
\DoxyCodeLine{00074\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00075\ T\&\ SpanPopBack(std::span<T>\&\ span)}
\DoxyCodeLine{00076\ \{}
\DoxyCodeLine{00077\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ size\ =\ span.size();}
\DoxyCodeLine{00078\ \ \ \ \ T\&\ back\ =\ span.back();}
\DoxyCodeLine{00079\ \ \ \ \ span\ =\ span.first(size\ -\/\ 1);}
\DoxyCodeLine{00080\ \ \ \ \ \textcolor{keywordflow}{return}\ back;}
\DoxyCodeLine{00081\ \}}
\DoxyCodeLine{00082\ }
\DoxyCodeLine{00083\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ V>}
\DoxyCodeLine{00084\ \textcolor{keyword}{auto}\ MakeByteSpan(\textcolor{keyword}{const}\ V\&\ v)\ \textcolor{keyword}{noexcept}}
\DoxyCodeLine{00085\ \{}
\DoxyCodeLine{00086\ \ \ \ \ \textcolor{keywordflow}{return}\ std::as\_bytes(std::span\{v\});}
\DoxyCodeLine{00087\ \}}
\DoxyCodeLine{00088\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ V>}
\DoxyCodeLine{00089\ \textcolor{keyword}{auto}\ MakeWritableByteSpan(V\&\&\ v)\ \textcolor{keyword}{noexcept}}
\DoxyCodeLine{00090\ \{}
\DoxyCodeLine{00091\ \ \ \ \ \textcolor{keywordflow}{return}\ std::as\_writable\_bytes(std::span\{std::forward<V>(v)\});}
\DoxyCodeLine{00092\ \}}
\DoxyCodeLine{00093\ }
\DoxyCodeLine{00094\ \textcolor{comment}{//\ Helper\ functions\ to\ safely\ cast\ basic\ byte\ pointers\ to\ unsigned\ char\ pointers.}}
\DoxyCodeLine{00095\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}*\ UCharCast(\textcolor{keywordtype}{char}*\ c)\ \{\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{reinterpret\_cast<}\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}*\textcolor{keyword}{>}(c);\ \}}
\DoxyCodeLine{00096\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}*\ UCharCast(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}*\ c)\ \{\ \textcolor{keywordflow}{return}\ c;\ \}}
\DoxyCodeLine{00097\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}*\ UCharCast(\textcolor{keywordtype}{signed}\ \textcolor{keywordtype}{char}*\ c)\ \{\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{reinterpret\_cast<}\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}*\textcolor{keyword}{>}(c);\ \}}
\DoxyCodeLine{00098\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}*\ UCharCast(std::byte*\ c)\ \{\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{reinterpret\_cast<}\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}*\textcolor{keyword}{>}(c);\ \}}
\DoxyCodeLine{00099\ \textcolor{keyword}{inline}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}*\ UCharCast(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ c)\ \{\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const\ }\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}*\textcolor{keyword}{>}(c);\ \}}
\DoxyCodeLine{00100\ \textcolor{keyword}{inline}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}*\ UCharCast(\textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}*\ c)\ \{\ \textcolor{keywordflow}{return}\ c;\ \}}
\DoxyCodeLine{00101\ \textcolor{keyword}{inline}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}*\ UCharCast(\textcolor{keyword}{const}\ \textcolor{keywordtype}{signed}\ \textcolor{keywordtype}{char}*\ c)\ \{\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const\ }\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}*\textcolor{keyword}{>}(c);\ \}}
\DoxyCodeLine{00102\ \textcolor{keyword}{inline}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}*\ UCharCast(\textcolor{keyword}{const}\ std::byte*\ c)\ \{\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const\ }\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}*\textcolor{keyword}{>}(c);\ \}}
\DoxyCodeLine{00103\ \textcolor{comment}{//\ Helper\ concept\ for\ the\ basic\ byte\ types.}}
\DoxyCodeLine{00104\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ B>}
\DoxyCodeLine{00105\ \textcolor{keyword}{concept\ }BasicByte\ =\ \textcolor{keyword}{requires}\ \{\ UCharCast(std::span<B>\{\}.data());\ \};}
\DoxyCodeLine{00106\ }
\DoxyCodeLine{00107\ \textcolor{comment}{//\ Helper\ function\ to\ safely\ convert\ a\ span\ to\ a\ span<[const]\ unsigned\ char>.}}
\DoxyCodeLine{00108\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T,\ \textcolor{keywordtype}{size\_t}\ N>\ \textcolor{keyword}{constexpr}\ \textcolor{keyword}{auto}\ UCharSpanCast(std::span<T,\ N>\ s)\ \{\ \textcolor{keywordflow}{return}\ std::span<std::remove\_pointer\_t<\textcolor{keyword}{decltype}(UCharCast(s.data()))>,\ N>\{UCharCast(s.data()),\ s.size()\};\ \}}
\DoxyCodeLine{00109\ }
\DoxyCodeLine{00111\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ V>\ \textcolor{keyword}{constexpr}\ \textcolor{keyword}{auto}\ MakeUCharSpan(\textcolor{keyword}{const}\ V\&\ v)\ -\/>\ \textcolor{keyword}{decltype}(UCharSpanCast(std::span\{v\}))\ \{\ \textcolor{keywordflow}{return}\ UCharSpanCast(std::span\{v\});\ \}}
\DoxyCodeLine{00112\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ V>\ \textcolor{keyword}{constexpr}\ \textcolor{keyword}{auto}\ MakeWritableUCharSpan(V\&\&\ v)\ -\/>\ \textcolor{keyword}{decltype}(UCharSpanCast(std::span\{std::forward<V>(v)\}))\ \{\ \textcolor{keywordflow}{return}\ UCharSpanCast(std::span\{std::forward<V>(v)\});\ \}}
\DoxyCodeLine{00113\ }
\DoxyCodeLine{00114\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//\ BITCOIN\_SPAN\_H}}

\end{DoxyCode}
