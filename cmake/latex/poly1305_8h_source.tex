\doxysection{poly1305.\+h}
\label{poly1305_8h_source}\index{src/crypto/poly1305.h@{src/crypto/poly1305.h}}
\textbf{ Go to the documentation of this file.}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{//\ Copyright\ (c)\ 2019-\/present\ The\ Bitcoin\ Core\ developers}}
\DoxyCodeLine{00002\ \textcolor{comment}{//\ Distributed\ under\ the\ MIT\ software\ license,\ see\ the\ accompanying}}
\DoxyCodeLine{00003\ \textcolor{comment}{//\ file\ COPYING\ or\ http://www.opensource.org/licenses/mit-\/license.php.}}
\DoxyCodeLine{00004\ }
\DoxyCodeLine{00005\ \textcolor{preprocessor}{\#ifndef\ BITCOIN\_CRYPTO\_POLY1305\_H}}
\DoxyCodeLine{00006\ \textcolor{preprocessor}{\#define\ BITCOIN\_CRYPTO\_POLY1305\_H}}
\DoxyCodeLine{00007\ }
\DoxyCodeLine{00008\ \textcolor{preprocessor}{\#include\ <span.h>}}
\DoxyCodeLine{00009\ }
\DoxyCodeLine{00010\ \textcolor{preprocessor}{\#include\ <cassert>}}
\DoxyCodeLine{00011\ \textcolor{preprocessor}{\#include\ <cstddef>}}
\DoxyCodeLine{00012\ \textcolor{preprocessor}{\#include\ <cstdint>}}
\DoxyCodeLine{00013\ \textcolor{preprocessor}{\#include\ <span>}}
\DoxyCodeLine{00014\ }
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#define\ POLY1305\_BLOCK\_SIZE\ 16}}
\DoxyCodeLine{00016\ }
\DoxyCodeLine{00017\ \textcolor{keyword}{namespace\ }poly1305\_donna\ \{}
\DoxyCodeLine{00018\ }
\DoxyCodeLine{00019\ \textcolor{comment}{//\ Based\ on\ the\ public\ domain\ implementation\ by\ Andrew\ Moon}}
\DoxyCodeLine{00020\ \textcolor{comment}{//\ poly1305-\/donna-\/32.h\ from\ https://github.com/floodyberry/poly1305-\/donna}}
\DoxyCodeLine{00021\ }
\DoxyCodeLine{00022\ \textcolor{keyword}{typedef}\ \textcolor{keyword}{struct\ }\{}
\DoxyCodeLine{00023\ \ \ \ \ uint32\_t\ r[5];}
\DoxyCodeLine{00024\ \ \ \ \ uint32\_t\ h[5];}
\DoxyCodeLine{00025\ \ \ \ \ uint32\_t\ pad[4];}
\DoxyCodeLine{00026\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ leftover;}
\DoxyCodeLine{00027\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ buffer[POLY1305\_BLOCK\_SIZE];}
\DoxyCodeLine{00028\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ \textcolor{keyword}{final};}
\DoxyCodeLine{00029\ \}\ poly1305\_context;}
\DoxyCodeLine{00030\ }
\DoxyCodeLine{00031\ \textcolor{keywordtype}{void}\ poly1305\_init(poly1305\_context\ *st,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ key[32])\ \textcolor{keyword}{noexcept};}
\DoxyCodeLine{00032\ \textcolor{keywordtype}{void}\ poly1305\_update(poly1305\_context\ *st,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *m,\ \textcolor{keywordtype}{size\_t}\ bytes)\ \textcolor{keyword}{noexcept};}
\DoxyCodeLine{00033\ \textcolor{keywordtype}{void}\ poly1305\_finish(poly1305\_context\ *st,\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ mac[16])\ \textcolor{keyword}{noexcept};}
\DoxyCodeLine{00034\ }
\DoxyCodeLine{00035\ \}\ \ \textcolor{comment}{//\ namespace\ poly1305\_donna}}
\DoxyCodeLine{00036\ }
\DoxyCodeLine{00038\ \textcolor{keyword}{class\ }Poly1305}
\DoxyCodeLine{00039\ \{}
\DoxyCodeLine{00040\ \ \ \ \ poly1305\_donna::poly1305\_context\ m\_ctx;}
\DoxyCodeLine{00041\ }
\DoxyCodeLine{00042\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00044\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{unsigned}\ TAGLEN\{16\};}
\DoxyCodeLine{00045\ }
\DoxyCodeLine{00047\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{unsigned}\ KEYLEN\{32\};}
\DoxyCodeLine{00048\ }
\DoxyCodeLine{00050\ \ \ \ \ Poly1305(std::span<const\ std::byte>\ key)\ \textcolor{keyword}{noexcept}}
\DoxyCodeLine{00051\ \ \ \ \ \{}
\DoxyCodeLine{00052\ \ \ \ \ \ \ \ \ assert(key.size()\ ==\ KEYLEN);}
\DoxyCodeLine{00053\ \ \ \ \ \ \ \ \ poly1305\_donna::poly1305\_init(\&m\_ctx,\ UCharCast(key.data()));}
\DoxyCodeLine{00054\ \ \ \ \ \}}
\DoxyCodeLine{00055\ }
\DoxyCodeLine{00057\ \ \ \ \ Poly1305\&\ Update(std::span<const\ std::byte>\ msg)\ \textcolor{keyword}{noexcept}}
\DoxyCodeLine{00058\ \ \ \ \ \{}
\DoxyCodeLine{00059\ \ \ \ \ \ \ \ \ poly1305\_donna::poly1305\_update(\&m\_ctx,\ UCharCast(msg.data()),\ msg.size());}
\DoxyCodeLine{00060\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};}
\DoxyCodeLine{00061\ \ \ \ \ \}}
\DoxyCodeLine{00062\ }
\DoxyCodeLine{00064\ \ \ \ \ \textcolor{keywordtype}{void}\ Finalize(std::span<std::byte>\ out)\ \textcolor{keyword}{noexcept}}
\DoxyCodeLine{00065\ \ \ \ \ \{}
\DoxyCodeLine{00066\ \ \ \ \ \ \ \ \ assert(out.size()\ ==\ TAGLEN);}
\DoxyCodeLine{00067\ \ \ \ \ \ \ \ \ poly1305\_donna::poly1305\_finish(\&m\_ctx,\ UCharCast(out.data()));}
\DoxyCodeLine{00068\ \ \ \ \ \}}
\DoxyCodeLine{00069\ \};}
\DoxyCodeLine{00070\ }
\DoxyCodeLine{00071\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//\ BITCOIN\_CRYPTO\_POLY1305\_H}}

\end{DoxyCode}
