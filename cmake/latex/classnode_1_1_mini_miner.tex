\doxysection{Mini\+Miner Class Reference}
\label{classnode_1_1_mini_miner}\index{MiniMiner@{MiniMiner}}


{\ttfamily \#include $<$mini\+\_\+miner.\+h$>$}

\doxysubsubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
bool \textbf{ Is\+Ready\+To\+Calculate} () const
\item 
void \textbf{ Build\+Mock\+Template} (std\+::optional$<$ \textbf{ CFee\+Rate} $>$ target\+\_\+feerate)
\item 
std\+::set$<$ \textbf{ Txid} $>$ \textbf{ Get\+Mock\+Template\+Txids} () const
\item 
\textbf{ Mini\+Miner} (const \textbf{ CTx\+Mem\+Pool} \&mempool, const std\+::vector$<$ \textbf{ COut\+Point} $>$ \&outpoints)
\item 
\textbf{ Mini\+Miner} (const std\+::vector$<$ \textbf{ Mini\+Miner\+Mempool\+Entry} $>$ \&manual\+\_\+entries, const std\+::map$<$ \textbf{ Txid}, std\+::set$<$ \textbf{ Txid} $>$ $>$ \&descendant\+\_\+caches)
\item 
std\+::map$<$ \textbf{ COut\+Point}, \textbf{ CAmount} $>$ \textbf{ Calculate\+Bump\+Fees} (const \textbf{ CFee\+Rate} \&target\+\_\+feerate)
\item 
std\+::optional$<$ \textbf{ CAmount} $>$ \textbf{ Calculate\+Total\+Bump\+Fees} (const \textbf{ CFee\+Rate} \&target\+\_\+feerate)
\item 
std\+::map$<$ \textbf{ Txid}, uint32\+\_\+t $>$ \textbf{ Linearize} ()
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
A minimal version of \doxyref{Block\+Assembler}{p.}{classnode_1_1_block_assembler}, using the same ancestor set scoring algorithm. Allows us to run this algorithm on a limited set of transactions (e.\+g. subset of mempool or transactions that are not yet in mempool) instead of the entire mempool, ignoring consensus rules. Callers may use this to\+:
\begin{DoxyItemize}
\item Calculate the "{}bump fee"{} needed to spend an unconfirmed UTXO at a given feerate
\item "{}\+Linearize"{} a list of transactions to see the order in which they would be selected for inclusion in a block 
\end{DoxyItemize}

\label{doc-constructors}
\doxysubsection{Constructor \& Destructor Documentation}
\index{MiniMiner@{MiniMiner}!MiniMiner@{MiniMiner}}
\index{MiniMiner@{MiniMiner}!MiniMiner@{MiniMiner}}
\doxysubsubsection{MiniMiner()\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily \label{classnode_1_1_mini_miner_a82cea9ec1d719f6f75de7374b7fa74f0} 
Mini\+Miner (\begin{DoxyParamCaption}\item[{const \textbf{ CTx\+Mem\+Pool} \&}]{mempool}{, }\item[{const std\+::vector$<$ \textbf{ COut\+Point} $>$ \&}]{outpoints}{}\end{DoxyParamCaption})}

Constructor that takes a list of outpoints that may or may not belong to transactions in the mempool. Copies out information about the relevant transactions in the mempool into Mini\+Miner\+Mempool\+Entrys. \index{MiniMiner@{MiniMiner}!MiniMiner@{MiniMiner}}
\index{MiniMiner@{MiniMiner}!MiniMiner@{MiniMiner}}
\doxysubsubsection{MiniMiner()\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily \label{classnode_1_1_mini_miner_af2a9735b35d9a4d30f9c49ac16d9d442} 
Mini\+Miner (\begin{DoxyParamCaption}\item[{const std\+::vector$<$ \textbf{ Mini\+Miner\+Mempool\+Entry} $>$ \&}]{manual\+\_\+entries}{, }\item[{const std\+::map$<$ \textbf{ Txid}, std\+::set$<$ \textbf{ Txid} $>$ $>$ \&}]{descendant\+\_\+caches}{}\end{DoxyParamCaption})}

Constructor in which the \doxyref{Mini\+Miner\+Mempool\+Entry}{p.}{classnode_1_1_mini_miner_mempool_entry} entries have been constructed manually. It is assumed that all entries are unique and their values are correct, otherwise results computed by \doxyref{Mini\+Miner}{p.}{classnode_1_1_mini_miner} may be incorrect. Callers should check \doxyref{Is\+Ready\+To\+Calculate()}{p.}{classnode_1_1_mini_miner_a631ce0ecde1a6c693c9c79421fe1908e} after construction. 
\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{in}}  & {\em descendant\+\_\+caches} & A map from each transaction to the set of txids of this transaction\textquotesingle{}s descendant set, including itself. Each tx in manual\+\_\+entries must have a corresponding entry in this map, and all of the txids in a descendant set must correspond to a tx in manual\+\_\+entries. \\
\hline
\end{DoxyParams}


\label{doc-func-members}
\doxysubsection{Member Function Documentation}
\index{MiniMiner@{MiniMiner}!BuildMockTemplate@{BuildMockTemplate}}
\index{BuildMockTemplate@{BuildMockTemplate}!MiniMiner@{MiniMiner}}
\doxysubsubsection{BuildMockTemplate()}
{\footnotesize\ttfamily \label{classnode_1_1_mini_miner_addb1752d1d2cdf67641f9ada5a6e5b64} 
void Build\+Mock\+Template (\begin{DoxyParamCaption}\item[{std\+::optional$<$ \textbf{ CFee\+Rate} $>$}]{target\+\_\+feerate}{}\end{DoxyParamCaption})}

Build a block template until the target feerate is hit. If target\+\_\+feerate is not given, builds a block template until all transactions have been selected. \index{MiniMiner@{MiniMiner}!CalculateBumpFees@{CalculateBumpFees}}
\index{CalculateBumpFees@{CalculateBumpFees}!MiniMiner@{MiniMiner}}
\doxysubsubsection{CalculateBumpFees()}
{\footnotesize\ttfamily \label{classnode_1_1_mini_miner_a916aecc4dadc9cd705684f8a75970e39} 
std\+::map$<$ \textbf{ COut\+Point}, \textbf{ CAmount} $>$ Calculate\+Bump\+Fees (\begin{DoxyParamCaption}\item[{const \textbf{ CFee\+Rate} \&}]{target\+\_\+feerate}{}\end{DoxyParamCaption})}

Construct a new block template and, for each outpoint corresponding to a transaction that did not make it into the block, calculate the cost of bumping those transactions (and their ancestors) to the minimum feerate. Returns a map from outpoint to bump fee, or an empty map if they cannot be calculated. \index{MiniMiner@{MiniMiner}!CalculateTotalBumpFees@{CalculateTotalBumpFees}}
\index{CalculateTotalBumpFees@{CalculateTotalBumpFees}!MiniMiner@{MiniMiner}}
\doxysubsubsection{CalculateTotalBumpFees()}
{\footnotesize\ttfamily \label{classnode_1_1_mini_miner_ad40670a25c2569686e74c17122ee7f88} 
std\+::optional$<$ \textbf{ CAmount} $>$ Calculate\+Total\+Bump\+Fees (\begin{DoxyParamCaption}\item[{const \textbf{ CFee\+Rate} \&}]{target\+\_\+feerate}{}\end{DoxyParamCaption})}

Construct a new block template and, calculate the cost of bumping all transactions that did not make it into the block to the target feerate. Returns the total bump fee, or std\+::nullopt if it cannot be calculated. \index{MiniMiner@{MiniMiner}!GetMockTemplateTxids@{GetMockTemplateTxids}}
\index{GetMockTemplateTxids@{GetMockTemplateTxids}!MiniMiner@{MiniMiner}}
\doxysubsubsection{GetMockTemplateTxids()}
{\footnotesize\ttfamily \label{classnode_1_1_mini_miner_aefd65bd4ef8c773bf3027924b292b6f9} 
std\+::set$<$ \textbf{ Txid} $>$ Get\+Mock\+Template\+Txids (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}

Returns set of txids in the block template if one has been constructed. \index{MiniMiner@{MiniMiner}!IsReadyToCalculate@{IsReadyToCalculate}}
\index{IsReadyToCalculate@{IsReadyToCalculate}!MiniMiner@{MiniMiner}}
\doxysubsubsection{IsReadyToCalculate()}
{\footnotesize\ttfamily \label{classnode_1_1_mini_miner_a631ce0ecde1a6c693c9c79421fe1908e} 
bool Is\+Ready\+To\+Calculate (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}

Returns true if Calculate\+Bump\+Fees may be called, false if not. \index{MiniMiner@{MiniMiner}!Linearize@{Linearize}}
\index{Linearize@{Linearize}!MiniMiner@{MiniMiner}}
\doxysubsubsection{Linearize()}
{\footnotesize\ttfamily \label{classnode_1_1_mini_miner_a31f860a775b45150fa3dfe178a848d1c} 
std\+::map$<$ \textbf{ Txid}, uint32\+\_\+t $>$ Linearize (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption})}

Construct a new block template with all of the transactions and calculate the order in which they are selected. Returns the sequence number (lower = selected earlier) with which each transaction was selected, indexed by txid, or an empty map if it cannot be calculated. 

The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
src/node/\textbf{ mini\+\_\+miner.\+h}\item 
src/node/\textbf{ mini\+\_\+miner.\+cpp}\end{DoxyCompactItemize}
