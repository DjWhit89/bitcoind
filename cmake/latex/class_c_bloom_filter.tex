\doxysection{CBloom\+Filter Class Reference}
\label{class_c_bloom_filter}\index{CBloomFilter@{CBloomFilter}}


{\ttfamily \#include $<$bloom.\+h$>$}

\doxysubsubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\textbf{ CBloom\+Filter} (const unsigned int n\+Elements, const double n\+FPRate, const unsigned int n\+Tweak, unsigned char n\+Flags\+In)
\item 
\textbf{ CBloom\+Filter} ()
\item 
\textbf{ SERIALIZE\+\_\+\+METHODS} (\textbf{ CBloom\+Filter}, obj)
\item 
void \textbf{ insert} (std\+::span$<$ const unsigned char $>$ v\+Key)
\item 
void \textbf{ insert} (const \textbf{ COut\+Point} \&outpoint)
\item 
bool \textbf{ contains} (std\+::span$<$ const unsigned char $>$ v\+Key) const
\item 
bool \textbf{ contains} (const \textbf{ COut\+Point} \&outpoint) const
\item 
bool \textbf{ Is\+Within\+Size\+Constraints} () const
\item 
bool \textbf{ Is\+Relevant\+And\+Update} (const \textbf{ CTransaction} \&tx)
\begin{DoxyCompactList}\small\item\em Also adds any outputs which match the filter to the filter (to match their spending txes). \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Bloom\+Filter is a probabilistic filter which SPV clients provide so that we can filter the transactions we send them.

This allows for significantly more efficient transaction and block downloads.

Because bloom filters are probabilistic, a SPV node can increase the false-\/ positive rate, making us send it transactions which aren\textquotesingle{}t actually its, allowing clients to trade more bandwidth for more privacy by obfuscating which keys are controlled by them. 

\label{doc-constructors}
\doxysubsection{Constructor \& Destructor Documentation}
\index{CBloomFilter@{CBloomFilter}!CBloomFilter@{CBloomFilter}}
\index{CBloomFilter@{CBloomFilter}!CBloomFilter@{CBloomFilter}}
\doxysubsubsection{CBloomFilter()\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily \label{class_c_bloom_filter_a000b9fe9d99838e83f63577d1678d5d8} 
\textbf{ CBloom\+Filter} (\begin{DoxyParamCaption}\item[{const unsigned int}]{n\+Elements}{, }\item[{const double}]{n\+FPRate}{, }\item[{const unsigned int}]{n\+Tweak\+In}{, }\item[{unsigned char}]{n\+Flags\+In}{}\end{DoxyParamCaption})}

Creates a new bloom filter which will provide the given fp rate when filled with the given number of elements Note that if the given parameters will result in a filter outside the bounds of the protocol limits, the filter created will be as close to the given parameters as possible within the protocol limits. This will apply if n\+FPRate is very low or n\+Elements is unreasonably high. n\+Tweak is a constant which is added to the seed value passed to the hash function It should generally always be a random value (and is largely only exposed for unit testing) n\+Flags should be one of the BLOOM\+\_\+\+UPDATE\+\_\+$\ast$ enums (not \+\_\+\+MASK)

The ideal size for a bloom filter with a given number of elements and false positive rate is\+:
\begin{DoxyItemize}
\item n\+Elements $\ast$ log(fp rate) / ln(2)$^\wedge$2 We ignore filter parameters which will create a bloom filter larger than the protocol limits The ideal number of hash functions is filter size $\ast$ ln(2) / number of elements Again, we ignore filter parameters which will create a bloom filter with more hash functions than the protocol limits See {\texttt{https\+://en.\+wikipedia.\+org/wiki/\+Bloom\+\_\+filter}} for an explanation of these formulas 
\end{DoxyItemize}\index{CBloomFilter@{CBloomFilter}!CBloomFilter@{CBloomFilter}}
\index{CBloomFilter@{CBloomFilter}!CBloomFilter@{CBloomFilter}}
\doxysubsubsection{CBloomFilter()\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily \label{class_c_bloom_filter_aa8d373580a2542fcc34b21dd5da55208} 
\textbf{ CBloom\+Filter} (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



\label{doc-func-members}
\doxysubsection{Member Function Documentation}
\index{CBloomFilter@{CBloomFilter}!contains@{contains}}
\index{contains@{contains}!CBloomFilter@{CBloomFilter}}
\doxysubsubsection{contains()\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily \label{class_c_bloom_filter_aec6b92490797d24c0c67868334b16b09} 
bool contains (\begin{DoxyParamCaption}\item[{const \textbf{ COut\+Point} \&}]{outpoint}{}\end{DoxyParamCaption}) const}

\index{CBloomFilter@{CBloomFilter}!contains@{contains}}
\index{contains@{contains}!CBloomFilter@{CBloomFilter}}
\doxysubsubsection{contains()\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily \label{class_c_bloom_filter_a4aa5df3f0e22486ae74c274897b2fe33} 
bool contains (\begin{DoxyParamCaption}\item[{std\+::span$<$ const unsigned char $>$}]{v\+Key}{}\end{DoxyParamCaption}) const}

\index{CBloomFilter@{CBloomFilter}!insert@{insert}}
\index{insert@{insert}!CBloomFilter@{CBloomFilter}}
\doxysubsubsection{insert()\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily \label{class_c_bloom_filter_a0619ff80281a65c8d6f21912e745e1f5} 
void insert (\begin{DoxyParamCaption}\item[{const \textbf{ COut\+Point} \&}]{outpoint}{}\end{DoxyParamCaption})}

\index{CBloomFilter@{CBloomFilter}!insert@{insert}}
\index{insert@{insert}!CBloomFilter@{CBloomFilter}}
\doxysubsubsection{insert()\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily \label{class_c_bloom_filter_a0ffa34ea13dcfd2604c6611a1910ec94} 
void insert (\begin{DoxyParamCaption}\item[{std\+::span$<$ const unsigned char $>$}]{v\+Key}{}\end{DoxyParamCaption})}

\index{CBloomFilter@{CBloomFilter}!IsRelevantAndUpdate@{IsRelevantAndUpdate}}
\index{IsRelevantAndUpdate@{IsRelevantAndUpdate}!CBloomFilter@{CBloomFilter}}
\doxysubsubsection{IsRelevantAndUpdate()}
{\footnotesize\ttfamily \label{class_c_bloom_filter_ad7d892ab0badaca2d4c937b5c74513a2} 
bool Is\+Relevant\+And\+Update (\begin{DoxyParamCaption}\item[{const \textbf{ CTransaction} \&}]{tx}{}\end{DoxyParamCaption})}



Also adds any outputs which match the filter to the filter (to match their spending txes). 

\index{CBloomFilter@{CBloomFilter}!IsWithinSizeConstraints@{IsWithinSizeConstraints}}
\index{IsWithinSizeConstraints@{IsWithinSizeConstraints}!CBloomFilter@{CBloomFilter}}
\doxysubsubsection{IsWithinSizeConstraints()}
{\footnotesize\ttfamily \label{class_c_bloom_filter_af20392e863cea130e5e00d3222d40a80} 
bool Is\+Within\+Size\+Constraints (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption}) const}

True if the size is $<$= MAX\+\_\+\+BLOOM\+\_\+\+FILTER\+\_\+\+SIZE and the number of hash functions is $<$= MAX\+\_\+\+HASH\+\_\+\+FUNCS (catch a filter which was just deserialized which was too big) \index{CBloomFilter@{CBloomFilter}!SERIALIZE\_METHODS@{SERIALIZE\_METHODS}}
\index{SERIALIZE\_METHODS@{SERIALIZE\_METHODS}!CBloomFilter@{CBloomFilter}}
\doxysubsubsection{SERIALIZE\_METHODS()}
{\footnotesize\ttfamily \label{class_c_bloom_filter_aa3f0843287a290781fdc506a2996b643} 
SERIALIZE\+\_\+\+METHODS (\begin{DoxyParamCaption}\item[{\textbf{ CBloom\+Filter}}]{}{, }\item[{obj}]{}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
src/common/\textbf{ bloom.\+h}\item 
src/common/\textbf{ bloom.\+cpp}\end{DoxyCompactItemize}
