\doxysection{src/secp256k1 Directory Reference}
\label{dir_44f34d1e62fda08bdb4ca69ab2d205ae}\index{src/secp256k1 Directory Reference@{src/secp256k1 Directory Reference}}
\doxysubsubsection*{Directories}
\begin{DoxyCompactItemize}
\item 
directory \textbf{ contrib}
\item 
directory \textbf{ doc}
\item 
directory \textbf{ examples}
\item 
directory \textbf{ include}
\item 
directory \textbf{ src}
\item 
directory \textbf{ tools}
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
 {\texttt{}}

High-\/performance high-\/assurance C library for digital signatures and other cryptographic primitives on the secp256k1 elliptic curve.

This library is intended to be the highest quality publicly available library for cryptography on the secp256k1 curve. However, the primary focus of its development has been for usage in the Bitcoin system and usage unlike Bitcoin\textquotesingle{}s may be less well tested, verified, or suffer from a less well thought out interface. Correct usage requires some care and consideration that the library is fit for your application\textquotesingle{}s purpose.

Features\+:
\begin{DoxyItemize}
\item secp256k1 ECDSA signing/verification and key generation.
\item Additive and multiplicative tweaking of secret/public keys.
\item Serialization/parsing of secret keys, public keys, signatures.
\item Constant time, constant memory access signing and public key generation.
\item Derandomized ECDSA (via RFC6979 or with a caller provided function.)
\item Very efficient implementation.
\item Suitable for embedded systems.
\item No runtime dependencies.
\item Optional module for public key recovery.
\item Optional module for ECDH key exchange.
\item Optional module for Schnorr signatures according to {\texttt{BIP-\/340}}.
\item Optional module for Elligator\+Swift key exchange according to {\texttt{BIP-\/324}}.
\item Optional module for Mu\+Sig2 Schnorr multi-\/signatures according to {\texttt{BIP-\/327}}.
\end{DoxyItemize}\doxysubsection{Implementation details}\label{dir_44f34d1e62fda08bdb4ca69ab2d205ae_autotoc_md211}

\begin{DoxyItemize}
\item General
\begin{DoxyItemize}
\item No runtime heap allocation.
\item Extensive testing infrastructure.
\item Structured to facilitate review and analysis.
\item Intended to be portable to any system with a C89 compiler and uint64\+\_\+t support.
\item No use of floating types.
\item Expose only higher level interfaces to minimize the API surface and improve application security. ("{}\+Be difficult to use insecurely."{})
\end{DoxyItemize}
\item Field operations
\begin{DoxyItemize}
\item Optimized implementation of arithmetic modulo the curve\textquotesingle{}s field size (2$^\wedge$256 -\/ 0x1000003\+D1).
\begin{DoxyItemize}
\item Using 5 52-\/bit limbs
\item Using 10 26-\/bit limbs (including hand-\/optimized assembly for 32-\/bit ARM, by Wladimir J. van der Laan).
\begin{DoxyItemize}
\item This is an experimental feature that has not received enough scrutiny to satisfy the standard of quality of this library but is made available for testing and review by the community.
\end{DoxyItemize}
\end{DoxyItemize}
\end{DoxyItemize}
\item Scalar operations
\begin{DoxyItemize}
\item Optimized implementation without data-\/dependent branches of arithmetic modulo the curve\textquotesingle{}s order.
\begin{DoxyItemize}
\item Using 4 64-\/bit limbs (relying on \+\_\+\+\_\+int128 support in the compiler).
\item Using 8 32-\/bit limbs.
\end{DoxyItemize}
\end{DoxyItemize}
\item Modular inverses (both field elements and scalars) based on {\texttt{safegcd}} with some modifications, and a variable-\/time variant (by Peter Dettman).
\item Group operations
\begin{DoxyItemize}
\item Point addition formula specifically simplified for the curve equation (y$^\wedge$2 = x$^\wedge$3 + 7).
\item Use addition between points in Jacobian and affine coordinates where possible.
\item Use a unified addition/doubling formula where necessary to avoid data-\/dependent branches.
\item Point/x comparison without a field inversion by comparison in the Jacobian coordinate space.
\end{DoxyItemize}
\item Point multiplication for verification (a$\ast$P + b$\ast$G).
\begin{DoxyItemize}
\item Use w\+NAF notation for point multiplicands.
\item Use a much larger window for multiples of G, using precomputed multiples.
\item Use Shamir\textquotesingle{}s trick to do the multiplication with the public key and the generator simultaneously.
\item Use secp256k1\textquotesingle{}s efficiently-\/computable endomorphism to split the P multiplicand into 2 half-\/sized ones.
\end{DoxyItemize}
\item Point multiplication for signing
\begin{DoxyItemize}
\item Use a precomputed table of multiples of powers of 16 multiplied with the generator, so general multiplication becomes a series of additions.
\item Intended to be completely free of timing sidechannels for secret-\/key operations (on reasonable hardware/toolchains)
\begin{DoxyItemize}
\item Access the table with branch-\/free conditional moves so memory access is uniform.
\item No data-\/dependent branches
\end{DoxyItemize}
\item Optional runtime blinding which attempts to frustrate differential power analysis.
\item The precomputed tables add and eventually subtract points for which no known scalar (secret key) is known, preventing even an attacker with control over the secret key used to control the data internally.
\end{DoxyItemize}
\end{DoxyItemize}\doxysubsection{Obtaining and verifying}\label{dir_44f34d1e62fda08bdb4ca69ab2d205ae_autotoc_md212}
The git tag for each release (e.\+g. {\ttfamily v0.\+6.\+0}) is GPG-\/signed by one of the maintainers. For a fully verified build of this project, it is recommended to obtain this repository via git, obtain the GPG keys of the signing maintainer(s), and then verify the release tag\textquotesingle{}s signature using git.

This can be done with the following steps\+:


\begin{DoxyEnumerate}
\item Obtain the GPG keys listed in SECURITY.md.
\item If possible, cross-\/reference these key IDs with another source controlled by its owner (e.\+g. social media, personal website). This is to mitigate the unlikely case that incorrect content is being presented by this repository.
\item Clone the repository\+: 
\begin{DoxyCode}{0}
\DoxyCodeLine{git\ clone\ https://github.com/bitcoin-\/core/secp256k1}

\end{DoxyCode}

\item Check out the latest release tag, e.\+g. 
\begin{DoxyCode}{0}
\DoxyCodeLine{git\ checkout\ v0.6.0}

\end{DoxyCode}

\item Use git to verify the GPG signature\+: 
\begin{DoxyCode}{0}
\DoxyCodeLine{\%\ git\ tag\ -\/v\ v0.6.0\ |\ grep\ -\/C\ 3\ 'Good\ signature'}
\DoxyCodeLine{}
\DoxyCodeLine{gpg:\ Signature\ made\ Mon\ 04\ Nov\ 2024\ 12:14:44\ PM\ EST}
\DoxyCodeLine{gpg:\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ using\ RSA\ key\ 4BBB845A6F5A65A69DFAEC234861DBF262123605}
\DoxyCodeLine{gpg:\ Good\ signature\ from\ "{}Jonas\ Nick\ <jonas@n-\/ck.net>"{}\ [unknown]}
\DoxyCodeLine{gpg:\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ aka\ "{}Jonas\ Nick\ <jonasd.nick@gmail.com>"{}\ [unknown]}
\DoxyCodeLine{gpg:\ WARNING:\ This\ key\ is\ not\ certified\ with\ a\ trusted\ signature!}
\DoxyCodeLine{gpg:\ \ \ \ \ \ \ \ \ \ There\ is\ no\ indication\ that\ the\ signature\ belongs\ to\ the\ owner.}
\DoxyCodeLine{Primary\ key\ fingerprint:\ 36C7\ 1A37\ C9D9\ 88BD\ E825\ \ 08D9\ B1A7\ 0E4F\ 8DCD\ 0366}
\DoxyCodeLine{\ \ \ \ \ Subkey\ fingerprint:\ 4BBB\ 845A\ 6F5A\ 65A6\ 9DFA\ \ EC23\ 4861\ DBF2\ 6212\ 3605}

\end{DoxyCode}

\end{DoxyEnumerate}\doxysubsection{Building with Autotools}\label{dir_44f34d1e62fda08bdb4ca69ab2d205ae_autotoc_md213}
\begin{DoxyVerb}$ ./autogen.sh       # Generate a ./configure script
$ ./configure        # Generate a build system
$ make               # Run the actual build process
$ make check         # Run the test suite
$ sudo make install  # Install the library into the system (optional)
\end{DoxyVerb}


To compile optional modules (such as Schnorr signatures), you need to run {\ttfamily ./configure} with additional flags (such as {\ttfamily -\/-\/enable-\/module-\/schnorrsig}). Run {\ttfamily ./configure -\/-\/help} to see the full list of available flags.\doxysubsection{Building with CMake}\label{dir_44f34d1e62fda08bdb4ca69ab2d205ae_autotoc_md214}
To maintain a pristine source tree, CMake encourages to perform an out-\/of-\/source build by using a separate dedicated build tree.\doxysubsubsection{Building on POSIX systems}\label{dir_44f34d1e62fda08bdb4ca69ab2d205ae_autotoc_md215}
\begin{DoxyVerb}$ cmake -B build              # Generate a build system in subdirectory "build"
$ cmake --build build         # Run the actual build process
$ ctest --test-dir build      # Run the test suite
$ sudo cmake --install build  # Install the library into the system (optional)
\end{DoxyVerb}


To compile optional modules (such as Schnorr signatures), you need to run {\ttfamily cmake} with additional flags (such as {\ttfamily -\/DSECP256\+K1\+\_\+\+ENABLE\+\_\+\+MODULE\+\_\+\+SCHNORRSIG=ON}). Run {\ttfamily cmake -\/\doxyref{B}{p.}{util__tests_8cpp_a111da81ae5883147168bbb8366377b10} build -\/LH} or {\ttfamily ccmake -\/\doxyref{B}{p.}{util__tests_8cpp_a111da81ae5883147168bbb8366377b10} build} to see the full list of available flags.\doxysubsubsection{Cross compiling}\label{dir_44f34d1e62fda08bdb4ca69ab2d205ae_autotoc_md216}
To alleviate issues with cross compiling, preconfigured toolchain files are available in the {\ttfamily cmake} directory. For example, to cross compile for Windows\+: \begin{DoxyVerb}$ cmake -B build -DCMAKE_TOOLCHAIN_FILE=cmake/x86_64-w64-mingw32.toolchain.cmake
\end{DoxyVerb}


To cross compile for Android with {\texttt{NDK}} (using NDK\textquotesingle{}s toolchain file, and assuming the {\ttfamily ANDROID\+\_\+\+NDK\+\_\+\+ROOT} environment variable has been set)\+: \begin{DoxyVerb}$ cmake -B build -DCMAKE_TOOLCHAIN_FILE="${ANDROID_NDK_ROOT}/build/cmake/android.toolchain.cmake" -DANDROID_ABI=arm64-v8a -DANDROID_PLATFORM=28
\end{DoxyVerb}
\doxysubsubsection{Building on Windows}\label{dir_44f34d1e62fda08bdb4ca69ab2d205ae_autotoc_md217}
The following example assumes Visual Studio 2022. Using clang-\/cl is recommended.

In "{}\+Developer Command Prompt for VS 2022"{}\+: \begin{DoxyVerb}>cmake -B build -T ClangCL
>cmake --build build --config RelWithDebInfo
\end{DoxyVerb}
\doxysubsection{Usage examples}\label{dir_44f34d1e62fda08bdb4ca69ab2d205ae_autotoc_md218}
Usage examples can be found in the [examples](examples) directory. To compile them you need to configure with {\ttfamily -\/-\/enable-\/examples}.
\begin{DoxyItemize}
\item {\texttt{ECDSA example}}
\item {\texttt{Schnorr signatures example}}
\item {\texttt{Deriving a shared secret (ECDH) example}}
\item {\texttt{Elligator\+Swift key exchange example}}
\item {\texttt{Mu\+Sig2 Schnorr multi-\/signatures example}}
\end{DoxyItemize}

To compile the examples, make sure the corresponding modules are enabled.\doxysubsection{Benchmark}\label{dir_44f34d1e62fda08bdb4ca69ab2d205ae_autotoc_md219}
If configured with {\ttfamily -\/-\/enable-\/benchmark} (which is the default), binaries for benchmarking the libsecp256k1 functions will be present in the root directory after the build.

To print the benchmark result to the command line\+: \begin{DoxyVerb}$ ./bench_name
\end{DoxyVerb}


To create a CSV file for the benchmark result \+: \begin{DoxyVerb}$ ./bench_name | sed '2d;s/ \{1,\}//g' > bench_name.csv
\end{DoxyVerb}
\doxysubsection{Reporting a vulnerability}\label{dir_44f34d1e62fda08bdb4ca69ab2d205ae_autotoc_md220}
See SECURITY.md\doxysubsection{Contributing to libsecp256k1}\label{dir_44f34d1e62fda08bdb4ca69ab2d205ae_autotoc_md221}
See CONTRIBUTING.md 