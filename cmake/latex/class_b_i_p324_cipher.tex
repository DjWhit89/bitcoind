\doxysection{BIP324\+Cipher Class Reference}
\label{class_b_i_p324_cipher}\index{BIP324Cipher@{BIP324Cipher}}


{\ttfamily \#include $<$bip324.\+h$>$}

\doxysubsubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\textbf{ BIP324\+Cipher} ()=delete
\item 
\textbf{ BIP324\+Cipher} (const \textbf{ CKey} \&key, std\+::span$<$ const std\+::byte $>$ ent32) noexcept
\item 
\textbf{ BIP324\+Cipher} (const \textbf{ CKey} \&key, const \textbf{ Ell\+Swift\+Pub\+Key} \&pubkey) noexcept
\item 
const \textbf{ Ell\+Swift\+Pub\+Key} \& \textbf{ Get\+Our\+Pub\+Key} () const noexcept
\item 
void \textbf{ Initialize} (const \textbf{ Ell\+Swift\+Pub\+Key} \&their\+\_\+pubkey, bool initiator, bool self\+\_\+decrypt=false) noexcept
\item 
\textbf{ operator bool} () const noexcept
\item 
void \textbf{ Encrypt} (std\+::span$<$ const std\+::byte $>$ contents, std\+::span$<$ const std\+::byte $>$ aad, bool ignore, std\+::span$<$ std\+::byte $>$ output) noexcept
\item 
unsigned \textbf{ Decrypt\+Length} (std\+::span$<$ const std\+::byte $>$ input) noexcept
\item 
bool \textbf{ Decrypt} (std\+::span$<$ const std\+::byte $>$ input, std\+::span$<$ const std\+::byte $>$ aad, bool \&ignore, std\+::span$<$ std\+::byte $>$ contents) noexcept
\item 
std\+::span$<$ const std\+::byte $>$ \textbf{ Get\+Session\+ID} () const noexcept
\item 
std\+::span$<$ const std\+::byte $>$ \textbf{ Get\+Send\+Garbage\+Terminator} () const noexcept
\item 
std\+::span$<$ const std\+::byte $>$ \textbf{ Get\+Receive\+Garbage\+Terminator} () const noexcept
\end{DoxyCompactItemize}
\doxysubsubsection*{Static Public Attributes}
\begin{DoxyCompactItemize}
\item 
static constexpr unsigned \textbf{ SESSION\+\_\+\+ID\+\_\+\+LEN} \{32\}
\item 
static constexpr unsigned \textbf{ GARBAGE\+\_\+\+TERMINATOR\+\_\+\+LEN} \{16\}
\item 
static constexpr unsigned \textbf{ REKEY\+\_\+\+INTERVAL} \{224\}
\item 
static constexpr unsigned \textbf{ LENGTH\+\_\+\+LEN} \{3\}
\item 
static constexpr unsigned \textbf{ HEADER\+\_\+\+LEN} \{1\}
\item 
static constexpr unsigned \textbf{ EXPANSION} = \textbf{ LENGTH\+\_\+\+LEN} + \textbf{ HEADER\+\_\+\+LEN} + \textbf{ FSCha\+Cha20\+Poly1305\+::\+EXPANSION}
\item 
static constexpr std\+::byte \textbf{ IGNORE\+\_\+\+BIT} \{0x80\}
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
The BIP324 packet cipher, encapsulating its key derivation, stream cipher, and AEAD. 

\label{doc-constructors}
\doxysubsection{Constructor \& Destructor Documentation}
\index{BIP324Cipher@{BIP324Cipher}!BIP324Cipher@{BIP324Cipher}}
\index{BIP324Cipher@{BIP324Cipher}!BIP324Cipher@{BIP324Cipher}}
\doxysubsubsection{BIP324Cipher()\hspace{0.1cm}{\footnotesize\ttfamily [1/3]}}
{\footnotesize\ttfamily \label{class_b_i_p324_cipher_a0b60703571f7aa1b7abe4f3c678b43e8} 
\textbf{ BIP324\+Cipher} (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [delete]}}

No default constructor; keys must be provided to create a \doxyref{BIP324\+Cipher}{p.}{class_b_i_p324_cipher}. \index{BIP324Cipher@{BIP324Cipher}!BIP324Cipher@{BIP324Cipher}}
\index{BIP324Cipher@{BIP324Cipher}!BIP324Cipher@{BIP324Cipher}}
\doxysubsubsection{BIP324Cipher()\hspace{0.1cm}{\footnotesize\ttfamily [2/3]}}
{\footnotesize\ttfamily \label{class_b_i_p324_cipher_aaa6e1c5bd7840abd5f83cef4b30192f1} 
\textbf{ BIP324\+Cipher} (\begin{DoxyParamCaption}\item[{const \textbf{ CKey} \&}]{key}{, }\item[{std\+::span$<$ const std\+::byte $>$}]{ent32}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [noexcept]}}

Initialize a BIP324 cipher with specified key and encoding entropy (testing only). \index{BIP324Cipher@{BIP324Cipher}!BIP324Cipher@{BIP324Cipher}}
\index{BIP324Cipher@{BIP324Cipher}!BIP324Cipher@{BIP324Cipher}}
\doxysubsubsection{BIP324Cipher()\hspace{0.1cm}{\footnotesize\ttfamily [3/3]}}
{\footnotesize\ttfamily \label{class_b_i_p324_cipher_a3941fa95d80ec39b4bbb98b7a31e0916} 
\textbf{ BIP324\+Cipher} (\begin{DoxyParamCaption}\item[{const \textbf{ CKey} \&}]{key}{, }\item[{const \textbf{ Ell\+Swift\+Pub\+Key} \&}]{pubkey}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [noexcept]}}

Initialize a BIP324 cipher with specified key (testing only). 

\label{doc-func-members}
\doxysubsection{Member Function Documentation}
\index{BIP324Cipher@{BIP324Cipher}!Decrypt@{Decrypt}}
\index{Decrypt@{Decrypt}!BIP324Cipher@{BIP324Cipher}}
\doxysubsubsection{Decrypt()}
{\footnotesize\ttfamily \label{class_b_i_p324_cipher_a95e0747a24590cb19e40bbc85d3f4501} 
bool Decrypt (\begin{DoxyParamCaption}\item[{std\+::span$<$ const std\+::byte $>$}]{input}{, }\item[{std\+::span$<$ const std\+::byte $>$}]{aad}{, }\item[{bool \&}]{ignore}{, }\item[{std\+::span$<$ std\+::byte $>$}]{contents}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [noexcept]}}

Decrypt a packet. Only after \doxyref{Initialize()}{p.}{class_b_i_p324_cipher_a87f44f44cd0aa5f834172aa6ef0c3442}.

It must hold that input.\+size() + LENGTH\+\_\+\+LEN == contents.\+size() + EXPANSION. Contents.\+size() must equal the length returned by Decrypt\+Length. \index{BIP324Cipher@{BIP324Cipher}!DecryptLength@{DecryptLength}}
\index{DecryptLength@{DecryptLength}!BIP324Cipher@{BIP324Cipher}}
\doxysubsubsection{DecryptLength()}
{\footnotesize\ttfamily \label{class_b_i_p324_cipher_ade0025dccb7ad8a522dea030741a35a2} 
uint32\+\_\+t Decrypt\+Length (\begin{DoxyParamCaption}\item[{std\+::span$<$ const std\+::byte $>$}]{input}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [noexcept]}}

Decrypt the length of a packet. Only after \doxyref{Initialize()}{p.}{class_b_i_p324_cipher_a87f44f44cd0aa5f834172aa6ef0c3442}.

It must hold that input.\+size() == LENGTH\+\_\+\+LEN. \index{BIP324Cipher@{BIP324Cipher}!Encrypt@{Encrypt}}
\index{Encrypt@{Encrypt}!BIP324Cipher@{BIP324Cipher}}
\doxysubsubsection{Encrypt()}
{\footnotesize\ttfamily \label{class_b_i_p324_cipher_a3873d321672b074ae55cac826b08aaba} 
void Encrypt (\begin{DoxyParamCaption}\item[{std\+::span$<$ const std\+::byte $>$}]{contents}{, }\item[{std\+::span$<$ const std\+::byte $>$}]{aad}{, }\item[{bool}]{ignore}{, }\item[{std\+::span$<$ std\+::byte $>$}]{output}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [noexcept]}}

Encrypt a packet. Only after \doxyref{Initialize()}{p.}{class_b_i_p324_cipher_a87f44f44cd0aa5f834172aa6ef0c3442}.

It must hold that output.\+size() == contents.\+size() + EXPANSION. \index{BIP324Cipher@{BIP324Cipher}!GetOurPubKey@{GetOurPubKey}}
\index{GetOurPubKey@{GetOurPubKey}!BIP324Cipher@{BIP324Cipher}}
\doxysubsubsection{GetOurPubKey()}
{\footnotesize\ttfamily \label{class_b_i_p324_cipher_ae8f0eba9c1d35debf89460e2d4ff9638} 
const \textbf{ Ell\+Swift\+Pub\+Key} \& Get\+Our\+Pub\+Key (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [noexcept]}}

Retrieve our public key. \index{BIP324Cipher@{BIP324Cipher}!GetReceiveGarbageTerminator@{GetReceiveGarbageTerminator}}
\index{GetReceiveGarbageTerminator@{GetReceiveGarbageTerminator}!BIP324Cipher@{BIP324Cipher}}
\doxysubsubsection{GetReceiveGarbageTerminator()}
{\footnotesize\ttfamily \label{class_b_i_p324_cipher_acc961cd2df819404cec95413b563e261} 
std\+::span$<$ const std\+::byte $>$ Get\+Receive\+Garbage\+Terminator (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [noexcept]}}

Get the expected Garbage Terminator to receive. Only after \doxyref{Initialize()}{p.}{class_b_i_p324_cipher_a87f44f44cd0aa5f834172aa6ef0c3442}. \index{BIP324Cipher@{BIP324Cipher}!GetSendGarbageTerminator@{GetSendGarbageTerminator}}
\index{GetSendGarbageTerminator@{GetSendGarbageTerminator}!BIP324Cipher@{BIP324Cipher}}
\doxysubsubsection{GetSendGarbageTerminator()}
{\footnotesize\ttfamily \label{class_b_i_p324_cipher_a67e8501aa5c15474c4c0774a0cc1870d} 
std\+::span$<$ const std\+::byte $>$ Get\+Send\+Garbage\+Terminator (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [noexcept]}}

Get the Garbage Terminator to send. Only after \doxyref{Initialize()}{p.}{class_b_i_p324_cipher_a87f44f44cd0aa5f834172aa6ef0c3442}. \index{BIP324Cipher@{BIP324Cipher}!GetSessionID@{GetSessionID}}
\index{GetSessionID@{GetSessionID}!BIP324Cipher@{BIP324Cipher}}
\doxysubsubsection{GetSessionID()}
{\footnotesize\ttfamily \label{class_b_i_p324_cipher_a894e525317e7d1e7ab8af8bef362782b} 
std\+::span$<$ const std\+::byte $>$ Get\+Session\+ID (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [noexcept]}}

Get the Session ID. Only after \doxyref{Initialize()}{p.}{class_b_i_p324_cipher_a87f44f44cd0aa5f834172aa6ef0c3442}. \index{BIP324Cipher@{BIP324Cipher}!Initialize@{Initialize}}
\index{Initialize@{Initialize}!BIP324Cipher@{BIP324Cipher}}
\doxysubsubsection{Initialize()}
{\footnotesize\ttfamily \label{class_b_i_p324_cipher_a87f44f44cd0aa5f834172aa6ef0c3442} 
void Initialize (\begin{DoxyParamCaption}\item[{const \textbf{ Ell\+Swift\+Pub\+Key} \&}]{their\+\_\+pubkey}{, }\item[{bool}]{initiator}{, }\item[{bool}]{self\+\_\+decrypt}{ = {\ttfamily false}}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [noexcept]}}

Initialize when the other side\textquotesingle{}s public key is received. Can only be called once.

initiator is set to true if we are the initiator establishing the v2 P2P connection. self\+\_\+decrypt is only for testing, and swaps encryption/decryption keys, so that encryption and decryption can be tested without knowing the other side\textquotesingle{}s private key. \index{BIP324Cipher@{BIP324Cipher}!operator bool@{operator bool}}
\index{operator bool@{operator bool}!BIP324Cipher@{BIP324Cipher}}
\doxysubsubsection{operator bool()}
{\footnotesize\ttfamily \label{class_b_i_p324_cipher_a420e60e9788bfa3b52aa3aab72ea3a5e} 
operator bool (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [explicit]}, {\ttfamily [noexcept]}}

Determine whether this cipher is fully initialized. 

\label{doc-variable-members}
\doxysubsection{Field Documentation}
\index{BIP324Cipher@{BIP324Cipher}!EXPANSION@{EXPANSION}}
\index{EXPANSION@{EXPANSION}!BIP324Cipher@{BIP324Cipher}}
\doxysubsubsection{EXPANSION}
{\footnotesize\ttfamily \label{class_b_i_p324_cipher_a4822b4e3276b4efe931706f48ecf065c} 
unsigned EXPANSION = \textbf{ LENGTH\+\_\+\+LEN} + \textbf{ HEADER\+\_\+\+LEN} + \textbf{ FSCha\+Cha20\+Poly1305\+::\+EXPANSION}\hspace{0.3cm}{\ttfamily [static]}, {\ttfamily [constexpr]}}

\index{BIP324Cipher@{BIP324Cipher}!GARBAGE\_TERMINATOR\_LEN@{GARBAGE\_TERMINATOR\_LEN}}
\index{GARBAGE\_TERMINATOR\_LEN@{GARBAGE\_TERMINATOR\_LEN}!BIP324Cipher@{BIP324Cipher}}
\doxysubsubsection{GARBAGE\_TERMINATOR\_LEN}
{\footnotesize\ttfamily \label{class_b_i_p324_cipher_a544c544b2f9eb64bdfece91c19bb3bdd} 
unsigned GARBAGE\+\_\+\+TERMINATOR\+\_\+\+LEN \{16\}\hspace{0.3cm}{\ttfamily [static]}, {\ttfamily [constexpr]}}

\index{BIP324Cipher@{BIP324Cipher}!HEADER\_LEN@{HEADER\_LEN}}
\index{HEADER\_LEN@{HEADER\_LEN}!BIP324Cipher@{BIP324Cipher}}
\doxysubsubsection{HEADER\_LEN}
{\footnotesize\ttfamily \label{class_b_i_p324_cipher_ae6edea3261273e0d4bf49cc85a7b5365} 
unsigned HEADER\+\_\+\+LEN \{1\}\hspace{0.3cm}{\ttfamily [static]}, {\ttfamily [constexpr]}}

\index{BIP324Cipher@{BIP324Cipher}!IGNORE\_BIT@{IGNORE\_BIT}}
\index{IGNORE\_BIT@{IGNORE\_BIT}!BIP324Cipher@{BIP324Cipher}}
\doxysubsubsection{IGNORE\_BIT}
{\footnotesize\ttfamily \label{class_b_i_p324_cipher_abdbf0cd63f3438a267285a5f3ea53f71} 
std\+::byte IGNORE\+\_\+\+BIT \{0x80\}\hspace{0.3cm}{\ttfamily [static]}, {\ttfamily [constexpr]}}

\index{BIP324Cipher@{BIP324Cipher}!LENGTH\_LEN@{LENGTH\_LEN}}
\index{LENGTH\_LEN@{LENGTH\_LEN}!BIP324Cipher@{BIP324Cipher}}
\doxysubsubsection{LENGTH\_LEN}
{\footnotesize\ttfamily \label{class_b_i_p324_cipher_a99be1c6d1d32b0c22578082196e92f83} 
unsigned LENGTH\+\_\+\+LEN \{3\}\hspace{0.3cm}{\ttfamily [static]}, {\ttfamily [constexpr]}}

\index{BIP324Cipher@{BIP324Cipher}!REKEY\_INTERVAL@{REKEY\_INTERVAL}}
\index{REKEY\_INTERVAL@{REKEY\_INTERVAL}!BIP324Cipher@{BIP324Cipher}}
\doxysubsubsection{REKEY\_INTERVAL}
{\footnotesize\ttfamily \label{class_b_i_p324_cipher_a81f9ab6214dca718806e15b59776150b} 
unsigned REKEY\+\_\+\+INTERVAL \{224\}\hspace{0.3cm}{\ttfamily [static]}, {\ttfamily [constexpr]}}

\index{BIP324Cipher@{BIP324Cipher}!SESSION\_ID\_LEN@{SESSION\_ID\_LEN}}
\index{SESSION\_ID\_LEN@{SESSION\_ID\_LEN}!BIP324Cipher@{BIP324Cipher}}
\doxysubsubsection{SESSION\_ID\_LEN}
{\footnotesize\ttfamily \label{class_b_i_p324_cipher_a1b89fa1d86700a838b0be4a31f321d0c} 
unsigned SESSION\+\_\+\+ID\+\_\+\+LEN \{32\}\hspace{0.3cm}{\ttfamily [static]}, {\ttfamily [constexpr]}}



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
src/\textbf{ bip324.\+h}\item 
src/\textbf{ bip324.\+cpp}\end{DoxyCompactItemize}
