\doxysection{i2p.\+h}
\label{i2p_8h_source}\index{src/i2p.h@{src/i2p.h}}
\textbf{ Go to the documentation of this file.}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{//\ Copyright\ (c)\ 2020-\/present\ The\ Bitcoin\ Core\ developers}}
\DoxyCodeLine{00002\ \textcolor{comment}{//\ Distributed\ under\ the\ MIT\ software\ license,\ see\ the\ accompanying}}
\DoxyCodeLine{00003\ \textcolor{comment}{//\ file\ COPYING\ or\ http://www.opensource.org/licenses/mit-\/license.php.}}
\DoxyCodeLine{00004\ }
\DoxyCodeLine{00005\ \textcolor{preprocessor}{\#ifndef\ BITCOIN\_I2P\_H}}
\DoxyCodeLine{00006\ \textcolor{preprocessor}{\#define\ BITCOIN\_I2P\_H}}
\DoxyCodeLine{00007\ }
\DoxyCodeLine{00008\ \textcolor{preprocessor}{\#include\ <compat/compat.h>}}
\DoxyCodeLine{00009\ \textcolor{preprocessor}{\#include\ <netaddress.h>}}
\DoxyCodeLine{00010\ \textcolor{preprocessor}{\#include\ <netbase.h>}}
\DoxyCodeLine{00011\ \textcolor{preprocessor}{\#include\ <sync.h>}}
\DoxyCodeLine{00012\ \textcolor{preprocessor}{\#include\ <util/fs.h>}}
\DoxyCodeLine{00013\ \textcolor{preprocessor}{\#include\ <util/sock.h>}}
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#include\ <util/threadinterrupt.h>}}
\DoxyCodeLine{00015\ }
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#include\ <memory>}}
\DoxyCodeLine{00017\ \textcolor{preprocessor}{\#include\ <optional>}}
\DoxyCodeLine{00018\ \textcolor{preprocessor}{\#include\ <string>}}
\DoxyCodeLine{00019\ \textcolor{preprocessor}{\#include\ <unordered\_map>}}
\DoxyCodeLine{00020\ \textcolor{preprocessor}{\#include\ <vector>}}
\DoxyCodeLine{00021\ }
\DoxyCodeLine{00022\ \textcolor{keyword}{namespace\ }i2p\ \{}
\DoxyCodeLine{00023\ }
\DoxyCodeLine{00027\ \textcolor{keyword}{using\ }Binary\ =\ std::vector<uint8\_t>;}
\DoxyCodeLine{00028\ }
\DoxyCodeLine{00032\ \textcolor{keyword}{struct\ }Connection\ \{}
\DoxyCodeLine{00034\ \ \ \ \ std::unique\_ptr<Sock>\ sock;}
\DoxyCodeLine{00035\ }
\DoxyCodeLine{00037\ \ \ \ \ CService\ me;}
\DoxyCodeLine{00038\ }
\DoxyCodeLine{00040\ \ \ \ \ CService\ peer;}
\DoxyCodeLine{00041\ \};}
\DoxyCodeLine{00042\ }
\DoxyCodeLine{00043\ \textcolor{keyword}{namespace\ }sam\ \{}
\DoxyCodeLine{00044\ }
\DoxyCodeLine{00051\ \textcolor{keyword}{static}\ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{size\_t}\ MAX\_MSG\_SIZE\{65536\};}
\DoxyCodeLine{00052\ }
\DoxyCodeLine{00056\ \textcolor{keyword}{class\ }Session}
\DoxyCodeLine{00057\ \{}
\DoxyCodeLine{00058\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00068\ \ \ \ \ Session(\textcolor{keyword}{const}\ fs::path\&\ private\_key\_file,}
\DoxyCodeLine{00069\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ Proxy\&\ control\_host,}
\DoxyCodeLine{00070\ \ \ \ \ \ \ \ \ \ \ \ \ std::shared\_ptr<CThreadInterrupt>\ interrupt);}
\DoxyCodeLine{00071\ }
\DoxyCodeLine{00081\ \ \ \ \ Session(\textcolor{keyword}{const}\ Proxy\&\ control\_host,\ std::shared\_ptr<CThreadInterrupt>\ interrupt);}
\DoxyCodeLine{00082\ }
\DoxyCodeLine{00089\ \ \ \ \ \string~Session();}
\DoxyCodeLine{00090\ }
\DoxyCodeLine{00097\ \ \ \ \ \textcolor{keywordtype}{bool}\ Listen(Connection\&\ conn)\ EXCLUSIVE\_LOCKS\_REQUIRED(!m\_mutex);}
\DoxyCodeLine{00098\ }
\DoxyCodeLine{00105\ \ \ \ \ \textcolor{keywordtype}{bool}\ Accept(Connection\&\ conn)\ EXCLUSIVE\_LOCKS\_REQUIRED(!m\_mutex);}
\DoxyCodeLine{00106\ }
\DoxyCodeLine{00116\ \ \ \ \ \textcolor{keywordtype}{bool}\ Connect(\textcolor{keyword}{const}\ CService\&\ to,\ Connection\&\ conn,\ \textcolor{keywordtype}{bool}\&\ proxy\_error)\ EXCLUSIVE\_LOCKS\_REQUIRED(!m\_mutex);}
\DoxyCodeLine{00117\ }
\DoxyCodeLine{00118\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00122\ \ \ \ \ \textcolor{keyword}{struct\ }Reply\ \{}
\DoxyCodeLine{00126\ \ \ \ \ \ \ \ \ std::string\ full;}
\DoxyCodeLine{00127\ }
\DoxyCodeLine{00131\ \ \ \ \ \ \ \ \ std::string\ request;}
\DoxyCodeLine{00132\ }
\DoxyCodeLine{00140\ \ \ \ \ \ \ \ \ std::unordered\_map<std::string,\ std::optional<std::string>>\ keys;}
\DoxyCodeLine{00141\ }
\DoxyCodeLine{00152\ \ \ \ \ \ \ \ \ std::string\ Get(\textcolor{keyword}{const}\ std::string\&\ key)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00153\ \ \ \ \ \};}
\DoxyCodeLine{00154\ }
\DoxyCodeLine{00163\ \ \ \ \ Reply\ SendRequestAndGetReply(\textcolor{keyword}{const}\ Sock\&\ sock,}
\DoxyCodeLine{00164\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::string\&\ request,}
\DoxyCodeLine{00165\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ check\_result\_ok\ =\ \textcolor{keyword}{true})\ \textcolor{keyword}{const};}
\DoxyCodeLine{00166\ }
\DoxyCodeLine{00172\ \ \ \ \ std::unique\_ptr<Sock>\ Hello()\ \textcolor{keyword}{const}\ EXCLUSIVE\_LOCKS\_REQUIRED(m\_mutex);}
\DoxyCodeLine{00173\ }
\DoxyCodeLine{00177\ \ \ \ \ \textcolor{keywordtype}{void}\ CheckControlSock()\ EXCLUSIVE\_LOCKS\_REQUIRED(!m\_mutex);}
\DoxyCodeLine{00178\ }
\DoxyCodeLine{00184\ \ \ \ \ \textcolor{keywordtype}{void}\ DestGenerate(\textcolor{keyword}{const}\ Sock\&\ sock)\ EXCLUSIVE\_LOCKS\_REQUIRED(m\_mutex);}
\DoxyCodeLine{00185\ }
\DoxyCodeLine{00192\ \ \ \ \ \textcolor{keywordtype}{void}\ GenerateAndSavePrivateKey(\textcolor{keyword}{const}\ Sock\&\ sock)\ EXCLUSIVE\_LOCKS\_REQUIRED(m\_mutex);}
\DoxyCodeLine{00193\ }
\DoxyCodeLine{00199\ \ \ \ \ Binary\ MyDestination()\ \textcolor{keyword}{const}\ EXCLUSIVE\_LOCKS\_REQUIRED(m\_mutex);}
\DoxyCodeLine{00200\ }
\DoxyCodeLine{00206\ \ \ \ \ \textcolor{keywordtype}{void}\ CreateIfNotCreatedAlready()\ EXCLUSIVE\_LOCKS\_REQUIRED(m\_mutex);}
\DoxyCodeLine{00207\ }
\DoxyCodeLine{00214\ \ \ \ \ std::unique\_ptr<Sock>\ StreamAccept()\ EXCLUSIVE\_LOCKS\_REQUIRED(m\_mutex);}
\DoxyCodeLine{00215\ }
\DoxyCodeLine{00219\ \ \ \ \ \textcolor{keywordtype}{void}\ Disconnect()\ EXCLUSIVE\_LOCKS\_REQUIRED(m\_mutex);}
\DoxyCodeLine{00220\ }
\DoxyCodeLine{00224\ \ \ \ \ \textcolor{keyword}{const}\ fs::path\ m\_private\_key\_file;}
\DoxyCodeLine{00225\ }
\DoxyCodeLine{00229\ \ \ \ \ \textcolor{keyword}{const}\ Proxy\ m\_control\_host;}
\DoxyCodeLine{00230\ }
\DoxyCodeLine{00234\ \ \ \ \ \textcolor{keyword}{const}\ std::shared\_ptr<CThreadInterrupt>\ m\_interrupt;}
\DoxyCodeLine{00235\ }
\DoxyCodeLine{00239\ \ \ \ \ \textcolor{keyword}{mutable}\ Mutex\ m\_mutex;}
\DoxyCodeLine{00240\ }
\DoxyCodeLine{00245\ \ \ \ \ Binary\ m\_private\_key\ GUARDED\_BY(m\_mutex);}
\DoxyCodeLine{00246\ }
\DoxyCodeLine{00256\ \ \ \ \ std::unique\_ptr<Sock>\ m\_control\_sock\ GUARDED\_BY(m\_mutex);}
\DoxyCodeLine{00257\ }
\DoxyCodeLine{00262\ \ \ \ \ CService\ m\_my\_addr\ GUARDED\_BY(m\_mutex);}
\DoxyCodeLine{00263\ }
\DoxyCodeLine{00267\ \ \ \ \ std::string\ m\_session\_id\ GUARDED\_BY(m\_mutex);}
\DoxyCodeLine{00268\ }
\DoxyCodeLine{00273\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ m\_transient;}
\DoxyCodeLine{00274\ \};}
\DoxyCodeLine{00275\ }
\DoxyCodeLine{00276\ \}\ \textcolor{comment}{//\ namespace\ sam}}
\DoxyCodeLine{00277\ \}\ \textcolor{comment}{//\ namespace\ i2p}}
\DoxyCodeLine{00278\ }
\DoxyCodeLine{00279\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//\ BITCOIN\_I2P\_H}}

\end{DoxyCode}
