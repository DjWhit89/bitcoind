\doxysection{Transport Class Reference}
\label{class_transport}\index{Transport@{Transport}}


{\ttfamily \#include $<$net.\+h$>$}

Inheritance diagram for Transport\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=2.000000cm]{class_transport}
\end{center}
\end{figure}
\doxysubsubsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \textbf{ Info}
\end{DoxyCompactItemize}
\doxysubsubsection*{Public Types}
\begin{DoxyCompactItemize}
\item 
using \textbf{ Bytes\+To\+Send}
\end{DoxyCompactItemize}
\doxysubsubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
virtual \textbf{ $\sim$\+Transport} ()=default
\item 
virtual \textbf{ Info} \textbf{ Get\+Info} () const noexcept=0
\item 
virtual bool \textbf{ Received\+Message\+Complete} () const =0
\item 
virtual bool \textbf{ Received\+Bytes} (std\+::span$<$ const uint8\+\_\+t $>$ \&msg\+\_\+bytes)=0
\item 
virtual \textbf{ CNet\+Message} \textbf{ Get\+Received\+Message} (std\+::chrono\+::microseconds time, bool \&reject\+\_\+message)=0
\item 
virtual bool \textbf{ Set\+Message\+To\+Send} (\textbf{ CSerialized\+Net\+Msg} \&msg) noexcept=0
\item 
virtual \textbf{ Bytes\+To\+Send} \textbf{ Get\+Bytes\+To\+Send} (bool have\+\_\+next\+\_\+message) const noexcept=0
\item 
virtual void \textbf{ Mark\+Bytes\+Sent} (size\+\_\+t bytes\+\_\+sent) noexcept=0
\item 
virtual size\+\_\+t \textbf{ Get\+Send\+Memory\+Usage} () const noexcept=0
\item 
virtual bool \textbf{ Should\+Reconnect\+V1} () const noexcept=0
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
The \doxyref{Transport}{p.}{class_transport} converts one connection\textquotesingle{}s sent messages to wire bytes, and received bytes back. 

\label{doc-typedef-members}
\doxysubsection{Member Typedef Documentation}
\index{Transport@{Transport}!BytesToSend@{BytesToSend}}
\index{BytesToSend@{BytesToSend}!Transport@{Transport}}
\doxysubsubsection{BytesToSend}
{\footnotesize\ttfamily \label{class_transport_af6ca4dbfbf45f9bd26bc6bf4a6adfb9f} 
using \textbf{ Bytes\+To\+Send}}

{\bfseries Initial value\+:}
\begin{DoxyCode}{0}
\DoxyCodeLine{\ std::tuple<}
\DoxyCodeLine{\ \ \ \ \ \ \ \ std::span<const\ uint8\_t>\ ,}
\DoxyCodeLine{\ \ \ \ \ \ \ \ bool\ ,}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::string\&\ }
\DoxyCodeLine{\ \ \ \ >}

\end{DoxyCode}
Return type for Get\+Bytes\+To\+Send, consisting of\+:
\begin{DoxyItemize}
\item std\+::span$<$const uint8\+\_\+t$>$ to\+\_\+send\+: span of bytes to be sent over the wire (possibly empty).
\item bool more\+: whether there will be more bytes to be sent after the ones in to\+\_\+send are all sent (as signaled by \doxyref{Mark\+Bytes\+Sent()}{p.}{class_transport_a915249a31c6d363883f933cbbd07d22f}).
\item const std\+::string\& m\+\_\+type\+: message type on behalf of which this is being sent ("{}"{} for bytes that are not on behalf of any message). 
\end{DoxyItemize}

\label{doc-constructors}
\doxysubsection{Constructor \& Destructor Documentation}
\index{Transport@{Transport}!````~Transport@{$\sim$Transport}}
\index{````~Transport@{$\sim$Transport}!Transport@{Transport}}
\doxysubsubsection{$\sim$Transport()}
{\footnotesize\ttfamily \label{class_transport_a9c4cb2756aafdbaa8e42942407e42e6c} 
virtual $\sim$\textbf{ Transport} (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [default]}}



\label{doc-func-members}
\doxysubsection{Member Function Documentation}
\index{Transport@{Transport}!GetBytesToSend@{GetBytesToSend}}
\index{GetBytesToSend@{GetBytesToSend}!Transport@{Transport}}
\doxysubsubsection{GetBytesToSend()}
{\footnotesize\ttfamily \label{class_transport_afe903c5a52b321e189d97c6edbb64e95} 
virtual \textbf{ Bytes\+To\+Send} Get\+Bytes\+To\+Send (\begin{DoxyParamCaption}\item[{bool}]{have\+\_\+next\+\_\+message}{}\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [pure virtual]}, {\ttfamily [noexcept]}}

Get bytes to send on the wire, if any, along with other information about it.

As a const function, it does not modify the transport\textquotesingle{}s observable state, and is thus safe to be called multiple times.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{in}}  & {\em have\+\_\+next\+\_\+message} & If true, the "{}more"{} return value reports whether more will be sendable after a Set\+Message\+To\+Send call. It is set by the caller when they know they have another message ready to send, and only care about what happens after that. The have\+\_\+next\+\_\+message argument only affects this "{}more"{} return value and nothing else.\\
\hline
\end{DoxyParams}
Effectively, there are three possible outcomes about whether there are more bytes to send\+:
\begin{DoxyItemize}
\item Yes\+: the transport itself has more bytes to send later. For example, for \doxyref{V1\+Transport}{p.}{class_v1_transport} this happens during the sending of the header of a message, when there is a non-\/empty payload that follows.
\item No\+: the transport itself has no more bytes to send, but will have bytes to send if handed a message through Set\+Message\+To\+Send. In \doxyref{V1\+Transport}{p.}{class_v1_transport} this happens when sending the payload of a message.
\item Blocked\+: the transport itself has no more bytes to send, and is also incapable of sending anything more at all now, if it were handed another message to send. This occurs in \doxyref{V2\+Transport}{p.}{class_v2_transport} before the handshake is complete, as the encryption ciphers are not set up for sending messages before that point.
\end{DoxyItemize}

The boolean \textquotesingle{}more\textquotesingle{} is true for Yes, false for Blocked, and have\+\_\+next\+\_\+message controls what is returned for No.

\begin{DoxyReturn}{Returns}
a \doxyref{Bytes\+To\+Send}{p.}{class_transport_af6ca4dbfbf45f9bd26bc6bf4a6adfb9f} object. The to\+\_\+send member returned acts as a stream which is only ever appended to. This means that with the exception of Mark\+Bytes\+Sent (which pops bytes off the front of later to\+\_\+sends), operations on the transport can only append to what is being returned. Also note that m\+\_\+type and to\+\_\+send refer to data that is internal to the transport, and calling any non-\/const function on this object may invalidate them. 
\end{DoxyReturn}


Implemented in \textbf{ V1\+Transport} \doxyref{}{p.}{class_v1_transport_a39dcf7de09089dc617df00c6850647b3}, and \textbf{ V2\+Transport} \doxyref{}{p.}{class_v2_transport_a39dcf7de09089dc617df00c6850647b3}.

\index{Transport@{Transport}!GetInfo@{GetInfo}}
\index{GetInfo@{GetInfo}!Transport@{Transport}}
\doxysubsubsection{GetInfo()}
{\footnotesize\ttfamily \label{class_transport_a48296f31d432a8809164b3f97bbc1e4a} 
virtual \textbf{ Info} Get\+Info (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [pure virtual]}, {\ttfamily [noexcept]}}

Retrieve information about this transport. 

Implemented in \textbf{ V1\+Transport} \doxyref{}{p.}{class_v1_transport_a58bd1ab368e66f029f6029a004871f34}, and \textbf{ V2\+Transport} \doxyref{}{p.}{class_v2_transport_a52d0c2171a477c4f78137f806a4871f0}.

\index{Transport@{Transport}!GetReceivedMessage@{GetReceivedMessage}}
\index{GetReceivedMessage@{GetReceivedMessage}!Transport@{Transport}}
\doxysubsubsection{GetReceivedMessage()}
{\footnotesize\ttfamily \label{class_transport_a65899c32e93818026372178488912881} 
virtual \textbf{ CNet\+Message} Get\+Received\+Message (\begin{DoxyParamCaption}\item[{std\+::chrono\+::microseconds}]{time}{, }\item[{bool \&}]{reject\+\_\+message}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [pure virtual]}}

Retrieve a completed message from transport.

This can only be called when \doxyref{Received\+Message\+Complete()}{p.}{class_transport_ad72f1df14e7c2b557c3f780d25361073} is true.

If reject\+\_\+message=true is returned the message itself is invalid, but (other than false returned by Received\+Bytes) the transport is not in an inconsistent state. 

Implemented in \textbf{ V1\+Transport} \doxyref{}{p.}{class_v1_transport_ada4775fac2b99d16d44d7e811cc8d5ef}, and \textbf{ V2\+Transport} \doxyref{}{p.}{class_v2_transport_a12316f223ad2873017e085b2aacaa6ec}.

\index{Transport@{Transport}!GetSendMemoryUsage@{GetSendMemoryUsage}}
\index{GetSendMemoryUsage@{GetSendMemoryUsage}!Transport@{Transport}}
\doxysubsubsection{GetSendMemoryUsage()}
{\footnotesize\ttfamily \label{class_transport_a091196a6bab12cd2fe571129015bba8b} 
virtual size\+\_\+t Get\+Send\+Memory\+Usage (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [pure virtual]}, {\ttfamily [noexcept]}}

Return the memory usage of this transport attributable to buffered data to send. 

Implemented in \textbf{ V1\+Transport} \doxyref{}{p.}{class_v1_transport_a6064b63ffba8cdc3f48a4217f75e3f93}, and \textbf{ V2\+Transport} \doxyref{}{p.}{class_v2_transport_a6064b63ffba8cdc3f48a4217f75e3f93}.

\index{Transport@{Transport}!MarkBytesSent@{MarkBytesSent}}
\index{MarkBytesSent@{MarkBytesSent}!Transport@{Transport}}
\doxysubsubsection{MarkBytesSent()}
{\footnotesize\ttfamily \label{class_transport_a915249a31c6d363883f933cbbd07d22f} 
virtual void Mark\+Bytes\+Sent (\begin{DoxyParamCaption}\item[{size\+\_\+t}]{bytes\+\_\+sent}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [pure virtual]}, {\ttfamily [noexcept]}}

Report how many bytes returned by the last \doxyref{Get\+Bytes\+To\+Send()}{p.}{class_transport_afe903c5a52b321e189d97c6edbb64e95} have been sent.

bytes\+\_\+sent cannot exceed to\+\_\+send.\+size() of the last \doxyref{Get\+Bytes\+To\+Send()}{p.}{class_transport_afe903c5a52b321e189d97c6edbb64e95} result.

If bytes\+\_\+sent=0, this call has no effect. 

Implemented in \textbf{ V1\+Transport} \doxyref{}{p.}{class_v1_transport_ac69707799060ee90f662f6139bf01505}, and \textbf{ V2\+Transport} \doxyref{}{p.}{class_v2_transport_ac69707799060ee90f662f6139bf01505}.

\index{Transport@{Transport}!ReceivedBytes@{ReceivedBytes}}
\index{ReceivedBytes@{ReceivedBytes}!Transport@{Transport}}
\doxysubsubsection{ReceivedBytes()}
{\footnotesize\ttfamily \label{class_transport_af5340b2062e8681b6fb7d8f5a724102d} 
virtual bool Received\+Bytes (\begin{DoxyParamCaption}\item[{std\+::span$<$ const uint8\+\_\+t $>$ \&}]{msg\+\_\+bytes}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [pure virtual]}}

Feed wire bytes to the transport.

\begin{DoxyReturn}{Returns}
false if some bytes were invalid, in which case the transport can\textquotesingle{}t be used anymore.
\end{DoxyReturn}
Consumed bytes are chopped off the front of msg\+\_\+bytes. 

Implemented in \textbf{ V1\+Transport} \doxyref{}{p.}{class_v1_transport_a7b1c80d6eaf17aa27556eb6ed47315c0}, and \textbf{ V2\+Transport} \doxyref{}{p.}{class_v2_transport_a5691fd1213bde99a8f6b51b0db49c799}.

\index{Transport@{Transport}!ReceivedMessageComplete@{ReceivedMessageComplete}}
\index{ReceivedMessageComplete@{ReceivedMessageComplete}!Transport@{Transport}}
\doxysubsubsection{ReceivedMessageComplete()}
{\footnotesize\ttfamily \label{class_transport_ad72f1df14e7c2b557c3f780d25361073} 
virtual bool Received\+Message\+Complete (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [pure virtual]}}

Returns true if the current message is complete (so Get\+Received\+Message can be called). 

Implemented in \textbf{ V1\+Transport} \doxyref{}{p.}{class_v1_transport_a8d29e67c1f1ec0f0bc1e0adcdb458c0d}, and \textbf{ V2\+Transport} \doxyref{}{p.}{class_v2_transport_a4f36f118f8160d80099867d6649af983}.

\index{Transport@{Transport}!SetMessageToSend@{SetMessageToSend}}
\index{SetMessageToSend@{SetMessageToSend}!Transport@{Transport}}
\doxysubsubsection{SetMessageToSend()}
{\footnotesize\ttfamily \label{class_transport_a7f7875e9c9bf5903f84dba2123309c01} 
virtual bool Set\+Message\+To\+Send (\begin{DoxyParamCaption}\item[{\textbf{ CSerialized\+Net\+Msg} \&}]{msg}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [pure virtual]}, {\ttfamily [noexcept]}}

Set the next message to send.

If no message can currently be set (perhaps because the previous one is not yet done being sent), returns false, and msg will be unmodified. Otherwise msg is enqueued (and possibly moved-\/from) and true is returned. 

Implemented in \textbf{ V1\+Transport} \doxyref{}{p.}{class_v1_transport_ae61bb32e8ff51cb3802156ab3eb10556}, and \textbf{ V2\+Transport} \doxyref{}{p.}{class_v2_transport_ae61bb32e8ff51cb3802156ab3eb10556}.

\index{Transport@{Transport}!ShouldReconnectV1@{ShouldReconnectV1}}
\index{ShouldReconnectV1@{ShouldReconnectV1}!Transport@{Transport}}
\doxysubsubsection{ShouldReconnectV1()}
{\footnotesize\ttfamily \label{class_transport_ab8e03c4ee651c248fe3c67c55844681c} 
virtual bool Should\+Reconnect\+V1 (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [pure virtual]}, {\ttfamily [noexcept]}}

Whether upon disconnections, a reconnect with V1 is warranted. 

Implemented in \textbf{ V1\+Transport} \doxyref{}{p.}{class_v1_transport_a52b4f178e8f2d4477668b401ed7ea8e1}, and \textbf{ V2\+Transport} \doxyref{}{p.}{class_v2_transport_ab392835ec6771ddb918c7322a2bf1826}.



The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
src/\textbf{ net.\+h}\end{DoxyCompactItemize}
