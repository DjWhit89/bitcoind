<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.15.0" xml:lang="en-US">
  <compounddef id="scriptpubkeyman_8h" kind="file" language="C++">
    <compoundname>scriptpubkeyman.h</compoundname>
    <includes refid="addresstype_8h" local="no">addresstype.h</includes>
    <includes refid="messages_8h" local="no">common/messages.h</includes>
    <includes refid="signmessage_8h" local="no">common/signmessage.h</includes>
    <includes refid="common_2types_8h" local="no">common/types.h</includes>
    <includes local="no">logging.h</includes>
    <includes refid="musig_8h" local="no">musig.h</includes>
    <includes refid="node_2types_8h" local="no">node/types.h</includes>
    <includes local="no">psbt.h</includes>
    <includes refid="script_2descriptor_8h" local="no">script/descriptor.h</includes>
    <includes refid="script_2script_8h" local="no">script/script.h</includes>
    <includes refid="signingprovider_8h" local="no">script/signingprovider.h</includes>
    <includes refid="result_8h" local="no">util/result.h</includes>
    <includes local="no">util/time.h</includes>
    <includes refid="crypter_8h" local="no">wallet/crypter.h</includes>
    <includes refid="wallet_2types_8h" local="no">wallet/types.h</includes>
    <includes refid="walletdb_8h" local="no">wallet/walletdb.h</includes>
    <includes refid="walletutil_8h" local="no">wallet/walletutil.h</includes>
    <includes local="no">boost/signals2/signal.hpp</includes>
    <includes local="no">functional</includes>
    <includes local="no">optional</includes>
    <includes local="no">unordered_map</includes>
    <includedby refid="external__signer__scriptpubkeyman_8h" local="no">src/wallet/external_signer_scriptpubkeyman.h</includedby>
    <includedby refid="scriptpubkeyman_8cpp" local="no">src/wallet/scriptpubkeyman.cpp</includedby>
    <includedby refid="test_2fuzz_2scriptpubkeyman_8cpp" local="no">src/wallet/test/fuzz/scriptpubkeyman.cpp</includedby>
    <includedby refid="scriptpubkeyman__tests_8cpp" local="no">src/wallet/test/scriptpubkeyman_tests.cpp</includedby>
    <includedby refid="wallet_2test_2util_8h" local="no">src/wallet/test/util.h</includedby>
    <includedby refid="wallet_8cpp" local="no">src/wallet/wallet.cpp</includedby>
    <includedby refid="wallet_2wallet_8h" local="no">src/wallet/wallet.h</includedby>
    <incdepgraph>
      <node id="2">
        <label>addresstype.h</label>
        <link refid="addresstype_8h"/>
        <childnode refid="3" relation="include">
        </childnode>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="45" relation="include">
        </childnode>
        <childnode refid="34" relation="include">
        </childnode>
        <childnode refid="48" relation="include">
        </childnode>
        <childnode refid="46" relation="include">
        </childnode>
        <childnode refid="19" relation="include">
        </childnode>
        <childnode refid="51" relation="include">
        </childnode>
        <childnode refid="33" relation="include">
        </childnode>
      </node>
      <node id="3">
        <label>attributes.h</label>
        <link refid="attributes_8h"/>
      </node>
      <node id="102">
        <label>clientversion.h</label>
        <link refid="clientversion_8h"/>
        <childnode refid="88" relation="include">
        </childnode>
        <childnode refid="103" relation="include">
        </childnode>
        <childnode refid="17" relation="include">
        </childnode>
        <childnode refid="33" relation="include">
        </childnode>
      </node>
      <node id="52">
        <label>common/messages.h</label>
        <link refid="messages_8h"/>
        <childnode refid="17" relation="include">
        </childnode>
        <childnode refid="41" relation="include">
        </childnode>
      </node>
      <node id="53">
        <label>common/signmessage.h</label>
        <link refid="signmessage_8h"/>
        <childnode refid="34" relation="include">
        </childnode>
        <childnode refid="17" relation="include">
        </childnode>
      </node>
      <node id="54">
        <label>common/types.h</label>
        <link refid="common_2types_8h"/>
      </node>
      <node id="25">
        <label>compat/assumptions.h</label>
        <link refid="compat_2assumptions_8h"/>
        <childnode refid="12" relation="include">
        </childnode>
        <childnode refid="26" relation="include">
        </childnode>
      </node>
      <node id="8">
        <label>compat/byteswap.h</label>
        <link refid="byteswap_8h"/>
        <childnode refid="9" relation="include">
        </childnode>
      </node>
      <node id="7">
        <label>compat/endian.h</label>
        <link refid="endian_8h"/>
        <childnode refid="8" relation="include">
        </childnode>
        <childnode refid="10" relation="include">
        </childnode>
        <childnode refid="9" relation="include">
        </childnode>
      </node>
      <node id="58">
        <label>consensus/amount.h</label>
        <link refid="amount_8h"/>
        <childnode refid="9" relation="include">
        </childnode>
      </node>
      <node id="60">
        <label>consensus/consensus.h</label>
        <link refid="consensus_8h"/>
        <childnode refid="9" relation="include">
        </childnode>
        <childnode refid="15" relation="include">
        </childnode>
      </node>
      <node id="6">
        <label>crypto/common.h</label>
        <link refid="crypto_2common_8h"/>
        <childnode refid="7" relation="include">
        </childnode>
        <childnode refid="11" relation="include">
        </childnode>
        <childnode refid="12" relation="include">
        </childnode>
        <childnode refid="9" relation="include">
        </childnode>
        <childnode refid="13" relation="include">
        </childnode>
      </node>
      <node id="36">
        <label>crypto/hex_base.h</label>
        <link refid="hex__base_8h"/>
        <childnode refid="27" relation="include">
        </childnode>
        <childnode refid="12" relation="include">
        </childnode>
        <childnode refid="9" relation="include">
        </childnode>
        <childnode refid="28" relation="include">
        </childnode>
        <childnode refid="17" relation="include">
        </childnode>
      </node>
      <node id="14">
        <label>crypto/ripemd160.h</label>
        <link refid="ripemd160_8h"/>
        <childnode refid="9" relation="include">
        </childnode>
        <childnode refid="15" relation="include">
        </childnode>
      </node>
      <node id="16">
        <label>crypto/sha256.h</label>
        <link refid="sha256_8h"/>
        <childnode refid="9" relation="include">
        </childnode>
        <childnode refid="15" relation="include">
        </childnode>
        <childnode refid="17" relation="include">
        </childnode>
      </node>
      <node id="106">
        <label>crypto/siphash.h</label>
        <link refid="siphash_8h"/>
        <childnode refid="38" relation="include">
        </childnode>
        <childnode refid="9" relation="include">
        </childnode>
        <childnode refid="28" relation="include">
        </childnode>
      </node>
      <node id="5">
        <label>hash.h</label>
        <link refid="hash_8h"/>
        <childnode refid="3" relation="include">
        </childnode>
        <childnode refid="6" relation="include">
        </childnode>
        <childnode refid="14" relation="include">
        </childnode>
        <childnode refid="16" relation="include">
        </childnode>
        <childnode refid="18" relation="include">
        </childnode>
        <childnode refid="24" relation="include">
        </childnode>
        <childnode refid="27" relation="include">
        </childnode>
        <childnode refid="34" relation="include">
        </childnode>
        <childnode refid="17" relation="include">
        </childnode>
        <childnode refid="33" relation="include">
        </childnode>
      </node>
      <node id="78">
        <label>key.h</label>
        <link refid="key_8h"/>
        <childnode refid="56" relation="include">
        </childnode>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="24" relation="include">
        </childnode>
        <childnode refid="79" relation="include">
        </childnode>
        <childnode refid="34" relation="include">
        </childnode>
        <childnode refid="47" relation="include">
        </childnode>
        <childnode refid="33" relation="include">
        </childnode>
      </node>
      <node id="105">
        <label>logging.h</label>
        <link refid="logging_8h"/>
        <childnode refid="106" relation="include">
        </childnode>
        <childnode refid="87" relation="include">
        </childnode>
        <childnode refid="96" relation="include">
        </childnode>
        <childnode refid="48" relation="include">
        </childnode>
        <childnode refid="107" relation="include">
        </childnode>
        <childnode refid="37" relation="include">
        </childnode>
        <childnode refid="112" relation="include">
        </childnode>
        <childnode refid="49" relation="include">
        </childnode>
        <childnode refid="9" relation="include">
        </childnode>
        <childnode refid="13" relation="include">
        </childnode>
        <childnode refid="91" relation="include">
        </childnode>
        <childnode refid="81" relation="include">
        </childnode>
        <childnode refid="31" relation="include">
        </childnode>
        <childnode refid="82" relation="include">
        </childnode>
        <childnode refid="50" relation="include">
        </childnode>
        <childnode refid="17" relation="include">
        </childnode>
        <childnode refid="83" relation="include">
        </childnode>
        <childnode refid="114" relation="include">
        </childnode>
        <childnode refid="33" relation="include">
        </childnode>
      </node>
      <node id="56">
        <label>musig.h</label>
        <link refid="musig_8h"/>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="43" relation="include">
        </childnode>
        <childnode refid="33" relation="include">
        </childnode>
      </node>
      <node id="57">
        <label>node/types.h</label>
        <link refid="node_2types_8h"/>
        <childnode refid="58" relation="include">
        </childnode>
        <childnode refid="12" relation="include">
        </childnode>
        <childnode refid="9" relation="include">
        </childnode>
        <childnode refid="59" relation="include">
        </childnode>
        <childnode refid="45" relation="include">
        </childnode>
        <childnode refid="34" relation="include">
        </childnode>
        <childnode refid="73" relation="include">
        </childnode>
      </node>
      <node id="76">
        <label>outputtype.h</label>
        <link refid="outputtype_8h"/>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="77" relation="include">
        </childnode>
        <childnode refid="38" relation="include">
        </childnode>
        <childnode refid="43" relation="include">
        </childnode>
        <childnode refid="17" relation="include">
        </childnode>
        <childnode refid="41" relation="include">
        </childnode>
        <childnode refid="33" relation="include">
        </childnode>
      </node>
      <node id="59">
        <label>policy/policy.h</label>
        <link refid="policy_8h"/>
        <childnode refid="58" relation="include">
        </childnode>
        <childnode refid="60" relation="include">
        </childnode>
        <childnode refid="61" relation="include">
        </childnode>
        <childnode refid="67" relation="include">
        </childnode>
        <childnode refid="71" relation="include">
        </childnode>
        <childnode refid="72" relation="include">
        </childnode>
        <childnode refid="9" relation="include">
        </childnode>
        <childnode refid="17" relation="include">
        </childnode>
      </node>
      <node id="18">
        <label>prevector.h</label>
        <link refid="prevector_8h"/>
        <childnode refid="19" relation="include">
        </childnode>
        <childnode refid="20" relation="include">
        </childnode>
        <childnode refid="12" relation="include">
        </childnode>
        <childnode refid="9" relation="include">
        </childnode>
        <childnode refid="15" relation="include">
        </childnode>
        <childnode refid="13" relation="include">
        </childnode>
        <childnode refid="21" relation="include">
        </childnode>
        <childnode refid="22" relation="include">
        </childnode>
        <childnode refid="23" relation="include">
        </childnode>
      </node>
      <node id="61">
        <label>primitives/transaction.h</label>
        <link refid="primitives_2transaction_8h"/>
        <childnode refid="3" relation="include">
        </childnode>
        <childnode refid="58" relation="include">
        </childnode>
        <childnode refid="62" relation="include">
        </childnode>
        <childnode refid="45" relation="include">
        </childnode>
        <childnode refid="24" relation="include">
        </childnode>
        <childnode refid="34" relation="include">
        </childnode>
        <childnode refid="12" relation="include">
        </childnode>
        <childnode refid="9" relation="include">
        </childnode>
        <childnode refid="29" relation="include">
        </childnode>
        <childnode refid="26" relation="include">
        </childnode>
        <childnode refid="31" relation="include">
        </childnode>
        <childnode refid="66" relation="include">
        </childnode>
        <childnode refid="17" relation="include">
        </childnode>
        <childnode refid="65" relation="include">
        </childnode>
        <childnode refid="23" relation="include">
        </childnode>
        <childnode refid="33" relation="include">
        </childnode>
      </node>
      <node id="62">
        <label>primitives/transaction_identifier.h</label>
        <link refid="transaction__identifier_8h"/>
        <childnode refid="3" relation="include">
        </childnode>
        <childnode refid="34" relation="include">
        </childnode>
        <childnode refid="63" relation="include">
        </childnode>
        <childnode refid="64" relation="include">
        </childnode>
        <childnode refid="11" relation="include">
        </childnode>
        <childnode refid="65" relation="include">
        </childnode>
        <childnode refid="51" relation="include">
        </childnode>
      </node>
      <node id="4">
        <label>pubkey.h</label>
        <link refid="pubkey_8h"/>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="24" relation="include">
        </childnode>
        <childnode refid="27" relation="include">
        </childnode>
        <childnode refid="34" relation="include">
        </childnode>
        <childnode refid="13" relation="include">
        </childnode>
        <childnode refid="43" relation="include">
        </childnode>
        <childnode refid="33" relation="include">
        </childnode>
      </node>
      <node id="75">
        <label>script/descriptor.h</label>
        <link refid="script_2descriptor_8h"/>
        <childnode refid="76" relation="include">
        </childnode>
        <childnode refid="45" relation="include">
        </childnode>
        <childnode refid="92" relation="include">
        </childnode>
        <childnode refid="77" relation="include">
        </childnode>
        <childnode refid="43" relation="include">
        </childnode>
        <childnode refid="33" relation="include">
        </childnode>
      </node>
      <node id="67">
        <label>script/interpreter.h</label>
        <link refid="interpreter_8h"/>
        <childnode refid="58" relation="include">
        </childnode>
        <childnode refid="68" relation="include">
        </childnode>
        <childnode refid="61" relation="include">
        </childnode>
        <childnode refid="69" relation="include">
        </childnode>
        <childnode refid="70" relation="include">
        </childnode>
        <childnode refid="27" relation="include">
        </childnode>
        <childnode refid="34" relation="include">
        </childnode>
        <childnode refid="12" relation="include">
        </childnode>
        <childnode refid="9" relation="include">
        </childnode>
        <childnode refid="43" relation="include">
        </childnode>
        <childnode refid="33" relation="include">
        </childnode>
      </node>
      <node id="85">
        <label>script/keyorigin.h</label>
        <link refid="keyorigin_8h"/>
        <childnode refid="24" relation="include">
        </childnode>
        <childnode refid="33" relation="include">
        </childnode>
      </node>
      <node id="45">
        <label>script/script.h</label>
        <link refid="script_2script_8h"/>
        <childnode refid="3" relation="include">
        </childnode>
        <childnode refid="6" relation="include">
        </childnode>
        <childnode refid="18" relation="include">
        </childnode>
        <childnode refid="24" relation="include">
        </childnode>
        <childnode refid="34" relation="include">
        </childnode>
        <childnode refid="46" relation="include">
        </childnode>
        <childnode refid="20" relation="include">
        </childnode>
        <childnode refid="9" relation="include">
        </childnode>
        <childnode refid="13" relation="include">
        </childnode>
        <childnode refid="26" relation="include">
        </childnode>
        <childnode refid="28" relation="include">
        </childnode>
        <childnode refid="47" relation="include">
        </childnode>
        <childnode refid="17" relation="include">
        </childnode>
        <childnode refid="22" relation="include">
        </childnode>
        <childnode refid="23" relation="include">
        </childnode>
        <childnode refid="33" relation="include">
        </childnode>
      </node>
      <node id="69">
        <label>script/script_error.h</label>
        <link refid="script__error_8h"/>
        <childnode refid="17" relation="include">
        </childnode>
      </node>
      <node id="92">
        <label>script/sign.h</label>
        <link refid="sign_8h"/>
        <childnode refid="3" relation="include">
        </childnode>
        <childnode refid="93" relation="include">
        </childnode>
        <childnode refid="68" relation="include">
        </childnode>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="67" relation="include">
        </childnode>
        <childnode refid="85" relation="include">
        </childnode>
        <childnode refid="77" relation="include">
        </childnode>
        <childnode refid="34" relation="include">
        </childnode>
      </node>
      <node id="77">
        <label>script/signingprovider.h</label>
        <link refid="signingprovider_8h"/>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="3" relation="include">
        </childnode>
        <childnode refid="78" relation="include">
        </childnode>
        <childnode refid="56" relation="include">
        </childnode>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="85" relation="include">
        </childnode>
        <childnode refid="45" relation="include">
        </childnode>
        <childnode refid="86" relation="include">
        </childnode>
        <childnode refid="91" relation="include">
        </childnode>
        <childnode refid="43" relation="include">
        </childnode>
      </node>
      <node id="71">
        <label>script/solver.h</label>
        <link refid="solver_8h"/>
        <childnode refid="3" relation="include">
        </childnode>
        <childnode refid="45" relation="include">
        </childnode>
        <childnode refid="27" relation="include">
        </childnode>
        <childnode refid="17" relation="include">
        </childnode>
        <childnode refid="43" relation="include">
        </childnode>
        <childnode refid="23" relation="include">
        </childnode>
        <childnode refid="33" relation="include">
        </childnode>
      </node>
      <node id="70">
        <label>script/verify_flags.h</label>
        <link refid="verify__flags_8h"/>
        <childnode refid="64" relation="include">
        </childnode>
        <childnode refid="9" relation="include">
        </childnode>
      </node>
      <node id="24">
        <label>serialize.h</label>
        <link refid="serialize_8h"/>
        <childnode refid="3" relation="include">
        </childnode>
        <childnode refid="25" relation="include">
        </childnode>
        <childnode refid="7" relation="include">
        </childnode>
        <childnode refid="18" relation="include">
        </childnode>
        <childnode refid="27" relation="include">
        </childnode>
        <childnode refid="19" relation="include">
        </childnode>
        <childnode refid="11" relation="include">
        </childnode>
        <childnode refid="9" relation="include">
        </childnode>
        <childnode refid="13" relation="include">
        </childnode>
        <childnode refid="29" relation="include">
        </childnode>
        <childnode refid="26" relation="include">
        </childnode>
        <childnode refid="30" relation="include">
        </childnode>
        <childnode refid="31" relation="include">
        </childnode>
        <childnode refid="32" relation="include">
        </childnode>
        <childnode refid="17" relation="include">
        </childnode>
        <childnode refid="23" relation="include">
        </childnode>
        <childnode refid="33" relation="include">
        </childnode>
      </node>
      <node id="27">
        <label>span.h</label>
        <link refid="span_8h"/>
        <childnode refid="20" relation="include">
        </childnode>
        <childnode refid="12" relation="include">
        </childnode>
        <childnode refid="28" relation="include">
        </childnode>
        <childnode refid="22" relation="include">
        </childnode>
        <childnode refid="23" relation="include">
        </childnode>
      </node>
      <node id="104">
        <label>streams.h</label>
        <link refid="streams_8h"/>
        <childnode refid="105" relation="include">
        </childnode>
        <childnode refid="24" relation="include">
        </childnode>
        <childnode refid="27" relation="include">
        </childnode>
        <childnode refid="115" relation="include">
        </childnode>
        <childnode refid="48" relation="include">
        </childnode>
        <childnode refid="116" relation="include">
        </childnode>
        <childnode refid="118" relation="include">
        </childnode>
        <childnode refid="119" relation="include">
        </childnode>
        <childnode refid="19" relation="include">
        </childnode>
        <childnode refid="20" relation="include">
        </childnode>
        <childnode refid="12" relation="include">
        </childnode>
        <childnode refid="9" relation="include">
        </childnode>
        <childnode refid="108" relation="include">
        </childnode>
        <childnode refid="13" relation="include">
        </childnode>
        <childnode refid="29" relation="include">
        </childnode>
        <childnode refid="26" relation="include">
        </childnode>
        <childnode refid="43" relation="include">
        </childnode>
        <childnode refid="17" relation="include">
        </childnode>
        <childnode refid="33" relation="include">
        </childnode>
      </node>
      <node id="79">
        <label>support/allocators/secure.h</label>
        <link refid="secure_8h"/>
        <childnode refid="80" relation="include">
        </childnode>
        <childnode refid="84" relation="include">
        </childnode>
        <childnode refid="31" relation="include">
        </childnode>
        <childnode refid="17" relation="include">
        </childnode>
      </node>
      <node id="115">
        <label>support/allocators/zeroafterfree.h</label>
        <link refid="zeroafterfree_8h"/>
        <childnode refid="84" relation="include">
        </childnode>
        <childnode refid="31" relation="include">
        </childnode>
        <childnode refid="33" relation="include">
        </childnode>
      </node>
      <node id="84">
        <label>support/cleanse.h</label>
        <link refid="cleanse_8h"/>
        <childnode refid="15" relation="include">
        </childnode>
      </node>
      <node id="80">
        <label>support/lockedpool.h</label>
        <link refid="lockedpool_8h"/>
        <childnode refid="12" relation="include">
        </childnode>
        <childnode refid="81" relation="include">
        </childnode>
        <childnode refid="30" relation="include">
        </childnode>
        <childnode refid="31" relation="include">
        </childnode>
        <childnode refid="82" relation="include">
        </childnode>
        <childnode refid="83" relation="include">
        </childnode>
      </node>
      <node id="86">
        <label>sync.h</label>
        <link refid="sync_8h"/>
        <childnode refid="87" relation="include">
        </childnode>
        <childnode refid="88" relation="include">
        </childnode>
        <childnode refid="20" relation="include">
        </childnode>
        <childnode refid="89" relation="include">
        </childnode>
        <childnode refid="82" relation="include">
        </childnode>
        <childnode refid="17" relation="include">
        </childnode>
        <childnode refid="90" relation="include">
        </childnode>
      </node>
      <node id="87">
        <label>threadsafety.h</label>
        <link refid="threadsafety_8h"/>
        <childnode refid="82" relation="include">
        </childnode>
      </node>
      <node id="96">
        <label>tinyformat.h</label>
        <link refid="tinyformat_8h"/>
        <childnode refid="19" relation="include">
        </childnode>
        <childnode refid="3" relation="include">
        </childnode>
        <childnode refid="97" relation="include">
        </childnode>
        <childnode refid="40" relation="include">
        </childnode>
        <childnode refid="47" relation="include">
        </childnode>
        <childnode refid="37" relation="include">
        </childnode>
        <childnode refid="20" relation="include">
        </childnode>
      </node>
      <node id="34">
        <label>uint256.h</label>
        <link refid="uint256_8h"/>
        <childnode refid="6" relation="include">
        </childnode>
        <childnode refid="27" relation="include">
        </childnode>
        <childnode refid="35" relation="include">
        </childnode>
        <childnode refid="37" relation="include">
        </childnode>
        <childnode refid="19" relation="include">
        </childnode>
        <childnode refid="38" relation="include">
        </childnode>
        <childnode refid="20" relation="include">
        </childnode>
        <childnode refid="9" relation="include">
        </childnode>
        <childnode refid="13" relation="include">
        </childnode>
        <childnode refid="43" relation="include">
        </childnode>
        <childnode refid="17" relation="include">
        </childnode>
        <childnode refid="41" relation="include">
        </childnode>
      </node>
      <node id="48">
        <label>util/check.h</label>
        <link refid="check_8h"/>
        <childnode refid="3" relation="include">
        </childnode>
        <childnode refid="49" relation="include">
        </childnode>
        <childnode refid="20" relation="include">
        </childnode>
        <childnode refid="50" relation="include">
        </childnode>
        <childnode refid="47" relation="include">
        </childnode>
        <childnode refid="17" relation="include">
        </childnode>
        <childnode refid="41" relation="include">
        </childnode>
        <childnode refid="23" relation="include">
        </childnode>
      </node>
      <node id="72">
        <label>util/feefrac.h</label>
        <link refid="feefrac_8h"/>
        <childnode refid="27" relation="include">
        </childnode>
        <childnode refid="48" relation="include">
        </childnode>
        <childnode refid="64" relation="include">
        </childnode>
        <childnode refid="9" relation="include">
        </childnode>
        <childnode refid="33" relation="include">
        </childnode>
      </node>
      <node id="107">
        <label>util/fs.h</label>
        <link refid="fs_8h"/>
        <childnode refid="96" relation="include">
        </childnode>
        <childnode refid="108" relation="include">
        </childnode>
        <childnode refid="109" relation="include">
        </childnode>
        <childnode refid="91" relation="include">
        </childnode>
        <childnode refid="110" relation="include">
        </childnode>
        <childnode refid="29" relation="include">
        </childnode>
        <childnode refid="111" relation="include">
        </childnode>
        <childnode refid="17" relation="include">
        </childnode>
        <childnode refid="41" relation="include">
        </childnode>
        <childnode refid="44" relation="include">
        </childnode>
        <childnode refid="22" relation="include">
        </childnode>
        <childnode refid="23" relation="include">
        </childnode>
      </node>
      <node id="46">
        <label>util/hash_type.h</label>
        <link refid="hash__type_8h"/>
      </node>
      <node id="88">
        <label>util/macros.h</label>
        <link refid="macros_8h"/>
      </node>
      <node id="116">
        <label>util/obfuscation.h</label>
        <link refid="obfuscation_8h"/>
        <childnode refid="9" relation="include">
        </childnode>
        <childnode refid="27" relation="include">
        </childnode>
        <childnode refid="96" relation="include">
        </childnode>
        <childnode refid="35" relation="include">
        </childnode>
        <childnode refid="38" relation="include">
        </childnode>
        <childnode refid="10" relation="include">
        </childnode>
        <childnode refid="117" relation="include">
        </childnode>
        <childnode refid="29" relation="include">
        </childnode>
        <childnode refid="31" relation="include">
        </childnode>
      </node>
      <node id="118">
        <label>util/overflow.h</label>
        <link refid="overflow_8h"/>
        <childnode refid="117" relation="include">
        </childnode>
        <childnode refid="11" relation="include">
        </childnode>
        <childnode refid="26" relation="include">
        </childnode>
        <childnode refid="43" relation="include">
        </childnode>
        <childnode refid="22" relation="include">
        </childnode>
      </node>
      <node id="94">
        <label>util/result.h</label>
        <link refid="result_8h"/>
        <childnode refid="3" relation="include">
        </childnode>
        <childnode refid="95" relation="include">
        </childnode>
        <childnode refid="51" relation="include">
        </childnode>
      </node>
      <node id="35">
        <label>util/strencodings.h</label>
        <link refid="strencodings_8h"/>
        <childnode refid="36" relation="include">
        </childnode>
        <childnode refid="27" relation="include">
        </childnode>
        <childnode refid="37" relation="include">
        </childnode>
        <childnode refid="38" relation="include">
        </childnode>
        <childnode refid="10" relation="include">
        </childnode>
        <childnode refid="42" relation="include">
        </childnode>
        <childnode refid="12" relation="include">
        </childnode>
        <childnode refid="9" relation="include">
        </childnode>
        <childnode refid="26" relation="include">
        </childnode>
        <childnode refid="43" relation="include">
        </childnode>
        <childnode refid="17" relation="include">
        </childnode>
        <childnode refid="41" relation="include">
        </childnode>
        <childnode refid="44" relation="include">
        </childnode>
        <childnode refid="22" relation="include">
        </childnode>
        <childnode refid="33" relation="include">
        </childnode>
      </node>
      <node id="37">
        <label>util/string.h</label>
        <link refid="string_8h"/>
        <childnode refid="27" relation="include">
        </childnode>
        <childnode refid="38" relation="include">
        </childnode>
        <childnode refid="9" relation="include">
        </childnode>
        <childnode refid="13" relation="include">
        </childnode>
        <childnode refid="39" relation="include">
        </childnode>
        <childnode refid="40" relation="include">
        </childnode>
        <childnode refid="17" relation="include">
        </childnode>
        <childnode refid="41" relation="include">
        </childnode>
        <childnode refid="33" relation="include">
        </childnode>
      </node>
      <node id="119">
        <label>util/syserror.h</label>
        <link refid="syserror_8h"/>
        <childnode refid="17" relation="include">
        </childnode>
      </node>
      <node id="112">
        <label>util/time.h</label>
        <link refid="util_2time_8h"/>
        <childnode refid="113" relation="include">
        </childnode>
        <childnode refid="9" relation="include">
        </childnode>
        <childnode refid="43" relation="include">
        </childnode>
        <childnode refid="17" relation="include">
        </childnode>
        <childnode refid="41" relation="include">
        </childnode>
      </node>
      <node id="95">
        <label>util/translation.h</label>
        <link refid="translation_8h"/>
        <childnode refid="96" relation="include">
        </childnode>
        <childnode refid="37" relation="include">
        </childnode>
        <childnode refid="20" relation="include">
        </childnode>
        <childnode refid="91" relation="include">
        </childnode>
        <childnode refid="17" relation="include">
        </childnode>
      </node>
      <node id="63">
        <label>util/types.h</label>
        <link refid="util_2types_8h"/>
      </node>
      <node id="98">
        <label>wallet/crypter.h</label>
        <link refid="crypter_8h"/>
        <childnode refid="24" relation="include">
        </childnode>
        <childnode refid="79" relation="include">
        </childnode>
        <childnode refid="77" relation="include">
        </childnode>
      </node>
      <node id="101">
        <label>wallet/db.h</label>
        <link refid="wallet_2db_8h"/>
        <childnode refid="102" relation="include">
        </childnode>
        <childnode refid="104" relation="include">
        </childnode>
        <childnode refid="79" relation="include">
        </childnode>
        <childnode refid="107" relation="include">
        </childnode>
        <childnode refid="49" relation="include">
        </childnode>
        <childnode refid="31" relation="include">
        </childnode>
        <childnode refid="43" relation="include">
        </childnode>
        <childnode refid="17" relation="include">
        </childnode>
      </node>
      <node id="1">
        <label>src/wallet/scriptpubkeyman.h</label>
        <link refid="scriptpubkeyman_8h"/>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="52" relation="include">
        </childnode>
        <childnode refid="53" relation="include">
        </childnode>
        <childnode refid="54" relation="include">
        </childnode>
        <childnode refid="55" relation="include">
        </childnode>
        <childnode refid="56" relation="include">
        </childnode>
        <childnode refid="57" relation="include">
        </childnode>
        <childnode refid="74" relation="include">
        </childnode>
        <childnode refid="75" relation="include">
        </childnode>
        <childnode refid="45" relation="include">
        </childnode>
        <childnode refid="77" relation="include">
        </childnode>
        <childnode refid="94" relation="include">
        </childnode>
        <childnode refid="73" relation="include">
        </childnode>
        <childnode refid="98" relation="include">
        </childnode>
        <childnode refid="99" relation="include">
        </childnode>
        <childnode refid="100" relation="include">
        </childnode>
        <childnode refid="120" relation="include">
        </childnode>
        <childnode refid="121" relation="include">
        </childnode>
        <childnode refid="91" relation="include">
        </childnode>
        <childnode refid="43" relation="include">
        </childnode>
        <childnode refid="83" relation="include">
        </childnode>
      </node>
      <node id="99">
        <label>wallet/types.h</label>
        <link refid="wallet_2types_8h"/>
        <childnode refid="22" relation="include">
        </childnode>
      </node>
      <node id="100">
        <label>wallet/walletdb.h</label>
        <link refid="walletdb_8h"/>
        <childnode refid="78" relation="include">
        </childnode>
        <childnode refid="62" relation="include">
        </childnode>
        <childnode refid="92" relation="include">
        </childnode>
        <childnode refid="101" relation="include">
        </childnode>
        <childnode refid="120" relation="include">
        </childnode>
        <childnode refid="9" relation="include">
        </childnode>
        <childnode refid="17" relation="include">
        </childnode>
        <childnode refid="33" relation="include">
        </childnode>
      </node>
      <node id="120">
        <label>wallet/walletutil.h</label>
        <link refid="walletutil_8h"/>
        <childnode refid="75" relation="include">
        </childnode>
        <childnode refid="107" relation="include">
        </childnode>
        <childnode refid="33" relation="include">
        </childnode>
      </node>
      <node id="19">
        <label>algorithm</label>
      </node>
      <node id="38">
        <label>array</label>
      </node>
      <node id="49">
        <label>atomic</label>
      </node>
      <node id="10">
        <label>bit</label>
      </node>
      <node id="103">
        <label>bitcoin-build-config.h</label>
      </node>
      <node id="121">
        <label>boost/signals2/signal.hpp</label>
      </node>
      <node id="20">
        <label>cassert</label>
      </node>
      <node id="42">
        <label>charconv</label>
      </node>
      <node id="113">
        <label>chrono</label>
      </node>
      <node id="117">
        <label>climits</label>
      </node>
      <node id="93">
        <label>coins.h</label>
      </node>
      <node id="64">
        <label>compare</label>
      </node>
      <node id="11">
        <label>concepts</label>
      </node>
      <node id="89">
        <label>condition_variable</label>
      </node>
      <node id="12">
        <label>cstddef</label>
      </node>
      <node id="9">
        <label>cstdint</label>
      </node>
      <node id="108">
        <label>cstdio</label>
      </node>
      <node id="15">
        <label>cstdlib</label>
      </node>
      <node id="13">
        <label>cstring</label>
      </node>
      <node id="109">
        <label>filesystem</label>
      </node>
      <node id="91">
        <label>functional</label>
      </node>
      <node id="68">
        <label>hash.h</label>
      </node>
      <node id="110">
        <label>iomanip</label>
      </node>
      <node id="29">
        <label>ios</label>
      </node>
      <node id="97">
        <label>iostream</label>
      </node>
      <node id="21">
        <label>iterator</label>
      </node>
      <node id="26">
        <label>limits</label>
      </node>
      <node id="81">
        <label>list</label>
      </node>
      <node id="39">
        <label>locale</label>
      </node>
      <node id="55">
        <label>logging.h</label>
      </node>
      <node id="30">
        <label>map</label>
      </node>
      <node id="31">
        <label>memory</label>
      </node>
      <node id="82">
        <label>mutex</label>
      </node>
      <node id="66">
        <label>numeric</label>
      </node>
      <node id="43">
        <label>optional</label>
      </node>
      <node id="111">
        <label>ostream</label>
      </node>
      <node id="74">
        <label>psbt.h</label>
      </node>
      <node id="32">
        <label>set</label>
      </node>
      <node id="50">
        <label>source_location</label>
      </node>
      <node id="28">
        <label>span</label>
      </node>
      <node id="40">
        <label>sstream</label>
      </node>
      <node id="47">
        <label>stdexcept</label>
      </node>
      <node id="17">
        <label>string</label>
      </node>
      <node id="41">
        <label>string_view</label>
      </node>
      <node id="44">
        <label>system_error</label>
      </node>
      <node id="90">
        <label>thread</label>
      </node>
      <node id="65">
        <label>tuple</label>
      </node>
      <node id="22">
        <label>type_traits</label>
      </node>
      <node id="83">
        <label>unordered_map</label>
      </node>
      <node id="114">
        <label>unordered_set</label>
      </node>
      <node id="73">
        <label>util/time.h</label>
      </node>
      <node id="23">
        <label>utility</label>
      </node>
      <node id="51">
        <label>variant</label>
      </node>
      <node id="33">
        <label>vector</label>
      </node>
    </incdepgraph>
    <invincdepgraph>
      <node id="9">
        <label>src/bench/coin_selection.cpp</label>
        <link refid="coin__selection_8cpp"/>
      </node>
      <node id="10">
        <label>src/bench/wallet_balance.cpp</label>
        <link refid="wallet__balance_8cpp"/>
      </node>
      <node id="33">
        <label>src/bench/wallet_create.cpp</label>
        <link refid="wallet__create_8cpp"/>
      </node>
      <node id="11">
        <label>src/bench/wallet_create_tx.cpp</label>
        <link refid="wallet__create__tx_8cpp"/>
      </node>
      <node id="12">
        <label>src/bench/wallet_ismine.cpp</label>
        <link refid="wallet__ismine_8cpp"/>
      </node>
      <node id="13">
        <label>src/bench/wallet_loading.cpp</label>
        <link refid="wallet__loading_8cpp"/>
      </node>
      <node id="14">
        <label>src/bench/wallet_migration.cpp</label>
        <link refid="wallet__migration_8cpp"/>
      </node>
      <node id="34">
        <label>src/qt/addresstablemodel.cpp</label>
        <link refid="addresstablemodel_8cpp"/>
      </node>
      <node id="35">
        <label>src/qt/coincontroldialog.cpp</label>
        <link refid="coincontroldialog_8cpp"/>
      </node>
      <node id="36">
        <label>src/qt/optionsmodel.cpp</label>
        <link refid="optionsmodel_8cpp"/>
      </node>
      <node id="37">
        <label>src/qt/paymentserver.cpp</label>
        <link refid="paymentserver_8cpp"/>
      </node>
      <node id="38">
        <label>src/qt/receivecoinsdialog.cpp</label>
        <link refid="receivecoinsdialog_8cpp"/>
      </node>
      <node id="39">
        <label>src/qt/sendcoinsdialog.cpp</label>
        <link refid="sendcoinsdialog_8cpp"/>
      </node>
      <node id="40">
        <label>src/qt/signverifymessagedialog.cpp</label>
        <link refid="signverifymessagedialog_8cpp"/>
      </node>
      <node id="15">
        <label>src/qt/test/addressbooktests.cpp</label>
        <link refid="addressbooktests_8cpp"/>
      </node>
      <node id="16">
        <label>src/qt/test/wallettests.cpp</label>
        <link refid="wallettests_8cpp"/>
      </node>
      <node id="41">
        <label>src/qt/walletcontroller.cpp</label>
        <link refid="walletcontroller_8cpp"/>
      </node>
      <node id="42">
        <label>src/qt/walletmodel.cpp</label>
        <link refid="walletmodel_8cpp"/>
      </node>
      <node id="17">
        <label>src/test/fuzz/util/wallet.h</label>
        <link refid="test_2fuzz_2util_2wallet_8h"/>
        <childnode refid="18" relation="include">
        </childnode>
      </node>
      <node id="43">
        <label>src/wallet/dump.cpp</label>
        <link refid="dump_8cpp"/>
      </node>
      <node id="3">
        <label>src/wallet/external_signer_scriptpubkeyman.cpp</label>
        <link refid="external__signer__scriptpubkeyman_8cpp"/>
      </node>
      <node id="2">
        <label>src/wallet/external_signer_scriptpubkeyman.h</label>
        <link refid="external__signer__scriptpubkeyman_8h"/>
        <childnode refid="3" relation="include">
        </childnode>
        <childnode refid="4" relation="include">
        </childnode>
      </node>
      <node id="44">
        <label>src/wallet/feebumper.cpp</label>
        <link refid="feebumper_8cpp"/>
      </node>
      <node id="45">
        <label>src/wallet/fees.cpp</label>
        <link refid="wallet_2fees_8cpp"/>
      </node>
      <node id="46">
        <label>src/wallet/init.cpp</label>
        <link refid="wallet_2init_8cpp"/>
      </node>
      <node id="47">
        <label>src/wallet/interfaces.cpp</label>
        <link refid="wallet_2interfaces_8cpp"/>
      </node>
      <node id="48">
        <label>src/wallet/load.cpp</label>
        <link refid="load_8cpp"/>
      </node>
      <node id="49">
        <label>src/wallet/receive.cpp</label>
        <link refid="receive_8cpp"/>
      </node>
      <node id="50">
        <label>src/wallet/receive.h</label>
        <link refid="receive_8h"/>
        <childnode refid="10" relation="include">
        </childnode>
        <childnode refid="14" relation="include">
        </childnode>
        <childnode refid="44" relation="include">
        </childnode>
        <childnode refid="47" relation="include">
        </childnode>
        <childnode refid="49" relation="include">
        </childnode>
        <childnode refid="51" relation="include">
        </childnode>
        <childnode refid="52" relation="include">
        </childnode>
        <childnode refid="53" relation="include">
        </childnode>
        <childnode refid="54" relation="include">
        </childnode>
        <childnode refid="55" relation="include">
        </childnode>
        <childnode refid="29" relation="include">
        </childnode>
      </node>
      <node id="51">
        <label>src/wallet/rpc/addresses.cpp</label>
        <link refid="addresses_8cpp"/>
      </node>
      <node id="56">
        <label>src/wallet/rpc/backup.cpp</label>
        <link refid="backup_8cpp"/>
      </node>
      <node id="52">
        <label>src/wallet/rpc/coins.cpp</label>
        <link refid="wallet_2rpc_2coins_8cpp"/>
      </node>
      <node id="57">
        <label>src/wallet/rpc/encrypt.cpp</label>
        <link refid="encrypt_8cpp"/>
      </node>
      <node id="58">
        <label>src/wallet/rpc/signmessage.cpp</label>
        <link refid="wallet_2rpc_2signmessage_8cpp"/>
      </node>
      <node id="59">
        <label>src/wallet/rpc/spend.cpp</label>
        <link refid="rpc_2spend_8cpp"/>
      </node>
      <node id="53">
        <label>src/wallet/rpc/transactions.cpp</label>
        <link refid="transactions_8cpp"/>
      </node>
      <node id="60">
        <label>src/wallet/rpc/util.cpp</label>
        <link refid="wallet_2rpc_2util_8cpp"/>
      </node>
      <node id="61">
        <label>src/wallet/rpc/util.h</label>
        <link refid="wallet_2rpc_2util_8h"/>
        <childnode refid="51" relation="include">
        </childnode>
        <childnode refid="56" relation="include">
        </childnode>
        <childnode refid="52" relation="include">
        </childnode>
        <childnode refid="57" relation="include">
        </childnode>
        <childnode refid="58" relation="include">
        </childnode>
        <childnode refid="59" relation="include">
        </childnode>
        <childnode refid="53" relation="include">
        </childnode>
        <childnode refid="60" relation="include">
        </childnode>
        <childnode refid="54" relation="include">
        </childnode>
        <childnode refid="62" relation="include">
        </childnode>
      </node>
      <node id="54">
        <label>src/wallet/rpc/wallet.cpp</label>
        <link refid="rpc_2wallet_8cpp"/>
      </node>
      <node id="5">
        <label>src/wallet/scriptpubkeyman.cpp</label>
        <link refid="scriptpubkeyman_8cpp"/>
      </node>
      <node id="1">
        <label>src/wallet/scriptpubkeyman.h</label>
        <link refid="scriptpubkeyman_8h"/>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="6" relation="include">
        </childnode>
        <childnode refid="7" relation="include">
        </childnode>
        <childnode refid="8" relation="include">
        </childnode>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="32" relation="include">
        </childnode>
      </node>
      <node id="55">
        <label>src/wallet/spend.cpp</label>
        <link refid="spend_8cpp"/>
      </node>
      <node id="63">
        <label>src/wallet/spend.h</label>
        <link refid="spend_8h"/>
        <childnode refid="9" relation="include">
        </childnode>
        <childnode refid="11" relation="include">
        </childnode>
        <childnode refid="17" relation="include">
        </childnode>
        <childnode refid="44" relation="include">
        </childnode>
        <childnode refid="47" relation="include">
        </childnode>
        <childnode refid="48" relation="include">
        </childnode>
        <childnode refid="52" relation="include">
        </childnode>
        <childnode refid="59" relation="include">
        </childnode>
        <childnode refid="55" relation="include">
        </childnode>
        <childnode refid="19" relation="include">
        </childnode>
        <childnode refid="18" relation="include">
        </childnode>
        <childnode refid="24" relation="include">
        </childnode>
        <childnode refid="26" relation="include">
        </childnode>
        <childnode refid="29" relation="include">
        </childnode>
      </node>
      <node id="66">
        <label>src/wallet/test/coinselection_tests.cpp</label>
        <link refid="coinselection__tests_8cpp"/>
      </node>
      <node id="19">
        <label>src/wallet/test/coinselector_tests.cpp</label>
        <link refid="coinselector__tests_8cpp"/>
      </node>
      <node id="20">
        <label>src/wallet/test/db_tests.cpp</label>
        <link refid="db__tests_8cpp"/>
      </node>
      <node id="21">
        <label>src/wallet/test/feebumper_tests.cpp</label>
        <link refid="feebumper__tests_8cpp"/>
      </node>
      <node id="22">
        <label>src/wallet/test/fuzz/coincontrol.cpp</label>
        <link refid="test_2fuzz_2coincontrol_8cpp"/>
      </node>
      <node id="23">
        <label>src/wallet/test/fuzz/fees.cpp</label>
        <link refid="wallet_2test_2fuzz_2fees_8cpp"/>
      </node>
      <node id="6">
        <label>src/wallet/test/fuzz/scriptpubkeyman.cpp</label>
        <link refid="test_2fuzz_2scriptpubkeyman_8cpp"/>
      </node>
      <node id="18">
        <label>src/wallet/test/fuzz/spend.cpp</label>
        <link refid="test_2fuzz_2spend_8cpp"/>
      </node>
      <node id="24">
        <label>src/wallet/test/group_outputs_tests.cpp</label>
        <link refid="group__outputs__tests_8cpp"/>
      </node>
      <node id="25">
        <label>src/wallet/test/ismine_tests.cpp</label>
        <link refid="ismine__tests_8cpp"/>
      </node>
      <node id="64">
        <label>src/wallet/test/psbt_wallet_tests.cpp</label>
        <link refid="psbt__wallet__tests_8cpp"/>
      </node>
      <node id="7">
        <label>src/wallet/test/scriptpubkeyman_tests.cpp</label>
        <link refid="scriptpubkeyman__tests_8cpp"/>
      </node>
      <node id="26">
        <label>src/wallet/test/spend_tests.cpp</label>
        <link refid="spend__tests_8cpp"/>
      </node>
      <node id="27">
        <label>src/wallet/test/util.cpp</label>
        <link refid="wallet_2test_2util_8cpp"/>
      </node>
      <node id="8">
        <label>src/wallet/test/util.h</label>
        <link refid="wallet_2test_2util_8h"/>
        <childnode refid="9" relation="include">
        </childnode>
        <childnode refid="10" relation="include">
        </childnode>
        <childnode refid="11" relation="include">
        </childnode>
        <childnode refid="12" relation="include">
        </childnode>
        <childnode refid="13" relation="include">
        </childnode>
        <childnode refid="14" relation="include">
        </childnode>
        <childnode refid="15" relation="include">
        </childnode>
        <childnode refid="16" relation="include">
        </childnode>
        <childnode refid="17" relation="include">
        </childnode>
        <childnode refid="19" relation="include">
        </childnode>
        <childnode refid="20" relation="include">
        </childnode>
        <childnode refid="21" relation="include">
        </childnode>
        <childnode refid="22" relation="include">
        </childnode>
        <childnode refid="23" relation="include">
        </childnode>
        <childnode refid="6" relation="include">
        </childnode>
        <childnode refid="18" relation="include">
        </childnode>
        <childnode refid="24" relation="include">
        </childnode>
        <childnode refid="25" relation="include">
        </childnode>
        <childnode refid="7" relation="include">
        </childnode>
        <childnode refid="26" relation="include">
        </childnode>
        <childnode refid="27" relation="include">
        </childnode>
        <childnode refid="28" relation="include">
        </childnode>
        <childnode refid="29" relation="include">
        </childnode>
        <childnode refid="30" relation="include">
        </childnode>
        <childnode refid="31" relation="include">
        </childnode>
      </node>
      <node id="62">
        <label>src/wallet/test/wallet_rpc_tests.cpp</label>
        <link refid="wallet__rpc__tests_8cpp"/>
      </node>
      <node id="28">
        <label>src/wallet/test/wallet_test_fixture.cpp</label>
        <link refid="wallet__test__fixture_8cpp"/>
      </node>
      <node id="65">
        <label>src/wallet/test/wallet_test_fixture.h</label>
        <link refid="wallet__test__fixture_8h"/>
        <childnode refid="66" relation="include">
        </childnode>
        <childnode refid="19" relation="include">
        </childnode>
        <childnode refid="21" relation="include">
        </childnode>
        <childnode refid="64" relation="include">
        </childnode>
        <childnode refid="26" relation="include">
        </childnode>
        <childnode refid="28" relation="include">
        </childnode>
        <childnode refid="29" relation="include">
        </childnode>
        <childnode refid="67" relation="include">
        </childnode>
      </node>
      <node id="29">
        <label>src/wallet/test/wallet_tests.cpp</label>
        <link refid="wallet__tests_8cpp"/>
      </node>
      <node id="67">
        <label>src/wallet/test/wallet_transaction_tests.cpp</label>
        <link refid="wallet__transaction__tests_8cpp"/>
      </node>
      <node id="30">
        <label>src/wallet/test/walletdb_tests.cpp</label>
        <link refid="walletdb__tests_8cpp"/>
      </node>
      <node id="31">
        <label>src/wallet/test/walletload_tests.cpp</label>
        <link refid="walletload__tests_8cpp"/>
      </node>
      <node id="4">
        <label>src/wallet/wallet.cpp</label>
        <link refid="wallet_8cpp"/>
      </node>
      <node id="32">
        <label>src/wallet/wallet.h</label>
        <link refid="wallet_2wallet_8h"/>
        <childnode refid="9" relation="include">
        </childnode>
        <childnode refid="10" relation="include">
        </childnode>
        <childnode refid="33" relation="include">
        </childnode>
        <childnode refid="11" relation="include">
        </childnode>
        <childnode refid="12" relation="include">
        </childnode>
        <childnode refid="13" relation="include">
        </childnode>
        <childnode refid="14" relation="include">
        </childnode>
        <childnode refid="34" relation="include">
        </childnode>
        <childnode refid="35" relation="include">
        </childnode>
        <childnode refid="36" relation="include">
        </childnode>
        <childnode refid="37" relation="include">
        </childnode>
        <childnode refid="38" relation="include">
        </childnode>
        <childnode refid="39" relation="include">
        </childnode>
        <childnode refid="40" relation="include">
        </childnode>
        <childnode refid="15" relation="include">
        </childnode>
        <childnode refid="16" relation="include">
        </childnode>
        <childnode refid="41" relation="include">
        </childnode>
        <childnode refid="42" relation="include">
        </childnode>
        <childnode refid="17" relation="include">
        </childnode>
        <childnode refid="43" relation="include">
        </childnode>
        <childnode refid="44" relation="include">
        </childnode>
        <childnode refid="45" relation="include">
        </childnode>
        <childnode refid="46" relation="include">
        </childnode>
        <childnode refid="47" relation="include">
        </childnode>
        <childnode refid="48" relation="include">
        </childnode>
        <childnode refid="49" relation="include">
        </childnode>
        <childnode refid="50" relation="include">
        </childnode>
        <childnode refid="51" relation="include">
        </childnode>
        <childnode refid="56" relation="include">
        </childnode>
        <childnode refid="52" relation="include">
        </childnode>
        <childnode refid="57" relation="include">
        </childnode>
        <childnode refid="58" relation="include">
        </childnode>
        <childnode refid="59" relation="include">
        </childnode>
        <childnode refid="53" relation="include">
        </childnode>
        <childnode refid="60" relation="include">
        </childnode>
        <childnode refid="61" relation="include">
        </childnode>
        <childnode refid="54" relation="include">
        </childnode>
        <childnode refid="55" relation="include">
        </childnode>
        <childnode refid="63" relation="include">
        </childnode>
        <childnode refid="19" relation="include">
        </childnode>
        <childnode refid="23" relation="include">
        </childnode>
        <childnode refid="6" relation="include">
        </childnode>
        <childnode refid="18" relation="include">
        </childnode>
        <childnode refid="24" relation="include">
        </childnode>
        <childnode refid="25" relation="include">
        </childnode>
        <childnode refid="64" relation="include">
        </childnode>
        <childnode refid="7" relation="include">
        </childnode>
        <childnode refid="27" relation="include">
        </childnode>
        <childnode refid="65" relation="include">
        </childnode>
        <childnode refid="29" relation="include">
        </childnode>
        <childnode refid="30" relation="include">
        </childnode>
        <childnode refid="31" relation="include">
        </childnode>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="68" relation="include">
        </childnode>
        <childnode refid="69" relation="include">
        </childnode>
      </node>
      <node id="68">
        <label>src/wallet/walletdb.cpp</label>
        <link refid="walletdb_8cpp"/>
      </node>
      <node id="69">
        <label>src/wallet/wallettool.cpp</label>
        <link refid="wallettool_8cpp"/>
      </node>
    </invincdepgraph>
    <innerclass refid="classwallet_1_1_wallet_storage" prot="public">wallet::WalletStorage</innerclass>
    <innerclass refid="structwallet_1_1_wallet_destination" prot="public">wallet::WalletDestination</innerclass>
    <innerclass refid="classwallet_1_1_script_pub_key_man" prot="public">wallet::ScriptPubKeyMan</innerclass>
    <innerclass refid="classwallet_1_1_legacy_data_s_p_k_m" prot="public">wallet::LegacyDataSPKM</innerclass>
    <innerclass refid="classwallet_1_1_legacy_signing_provider" prot="public">wallet::LegacySigningProvider</innerclass>
    <innerclass refid="classwallet_1_1_descriptor_script_pub_key_man" prot="public">wallet::DescriptorScriptPubKeyMan</innerclass>
    <innerclass refid="structwallet_1_1_migration_data" prot="public">wallet::MigrationData</innerclass>
    <innernamespace refid="namespacewallet">wallet</innernamespace>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="comment">//<sp/>Copyright<sp/>(c)<sp/>2019-present<sp/>The<sp/>Bitcoin<sp/>Core<sp/>developers</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Distributed<sp/>under<sp/>the<sp/>MIT<sp/>software<sp/>license,<sp/>see<sp/>the<sp/>accompanying</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3"><highlight class="normal"></highlight><highlight class="comment">//<sp/>file<sp/>COPYING<sp/>or<sp/>http://www.opensource.org/licenses/mit-license.php.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4"><highlight class="normal"></highlight></codeline>
<codeline lineno="5"><highlight class="normal"></highlight><highlight class="preprocessor">#ifndef<sp/>BITCOIN_WALLET_SCRIPTPUBKEYMAN_H</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>BITCOIN_WALLET_SCRIPTPUBKEYMAN_H</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7"><highlight class="normal"></highlight></codeline>
<codeline lineno="8"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;<ref refid="addresstype_8h" kindref="compound">addresstype.h</ref>&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="9"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;<ref refid="messages_8h" kindref="compound">common/messages.h</ref>&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="10"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;<ref refid="signmessage_8h" kindref="compound">common/signmessage.h</ref>&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="11"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;<ref refid="common_2types_8h" kindref="compound">common/types.h</ref>&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="12"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;logging.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="13"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;<ref refid="musig_8h" kindref="compound">musig.h</ref>&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="14"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;<ref refid="node_2types_8h" kindref="compound">node/types.h</ref>&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="15"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;psbt.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="16"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;<ref refid="script_2descriptor_8h" kindref="compound">script/descriptor.h</ref>&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="17"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;<ref refid="script_2script_8h" kindref="compound">script/script.h</ref>&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="18"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;<ref refid="signingprovider_8h" kindref="compound">script/signingprovider.h</ref>&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="19"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;<ref refid="result_8h" kindref="compound">util/result.h</ref>&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="20"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;util/time.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="21"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;<ref refid="crypter_8h" kindref="compound">wallet/crypter.h</ref>&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="22"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;<ref refid="wallet_2types_8h" kindref="compound">wallet/types.h</ref>&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="23"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;<ref refid="walletdb_8h" kindref="compound">wallet/walletdb.h</ref>&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="24"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;<ref refid="walletutil_8h" kindref="compound">wallet/walletutil.h</ref>&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="25"><highlight class="normal"></highlight></codeline>
<codeline lineno="26"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;boost/signals2/signal.hpp&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="27"><highlight class="normal"></highlight></codeline>
<codeline lineno="28"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;functional&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="29"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;optional&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="30"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;unordered_map&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="31"><highlight class="normal"></highlight></codeline>
<codeline lineno="32"><highlight class="normal"></highlight><highlight class="keyword">enum<sp/>class</highlight><highlight class="normal"><sp/><ref refid="outputtype_8h_1a4e0517338e6c4a31a2addafc06d4f3a3" kindref="member">OutputType</ref>;</highlight></codeline>
<codeline lineno="33"><highlight class="normal"></highlight></codeline>
<codeline lineno="34"><highlight class="normal"></highlight><highlight class="keyword">namespace<sp/></highlight><highlight class="normal"><ref refid="namespacewallet" kindref="compound">wallet</ref><sp/>{</highlight></codeline>
<codeline lineno="35"><highlight class="normal"></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="structwallet_1_1_migration_data" kindref="compound">MigrationData</ref>;</highlight></codeline>
<codeline lineno="36"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classwallet_1_1_script_pub_key_man" kindref="compound">ScriptPubKeyMan</ref>;</highlight></codeline>
<codeline lineno="37"><highlight class="normal"></highlight></codeline>
<codeline lineno="38"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Wallet<sp/>storage<sp/>things<sp/>that<sp/>ScriptPubKeyMans<sp/>need<sp/>in<sp/>order<sp/>to<sp/>be<sp/>able<sp/>to<sp/>store<sp/>things<sp/>to<sp/>the<sp/>wallet<sp/>database.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="39"><highlight class="normal"></highlight><highlight class="comment">//<sp/>It<sp/>provides<sp/>access<sp/>to<sp/>things<sp/>that<sp/>are<sp/>part<sp/>of<sp/>the<sp/>entire<sp/>wallet<sp/>and<sp/>not<sp/>specific<sp/>to<sp/>a<sp/>ScriptPubKeyMan<sp/>such<sp/>as</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="40"><highlight class="normal"></highlight><highlight class="comment">//<sp/>wallet<sp/>flags,<sp/>wallet<sp/>version,<sp/>encryption<sp/>keys,<sp/>encryption<sp/>status,<sp/>and<sp/>the<sp/>database<sp/>itself.<sp/>This<sp/>allows<sp/>a</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="41"><highlight class="normal"></highlight><highlight class="comment">//<sp/>ScriptPubKeyMan<sp/>to<sp/>have<sp/>callbacks<sp/>into<sp/>CWallet<sp/>without<sp/>causing<sp/>a<sp/>circular<sp/>dependency.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="42"><highlight class="normal"></highlight><highlight class="comment">//<sp/>WalletStorage<sp/>should<sp/>be<sp/>the<sp/>same<sp/>for<sp/>all<sp/>ScriptPubKeyMans<sp/>of<sp/>a<sp/>wallet.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="43" refid="classwallet_1_1_wallet_storage" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classwallet_1_1_wallet_storage" kindref="compound">WalletStorage</ref></highlight></codeline>
<codeline lineno="44"><highlight class="normal">{</highlight></codeline>
<codeline lineno="45"><highlight class="normal"></highlight><highlight class="keyword">public</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="46" refid="classwallet_1_1_wallet_storage_1ac06f5246a9b3fac86cafda6ea9613bb0" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">virtual</highlight><highlight class="normal"><sp/><ref refid="classwallet_1_1_wallet_storage_1ac06f5246a9b3fac86cafda6ea9613bb0" kindref="member">~WalletStorage</ref>()<sp/>=<sp/></highlight><highlight class="keywordflow">default</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="47" refid="classwallet_1_1_wallet_storage_1ad324bcc4895a73c0076895674a0961d4" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">virtual</highlight><highlight class="normal"><sp/>std::string<sp/><ref refid="classwallet_1_1_wallet_storage_1ad324bcc4895a73c0076895674a0961d4" kindref="member">LogName</ref>()<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="48" refid="classwallet_1_1_wallet_storage_1a3d655ffff7290e1454b42041b73595f2" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">virtual</highlight><highlight class="normal"><sp/><ref refid="classwallet_1_1_wallet_database" kindref="compound">WalletDatabase</ref>&amp;<sp/><ref refid="classwallet_1_1_wallet_storage_1a3d655ffff7290e1454b42041b73595f2" kindref="member">GetDatabase</ref>()<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="49" refid="classwallet_1_1_wallet_storage_1a39f5a481a5eacb57ca38b546a07261c9" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">virtual</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="classwallet_1_1_wallet_storage_1a39f5a481a5eacb57ca38b546a07261c9" kindref="member">IsWalletFlagSet</ref>(uint64_t)<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="50" refid="classwallet_1_1_wallet_storage_1a3d5bf05a522cdd0dae38bf4b00368df3" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">virtual</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classwallet_1_1_wallet_storage_1a3d5bf05a522cdd0dae38bf4b00368df3" kindref="member">UnsetBlankWalletFlag</ref>(<ref refid="classwallet_1_1_wallet_batch" kindref="compound">WalletBatch</ref>&amp;)<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="52" refid="classwallet_1_1_wallet_storage_1a9b8c7098575cc9f46dd4659567da323c" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">virtual</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="classwallet_1_1_wallet_storage_1a9b8c7098575cc9f46dd4659567da323c" kindref="member">WithEncryptionKey</ref>(std::function&lt;</highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="namespacewallet_1a64709c9a3acc8f5694515789a183ad7b" kindref="member">CKeyingMaterial</ref>&amp;)&gt;<sp/>cb)<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="53" refid="classwallet_1_1_wallet_storage_1a2b13770749ea5b14609b668e9ad49003" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">virtual</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="classwallet_1_1_wallet_storage_1a2b13770749ea5b14609b668e9ad49003" kindref="member">HasEncryptionKeys</ref>()<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="54" refid="classwallet_1_1_wallet_storage_1ae7bc78361f30bfda0286c8af11392f2d" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">virtual</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="classwallet_1_1_wallet_storage_1ae7bc78361f30bfda0286c8af11392f2d" kindref="member">IsLocked</ref>()<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="56" refid="classwallet_1_1_wallet_storage_1a66367c3f76bf794ccb5e1afd4562b4eb" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">virtual</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classwallet_1_1_wallet_storage_1a66367c3f76bf794ccb5e1afd4562b4eb" kindref="member">TopUpCallback</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>std::set&lt;CScript&gt;&amp;,<sp/><ref refid="classwallet_1_1_script_pub_key_man" kindref="compound">ScriptPubKeyMan</ref>*)<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="57"><highlight class="normal">};</highlight></codeline>
<codeline lineno="58"><highlight class="normal"></highlight></codeline>
<codeline lineno="60"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">constexpr</highlight><highlight class="normal"><sp/>int64_t<sp/>UNKNOWN_TIME<sp/>=<sp/>std::numeric_limits&lt;int64_t&gt;::max();</highlight></codeline>
<codeline lineno="61"><highlight class="normal"></highlight></codeline>
<codeline lineno="63"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>DEFAULT_KEYPOOL_SIZE<sp/>=<sp/>1000;</highlight></codeline>
<codeline lineno="64"><highlight class="normal"></highlight></codeline>
<codeline lineno="65" refid="namespacewallet_1a6e6195e0225e313e82634fb730d2164d" refkind="member"><highlight class="normal">std::vector&lt;CKeyID&gt;<sp/><ref refid="namespacewallet_1a6e6195e0225e313e82634fb730d2164d" kindref="member">GetAffectedKeys</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_c_script" kindref="compound">CScript</ref>&amp;<sp/>spk,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_signing_provider" kindref="compound">SigningProvider</ref>&amp;<sp/>provider);</highlight></codeline>
<codeline lineno="66"><highlight class="normal"></highlight></codeline>
<codeline lineno="67" refid="structwallet_1_1_wallet_destination" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="structwallet_1_1_wallet_destination" kindref="compound">WalletDestination</ref></highlight></codeline>
<codeline lineno="68"><highlight class="normal">{</highlight></codeline>
<codeline lineno="69" refid="structwallet_1_1_wallet_destination_1a317ed8564204078183db6783baff8973" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="addresstype_8h_1abf613dc5a753218ddc85df6ff269be12" kindref="member">CTxDestination</ref><sp/><ref refid="structwallet_1_1_wallet_destination_1a317ed8564204078183db6783baff8973" kindref="member">dest</ref>;</highlight></codeline>
<codeline lineno="70" refid="structwallet_1_1_wallet_destination_1ac83fc3379ca7265f3c20ffa9bcf5d4a3" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>std::optional&lt;bool&gt;<sp/><ref refid="structwallet_1_1_wallet_destination_1ac83fc3379ca7265f3c20ffa9bcf5d4a3" kindref="member">internal</ref>;</highlight></codeline>
<codeline lineno="71"><highlight class="normal">};</highlight></codeline>
<codeline lineno="72"><highlight class="normal"></highlight></codeline>
<codeline lineno="73"><highlight class="normal"></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="74"><highlight class="comment"><sp/>*<sp/>A<sp/>class<sp/>implementing<sp/>ScriptPubKeyMan<sp/>manages<sp/>some<sp/>(or<sp/>all)<sp/>scriptPubKeys<sp/>used<sp/>in<sp/>a<sp/>wallet.</highlight></codeline>
<codeline lineno="75"><highlight class="comment"><sp/>*<sp/>It<sp/>contains<sp/>the<sp/>scripts<sp/>and<sp/>keys<sp/>related<sp/>to<sp/>the<sp/>scriptPubKeys<sp/>it<sp/>manages.</highlight></codeline>
<codeline lineno="76"><highlight class="comment"><sp/>*<sp/>A<sp/>ScriptPubKeyMan<sp/>will<sp/>be<sp/>able<sp/>to<sp/>give<sp/>out<sp/>scriptPubKeys<sp/>to<sp/>be<sp/>used,<sp/>as<sp/>well<sp/>as<sp/>marking</highlight></codeline>
<codeline lineno="77"><highlight class="comment"><sp/>*<sp/>when<sp/>a<sp/>scriptPubKey<sp/>has<sp/>been<sp/>used.<sp/>It<sp/>also<sp/>handles<sp/>when<sp/>and<sp/>how<sp/>to<sp/>store<sp/>a<sp/>scriptPubKey</highlight></codeline>
<codeline lineno="78"><highlight class="comment"><sp/>*<sp/>and<sp/>its<sp/>related<sp/>scripts<sp/>and<sp/>keys,<sp/>including<sp/>encryption.</highlight></codeline>
<codeline lineno="79"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="80" refid="classwallet_1_1_script_pub_key_man" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classwallet_1_1_script_pub_key_man_1afe01a622dff90547d2f9b0f11d74968f" kindref="member">ScriptPubKeyMan</ref></highlight></codeline>
<codeline lineno="81"><highlight class="normal">{</highlight></codeline>
<codeline lineno="82"><highlight class="normal"></highlight><highlight class="keyword">protected</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="83" refid="classwallet_1_1_script_pub_key_man_1ac4a21736443c15ad56498832ce090e19" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classwallet_1_1_wallet_storage" kindref="compound">WalletStorage</ref>&amp;<sp/><ref refid="classwallet_1_1_script_pub_key_man_1ac4a21736443c15ad56498832ce090e19" kindref="member">m_storage</ref>;</highlight></codeline>
<codeline lineno="84"><highlight class="normal"></highlight></codeline>
<codeline lineno="85"><highlight class="normal"></highlight><highlight class="keyword">public</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="86" refid="classwallet_1_1_script_pub_key_man_1afe01a622dff90547d2f9b0f11d74968f" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">explicit</highlight><highlight class="normal"><sp/><ref refid="classwallet_1_1_script_pub_key_man_1afe01a622dff90547d2f9b0f11d74968f" kindref="member">ScriptPubKeyMan</ref>(<ref refid="classwallet_1_1_wallet_storage" kindref="compound">WalletStorage</ref>&amp;<sp/>storage)<sp/>:<sp/><ref refid="classwallet_1_1_script_pub_key_man_1ac4a21736443c15ad56498832ce090e19" kindref="member">m_storage</ref>(storage)<sp/>{}</highlight></codeline>
<codeline lineno="87" refid="classwallet_1_1_script_pub_key_man_1a4dc8c1c796df82845d0eba3b3fc85098" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">virtual</highlight><highlight class="normal"><sp/><ref refid="classwallet_1_1_script_pub_key_man_1a4dc8c1c796df82845d0eba3b3fc85098" kindref="member">~ScriptPubKeyMan</ref>()<sp/>=<sp/></highlight><highlight class="keywordflow">default</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="88" refid="classwallet_1_1_script_pub_key_man_1af8ac55386f75dd3d353757787e74c1ce" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">virtual</highlight><highlight class="normal"><sp/><ref refid="classutil_1_1_result" kindref="compound">util::Result&lt;CTxDestination&gt;</ref><sp/><ref refid="classwallet_1_1_script_pub_key_man_1af8ac55386f75dd3d353757787e74c1ce" kindref="member">GetNewDestination</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="outputtype_8h_1a4e0517338e6c4a31a2addafc06d4f3a3" kindref="member">OutputType</ref><sp/>type)<sp/>{<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="structutil_1_1_error" kindref="compound">util::Error</ref>{<ref refid="translation_8h_1adff31aba0266455557bf721860f481b8" kindref="member">Untranslated</ref>(</highlight><highlight class="stringliteral">&quot;Not<sp/>supported&quot;</highlight><highlight class="normal">)};<sp/>}</highlight></codeline>
<codeline lineno="89" refid="classwallet_1_1_script_pub_key_man_1ace31e444272c0add4bd94c44761f7ba0" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">virtual</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="classwallet_1_1_script_pub_key_man_1ace31e444272c0add4bd94c44761f7ba0" kindref="member">IsMine</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_c_script" kindref="compound">CScript</ref>&amp;<sp/><ref refid="namespacescript" kindref="compound">script</ref>)</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;<sp/>}</highlight></codeline>
<codeline lineno="90"><highlight class="normal"></highlight></codeline>
<codeline lineno="92" refid="classwallet_1_1_script_pub_key_man_1ac6d13c936a257d55f12a5560c1ae1987" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">virtual</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="classwallet_1_1_script_pub_key_man_1ac6d13c936a257d55f12a5560c1ae1987" kindref="member">CheckDecryptionKey</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="namespacewallet_1a64709c9a3acc8f5694515789a183ad7b" kindref="member">CKeyingMaterial</ref>&amp;<sp/>master_key)<sp/>{<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;<sp/>}</highlight></codeline>
<codeline lineno="93" refid="classwallet_1_1_script_pub_key_man_1ac52ee85751d421dc586831d35357c83e" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">virtual</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="classwallet_1_1_script_pub_key_man_1ac52ee85751d421dc586831d35357c83e" kindref="member">Encrypt</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="namespacewallet_1a64709c9a3acc8f5694515789a183ad7b" kindref="member">CKeyingMaterial</ref>&amp;<sp/>master_key,<sp/><ref refid="classwallet_1_1_wallet_batch" kindref="compound">WalletBatch</ref>*<sp/>batch)<sp/>{<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;<sp/>}</highlight></codeline>
<codeline lineno="94"><highlight class="normal"></highlight></codeline>
<codeline lineno="95" refid="classwallet_1_1_script_pub_key_man_1a430cbfac8428d10eb13806ff17118be9" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">virtual</highlight><highlight class="normal"><sp/><ref refid="classutil_1_1_result" kindref="compound">util::Result&lt;CTxDestination&gt;</ref><sp/><ref refid="classwallet_1_1_script_pub_key_man_1a430cbfac8428d10eb13806ff17118be9" kindref="member">GetReservedDestination</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="outputtype_8h_1a4e0517338e6c4a31a2addafc06d4f3a3" kindref="member">OutputType</ref><sp/>type,<sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>internal,<sp/>int64_t&amp;<sp/>index)<sp/>{<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="structutil_1_1_error" kindref="compound">util::Error</ref>{<ref refid="translation_8h_1adff31aba0266455557bf721860f481b8" kindref="member">Untranslated</ref>(</highlight><highlight class="stringliteral">&quot;Not<sp/>supported&quot;</highlight><highlight class="normal">)};<sp/>}</highlight></codeline>
<codeline lineno="96" refid="classwallet_1_1_script_pub_key_man_1a2c6affb18523a8f3d9505585185bf045" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">virtual</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classwallet_1_1_script_pub_key_man_1a2c6affb18523a8f3d9505585185bf045" kindref="member">KeepDestination</ref>(int64_t<sp/>index,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="outputtype_8h_1a4e0517338e6c4a31a2addafc06d4f3a3" kindref="member">OutputType</ref>&amp;<sp/>type)<sp/>{}</highlight></codeline>
<codeline lineno="97" refid="classwallet_1_1_script_pub_key_man_1a0b0edfe43d923d766e90ffa613323a30" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">virtual</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classwallet_1_1_script_pub_key_man_1a0b0edfe43d923d766e90ffa613323a30" kindref="member">ReturnDestination</ref>(int64_t<sp/>index,<sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>internal,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="addresstype_8h_1abf613dc5a753218ddc85df6ff269be12" kindref="member">CTxDestination</ref>&amp;<sp/>addr)<sp/>{}</highlight></codeline>
<codeline lineno="98"><highlight class="normal"></highlight></codeline>
<codeline lineno="103" refid="classwallet_1_1_script_pub_key_man_1aefacf9065a8a1bbedba70133a12c6e21" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">virtual</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="classwallet_1_1_script_pub_key_man_1aefacf9065a8a1bbedba70133a12c6e21" kindref="member">TopUp</ref>(</highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>size<sp/>=<sp/>0)<sp/>{<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;<sp/>}</highlight></codeline>
<codeline lineno="104"><highlight class="normal"></highlight></codeline>
<codeline lineno="112" refid="classwallet_1_1_script_pub_key_man_1a5c5b052c7b616b7880dfa0fe1a2e6c86" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">virtual</highlight><highlight class="normal"><sp/>std::vector&lt;WalletDestination&gt;<sp/><ref refid="classwallet_1_1_script_pub_key_man_1a5c5b052c7b616b7880dfa0fe1a2e6c86" kindref="member">MarkUnusedAddresses</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_c_script" kindref="compound">CScript</ref>&amp;<sp/><ref refid="namespacescript" kindref="compound">script</ref>)<sp/>{<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>{};<sp/>}</highlight></codeline>
<codeline lineno="113"><highlight class="normal"></highlight></codeline>
<codeline lineno="114"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Returns<sp/>true<sp/>if<sp/>HD<sp/>is<sp/>enabled<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="115" refid="classwallet_1_1_script_pub_key_man_1a192cce942a62d616153fbfb7eb32dc63" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">virtual</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="classwallet_1_1_script_pub_key_man_1a192cce942a62d616153fbfb7eb32dc63" kindref="member">IsHDEnabled</ref>()</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;<sp/>}</highlight></codeline>
<codeline lineno="116"><highlight class="normal"></highlight></codeline>
<codeline lineno="117"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Returns<sp/>true<sp/>if<sp/>the<sp/>wallet<sp/>can<sp/>give<sp/>out<sp/>new<sp/>addresses.<sp/>This<sp/>means<sp/>it<sp/>has<sp/>keys<sp/>in<sp/>the<sp/>keypool<sp/>or<sp/>can<sp/>generate<sp/>new<sp/>keys<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="118" refid="classwallet_1_1_script_pub_key_man_1a97c792ee32f77465742ea92d64da08e7" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">virtual</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="classwallet_1_1_script_pub_key_man_1a97c792ee32f77465742ea92d64da08e7" kindref="member">CanGetAddresses</ref>(</highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>internal<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">)</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;<sp/>}</highlight></codeline>
<codeline lineno="119"><highlight class="normal"></highlight></codeline>
<codeline lineno="120" refid="classwallet_1_1_script_pub_key_man_1a1476ab960626063771df7cd43ea42585" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">virtual</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="classwallet_1_1_script_pub_key_man_1a1476ab960626063771df7cd43ea42585" kindref="member">HavePrivateKeys</ref>()</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;<sp/>}</highlight></codeline>
<codeline lineno="121" refid="classwallet_1_1_script_pub_key_man_1ab31d9c2beb5760c4e7fe2b340565b167" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">virtual</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="classwallet_1_1_script_pub_key_man_1ab31d9c2beb5760c4e7fe2b340565b167" kindref="member">HaveCryptedKeys</ref>()</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;<sp/>}</highlight></codeline>
<codeline lineno="122"><highlight class="normal"></highlight></codeline>
<codeline lineno="124" refid="classwallet_1_1_script_pub_key_man_1ab437d7bea4222ff007dec29496e46e4a" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">virtual</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classwallet_1_1_script_pub_key_man_1ab437d7bea4222ff007dec29496e46e4a" kindref="member">RewriteDB</ref>()<sp/>{}</highlight></codeline>
<codeline lineno="125"><highlight class="normal"></highlight></codeline>
<codeline lineno="126" refid="classwallet_1_1_script_pub_key_man_1a7d236f7e3f4752b8d179c7c6d777109e" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">virtual</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="classwallet_1_1_script_pub_key_man_1a7d236f7e3f4752b8d179c7c6d777109e" kindref="member">GetKeyPoolSize</ref>()</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0;<sp/>}</highlight></codeline>
<codeline lineno="127"><highlight class="normal"></highlight></codeline>
<codeline lineno="128" refid="classwallet_1_1_script_pub_key_man_1a4680a0f3fff2af8499ba1f100ff553b0" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">virtual</highlight><highlight class="normal"><sp/>int64_t<sp/><ref refid="classwallet_1_1_script_pub_key_man_1a4680a0f3fff2af8499ba1f100ff553b0" kindref="member">GetTimeFirstKey</ref>()</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0;<sp/>}</highlight></codeline>
<codeline lineno="129"><highlight class="normal"></highlight></codeline>
<codeline lineno="130" refid="classwallet_1_1_script_pub_key_man_1a73307c0f97415aaeeef89250f8abc380" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">virtual</highlight><highlight class="normal"><sp/>std::unique_ptr&lt;CKeyMetadata&gt;<sp/><ref refid="classwallet_1_1_script_pub_key_man_1a73307c0f97415aaeeef89250f8abc380" kindref="member">GetMetadata</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="addresstype_8h_1abf613dc5a753218ddc85df6ff269be12" kindref="member">CTxDestination</ref>&amp;<sp/>dest)</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">nullptr</highlight><highlight class="normal">;<sp/>}</highlight></codeline>
<codeline lineno="131"><highlight class="normal"></highlight></codeline>
<codeline lineno="132" refid="classwallet_1_1_script_pub_key_man_1a2534aad5e3d342fd387b9a659d933ee0" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">virtual</highlight><highlight class="normal"><sp/>std::unique_ptr&lt;SigningProvider&gt;<sp/><ref refid="classwallet_1_1_script_pub_key_man_1a2534aad5e3d342fd387b9a659d933ee0" kindref="member">GetSolvingProvider</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_c_script" kindref="compound">CScript</ref>&amp;<sp/><ref refid="namespacescript" kindref="compound">script</ref>)</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">nullptr</highlight><highlight class="normal">;<sp/>}</highlight></codeline>
<codeline lineno="133"><highlight class="normal"></highlight></codeline>
<codeline lineno="137" refid="classwallet_1_1_script_pub_key_man_1a3944f5f86ba673b484082fef35a75ddb" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">virtual</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="classwallet_1_1_script_pub_key_man_1a3944f5f86ba673b484082fef35a75ddb" kindref="member">CanProvide</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_c_script" kindref="compound">CScript</ref>&amp;<sp/><ref refid="namespacescript" kindref="compound">script</ref>,<sp/><ref refid="struct_signature_data" kindref="compound">SignatureData</ref>&amp;<sp/>sigdata)<sp/>{<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;<sp/>}</highlight></codeline>
<codeline lineno="138"><highlight class="normal"></highlight></codeline>
<codeline lineno="140" refid="classwallet_1_1_script_pub_key_man_1a65d657c387c39d56df83db10ae076f66" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">virtual</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="classwallet_1_1_script_pub_key_man_1a65d657c387c39d56df83db10ae076f66" kindref="member">SignTransaction</ref>(<ref refid="struct_c_mutable_transaction" kindref="compound">CMutableTransaction</ref>&amp;<sp/>tx,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>std::map&lt;COutPoint,<sp/>Coin&gt;&amp;<sp/>coins,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>sighash,<sp/>std::map&lt;int,<sp/>bilingual_str&gt;&amp;<sp/>input_errors)</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;<sp/>}</highlight></codeline>
<codeline lineno="142" refid="classwallet_1_1_script_pub_key_man_1a07b95fa1f835ea7a90382556f88daf71" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">virtual</highlight><highlight class="normal"><sp/><ref refid="signmessage_8h_1a5f6c064c16999f3c857affb9e4b99a1e" kindref="member">SigningResult</ref><sp/><ref refid="classwallet_1_1_script_pub_key_man_1a07b95fa1f835ea7a90382556f88daf71" kindref="member">SignMessage</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>std::string&amp;<sp/>message,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="struct_p_k_hash" kindref="compound">PKHash</ref>&amp;<sp/>pkhash,<sp/>std::string&amp;<sp/>str_sig)</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="signmessage_8h_1a5f6c064c16999f3c857affb9e4b99a1ea5949069cd0ebd438f332cab590a1b073" kindref="member">SigningResult::SIGNING_FAILED</ref>;<sp/>};</highlight></codeline>
<codeline lineno="144" refid="classwallet_1_1_script_pub_key_man_1ac95b49c07214ecbe8101ba7229d3721b" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">virtual</highlight><highlight class="normal"><sp/>std::optional&lt;common::PSBTError&gt;<sp/><ref refid="classwallet_1_1_script_pub_key_man_1ac95b49c07214ecbe8101ba7229d3721b" kindref="member">FillPSBT</ref>(<ref refid="struct_partially_signed_transaction" kindref="compound">PartiallySignedTransaction</ref>&amp;<sp/>psbt,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="struct_precomputed_transaction_data" kindref="compound">PrecomputedTransactionData</ref>&amp;<sp/>txdata,<sp/>std::optional&lt;int&gt;<sp/>sighash_type<sp/>=<sp/>std::nullopt,<sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>sign<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">,<sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>bip32derivs<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal">*<sp/>n_signed<sp/>=<sp/></highlight><highlight class="keyword">nullptr</highlight><highlight class="normal">,<sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>finalize<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">)</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="namespacecommon_1a463d00d67d3e9d48d7a3dc0c6ee84d06a40aa75f8e8cfdf7b660c5620e953229f" kindref="member">common::PSBTError::UNSUPPORTED</ref>;<sp/>}</highlight></codeline>
<codeline lineno="145"><highlight class="normal"></highlight></codeline>
<codeline lineno="146" refid="classwallet_1_1_script_pub_key_man_1ac5969a450182fb29387e06e0fa49dcd6" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">virtual</highlight><highlight class="normal"><sp/><ref refid="classuint256" kindref="compound">uint256</ref><sp/><ref refid="classwallet_1_1_script_pub_key_man_1ac5969a450182fb29387e06e0fa49dcd6" kindref="member">GetID</ref>()</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classuint256" kindref="compound">uint256</ref>();<sp/>}</highlight></codeline>
<codeline lineno="147"><highlight class="normal"></highlight></codeline>
<codeline lineno="149" refid="classwallet_1_1_script_pub_key_man_1a171a49b06a5ad69d8e079fdf91013d08" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">virtual</highlight><highlight class="normal"><sp/>std::unordered_set&lt;CScript,<sp/>SaltedSipHasher&gt;<sp/><ref refid="classwallet_1_1_script_pub_key_man_1a171a49b06a5ad69d8e079fdf91013d08" kindref="member">GetScriptPubKeys</ref>()</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>{};<sp/>};</highlight></codeline>
<codeline lineno="150"><highlight class="normal"></highlight></codeline>
<codeline lineno="152"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">template</highlight><highlight class="normal"><sp/>&lt;</highlight><highlight class="keyword">typename</highlight><highlight class="normal">...<sp/><ref refid="chainparams_8cpp_1ad82533eea3b187c1ac5b7c54d8c6f121" kindref="member">Params</ref>&gt;</highlight></codeline>
<codeline lineno="153" refid="classwallet_1_1_script_pub_key_man_1ab231740b5fcabd8da3c6eda6cf1cfd06" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classwallet_1_1_script_pub_key_man_1ab231740b5fcabd8da3c6eda6cf1cfd06" kindref="member">WalletLogPrintf</ref>(<ref refid="structutil_1_1_consteval_format_string" kindref="compound">util::ConstevalFormatString</ref>&lt;</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">...(<ref refid="chainparams_8cpp_1ad82533eea3b187c1ac5b7c54d8c6f121" kindref="member">Params</ref>)&gt;<sp/>wallet_fmt,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="chainparams_8cpp_1ad82533eea3b187c1ac5b7c54d8c6f121" kindref="member">Params</ref>&amp;...<sp/>params)</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="154"><highlight class="keyword"><sp/><sp/><sp/><sp/></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="155"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="logging_8h_1a57eb3ffc98e6ad1bdbed0a980a54c484" kindref="member">LogInfo</ref>(</highlight><highlight class="stringliteral">&quot;[%s]<sp/>%s&quot;</highlight><highlight class="normal">,<sp/><ref refid="classwallet_1_1_script_pub_key_man_1ac4a21736443c15ad56498832ce090e19" kindref="member">m_storage</ref>.LogName(),<sp/><ref refid="namespacetinyformat_1a94e672659dfe070f7905299d1f170931" kindref="member">tfm::format</ref>(wallet_fmt,<sp/>params...));</highlight></codeline>
<codeline lineno="156"><highlight class="normal"><sp/><sp/><sp/><sp/>};</highlight></codeline>
<codeline lineno="157"><highlight class="normal"></highlight></codeline>
<codeline lineno="159" refid="classwallet_1_1_script_pub_key_man_1a909c982de74e0eb5c51f57b161ae6352" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>boost::signals2::signal&lt;void<sp/>()&gt;<sp/><ref refid="classwallet_1_1_script_pub_key_man_1a909c982de74e0eb5c51f57b161ae6352" kindref="member">NotifyCanGetAddressesChanged</ref>;</highlight></codeline>
<codeline lineno="160"><highlight class="normal"></highlight></codeline>
<codeline lineno="162" refid="classwallet_1_1_script_pub_key_man_1a9d82c74227d863f5df2aeba563bc1043" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>boost::signals2::signal&lt;void<sp/>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classwallet_1_1_script_pub_key_man_1afe01a622dff90547d2f9b0f11d74968f" kindref="member">ScriptPubKeyMan</ref>*<sp/>spkm,<sp/>int64_t<sp/>new_birth_time)&gt;<sp/><ref refid="classwallet_1_1_script_pub_key_man_1a9d82c74227d863f5df2aeba563bc1043" kindref="member">NotifyFirstKeyTimeChanged</ref>;</highlight></codeline>
<codeline lineno="163"><highlight class="normal">};</highlight></codeline>
<codeline lineno="164"><highlight class="normal"></highlight></codeline>
<codeline lineno="166"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>std::unordered_set&lt;OutputType&gt;<sp/>LEGACY_OUTPUT_TYPES<sp/>{</highlight></codeline>
<codeline lineno="167"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="outputtype_8h_1a4e0517338e6c4a31a2addafc06d4f3a3a456d016bd133625e5036aa9a556f2730" kindref="member">OutputType::LEGACY</ref>,</highlight></codeline>
<codeline lineno="168"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="outputtype_8h_1a4e0517338e6c4a31a2addafc06d4f3a3adca4c7228b48e4a611d32dc21a0e341a" kindref="member">OutputType::P2SH_SEGWIT</ref>,</highlight></codeline>
<codeline lineno="169"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="outputtype_8h_1a4e0517338e6c4a31a2addafc06d4f3a3ad4fd7223ebde09ed36b615658d29d7bc" kindref="member">OutputType::BECH32</ref>,</highlight></codeline>
<codeline lineno="170"><highlight class="normal">};</highlight></codeline>
<codeline lineno="171"><highlight class="normal"></highlight></codeline>
<codeline lineno="172"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Manages<sp/>the<sp/>data<sp/>for<sp/>a<sp/>LegacyScriptPubKeyMan.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="173"><highlight class="normal"></highlight><highlight class="comment">//<sp/>This<sp/>is<sp/>the<sp/>minimum<sp/>necessary<sp/>to<sp/>load<sp/>a<sp/>legacy<sp/>wallet<sp/>so<sp/>that<sp/>it<sp/>can<sp/>be<sp/>migrated.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="174" refid="classwallet_1_1_legacy_data_s_p_k_m" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classwallet_1_1_legacy_data_s_p_k_m" kindref="compound">LegacyDataSPKM</ref><sp/>:<sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/><ref refid="classwallet_1_1_legacy_data_s_p_k_m_1afe01a622dff90547d2f9b0f11d74968f" kindref="member">ScriptPubKeyMan</ref>,<sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/><ref refid="class_fillable_signing_provider" kindref="compound">FillableSigningProvider</ref></highlight></codeline>
<codeline lineno="175"><highlight class="normal">{</highlight></codeline>
<codeline lineno="176"><highlight class="normal"></highlight><highlight class="keyword">private</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="177"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">using<sp/></highlight><highlight class="normal">WatchOnlySet<sp/>=<sp/>std::set&lt;CScript&gt;;</highlight></codeline>
<codeline lineno="178"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">using<sp/></highlight><highlight class="normal">WatchKeyMap<sp/>=<sp/>std::map&lt;CKeyID,<sp/>CPubKey&gt;;</highlight></codeline>
<codeline lineno="179"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">using<sp/></highlight><highlight class="normal">CryptedKeyMap<sp/>=<sp/>std::map&lt;CKeyID,<sp/>std::pair&lt;CPubKey,<sp/>std::vector&lt;unsigned<sp/>char&gt;&gt;&gt;;</highlight></codeline>
<codeline lineno="180"><highlight class="normal"></highlight></codeline>
<codeline lineno="181"><highlight class="normal"><sp/><sp/><sp/><sp/>CryptedKeyMap<sp/>mapCryptedKeys<sp/><ref refid="thread__annotations_8h_1a4bc26ad7e8bc853ad3f58a8a343c952e" kindref="member">GUARDED_BY</ref>(<ref refid="class_fillable_signing_provider_1a03bc5e9dccecd885e00eeefdad774c7f" kindref="member">cs_KeyStore</ref>);</highlight></codeline>
<codeline lineno="182"><highlight class="normal"><sp/><sp/><sp/><sp/>WatchOnlySet<sp/>setWatchOnly<sp/><ref refid="thread__annotations_8h_1a4bc26ad7e8bc853ad3f58a8a343c952e" kindref="member">GUARDED_BY</ref>(<ref refid="class_fillable_signing_provider_1a03bc5e9dccecd885e00eeefdad774c7f" kindref="member">cs_KeyStore</ref>);</highlight></codeline>
<codeline lineno="183"><highlight class="normal"><sp/><sp/><sp/><sp/>WatchKeyMap<sp/>mapWatchKeys<sp/><ref refid="thread__annotations_8h_1a4bc26ad7e8bc853ad3f58a8a343c952e" kindref="member">GUARDED_BY</ref>(<ref refid="class_fillable_signing_provider_1a03bc5e9dccecd885e00eeefdad774c7f" kindref="member">cs_KeyStore</ref>);</highlight></codeline>
<codeline lineno="184"><highlight class="normal"></highlight></codeline>
<codeline lineno="185"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>the<sp/>HD<sp/>chain<sp/>data<sp/>model<sp/>(external<sp/>chain<sp/>counters)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="186"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classwallet_1_1_c_h_d_chain" kindref="compound">CHDChain</ref><sp/>m_hd_chain;</highlight></codeline>
<codeline lineno="187"><highlight class="normal"><sp/><sp/><sp/><sp/>std::unordered_map&lt;CKeyID,<sp/>CHDChain,<sp/>SaltedSipHasher&gt;<sp/>m_inactive_hd_chains;</highlight></codeline>
<codeline lineno="188"><highlight class="normal"></highlight></codeline>
<codeline lineno="190"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>fDecryptionThoroughlyChecked<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="191"><highlight class="normal"></highlight></codeline>
<codeline lineno="192"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>AddWatchOnlyInMem(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_c_script" kindref="compound">CScript</ref><sp/>&amp;dest);</highlight></codeline>
<codeline lineno="193"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">virtual</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>AddKeyPubKeyInner(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_c_key" kindref="compound">CKey</ref>&amp;<sp/>key,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_c_pub_key" kindref="compound">CPubKey</ref><sp/>&amp;pubkey);</highlight></codeline>
<codeline lineno="194"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>AddCryptedKeyInner(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_c_pub_key" kindref="compound">CPubKey</ref><sp/>&amp;vchPubKey,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>std::vector&lt;unsigned<sp/>char&gt;<sp/>&amp;vchCryptedSecret);</highlight></codeline>
<codeline lineno="195"><highlight class="normal"></highlight></codeline>
<codeline lineno="196"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Helper<sp/>function<sp/>to<sp/>retrieve<sp/>a<sp/>conservative<sp/>superset<sp/>of<sp/>all<sp/>output<sp/>scripts<sp/>that<sp/>may<sp/>be<sp/>relevant<sp/>to<sp/>this<sp/>LegacyDataSPKM.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="197"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>It<sp/>may<sp/>include<sp/>scripts<sp/>that<sp/>are<sp/>invalid<sp/>or<sp/>not<sp/>actually<sp/>watched<sp/>by<sp/>this<sp/>LegacyDataSPKM.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="198"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Used<sp/>only<sp/>in<sp/>migration.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="199"><highlight class="normal"><sp/><sp/><sp/><sp/>std::unordered_set&lt;CScript,<sp/>SaltedSipHasher&gt;<sp/>GetCandidateScriptPubKeys()<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="200"><highlight class="normal"></highlight></codeline>
<codeline lineno="201"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>IsMine(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_c_script" kindref="compound">CScript</ref>&amp;<sp/><ref refid="namespacescript" kindref="compound">script</ref>)<sp/></highlight><highlight class="keyword">const<sp/>override</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="202"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>CanProvide(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_c_script" kindref="compound">CScript</ref>&amp;<sp/><ref refid="namespacescript" kindref="compound">script</ref>,<sp/><ref refid="struct_signature_data" kindref="compound">SignatureData</ref>&amp;<sp/>sigdata)<sp/></highlight><highlight class="keyword">override</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="203"><highlight class="normal"></highlight><highlight class="keyword">public</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="204"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">using<sp/></highlight><highlight class="normal"><ref refid="classwallet_1_1_script_pub_key_man_1afe01a622dff90547d2f9b0f11d74968f" kindref="member">ScriptPubKeyMan::ScriptPubKeyMan</ref>;</highlight></codeline>
<codeline lineno="205"><highlight class="normal"></highlight></codeline>
<codeline lineno="206"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Map<sp/>from<sp/>Key<sp/>ID<sp/>to<sp/>key<sp/>metadata.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="207" refid="classwallet_1_1_legacy_data_s_p_k_m_1ab2c180db432f2552d90d838092541e42" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>std::map&lt;CKeyID,<sp/>CKeyMetadata&gt;<sp/>mapKeyMetadata<sp/><ref refid="classwallet_1_1_legacy_data_s_p_k_m_1ab2c180db432f2552d90d838092541e42" kindref="member">GUARDED_BY</ref>(<ref refid="class_fillable_signing_provider_1a03bc5e9dccecd885e00eeefdad774c7f" kindref="member">cs_KeyStore</ref>);</highlight></codeline>
<codeline lineno="208"><highlight class="normal"></highlight></codeline>
<codeline lineno="209"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Map<sp/>from<sp/>Script<sp/>ID<sp/>to<sp/>key<sp/>metadata<sp/>(for<sp/>watch-only<sp/>keys).</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="210" refid="classwallet_1_1_legacy_data_s_p_k_m_1a0a176577091edfd6984b3f1501eeed9d" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>std::map&lt;CScriptID,<sp/>CKeyMetadata&gt;<sp/>m_script_metadata<sp/><ref refid="classwallet_1_1_legacy_data_s_p_k_m_1a0a176577091edfd6984b3f1501eeed9d" kindref="member">GUARDED_BY</ref>(<ref refid="class_fillable_signing_provider_1a03bc5e9dccecd885e00eeefdad774c7f" kindref="member">cs_KeyStore</ref>);</highlight></codeline>
<codeline lineno="211"><highlight class="normal"></highlight></codeline>
<codeline lineno="212"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>ScriptPubKeyMan<sp/>overrides</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="213"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="classwallet_1_1_legacy_data_s_p_k_m_1aff1ae69e02a3fb4746b7773ef7f6875a" kindref="member">CheckDecryptionKey</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="namespacewallet_1a64709c9a3acc8f5694515789a183ad7b" kindref="member">CKeyingMaterial</ref>&amp;<sp/>master_key)<sp/></highlight><highlight class="keyword">override</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="214"><highlight class="normal"><sp/><sp/><sp/><sp/>std::unordered_set&lt;CScript,<sp/>SaltedSipHasher&gt;<sp/><ref refid="classwallet_1_1_legacy_data_s_p_k_m_1acae3971be9f74320a4809532658ea30a" kindref="member">GetScriptPubKeys</ref>()<sp/></highlight><highlight class="keyword">const<sp/>override</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="215"><highlight class="normal"><sp/><sp/><sp/><sp/>std::unique_ptr&lt;SigningProvider&gt;<sp/><ref refid="classwallet_1_1_legacy_data_s_p_k_m_1ae942fc8344998297343ebae204e7f496" kindref="member">GetSolvingProvider</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_c_script" kindref="compound">CScript</ref>&amp;<sp/><ref refid="namespacescript" kindref="compound">script</ref>)<sp/></highlight><highlight class="keyword">const<sp/>override</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="216" refid="classwallet_1_1_legacy_data_s_p_k_m_1a9bb89235acfb364af1ce6452d41b8dce" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classuint256" kindref="compound">uint256</ref><sp/><ref refid="classwallet_1_1_legacy_data_s_p_k_m_1a9bb89235acfb364af1ce6452d41b8dce" kindref="member">GetID</ref>()</highlight><highlight class="keyword"><sp/>const<sp/>override<sp/></highlight><highlight class="normal">{<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classuint256_1afe31bf960eff93e9fbb93ae573acaef9" kindref="member">uint256::ONE</ref>;<sp/>}</highlight></codeline>
<codeline lineno="217"><highlight class="normal"></highlight></codeline>
<codeline lineno="218"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>FillableSigningProvider<sp/>overrides</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="219"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="classwallet_1_1_legacy_data_s_p_k_m_1a25aee14df3601a0cae72852121cfa80a" kindref="member">HaveKey</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_c_key_i_d" kindref="compound">CKeyID</ref><sp/>&amp;address)<sp/></highlight><highlight class="keyword">const<sp/>override</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="220"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="classwallet_1_1_legacy_data_s_p_k_m_1a255a187c6bac2bbed75fa7f9f605361b" kindref="member">GetKey</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_c_key_i_d" kindref="compound">CKeyID</ref><sp/>&amp;address,<sp/><ref refid="class_c_key" kindref="compound">CKey</ref>&amp;<sp/>keyOut)<sp/></highlight><highlight class="keyword">const<sp/>override</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="221"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="classwallet_1_1_legacy_data_s_p_k_m_1ac0baae1468399cc0d85d5ca777c15633" kindref="member">GetPubKey</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_c_key_i_d" kindref="compound">CKeyID</ref><sp/>&amp;address,<sp/><ref refid="class_c_pub_key" kindref="compound">CPubKey</ref>&amp;<sp/>vchPubKeyOut)<sp/></highlight><highlight class="keyword">const<sp/>override</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="222"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="classwallet_1_1_legacy_data_s_p_k_m_1a443ac821ab7054c5f8652e3dc30b5f0f" kindref="member">GetKeyOrigin</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_c_key_i_d" kindref="compound">CKeyID</ref>&amp;<sp/>keyid,<sp/><ref refid="struct_key_origin_info" kindref="compound">KeyOriginInfo</ref>&amp;<sp/>info)<sp/></highlight><highlight class="keyword">const<sp/>override</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="223"><highlight class="normal"></highlight></codeline>
<codeline lineno="225"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">virtual</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classwallet_1_1_legacy_data_s_p_k_m_1a818c6d0e90561007e9f3f07a89bc2422" kindref="member">LoadKeyMetadata</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_c_key_i_d" kindref="compound">CKeyID</ref>&amp;<sp/>keyID,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classwallet_1_1_c_key_metadata" kindref="compound">CKeyMetadata</ref><sp/>&amp;metadata);</highlight></codeline>
<codeline lineno="226"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">virtual</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classwallet_1_1_legacy_data_s_p_k_m_1a2c1c303e31d4f0c8982ef45741274c48" kindref="member">LoadScriptMetadata</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_c_script_i_d" kindref="compound">CScriptID</ref>&amp;<sp/>script_id,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classwallet_1_1_c_key_metadata" kindref="compound">CKeyMetadata</ref><sp/>&amp;metadata);</highlight></codeline>
<codeline lineno="227"><highlight class="normal"></highlight></codeline>
<codeline lineno="229"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="classwallet_1_1_legacy_data_s_p_k_m_1ad65d18f7079b96c0746346333416a176" kindref="member">LoadWatchOnly</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_c_script" kindref="compound">CScript</ref><sp/>&amp;dest);</highlight></codeline>
<codeline lineno="231"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="classwallet_1_1_legacy_data_s_p_k_m_1acb5d295a2d134a28e76d7a42abb8779d" kindref="member">HaveWatchOnly</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_c_script" kindref="compound">CScript</ref><sp/>&amp;dest)<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="233"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="classwallet_1_1_legacy_data_s_p_k_m_1a44d1df900e56c3ec97a7867905d88716" kindref="member">LoadKey</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_c_key" kindref="compound">CKey</ref>&amp;<sp/>key,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_c_pub_key" kindref="compound">CPubKey</ref><sp/>&amp;pubkey);</highlight></codeline>
<codeline lineno="235"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="classwallet_1_1_legacy_data_s_p_k_m_1a20fe5abbe92c5a7d12a1ec0bdcfaee7e" kindref="member">LoadCryptedKey</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_c_pub_key" kindref="compound">CPubKey</ref><sp/>&amp;vchPubKey,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>std::vector&lt;unsigned<sp/>char&gt;<sp/>&amp;vchCryptedSecret,<sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>checksum_valid);</highlight></codeline>
<codeline lineno="237"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="classwallet_1_1_legacy_data_s_p_k_m_1a6c92b666312e1336653363250e66cbbf" kindref="member">LoadCScript</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_c_script" kindref="compound">CScript</ref>&amp;<sp/>redeemScript);</highlight></codeline>
<codeline lineno="239"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classwallet_1_1_legacy_data_s_p_k_m_1a2e4b481012311c3aaf2953c355976a49" kindref="member">LoadHDChain</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classwallet_1_1_c_h_d_chain" kindref="compound">CHDChain</ref>&amp;<sp/>chain);</highlight></codeline>
<codeline lineno="240"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classwallet_1_1_legacy_data_s_p_k_m_1a77919e347d96b63033779cca4af4d860" kindref="member">AddInactiveHDChain</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classwallet_1_1_c_h_d_chain" kindref="compound">CHDChain</ref>&amp;<sp/>chain);</highlight></codeline>
<codeline lineno="241" refid="classwallet_1_1_legacy_data_s_p_k_m_1a3ee0805f81142cc75bbdf167a50f0ca5" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classwallet_1_1_c_h_d_chain" kindref="compound">CHDChain</ref>&amp;<sp/><ref refid="classwallet_1_1_legacy_data_s_p_k_m_1a3ee0805f81142cc75bbdf167a50f0ca5" kindref="member">GetHDChain</ref>()</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>m_hd_chain;<sp/>}</highlight></codeline>
<codeline lineno="242"><highlight class="normal"></highlight></codeline>
<codeline lineno="244"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="classwallet_1_1_legacy_data_s_p_k_m_1a2b5fc1f76ac9ca96789a31bdf22454cb" kindref="member">GetWatchPubKey</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_c_key_i_d" kindref="compound">CKeyID</ref><sp/>&amp;address,<sp/><ref refid="class_c_pub_key" kindref="compound">CPubKey</ref><sp/>&amp;pubkey_out)<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="245"><highlight class="normal"></highlight></codeline>
<codeline lineno="250"><highlight class="normal"><sp/><sp/><sp/><sp/>std::unordered_set&lt;CScript,<sp/>SaltedSipHasher&gt;<sp/><ref refid="classwallet_1_1_legacy_data_s_p_k_m_1ad9ee01d938ada8052527b37d891cdfcf" kindref="member">GetNotMineScriptPubKeys</ref>()<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="251"><highlight class="normal"></highlight></codeline>
<codeline lineno="254"><highlight class="normal"><sp/><sp/><sp/><sp/>std::optional&lt;MigrationData&gt;<sp/><ref refid="classwallet_1_1_legacy_data_s_p_k_m_1ac5f6bbe7b3f979e34e8fa1b83dfcddf4" kindref="member">MigrateToDescriptor</ref>();</highlight></codeline>
<codeline lineno="256"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="classwallet_1_1_legacy_data_s_p_k_m_1aab372ddde1ef74fcc95ee85088be4764" kindref="member">DeleteRecordsWithDB</ref>(<ref refid="classwallet_1_1_wallet_batch" kindref="compound">WalletBatch</ref>&amp;<sp/>batch);</highlight></codeline>
<codeline lineno="257"><highlight class="normal">};</highlight></codeline>
<codeline lineno="258"><highlight class="normal"></highlight></codeline>
<codeline lineno="260" refid="classwallet_1_1_legacy_signing_provider" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classwallet_1_1_legacy_signing_provider_1ab64749c93cb9c9a78edf4349ae39a041" kindref="member">LegacySigningProvider</ref><sp/>:<sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/><ref refid="class_signing_provider" kindref="compound">SigningProvider</ref></highlight></codeline>
<codeline lineno="261"><highlight class="normal">{</highlight></codeline>
<codeline lineno="262"><highlight class="normal"></highlight><highlight class="keyword">private</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="263"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classwallet_1_1_legacy_data_s_p_k_m" kindref="compound">LegacyDataSPKM</ref>&amp;<sp/>m_spk_man;</highlight></codeline>
<codeline lineno="264"><highlight class="normal"></highlight><highlight class="keyword">public</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="265" refid="classwallet_1_1_legacy_signing_provider_1ab64749c93cb9c9a78edf4349ae39a041" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">explicit</highlight><highlight class="normal"><sp/><ref refid="classwallet_1_1_legacy_signing_provider_1ab64749c93cb9c9a78edf4349ae39a041" kindref="member">LegacySigningProvider</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classwallet_1_1_legacy_data_s_p_k_m" kindref="compound">LegacyDataSPKM</ref>&amp;<sp/>spk_man)<sp/>:<sp/>m_spk_man(spk_man)<sp/>{}</highlight></codeline>
<codeline lineno="266"><highlight class="normal"></highlight></codeline>
<codeline lineno="267" refid="classwallet_1_1_legacy_signing_provider_1ab0fc47f2cf61a87d3ee6d118e9560dbb" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="classwallet_1_1_legacy_signing_provider_1ab0fc47f2cf61a87d3ee6d118e9560dbb" kindref="member">GetCScript</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_c_script_i_d" kindref="compound">CScriptID</ref><sp/>&amp;scriptid,<sp/><ref refid="class_c_script" kindref="compound">CScript</ref>&amp;<sp/><ref refid="namespacescript" kindref="compound">script</ref>)</highlight><highlight class="keyword"><sp/>const<sp/>override<sp/></highlight><highlight class="normal">{<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>m_spk_man.GetCScript(scriptid,<sp/><ref refid="namespacescript" kindref="compound">script</ref>);<sp/>}</highlight></codeline>
<codeline lineno="268" refid="classwallet_1_1_legacy_signing_provider_1af34cf5bb47b9be224e2cef0e1fa8aba2" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="classwallet_1_1_legacy_signing_provider_1af34cf5bb47b9be224e2cef0e1fa8aba2" kindref="member">HaveCScript</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_c_script_i_d" kindref="compound">CScriptID</ref><sp/>&amp;scriptid)</highlight><highlight class="keyword"><sp/>const<sp/>override<sp/></highlight><highlight class="normal">{<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>m_spk_man.HaveCScript(scriptid);<sp/>}</highlight></codeline>
<codeline lineno="269" refid="classwallet_1_1_legacy_signing_provider_1a8dded79fe6b083e9d86113aa568dedf4" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="classwallet_1_1_legacy_signing_provider_1a8dded79fe6b083e9d86113aa568dedf4" kindref="member">GetPubKey</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_c_key_i_d" kindref="compound">CKeyID</ref><sp/>&amp;address,<sp/><ref refid="class_c_pub_key" kindref="compound">CPubKey</ref>&amp;<sp/>pubkey)</highlight><highlight class="keyword"><sp/>const<sp/>override<sp/></highlight><highlight class="normal">{<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>m_spk_man.GetPubKey(address,<sp/>pubkey);<sp/>}</highlight></codeline>
<codeline lineno="270" refid="classwallet_1_1_legacy_signing_provider_1a0a8ae25cba768d006ed5f8bdf631b12f" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="classwallet_1_1_legacy_signing_provider_1a0a8ae25cba768d006ed5f8bdf631b12f" kindref="member">GetKey</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_c_key_i_d" kindref="compound">CKeyID</ref><sp/>&amp;address,<sp/><ref refid="class_c_key" kindref="compound">CKey</ref>&amp;<sp/>key)</highlight><highlight class="keyword"><sp/>const<sp/>override<sp/></highlight><highlight class="normal">{<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;<sp/>}</highlight></codeline>
<codeline lineno="271" refid="classwallet_1_1_legacy_signing_provider_1a25aee14df3601a0cae72852121cfa80a" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="classwallet_1_1_legacy_signing_provider_1a25aee14df3601a0cae72852121cfa80a" kindref="member">HaveKey</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_c_key_i_d" kindref="compound">CKeyID</ref><sp/>&amp;address)</highlight><highlight class="keyword"><sp/>const<sp/>override<sp/></highlight><highlight class="normal">{<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;<sp/>}</highlight></codeline>
<codeline lineno="272" refid="classwallet_1_1_legacy_signing_provider_1a443ac821ab7054c5f8652e3dc30b5f0f" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="classwallet_1_1_legacy_signing_provider_1a443ac821ab7054c5f8652e3dc30b5f0f" kindref="member">GetKeyOrigin</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_c_key_i_d" kindref="compound">CKeyID</ref>&amp;<sp/>keyid,<sp/><ref refid="struct_key_origin_info" kindref="compound">KeyOriginInfo</ref>&amp;<sp/>info)</highlight><highlight class="keyword"><sp/>const<sp/>override<sp/></highlight><highlight class="normal">{<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>m_spk_man.GetKeyOrigin(keyid,<sp/>info);<sp/>}</highlight></codeline>
<codeline lineno="273"><highlight class="normal">};</highlight></codeline>
<codeline lineno="274"><highlight class="normal"></highlight></codeline>
<codeline lineno="275" refid="classwallet_1_1_descriptor_script_pub_key_man" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classwallet_1_1_descriptor_script_pub_key_man_1ae341c513be603fa2e5a36258b2cfbdd0" kindref="member">DescriptorScriptPubKeyMan</ref><sp/>:<sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/><ref refid="classwallet_1_1_script_pub_key_man_1afe01a622dff90547d2f9b0f11d74968f" kindref="member">ScriptPubKeyMan</ref></highlight></codeline>
<codeline lineno="276"><highlight class="normal">{</highlight></codeline>
<codeline lineno="277" refid="classwallet_1_1_descriptor_script_pub_key_man_1a7e92fbfdbf54c466921dea5d26fdcc1b" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">friend</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classwallet_1_1_descriptor_script_pub_key_man_1a7e92fbfdbf54c466921dea5d26fdcc1b" kindref="member">LegacyDataSPKM</ref>;</highlight></codeline>
<codeline lineno="278"><highlight class="normal"></highlight><highlight class="keyword">private</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="279"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">using<sp/></highlight><highlight class="normal">ScriptPubKeyMap<sp/>=<sp/>std::map&lt;CScript,<sp/>int32_t&gt;;<sp/></highlight><highlight class="comment">//<sp/>Map<sp/>of<sp/>scripts<sp/>to<sp/>descriptor<sp/>range<sp/>index</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="280"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">using<sp/></highlight><highlight class="normal">PubKeyMap<sp/>=<sp/>std::map&lt;CPubKey,<sp/>int32_t&gt;;<sp/></highlight><highlight class="comment">//<sp/>Map<sp/>of<sp/>pubkeys<sp/>involved<sp/>in<sp/>scripts<sp/>to<sp/>descriptor<sp/>range<sp/>index</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="281"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">using<sp/></highlight><highlight class="normal">CryptedKeyMap<sp/>=<sp/>std::map&lt;CKeyID,<sp/>std::pair&lt;CPubKey,<sp/>std::vector&lt;unsigned<sp/>char&gt;&gt;&gt;;</highlight></codeline>
<codeline lineno="282"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">using<sp/></highlight><highlight class="normal">KeyMap<sp/>=<sp/>std::map&lt;CKeyID,<sp/>CKey&gt;;</highlight></codeline>
<codeline lineno="283"><highlight class="normal"></highlight></codeline>
<codeline lineno="284"><highlight class="normal"><sp/><sp/><sp/><sp/>ScriptPubKeyMap<sp/>m_map_script_pub_keys<sp/><ref refid="thread__annotations_8h_1a4bc26ad7e8bc853ad3f58a8a343c952e" kindref="member">GUARDED_BY</ref>(<ref refid="classwallet_1_1_descriptor_script_pub_key_man_1ad9c99f06638e62801616f7de3d48a64c" kindref="member">cs_desc_man</ref>);</highlight></codeline>
<codeline lineno="285"><highlight class="normal"><sp/><sp/><sp/><sp/>PubKeyMap<sp/>m_map_pubkeys<sp/><ref refid="thread__annotations_8h_1a4bc26ad7e8bc853ad3f58a8a343c952e" kindref="member">GUARDED_BY</ref>(<ref refid="classwallet_1_1_descriptor_script_pub_key_man_1ad9c99f06638e62801616f7de3d48a64c" kindref="member">cs_desc_man</ref>);</highlight></codeline>
<codeline lineno="286"><highlight class="normal"><sp/><sp/><sp/><sp/>int32_t<sp/>m_max_cached_index<sp/>=<sp/>-1;</highlight></codeline>
<codeline lineno="287"><highlight class="normal"></highlight></codeline>
<codeline lineno="288"><highlight class="normal"><sp/><sp/><sp/><sp/>KeyMap<sp/>m_map_keys<sp/><ref refid="thread__annotations_8h_1a4bc26ad7e8bc853ad3f58a8a343c952e" kindref="member">GUARDED_BY</ref>(<ref refid="classwallet_1_1_descriptor_script_pub_key_man_1ad9c99f06638e62801616f7de3d48a64c" kindref="member">cs_desc_man</ref>);</highlight></codeline>
<codeline lineno="289"><highlight class="normal"><sp/><sp/><sp/><sp/>CryptedKeyMap<sp/>m_map_crypted_keys<sp/><ref refid="thread__annotations_8h_1a4bc26ad7e8bc853ad3f58a8a343c952e" kindref="member">GUARDED_BY</ref>(<ref refid="classwallet_1_1_descriptor_script_pub_key_man_1ad9c99f06638e62801616f7de3d48a64c" kindref="member">cs_desc_man</ref>);</highlight></codeline>
<codeline lineno="290"><highlight class="normal"></highlight></codeline>
<codeline lineno="292"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>m_decryption_thoroughly_checked<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="293"><highlight class="normal"></highlight></codeline>
<codeline lineno="295"><highlight class="normal"><sp/><sp/><sp/><sp/>int64_t<sp/>m_keypool_size<sp/><ref refid="thread__annotations_8h_1a4bc26ad7e8bc853ad3f58a8a343c952e" kindref="member">GUARDED_BY</ref>(<ref refid="classwallet_1_1_descriptor_script_pub_key_man_1ad9c99f06638e62801616f7de3d48a64c" kindref="member">cs_desc_man</ref>){DEFAULT_KEYPOOL_SIZE};</highlight></codeline>
<codeline lineno="296"><highlight class="normal"></highlight></codeline>
<codeline lineno="308"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">mutable</highlight><highlight class="normal"><sp/>std::map&lt;uint256,<sp/>MuSig2SecNonce&gt;<sp/>m_musig2_secnonces;</highlight></codeline>
<codeline lineno="309"><highlight class="normal"></highlight></codeline>
<codeline lineno="310"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>AddDescriptorKeyWithDB(<ref refid="classwallet_1_1_wallet_batch" kindref="compound">WalletBatch</ref>&amp;<sp/>batch,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_c_key" kindref="compound">CKey</ref>&amp;<sp/>key,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_c_pub_key" kindref="compound">CPubKey</ref><sp/>&amp;pubkey)<sp/><ref refid="thread__annotations_8h_1a0e2e86b0f11d9778240b0a0b263047b1" kindref="member">EXCLUSIVE_LOCKS_REQUIRED</ref>(<ref refid="classwallet_1_1_descriptor_script_pub_key_man_1ad9c99f06638e62801616f7de3d48a64c" kindref="member">cs_desc_man</ref>);</highlight></codeline>
<codeline lineno="311"><highlight class="normal"></highlight></codeline>
<codeline lineno="312"><highlight class="normal"><sp/><sp/><sp/><sp/>KeyMap<sp/>GetKeys()<sp/>const<sp/><ref refid="thread__annotations_8h_1a0e2e86b0f11d9778240b0a0b263047b1" kindref="member">EXCLUSIVE_LOCKS_REQUIRED</ref>(<ref refid="classwallet_1_1_descriptor_script_pub_key_man_1ad9c99f06638e62801616f7de3d48a64c" kindref="member">cs_desc_man</ref>);</highlight></codeline>
<codeline lineno="313"><highlight class="normal"></highlight></codeline>
<codeline lineno="314"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Cached<sp/>FlatSigningProviders<sp/>to<sp/>avoid<sp/>regenerating<sp/>them<sp/>each<sp/>time<sp/>they<sp/>are<sp/>needed.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="315"><highlight class="normal"><sp/><sp/><sp/><sp/>mutable<sp/><ref refid="namespacestd" kindref="compound">std</ref>::map&lt;int32_t,<sp/><ref refid="struct_flat_signing_provider" kindref="compound">FlatSigningProvider</ref>&gt;<sp/>m_map_signing_providers;</highlight></codeline>
<codeline lineno="316"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Fetch<sp/>the<sp/>SigningProvider<sp/>for<sp/>the<sp/>given<sp/>script<sp/>and<sp/>optionally<sp/>include<sp/>private<sp/>keys</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="317"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="namespacestd" kindref="compound">std</ref>::unique_ptr&lt;<ref refid="struct_flat_signing_provider" kindref="compound">FlatSigningProvider</ref>&gt;<sp/>GetSigningProvider(const<sp/><ref refid="class_c_script" kindref="compound">CScript</ref>&amp;<sp/><ref refid="namespacescript" kindref="compound">script</ref>,<sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>include_private<sp/>=<sp/>false)<sp/>const;</highlight></codeline>
<codeline lineno="318"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Fetch<sp/>the<sp/>SigningProvider<sp/>for<sp/>a<sp/>given<sp/>index<sp/>and<sp/>optionally<sp/>include<sp/>private<sp/>keys.<sp/>Called<sp/>by<sp/>the<sp/>above<sp/>functions.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="319"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="namespacestd" kindref="compound">std</ref>::unique_ptr&lt;<ref refid="struct_flat_signing_provider" kindref="compound">FlatSigningProvider</ref>&gt;<sp/>GetSigningProvider(int32_t<sp/>index,<sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>include_private<sp/>=<sp/>false)<sp/>const<sp/><ref refid="thread__annotations_8h_1a0e2e86b0f11d9778240b0a0b263047b1" kindref="member">EXCLUSIVE_LOCKS_REQUIRED</ref>(<ref refid="classwallet_1_1_descriptor_script_pub_key_man_1ad9c99f06638e62801616f7de3d48a64c" kindref="member">cs_desc_man</ref>);</highlight></codeline>
<codeline lineno="320"><highlight class="normal"></highlight></codeline>
<codeline lineno="321"><highlight class="normal">protected:</highlight></codeline>
<codeline lineno="322" refid="classwallet_1_1_descriptor_script_pub_key_man_1afe6082ce1af01f65e3b4291244585a79" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classwallet_1_1_wallet_descriptor" kindref="compound">WalletDescriptor</ref><sp/>m_wallet_descriptor<sp/>GUARDED_BY(<ref refid="classwallet_1_1_descriptor_script_pub_key_man_1ad9c99f06638e62801616f7de3d48a64c" kindref="member">cs_desc_man</ref>);</highlight></codeline>
<codeline lineno="323"><highlight class="normal"></highlight></codeline>
<codeline lineno="325"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="classwallet_1_1_descriptor_script_pub_key_man_1a176aa3c34d315bcb434b2a57b28f442b" kindref="member">TopUpWithDB</ref>(<ref refid="classwallet_1_1_wallet_batch" kindref="compound">WalletBatch</ref>&amp;<sp/>batch,<sp/></highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>size<sp/>=<sp/>0);</highlight></codeline>
<codeline lineno="326"><highlight class="normal"></highlight></codeline>
<codeline lineno="327"><highlight class="normal">public:</highlight></codeline>
<codeline lineno="328" refid="classwallet_1_1_descriptor_script_pub_key_man_1ae341c513be603fa2e5a36258b2cfbdd0" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classwallet_1_1_descriptor_script_pub_key_man_1ae341c513be603fa2e5a36258b2cfbdd0" kindref="member">DescriptorScriptPubKeyMan</ref>(<ref refid="classwallet_1_1_wallet_storage" kindref="compound">WalletStorage</ref>&amp;<sp/>storage,<sp/><ref refid="classwallet_1_1_wallet_descriptor" kindref="compound">WalletDescriptor</ref>&amp;<sp/>descriptor,<sp/>int64_t<sp/>keypool_size)</highlight></codeline>
<codeline lineno="329"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:<sp/><sp/><sp/><ref refid="classwallet_1_1_script_pub_key_man_1afe01a622dff90547d2f9b0f11d74968f" kindref="member">ScriptPubKeyMan</ref>(storage),</highlight></codeline>
<codeline lineno="330"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m_keypool_size(keypool_size),</highlight></codeline>
<codeline lineno="331"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m_wallet_descriptor(descriptor)</highlight></codeline>
<codeline lineno="332"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{}</highlight></codeline>
<codeline lineno="333" refid="classwallet_1_1_descriptor_script_pub_key_man_1ab46d2ceaf696638645a68c9ef2eafa5b" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classwallet_1_1_descriptor_script_pub_key_man_1ab46d2ceaf696638645a68c9ef2eafa5b" kindref="member">DescriptorScriptPubKeyMan</ref>(<ref refid="classwallet_1_1_wallet_storage" kindref="compound">WalletStorage</ref>&amp;<sp/>storage,<sp/>int64_t<sp/>keypool_size)</highlight></codeline>
<codeline lineno="334"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:<sp/><sp/><sp/><ref refid="classwallet_1_1_script_pub_key_man_1afe01a622dff90547d2f9b0f11d74968f" kindref="member">ScriptPubKeyMan</ref>(storage),</highlight></codeline>
<codeline lineno="335"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m_keypool_size(keypool_size)</highlight></codeline>
<codeline lineno="336"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{}</highlight></codeline>
<codeline lineno="337"><highlight class="normal"></highlight></codeline>
<codeline lineno="338" refid="classwallet_1_1_descriptor_script_pub_key_man_1ad9c99f06638e62801616f7de3d48a64c" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">mutable</highlight><highlight class="normal"><sp/><ref refid="sync_8h_1a5d71768bc9626b7482055d56d4e2c533" kindref="member">RecursiveMutex</ref><sp/><ref refid="classwallet_1_1_descriptor_script_pub_key_man_1ad9c99f06638e62801616f7de3d48a64c" kindref="member">cs_desc_man</ref>;</highlight></codeline>
<codeline lineno="339"><highlight class="normal"></highlight></codeline>
<codeline lineno="340"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classutil_1_1_result" kindref="compound">util::Result&lt;CTxDestination&gt;</ref><sp/><ref refid="classwallet_1_1_descriptor_script_pub_key_man_1ae83f39f0787c5ff7ac70d9f4aca63652" kindref="member">GetNewDestination</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="outputtype_8h_1a4e0517338e6c4a31a2addafc06d4f3a3" kindref="member">OutputType</ref><sp/>type)<sp/></highlight><highlight class="keyword">override</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="341"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="classwallet_1_1_descriptor_script_pub_key_man_1a3790661aa0b6c5110fde4476a7f29cd0" kindref="member">IsMine</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_c_script" kindref="compound">CScript</ref>&amp;<sp/><ref refid="namespacescript" kindref="compound">script</ref>)<sp/></highlight><highlight class="keyword">const<sp/>override</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="342"><highlight class="normal"></highlight></codeline>
<codeline lineno="343"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="classwallet_1_1_descriptor_script_pub_key_man_1aff1ae69e02a3fb4746b7773ef7f6875a" kindref="member">CheckDecryptionKey</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="namespacewallet_1a64709c9a3acc8f5694515789a183ad7b" kindref="member">CKeyingMaterial</ref>&amp;<sp/>master_key)<sp/></highlight><highlight class="keyword">override</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="344"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="classwallet_1_1_descriptor_script_pub_key_man_1a97f47858921bce30b15f99daf778e9d7" kindref="member">Encrypt</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="namespacewallet_1a64709c9a3acc8f5694515789a183ad7b" kindref="member">CKeyingMaterial</ref>&amp;<sp/>master_key,<sp/><ref refid="classwallet_1_1_wallet_batch" kindref="compound">WalletBatch</ref>*<sp/>batch)<sp/></highlight><highlight class="keyword">override</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="345"><highlight class="normal"></highlight></codeline>
<codeline lineno="346"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classutil_1_1_result" kindref="compound">util::Result&lt;CTxDestination&gt;</ref><sp/><ref refid="classwallet_1_1_descriptor_script_pub_key_man_1a519d9d727f33b44dae4c03905b7c73f0" kindref="member">GetReservedDestination</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="outputtype_8h_1a4e0517338e6c4a31a2addafc06d4f3a3" kindref="member">OutputType</ref><sp/>type,<sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>internal,<sp/>int64_t&amp;<sp/>index)<sp/></highlight><highlight class="keyword">override</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="347"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classwallet_1_1_descriptor_script_pub_key_man_1afd49b62ac63f50d3ee3c6cac0a21c29b" kindref="member">ReturnDestination</ref>(int64_t<sp/>index,<sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>internal,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="addresstype_8h_1abf613dc5a753218ddc85df6ff269be12" kindref="member">CTxDestination</ref>&amp;<sp/>addr)<sp/></highlight><highlight class="keyword">override</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="348"><highlight class="normal"></highlight></codeline>
<codeline lineno="349"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Tops<sp/>up<sp/>the<sp/>descriptor<sp/>cache<sp/>and<sp/>m_map_script_pub_keys.<sp/>The<sp/>cache<sp/>is<sp/>stored<sp/>in<sp/>the<sp/>wallet<sp/>file</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="350"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>and<sp/>is<sp/>used<sp/>to<sp/>expand<sp/>the<sp/>descriptor<sp/>in<sp/>GetNewDestination.<sp/>DescriptorScriptPubKeyMan<sp/>relies</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="351"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>more<sp/>on<sp/>ephemeral<sp/>data<sp/>than<sp/>LegacyScriptPubKeyMan.<sp/>For<sp/>wallets<sp/>using<sp/>unhardened<sp/>derivation</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="352"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>(with<sp/>or<sp/>without<sp/>private<sp/>keys),<sp/>the<sp/>&quot;keypool&quot;<sp/>is<sp/>a<sp/>single<sp/>xpub.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="353"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="classwallet_1_1_descriptor_script_pub_key_man_1a13cabb9490bbf25ed8d9cc627618cf9d" kindref="member">TopUp</ref>(</highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>size<sp/>=<sp/>0)<sp/></highlight><highlight class="keyword">override</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="354"><highlight class="normal"></highlight></codeline>
<codeline lineno="355"><highlight class="normal"><sp/><sp/><sp/><sp/>std::vector&lt;WalletDestination&gt;<sp/><ref refid="classwallet_1_1_descriptor_script_pub_key_man_1ab33f26945a28cc8eb92de11a09ba3913" kindref="member">MarkUnusedAddresses</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_c_script" kindref="compound">CScript</ref>&amp;<sp/><ref refid="namespacescript" kindref="compound">script</ref>)<sp/></highlight><highlight class="keyword">override</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="356"><highlight class="normal"></highlight></codeline>
<codeline lineno="357"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="classwallet_1_1_descriptor_script_pub_key_man_1a4f8bd867013fccff13b4159fa3903e5c" kindref="member">IsHDEnabled</ref>()<sp/></highlight><highlight class="keyword">const<sp/>override</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="358"><highlight class="normal"></highlight></codeline>
<codeline lineno="360"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="classwallet_1_1_descriptor_script_pub_key_man_1a62cf46cfdec9b1119a5d6780c6a1d462" kindref="member">SetupDescriptorGeneration</ref>(<ref refid="classwallet_1_1_wallet_batch" kindref="compound">WalletBatch</ref>&amp;<sp/>batch,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="struct_c_ext_key" kindref="compound">CExtKey</ref>&amp;<sp/>master_key,<sp/><ref refid="outputtype_8h_1a4e0517338e6c4a31a2addafc06d4f3a3" kindref="member">OutputType</ref><sp/>addr_type,<sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>internal);</highlight></codeline>
<codeline lineno="361"><highlight class="normal"></highlight></codeline>
<codeline lineno="362"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="classwallet_1_1_descriptor_script_pub_key_man_1a199bbb843acd137f84585f37ccb18956" kindref="member">HavePrivateKeys</ref>()<sp/></highlight><highlight class="keyword">const<sp/>override</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="363"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="classwallet_1_1_descriptor_script_pub_key_man_1a34b7b0152195e0974232c1320e34c4ff" kindref="member">HasPrivKey</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_c_key_i_d" kindref="compound">CKeyID</ref>&amp;<sp/>keyid)<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="thread__annotations_8h_1a0e2e86b0f11d9778240b0a0b263047b1" kindref="member">EXCLUSIVE_LOCKS_REQUIRED</ref>(<ref refid="classwallet_1_1_descriptor_script_pub_key_man_1ad9c99f06638e62801616f7de3d48a64c" kindref="member">cs_desc_man</ref>);</highlight></codeline>
<codeline lineno="365"><highlight class="normal"><sp/><sp/><sp/><sp/>std::optional&lt;CKey&gt;<sp/><ref refid="classwallet_1_1_descriptor_script_pub_key_man_1aac3ad9f0dd9e84ac3f61b24aa067b246" kindref="member">GetKey</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_c_key_i_d" kindref="compound">CKeyID</ref>&amp;<sp/>keyid)<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="thread__annotations_8h_1a0e2e86b0f11d9778240b0a0b263047b1" kindref="member">EXCLUSIVE_LOCKS_REQUIRED</ref>(<ref refid="classwallet_1_1_descriptor_script_pub_key_man_1ad9c99f06638e62801616f7de3d48a64c" kindref="member">cs_desc_man</ref>);</highlight></codeline>
<codeline lineno="366"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="classwallet_1_1_descriptor_script_pub_key_man_1a23820976ac78f311ea3acff6df76d242" kindref="member">HaveCryptedKeys</ref>()<sp/></highlight><highlight class="keyword">const<sp/>override</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="367"><highlight class="normal"></highlight></codeline>
<codeline lineno="368"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="classwallet_1_1_descriptor_script_pub_key_man_1a6a4626bcf1eddc9dcd80c590368a5e33" kindref="member">GetKeyPoolSize</ref>()<sp/></highlight><highlight class="keyword">const<sp/>override</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="369"><highlight class="normal"></highlight></codeline>
<codeline lineno="370"><highlight class="normal"><sp/><sp/><sp/><sp/>int64_t<sp/><ref refid="classwallet_1_1_descriptor_script_pub_key_man_1acba36819e3f59482abd9f2243e672e9e" kindref="member">GetTimeFirstKey</ref>()<sp/></highlight><highlight class="keyword">const<sp/>override</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="371"><highlight class="normal"></highlight></codeline>
<codeline lineno="372"><highlight class="normal"><sp/><sp/><sp/><sp/>std::unique_ptr&lt;CKeyMetadata&gt;<sp/><ref refid="classwallet_1_1_descriptor_script_pub_key_man_1a6e637243839e104113b976c654d3ee62" kindref="member">GetMetadata</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="addresstype_8h_1abf613dc5a753218ddc85df6ff269be12" kindref="member">CTxDestination</ref>&amp;<sp/>dest)<sp/></highlight><highlight class="keyword">const<sp/>override</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="373"><highlight class="normal"></highlight></codeline>
<codeline lineno="374"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="classwallet_1_1_descriptor_script_pub_key_man_1afe3ef6e5f3a6d4262aecfe4c1d13c5fb" kindref="member">CanGetAddresses</ref>(</highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>internal<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">)<sp/></highlight><highlight class="keyword">const<sp/>override</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="375"><highlight class="normal"></highlight></codeline>
<codeline lineno="376"><highlight class="normal"><sp/><sp/><sp/><sp/>std::unique_ptr&lt;SigningProvider&gt;<sp/><ref refid="classwallet_1_1_descriptor_script_pub_key_man_1ae942fc8344998297343ebae204e7f496" kindref="member">GetSolvingProvider</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_c_script" kindref="compound">CScript</ref>&amp;<sp/><ref refid="namespacescript" kindref="compound">script</ref>)<sp/></highlight><highlight class="keyword">const<sp/>override</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="377"><highlight class="normal"></highlight></codeline>
<codeline lineno="378"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="classwallet_1_1_descriptor_script_pub_key_man_1a403dd1b4d652d425bb8d0f2ff52389e7" kindref="member">CanProvide</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_c_script" kindref="compound">CScript</ref>&amp;<sp/><ref refid="namespacescript" kindref="compound">script</ref>,<sp/><ref refid="struct_signature_data" kindref="compound">SignatureData</ref>&amp;<sp/>sigdata)<sp/></highlight><highlight class="keyword">override</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="379"><highlight class="normal"></highlight></codeline>
<codeline lineno="380"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Fetch<sp/>the<sp/>SigningProvider<sp/>for<sp/>the<sp/>given<sp/>pubkey<sp/>and<sp/>always<sp/>include<sp/>private<sp/>keys.<sp/>This<sp/>should<sp/>only<sp/>be<sp/>called<sp/>by<sp/>signing<sp/>code.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="381"><highlight class="normal"><sp/><sp/><sp/><sp/>std::unique_ptr&lt;FlatSigningProvider&gt;<sp/>GetSigningProvider(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_c_pub_key" kindref="compound">CPubKey</ref>&amp;<sp/>pubkey)<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="382"><highlight class="normal"></highlight></codeline>
<codeline lineno="383"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="classwallet_1_1_descriptor_script_pub_key_man_1a2c392d37195242545844c3c8009c3e76" kindref="member">SignTransaction</ref>(<ref refid="struct_c_mutable_transaction" kindref="compound">CMutableTransaction</ref>&amp;<sp/>tx,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>std::map&lt;COutPoint,<sp/>Coin&gt;&amp;<sp/>coins,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>sighash,<sp/>std::map&lt;int,<sp/>bilingual_str&gt;&amp;<sp/>input_errors)<sp/></highlight><highlight class="keyword">const<sp/>override</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="384"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="signmessage_8h_1a5f6c064c16999f3c857affb9e4b99a1e" kindref="member">SigningResult</ref><sp/><ref refid="classwallet_1_1_descriptor_script_pub_key_man_1a328d3f8111415068d28c86d833b5156b" kindref="member">SignMessage</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>std::string&amp;<sp/>message,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="struct_p_k_hash" kindref="compound">PKHash</ref>&amp;<sp/>pkhash,<sp/>std::string&amp;<sp/>str_sig)<sp/></highlight><highlight class="keyword">const<sp/>override</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="385"><highlight class="normal"><sp/><sp/><sp/><sp/>std::optional&lt;common::PSBTError&gt;<sp/><ref refid="classwallet_1_1_descriptor_script_pub_key_man_1a9acb2bdcd9c33be21fbde99eb195755e" kindref="member">FillPSBT</ref>(<ref refid="struct_partially_signed_transaction" kindref="compound">PartiallySignedTransaction</ref>&amp;<sp/>psbt,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="struct_precomputed_transaction_data" kindref="compound">PrecomputedTransactionData</ref>&amp;<sp/>txdata,<sp/>std::optional&lt;int&gt;<sp/>sighash_type<sp/>=<sp/>std::nullopt,<sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>sign<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">,<sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>bip32derivs<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal">*<sp/>n_signed<sp/>=<sp/></highlight><highlight class="keyword">nullptr</highlight><highlight class="normal">,<sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>finalize<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">)<sp/></highlight><highlight class="keyword">const<sp/>override</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="386"><highlight class="normal"></highlight></codeline>
<codeline lineno="387"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classuint256" kindref="compound">uint256</ref><sp/><ref refid="classwallet_1_1_descriptor_script_pub_key_man_1a9bb89235acfb364af1ce6452d41b8dce" kindref="member">GetID</ref>()<sp/></highlight><highlight class="keyword">const<sp/>override</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="388"><highlight class="normal"></highlight></codeline>
<codeline lineno="389"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classwallet_1_1_descriptor_script_pub_key_man_1ab8d01d03335af702cb6256f67a713e8c" kindref="member">SetCache</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_descriptor_cache" kindref="compound">DescriptorCache</ref>&amp;<sp/>cache);</highlight></codeline>
<codeline lineno="390"><highlight class="normal"></highlight></codeline>
<codeline lineno="391"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="classwallet_1_1_descriptor_script_pub_key_man_1aaff5037a8a8d0eab15011b3b0121fed6" kindref="member">AddKey</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_c_key_i_d" kindref="compound">CKeyID</ref>&amp;<sp/>key_id,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_c_key" kindref="compound">CKey</ref>&amp;<sp/>key);</highlight></codeline>
<codeline lineno="392"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="classwallet_1_1_descriptor_script_pub_key_man_1a2e4a39421c774381e4aa35cd1ddf4527" kindref="member">AddCryptedKey</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_c_key_i_d" kindref="compound">CKeyID</ref>&amp;<sp/>key_id,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_c_pub_key" kindref="compound">CPubKey</ref>&amp;<sp/>pubkey,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>std::vector&lt;unsigned<sp/>char&gt;&amp;<sp/>crypted_key);</highlight></codeline>
<codeline lineno="393"><highlight class="normal"></highlight></codeline>
<codeline lineno="394"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="classwallet_1_1_descriptor_script_pub_key_man_1a97916a15b69fffd61a9ce775a79b4e1b" kindref="member">HasWalletDescriptor</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classwallet_1_1_wallet_descriptor" kindref="compound">WalletDescriptor</ref>&amp;<sp/>desc)<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="395"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classutil_1_1_result" kindref="compound">util::Result&lt;void&gt;</ref><sp/><ref refid="classwallet_1_1_descriptor_script_pub_key_man_1a7e593f00fe614ca7aacff57503b13f3e" kindref="member">UpdateWalletDescriptor</ref>(<ref refid="classwallet_1_1_wallet_descriptor" kindref="compound">WalletDescriptor</ref>&amp;<sp/>descriptor);</highlight></codeline>
<codeline lineno="396"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="classwallet_1_1_descriptor_script_pub_key_man_1aa389a1038c0f76fb2ae91fa029e1cdcf" kindref="member">CanUpdateToWalletDescriptor</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classwallet_1_1_wallet_descriptor" kindref="compound">WalletDescriptor</ref>&amp;<sp/>descriptor,<sp/>std::string&amp;<sp/>error);</highlight></codeline>
<codeline lineno="397"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classwallet_1_1_descriptor_script_pub_key_man_1afc77be04e0aa0842b9033c3e2e23316f" kindref="member">AddDescriptorKey</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_c_key" kindref="compound">CKey</ref>&amp;<sp/>key,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_c_pub_key" kindref="compound">CPubKey</ref><sp/>&amp;pubkey);</highlight></codeline>
<codeline lineno="398"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classwallet_1_1_descriptor_script_pub_key_man_1ac6f1be4e404ae15058c834202d94c162" kindref="member">WriteDescriptor</ref>();</highlight></codeline>
<codeline lineno="399"><highlight class="normal"></highlight></codeline>
<codeline lineno="400"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classwallet_1_1_wallet_descriptor" kindref="compound">WalletDescriptor</ref><sp/><ref refid="classwallet_1_1_descriptor_script_pub_key_man_1a26ca930fc8900ab599d597dbc867046b" kindref="member">GetWalletDescriptor</ref>()<sp/>const<sp/><ref refid="thread__annotations_8h_1a0e2e86b0f11d9778240b0a0b263047b1" kindref="member">EXCLUSIVE_LOCKS_REQUIRED</ref>(<ref refid="classwallet_1_1_descriptor_script_pub_key_man_1ad9c99f06638e62801616f7de3d48a64c" kindref="member">cs_desc_man</ref>);</highlight></codeline>
<codeline lineno="401"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="namespacestd" kindref="compound">std</ref>::unordered_set&lt;<ref refid="class_c_script" kindref="compound">CScript</ref>,<sp/><ref refid="class_salted_sip_hasher" kindref="compound">SaltedSipHasher</ref>&gt;<sp/><ref refid="classwallet_1_1_descriptor_script_pub_key_man_1acae3971be9f74320a4809532658ea30a" kindref="member">GetScriptPubKeys</ref>()<sp/>const<sp/>override;</highlight></codeline>
<codeline lineno="402"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="namespacestd" kindref="compound">std</ref>::unordered_set&lt;<ref refid="class_c_script" kindref="compound">CScript</ref>,<sp/><ref refid="class_salted_sip_hasher" kindref="compound">SaltedSipHasher</ref>&gt;<sp/><ref refid="classwallet_1_1_descriptor_script_pub_key_man_1acae3971be9f74320a4809532658ea30a" kindref="member">GetScriptPubKeys</ref>(int32_t<sp/>minimum_index)<sp/>const;</highlight></codeline>
<codeline lineno="403"><highlight class="normal"><sp/><sp/><sp/><sp/>int32_t<sp/><ref refid="classwallet_1_1_descriptor_script_pub_key_man_1a0e6bbdbdedea16b9ede099a336772335" kindref="member">GetEndRange</ref>()<sp/>const;</highlight></codeline>
<codeline lineno="404"><highlight class="normal"></highlight></codeline>
<codeline lineno="405"><highlight class="normal"><sp/><sp/><sp/><sp/>[[nodiscard]]<sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="classwallet_1_1_descriptor_script_pub_key_man_1a5d31b95c8d0171b082f0bbe87be3c197" kindref="member">GetDescriptorString</ref>(<ref refid="namespacestd" kindref="compound">std</ref>::</highlight><highlight class="keywordtype">string</highlight><highlight class="normal">&amp;<sp/>out,<sp/>const<sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>priv)<sp/>const;</highlight></codeline>
<codeline lineno="406"><highlight class="normal"></highlight></codeline>
<codeline lineno="407"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classwallet_1_1_descriptor_script_pub_key_man_1ae5d92b03295e3a2208d5733168308481" kindref="member">UpgradeDescriptorCache</ref>();</highlight></codeline>
<codeline lineno="408"><highlight class="normal">};</highlight></codeline>
<codeline lineno="409"><highlight class="normal"></highlight></codeline>
<codeline lineno="411" refid="structwallet_1_1_migration_data" refkind="compound"><highlight class="normal">struct<sp/><ref refid="structwallet_1_1_migration_data" kindref="compound">MigrationData</ref></highlight></codeline>
<codeline lineno="412"><highlight class="normal">{</highlight></codeline>
<codeline lineno="413" refid="structwallet_1_1_migration_data_1ac064fed58fde64c3cfef849c64221e09" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_c_ext_key" kindref="compound">CExtKey</ref><sp/><ref refid="structwallet_1_1_migration_data_1ac064fed58fde64c3cfef849c64221e09" kindref="member">master_key</ref>;</highlight></codeline>
<codeline lineno="414" refid="structwallet_1_1_migration_data_1a117439f1253ad547fcad16e73ab4c401" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>std::vector&lt;std::pair&lt;std::string,<sp/>int64_t&gt;&gt;<sp/><ref refid="structwallet_1_1_migration_data_1a117439f1253ad547fcad16e73ab4c401" kindref="member">watch_descs</ref>;</highlight></codeline>
<codeline lineno="415" refid="structwallet_1_1_migration_data_1a76282a2dd7cfda436b1886787e54e02e" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>std::vector&lt;std::pair&lt;std::string,<sp/>int64_t&gt;&gt;<sp/><ref refid="structwallet_1_1_migration_data_1a76282a2dd7cfda436b1886787e54e02e" kindref="member">solvable_descs</ref>;</highlight></codeline>
<codeline lineno="416" refid="structwallet_1_1_migration_data_1aa7920864f6d125e013e7ec08b3192553" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>std::vector&lt;std::unique_ptr&lt;DescriptorScriptPubKeyMan&gt;&gt;<sp/><ref refid="structwallet_1_1_migration_data_1aa7920864f6d125e013e7ec08b3192553" kindref="member">desc_spkms</ref>;</highlight></codeline>
<codeline lineno="417" refid="structwallet_1_1_migration_data_1a76cdce260a3faf14dece8fb9ec6ddd3e" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>std::shared_ptr&lt;CWallet&gt;<sp/><ref refid="structwallet_1_1_migration_data_1a76cdce260a3faf14dece8fb9ec6ddd3e" kindref="member">watchonly_wallet</ref>{</highlight><highlight class="keyword">nullptr</highlight><highlight class="normal">};</highlight></codeline>
<codeline lineno="418" refid="structwallet_1_1_migration_data_1a0afd760c9181d4adc36db14841da739d" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>std::shared_ptr&lt;CWallet&gt;<sp/><ref refid="structwallet_1_1_migration_data_1a0afd760c9181d4adc36db14841da739d" kindref="member">solvable_wallet</ref>{</highlight><highlight class="keyword">nullptr</highlight><highlight class="normal">};</highlight></codeline>
<codeline lineno="419"><highlight class="normal">};</highlight></codeline>
<codeline lineno="420"><highlight class="normal"></highlight></codeline>
<codeline lineno="421"><highlight class="normal">}<sp/></highlight><highlight class="comment">//<sp/>namespace<sp/>wallet</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="422"><highlight class="normal"></highlight></codeline>
<codeline lineno="423"><highlight class="normal"></highlight><highlight class="preprocessor">#endif<sp/></highlight><highlight class="comment">//<sp/>BITCOIN_WALLET_SCRIPTPUBKEYMAN_H</highlight><highlight class="normal"></highlight></codeline>
    </programlisting>
    <location file="src/wallet/scriptpubkeyman.h"/>
  </compounddef>
</doxygen>
