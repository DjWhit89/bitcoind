<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.15.0" xml:lang="en-US">
  <compounddef id="class_taproot_builder" kind="class" language="C++" prot="public">
    <compoundname>TaprootBuilder</compoundname>
    <includes refid="signingprovider_8h" local="no">signingprovider.h</includes>
    <innerclass refid="struct_taproot_builder_1_1_leaf_info" prot="private">TaprootBuilder::LeafInfo</innerclass>
    <innerclass refid="struct_taproot_builder_1_1_node_info" prot="private">TaprootBuilder::NodeInfo</innerclass>
    <sectiondef kind="private-attrib">
      <memberdef kind="variable" id="class_taproot_builder_1a8a503ea8b57d562480e866d19f1ee484" prot="private" static="no" mutable="no">
        <type>bool</type>
        <definition>bool m_valid</definition>
        <argsstring></argsstring>
        <name>m_valid</name>
        <qualifiedname>TaprootBuilder::m_valid</qualifiedname>
        <initializer>= true</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Whether the builder is in a valid state so far. </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/script/signingprovider.h" line="70" column="10" bodyfile="src/script/signingprovider.h" bodystart="70" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="class_taproot_builder_1a4bd208a51bef418975649dbab506295a" prot="private" static="no" mutable="no">
        <type>std::vector&lt; std::optional&lt; NodeInfo &gt; &gt;</type>
        <definition>std::vector&lt;std::optional&lt;NodeInfo&gt; &gt; m_branch</definition>
        <argsstring></argsstring>
        <name>m_branch</name>
        <qualifiedname>TaprootBuilder::m_branch</qualifiedname>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>The current state of the builder.</para>
<para>For each level in the tree, one NodeInfo object may be present. m_branch[0] is information about the root; further values are for deeper subtrees being explored.</para>
<para>For every right branch taken to reach the position we&apos;re currently working in, there will be a (non-nullopt) entry in m_branch corresponding to the left branch at that level.</para>
<para>For example, imagine this tree: - N0 - / \ N1 N2 / \ / \ A B C N3 / \ D E</para>
<para>Initially, m_branch is empty. After processing leaf A, it would become {nullopt, nullopt, A}. When processing leaf B, an entry at level 2 already exists, and it would thus be combined with it to produce a level 1 one, resulting in {nullopt, N1}. Adding C and D takes us to {nullopt, N1, C} and {nullopt, N1, C, D} respectively. When E is processed, it is combined with D, and then C, and then N1, to produce the root, resulting in {N0}.</para>
<para>This structure allows processing with just O(log n) overhead if the leaves are computed on the fly.</para>
<para>As an invariant, there can never be nullopt entries at the end. There can also not be more than 128 entries (as that would mean more than 128 levels in the tree). The depth of newly added entries will always be at least equal to the current size of m_branch (otherwise it does not correspond to a depth-first traversal of a tree). m_branch is only empty if no entries have ever be processed. m_branch having length 1 corresponds to being done. </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/script/signingprovider.h" line="107" column="17" bodyfile="src/script/signingprovider.h" bodystart="107" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="class_taproot_builder_1a7aef7797724e01f4fad316f82d340a32" prot="private" static="no" mutable="no">
        <type><ref refid="class_x_only_pub_key" kindref="compound">XOnlyPubKey</ref></type>
        <definition>XOnlyPubKey m_internal_key</definition>
        <argsstring></argsstring>
        <name>m_internal_key</name>
        <qualifiedname>TaprootBuilder::m_internal_key</qualifiedname>
        <briefdescription>
<para>The internal key, set when finalizing. </para>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/script/signingprovider.h" line="109" column="17" bodyfile="src/script/signingprovider.h" bodystart="109" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="class_taproot_builder_1a179c0935083c96a862c5945026d10d58" prot="private" static="no" mutable="no">
        <type><ref refid="class_x_only_pub_key" kindref="compound">XOnlyPubKey</ref></type>
        <definition>XOnlyPubKey m_output_key</definition>
        <argsstring></argsstring>
        <name>m_output_key</name>
        <qualifiedname>TaprootBuilder::m_output_key</qualifiedname>
        <briefdescription>
<para>The output key, computed when finalizing. </para>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/script/signingprovider.h" line="110" column="17" bodyfile="src/script/signingprovider.h" bodystart="110" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="class_taproot_builder_1ac466896d347ca1caf7427b28e7fd460e" prot="private" static="no" mutable="no">
        <type>bool</type>
        <definition>bool m_parity</definition>
        <argsstring></argsstring>
        <name>m_parity</name>
        <qualifiedname>TaprootBuilder::m_parity</qualifiedname>
        <briefdescription>
<para>The tweak parity, computed when finalizing. </para>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/script/signingprovider.h" line="111" column="10" bodyfile="src/script/signingprovider.h" bodystart="111" bodyend="-1"/>
      </memberdef>
    </sectiondef>
    <sectiondef kind="private-static-func">
      <memberdef kind="function" id="class_taproot_builder_1a465d74a0f1f70f9f4fef75e44167a867" prot="private" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>NodeInfo</type>
        <definition>TaprootBuilder::NodeInfo Combine</definition>
        <argsstring>(NodeInfo &amp;&amp;a, NodeInfo &amp;&amp;b)</argsstring>
        <name>Combine</name>
        <qualifiedname>TaprootBuilder::Combine</qualifiedname>
        <param>
          <type>NodeInfo &amp;&amp;</type>
          <declname>a</declname>
        </param>
        <param>
          <type>NodeInfo &amp;&amp;</type>
          <declname>b</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Combine information about a parent Merkle tree node from its child nodes. </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/script/signingprovider.h" line="114" column="21" bodyfile="src/script/signingprovider.cpp" bodystart="352" bodyend="367"/>
      </memberdef>
    </sectiondef>
    <sectiondef kind="private-func">
      <memberdef kind="function" id="class_taproot_builder_1aa97b777aa7c0ba66c6952e4507db2733" prot="private" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void Insert</definition>
        <argsstring>(NodeInfo &amp;&amp;node, int depth)</argsstring>
        <name>Insert</name>
        <qualifiedname>TaprootBuilder::Insert</qualifiedname>
        <param>
          <type>NodeInfo &amp;&amp;</type>
          <declname>node</declname>
        </param>
        <param>
          <type>int</type>
          <declname>depth</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Insert information about a node at a certain depth, and propagate information up. </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/script/signingprovider.h" line="116" column="10" bodyfile="src/script/signingprovider.cpp" bodystart="384" bodyend="408"/>
      </memberdef>
    </sectiondef>
    <sectiondef kind="public-func">
      <memberdef kind="function" id="class_taproot_builder_1ab6a1b07f2b850eb59b5ac8c44bd13ed2" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="class_taproot_builder" kindref="compound">TaprootBuilder</ref> &amp;</type>
        <definition>TaprootBuilder &amp; Add</definition>
        <argsstring>(int depth, std::span&lt; const unsigned char &gt; script, int leaf_version, bool track=true)</argsstring>
        <name>Add</name>
        <qualifiedname>TaprootBuilder::Add</qualifiedname>
        <param>
          <type>int</type>
          <declname>depth</declname>
        </param>
        <param>
          <type>std::span&lt; const unsigned char &gt;</type>
          <declname>script</declname>
        </param>
        <param>
          <type>int</type>
          <declname>leaf_version</declname>
        </param>
        <param>
          <type>bool</type>
          <declname>track</declname>
          <defval>true</defval>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Add a new script at a certain depth in the tree. <ref refid="class_taproot_builder_1ab6a1b07f2b850eb59b5ac8c44bd13ed2" kindref="member">Add()</ref> operations must be called in depth-first traversal order of binary tree. If track is true, it will be included in the <ref refid="class_taproot_builder_1a699c66a0ba28809a5e92eeaff8ff60e6" kindref="member">GetSpendData()</ref> output. </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/script/signingprovider.h" line="122" column="20" bodyfile="src/script/signingprovider.cpp" bodystart="433" bodyend="444"/>
      </memberdef>
      <memberdef kind="function" id="class_taproot_builder_1a57d2c764bb6ff03e3a569e06125b55d0" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="class_taproot_builder" kindref="compound">TaprootBuilder</ref> &amp;</type>
        <definition>TaprootBuilder &amp; AddOmitted</definition>
        <argsstring>(int depth, const uint256 &amp;hash)</argsstring>
        <name>AddOmitted</name>
        <qualifiedname>TaprootBuilder::AddOmitted</qualifiedname>
        <param>
          <type>int</type>
          <declname>depth</declname>
        </param>
        <param>
          <type>const <ref refid="classuint256" kindref="compound">uint256</ref> &amp;</type>
          <declname>hash</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Like <ref refid="class_taproot_builder_1ab6a1b07f2b850eb59b5ac8c44bd13ed2" kindref="member">Add()</ref>, but for a Merkle node with a given hash to the tree. </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/script/signingprovider.h" line="124" column="20" bodyfile="src/script/signingprovider.cpp" bodystart="446" bodyend="454"/>
      </memberdef>
      <memberdef kind="function" id="class_taproot_builder_1ab8b83511ea72001bc26cbb24176e08cd" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="class_taproot_builder" kindref="compound">TaprootBuilder</ref> &amp;</type>
        <definition>TaprootBuilder &amp; Finalize</definition>
        <argsstring>(const XOnlyPubKey &amp;internal_key)</argsstring>
        <name>Finalize</name>
        <qualifiedname>TaprootBuilder::Finalize</qualifiedname>
        <param>
          <type>const <ref refid="class_x_only_pub_key" kindref="compound">XOnlyPubKey</ref> &amp;</type>
          <declname>internal_key</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Finalize the construction. Can only be called when <ref refid="class_taproot_builder_1a2dcfd43994bb6ea7a391ced3f53b71df" kindref="member">IsComplete()</ref> is true. internal_key.IsFullyValid() must be true. </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/script/signingprovider.h" line="127" column="20" bodyfile="src/script/signingprovider.cpp" bodystart="456" bodyend="465"/>
      </memberdef>
      <memberdef kind="function" id="class_taproot_builder_1ac532c4b500b1a85ea22217f2c65a70ed" prot="public" static="no" const="yes" explicit="no" inline="yes" virt="non-virtual">
        <type>bool</type>
        <definition>bool IsValid</definition>
        <argsstring>() const</argsstring>
        <name>IsValid</name>
        <qualifiedname>TaprootBuilder::IsValid</qualifiedname>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Return true if so far all input was valid. </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/script/signingprovider.h" line="130" column="10" bodyfile="src/script/signingprovider.h" bodystart="130" bodyend="130"/>
      </memberdef>
      <memberdef kind="function" id="class_taproot_builder_1a2dcfd43994bb6ea7a391ced3f53b71df" prot="public" static="no" const="yes" explicit="no" inline="yes" virt="non-virtual">
        <type>bool</type>
        <definition>bool IsComplete</definition>
        <argsstring>() const</argsstring>
        <name>IsComplete</name>
        <qualifiedname>TaprootBuilder::IsComplete</qualifiedname>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Return whether there were either no leaves, or the leaves form a Huffman tree. </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/script/signingprovider.h" line="132" column="10" bodyfile="src/script/signingprovider.h" bodystart="132" bodyend="132"/>
      </memberdef>
      <memberdef kind="function" id="class_taproot_builder_1a43d5b75ae85829eaf0aab5747e42f7f1" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="struct_witness_v1_taproot" kindref="compound">WitnessV1Taproot</ref></type>
        <definition>WitnessV1Taproot GetOutput</definition>
        <argsstring>()</argsstring>
        <name>GetOutput</name>
        <qualifiedname>TaprootBuilder::GetOutput</qualifiedname>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Compute scriptPubKey (after <ref refid="class_taproot_builder_1ab8b83511ea72001bc26cbb24176e08cd" kindref="member">Finalize()</ref>). </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/script/signingprovider.h" line="134" column="22" bodyfile="src/script/signingprovider.cpp" bodystart="467" bodyend="467"/>
      </memberdef>
      <memberdef kind="function" id="class_taproot_builder_1a699c66a0ba28809a5e92eeaff8ff60e6" prot="public" static="no" const="yes" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="struct_taproot_spend_data" kindref="compound">TaprootSpendData</ref></type>
        <definition>TaprootSpendData GetSpendData</definition>
        <argsstring>() const</argsstring>
        <name>GetSpendData</name>
        <qualifiedname>TaprootBuilder::GetSpendData</qualifiedname>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Compute spending data (after <ref refid="class_taproot_builder_1ab8b83511ea72001bc26cbb24176e08cd" kindref="member">Finalize()</ref>). </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/script/signingprovider.h" line="138" column="22" bodyfile="src/script/signingprovider.cpp" bodystart="469" bodyend="494"/>
      </memberdef>
      <memberdef kind="function" id="class_taproot_builder_1a86b77ebebc24f51df0783a7db10d522b" prot="public" static="no" const="yes" explicit="no" inline="no" virt="non-virtual">
        <type>std::vector&lt; std::tuple&lt; uint8_t, uint8_t, std::vector&lt; unsigned char &gt; &gt; &gt;</type>
        <definition>std::vector&lt; std::tuple&lt; uint8_t, uint8_t, std::vector&lt; unsigned char &gt; &gt; &gt; GetTreeTuples</definition>
        <argsstring>() const</argsstring>
        <name>GetTreeTuples</name>
        <qualifiedname>TaprootBuilder::GetTreeTuples</qualifiedname>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Returns a vector of tuples representing the depth, leaf version, and script </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/script/signingprovider.h" line="140" column="17" bodyfile="src/script/signingprovider.cpp" bodystart="631" bodyend="645"/>
      </memberdef>
      <memberdef kind="function" id="class_taproot_builder_1ae5ca94077fef6c5e5b9c54fe55dfa1a9" prot="public" static="no" const="yes" explicit="no" inline="yes" virt="non-virtual">
        <type>bool</type>
        <definition>bool HasScripts</definition>
        <argsstring>() const</argsstring>
        <name>HasScripts</name>
        <qualifiedname>TaprootBuilder::HasScripts</qualifiedname>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Returns true if there are any tapscripts </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/script/signingprovider.h" line="142" column="10" bodyfile="src/script/signingprovider.h" bodystart="142" bodyend="142"/>
      </memberdef>
      <memberdef kind="function" id="class_taproot_builder_1a21c159ff5921d7724e65983a5ccda35e" prot="public" static="no" const="yes" explicit="no" inline="yes" virt="non-virtual">
        <type>bool</type>
        <definition>bool operator==</definition>
        <argsstring>(const TaprootBuilder &amp;other) const</argsstring>
        <name>operator==</name>
        <qualifiedname>TaprootBuilder::operator==</qualifiedname>
        <param>
          <type>const <ref refid="class_taproot_builder" kindref="compound">TaprootBuilder</ref> &amp;</type>
          <declname>other</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/script/signingprovider.h" line="144" column="10" bodyfile="src/script/signingprovider.h" bodystart="144" bodyend="144"/>
      </memberdef>
    </sectiondef>
    <sectiondef kind="public-static-func">
      <memberdef kind="function" id="class_taproot_builder_1afccc56922add6cfd21f81df748e2288c" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>bool</type>
        <definition>bool ValidDepths</definition>
        <argsstring>(const std::vector&lt; int &gt; &amp;depths)</argsstring>
        <name>ValidDepths</name>
        <qualifiedname>TaprootBuilder::ValidDepths</qualifiedname>
        <param>
          <type>const std::vector&lt; int &gt; &amp;</type>
          <declname>depths</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Check if a list of depths is legal (will lead to <ref refid="class_taproot_builder_1a2dcfd43994bb6ea7a391ced3f53b71df" kindref="member">IsComplete()</ref>). </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/script/signingprovider.h" line="136" column="17" bodyfile="src/script/signingprovider.cpp" bodystart="410" bodyend="431"/>
      </memberdef>
    </sectiondef>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
<para>Utility class to construct Taproot outputs from internal key and script tree. </para>
    </detaileddescription>
    <location file="src/script/signingprovider.h" line="49" column="1" bodyfile="src/script/signingprovider.h" bodystart="50" bodyend="145"/>
    <listofallmembers>
      <member refid="class_taproot_builder_1ab6a1b07f2b850eb59b5ac8c44bd13ed2" prot="public" virt="non-virtual"><scope>TaprootBuilder</scope><name>Add</name></member>
      <member refid="class_taproot_builder_1a57d2c764bb6ff03e3a569e06125b55d0" prot="public" virt="non-virtual"><scope>TaprootBuilder</scope><name>AddOmitted</name></member>
      <member refid="class_taproot_builder_1a465d74a0f1f70f9f4fef75e44167a867" prot="private" virt="non-virtual"><scope>TaprootBuilder</scope><name>Combine</name></member>
      <member refid="class_taproot_builder_1ab8b83511ea72001bc26cbb24176e08cd" prot="public" virt="non-virtual"><scope>TaprootBuilder</scope><name>Finalize</name></member>
      <member refid="class_taproot_builder_1a43d5b75ae85829eaf0aab5747e42f7f1" prot="public" virt="non-virtual"><scope>TaprootBuilder</scope><name>GetOutput</name></member>
      <member refid="class_taproot_builder_1a699c66a0ba28809a5e92eeaff8ff60e6" prot="public" virt="non-virtual"><scope>TaprootBuilder</scope><name>GetSpendData</name></member>
      <member refid="class_taproot_builder_1a86b77ebebc24f51df0783a7db10d522b" prot="public" virt="non-virtual"><scope>TaprootBuilder</scope><name>GetTreeTuples</name></member>
      <member refid="class_taproot_builder_1ae5ca94077fef6c5e5b9c54fe55dfa1a9" prot="public" virt="non-virtual"><scope>TaprootBuilder</scope><name>HasScripts</name></member>
      <member refid="class_taproot_builder_1aa97b777aa7c0ba66c6952e4507db2733" prot="private" virt="non-virtual"><scope>TaprootBuilder</scope><name>Insert</name></member>
      <member refid="class_taproot_builder_1a2dcfd43994bb6ea7a391ced3f53b71df" prot="public" virt="non-virtual"><scope>TaprootBuilder</scope><name>IsComplete</name></member>
      <member refid="class_taproot_builder_1ac532c4b500b1a85ea22217f2c65a70ed" prot="public" virt="non-virtual"><scope>TaprootBuilder</scope><name>IsValid</name></member>
      <member refid="class_taproot_builder_1a4bd208a51bef418975649dbab506295a" prot="private" virt="non-virtual"><scope>TaprootBuilder</scope><name>m_branch</name></member>
      <member refid="class_taproot_builder_1a7aef7797724e01f4fad316f82d340a32" prot="private" virt="non-virtual"><scope>TaprootBuilder</scope><name>m_internal_key</name></member>
      <member refid="class_taproot_builder_1a179c0935083c96a862c5945026d10d58" prot="private" virt="non-virtual"><scope>TaprootBuilder</scope><name>m_output_key</name></member>
      <member refid="class_taproot_builder_1ac466896d347ca1caf7427b28e7fd460e" prot="private" virt="non-virtual"><scope>TaprootBuilder</scope><name>m_parity</name></member>
      <member refid="class_taproot_builder_1a8a503ea8b57d562480e866d19f1ee484" prot="private" virt="non-virtual"><scope>TaprootBuilder</scope><name>m_valid</name></member>
      <member refid="class_taproot_builder_1a21c159ff5921d7724e65983a5ccda35e" prot="public" virt="non-virtual"><scope>TaprootBuilder</scope><name>operator==</name></member>
      <member refid="class_taproot_builder_1afccc56922add6cfd21f81df748e2288c" prot="public" virt="non-virtual"><scope>TaprootBuilder</scope><name>ValidDepths</name></member>
    </listofallmembers>
  </compounddef>
</doxygen>
