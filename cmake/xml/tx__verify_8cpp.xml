<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.15.0" xml:lang="en-US">
  <compounddef id="tx__verify_8cpp" kind="file" language="C++">
    <compoundname>tx_verify.cpp</compoundname>
    <includes refid="tx__verify_8h" local="no">consensus/tx_verify.h</includes>
    <includes local="no">chain.h</includes>
    <includes local="no">coins.h</includes>
    <includes refid="amount_8h" local="no">consensus/amount.h</includes>
    <includes refid="consensus_8h" local="no">consensus/consensus.h</includes>
    <includes refid="consensus_2validation_8h" local="no">consensus/validation.h</includes>
    <includes refid="primitives_2transaction_8h" local="no">primitives/transaction.h</includes>
    <includes refid="interpreter_8h" local="no">script/interpreter.h</includes>
    <includes refid="check_8h" local="no">util/check.h</includes>
    <includes refid="moneystr_8h" local="no">util/moneystr.h</includes>
    <incdepgraph>
      <node id="15">
        <label>attributes.h</label>
        <link refid="attributes_8h"/>
      </node>
      <node id="49">
        <label>compat/assumptions.h</label>
        <link refid="compat_2assumptions_8h"/>
        <childnode refid="23" relation="include">
        </childnode>
        <childnode refid="38" relation="include">
        </childnode>
      </node>
      <node id="20">
        <label>compat/byteswap.h</label>
        <link refid="byteswap_8h"/>
        <childnode refid="4" relation="include">
        </childnode>
      </node>
      <node id="19">
        <label>compat/endian.h</label>
        <link refid="endian_8h"/>
        <childnode refid="20" relation="include">
        </childnode>
        <childnode refid="21" relation="include">
        </childnode>
        <childnode refid="4" relation="include">
        </childnode>
      </node>
      <node id="3">
        <label>consensus/amount.h</label>
        <link refid="amount_8h"/>
        <childnode refid="4" relation="include">
        </childnode>
      </node>
      <node id="10">
        <label>consensus/consensus.h</label>
        <link refid="consensus_8h"/>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="11" relation="include">
        </childnode>
      </node>
      <node id="1">
        <label>src/consensus/tx_verify.cpp</label>
        <link refid="tx__verify_8cpp"/>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="8" relation="include">
        </childnode>
        <childnode refid="9" relation="include">
        </childnode>
        <childnode refid="3" relation="include">
        </childnode>
        <childnode refid="10" relation="include">
        </childnode>
        <childnode refid="12" relation="include">
        </childnode>
        <childnode refid="14" relation="include">
        </childnode>
        <childnode refid="59" relation="include">
        </childnode>
        <childnode refid="62" relation="include">
        </childnode>
        <childnode refid="65" relation="include">
        </childnode>
      </node>
      <node id="2">
        <label>consensus/tx_verify.h</label>
        <link refid="tx__verify_8h"/>
        <childnode refid="3" relation="include">
        </childnode>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="7" relation="include">
        </childnode>
      </node>
      <node id="12">
        <label>consensus/validation.h</label>
        <link refid="consensus_2validation_8h"/>
        <childnode refid="13" relation="include">
        </childnode>
        <childnode refid="10" relation="include">
        </childnode>
        <childnode refid="14" relation="include">
        </childnode>
        <childnode refid="57" relation="include">
        </childnode>
      </node>
      <node id="18">
        <label>crypto/common.h</label>
        <link refid="crypto_2common_8h"/>
        <childnode refid="19" relation="include">
        </childnode>
        <childnode refid="22" relation="include">
        </childnode>
        <childnode refid="23" relation="include">
        </childnode>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="24" relation="include">
        </childnode>
      </node>
      <node id="31">
        <label>crypto/hex_base.h</label>
        <link refid="hex__base_8h"/>
        <childnode refid="25" relation="include">
        </childnode>
        <childnode refid="23" relation="include">
        </childnode>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="27" relation="include">
        </childnode>
        <childnode refid="13" relation="include">
        </childnode>
      </node>
      <node id="46">
        <label>prevector.h</label>
        <link refid="prevector_8h"/>
        <childnode refid="41" relation="include">
        </childnode>
        <childnode refid="26" relation="include">
        </childnode>
        <childnode refid="23" relation="include">
        </childnode>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="11" relation="include">
        </childnode>
        <childnode refid="24" relation="include">
        </childnode>
        <childnode refid="47" relation="include">
        </childnode>
        <childnode refid="28" relation="include">
        </childnode>
        <childnode refid="29" relation="include">
        </childnode>
      </node>
      <node id="57">
        <label>primitives/block.h</label>
        <link refid="primitives_2block_8h"/>
        <childnode refid="14" relation="include">
        </childnode>
        <childnode refid="48" relation="include">
        </childnode>
        <childnode refid="17" relation="include">
        </childnode>
        <childnode refid="58" relation="include">
        </childnode>
      </node>
      <node id="14">
        <label>primitives/transaction.h</label>
        <link refid="primitives_2transaction_8h"/>
        <childnode refid="15" relation="include">
        </childnode>
        <childnode refid="3" relation="include">
        </childnode>
        <childnode refid="16" relation="include">
        </childnode>
        <childnode refid="45" relation="include">
        </childnode>
        <childnode refid="48" relation="include">
        </childnode>
        <childnode refid="17" relation="include">
        </childnode>
        <childnode refid="23" relation="include">
        </childnode>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="50" relation="include">
        </childnode>
        <childnode refid="38" relation="include">
        </childnode>
        <childnode refid="52" relation="include">
        </childnode>
        <childnode refid="56" relation="include">
        </childnode>
        <childnode refid="13" relation="include">
        </childnode>
        <childnode refid="43" relation="include">
        </childnode>
        <childnode refid="29" relation="include">
        </childnode>
        <childnode refid="7" relation="include">
        </childnode>
      </node>
      <node id="16">
        <label>primitives/transaction_identifier.h</label>
        <link refid="transaction__identifier_8h"/>
        <childnode refid="15" relation="include">
        </childnode>
        <childnode refid="17" relation="include">
        </childnode>
        <childnode refid="42" relation="include">
        </childnode>
        <childnode refid="6" relation="include">
        </childnode>
        <childnode refid="22" relation="include">
        </childnode>
        <childnode refid="43" relation="include">
        </childnode>
        <childnode refid="44" relation="include">
        </childnode>
      </node>
      <node id="59">
        <label>script/interpreter.h</label>
        <link refid="interpreter_8h"/>
        <childnode refid="3" relation="include">
        </childnode>
        <childnode refid="60" relation="include">
        </childnode>
        <childnode refid="14" relation="include">
        </childnode>
        <childnode refid="61" relation="include">
        </childnode>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="25" relation="include">
        </childnode>
        <childnode refid="17" relation="include">
        </childnode>
        <childnode refid="23" relation="include">
        </childnode>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="39" relation="include">
        </childnode>
        <childnode refid="7" relation="include">
        </childnode>
      </node>
      <node id="45">
        <label>script/script.h</label>
        <link refid="script_2script_8h"/>
        <childnode refid="15" relation="include">
        </childnode>
        <childnode refid="18" relation="include">
        </childnode>
        <childnode refid="46" relation="include">
        </childnode>
        <childnode refid="48" relation="include">
        </childnode>
        <childnode refid="17" relation="include">
        </childnode>
        <childnode refid="54" relation="include">
        </childnode>
        <childnode refid="26" relation="include">
        </childnode>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="24" relation="include">
        </childnode>
        <childnode refid="38" relation="include">
        </childnode>
        <childnode refid="27" relation="include">
        </childnode>
        <childnode refid="55" relation="include">
        </childnode>
        <childnode refid="13" relation="include">
        </childnode>
        <childnode refid="28" relation="include">
        </childnode>
        <childnode refid="29" relation="include">
        </childnode>
        <childnode refid="7" relation="include">
        </childnode>
      </node>
      <node id="61">
        <label>script/script_error.h</label>
        <link refid="script__error_8h"/>
        <childnode refid="13" relation="include">
        </childnode>
      </node>
      <node id="5">
        <label>script/verify_flags.h</label>
        <link refid="verify__flags_8h"/>
        <childnode refid="6" relation="include">
        </childnode>
        <childnode refid="4" relation="include">
        </childnode>
      </node>
      <node id="48">
        <label>serialize.h</label>
        <link refid="serialize_8h"/>
        <childnode refid="15" relation="include">
        </childnode>
        <childnode refid="49" relation="include">
        </childnode>
        <childnode refid="19" relation="include">
        </childnode>
        <childnode refid="46" relation="include">
        </childnode>
        <childnode refid="25" relation="include">
        </childnode>
        <childnode refid="41" relation="include">
        </childnode>
        <childnode refid="22" relation="include">
        </childnode>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="24" relation="include">
        </childnode>
        <childnode refid="50" relation="include">
        </childnode>
        <childnode refid="38" relation="include">
        </childnode>
        <childnode refid="51" relation="include">
        </childnode>
        <childnode refid="52" relation="include">
        </childnode>
        <childnode refid="53" relation="include">
        </childnode>
        <childnode refid="13" relation="include">
        </childnode>
        <childnode refid="29" relation="include">
        </childnode>
        <childnode refid="7" relation="include">
        </childnode>
      </node>
      <node id="25">
        <label>span.h</label>
        <link refid="span_8h"/>
        <childnode refid="26" relation="include">
        </childnode>
        <childnode refid="23" relation="include">
        </childnode>
        <childnode refid="27" relation="include">
        </childnode>
        <childnode refid="28" relation="include">
        </childnode>
        <childnode refid="29" relation="include">
        </childnode>
      </node>
      <node id="17">
        <label>uint256.h</label>
        <link refid="uint256_8h"/>
        <childnode refid="18" relation="include">
        </childnode>
        <childnode refid="25" relation="include">
        </childnode>
        <childnode refid="30" relation="include">
        </childnode>
        <childnode refid="32" relation="include">
        </childnode>
        <childnode refid="41" relation="include">
        </childnode>
        <childnode refid="33" relation="include">
        </childnode>
        <childnode refid="26" relation="include">
        </childnode>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="24" relation="include">
        </childnode>
        <childnode refid="39" relation="include">
        </childnode>
        <childnode refid="13" relation="include">
        </childnode>
        <childnode refid="36" relation="include">
        </childnode>
      </node>
      <node id="62">
        <label>util/check.h</label>
        <link refid="check_8h"/>
        <childnode refid="15" relation="include">
        </childnode>
        <childnode refid="63" relation="include">
        </childnode>
        <childnode refid="26" relation="include">
        </childnode>
        <childnode refid="64" relation="include">
        </childnode>
        <childnode refid="55" relation="include">
        </childnode>
        <childnode refid="13" relation="include">
        </childnode>
        <childnode refid="36" relation="include">
        </childnode>
        <childnode refid="29" relation="include">
        </childnode>
      </node>
      <node id="54">
        <label>util/hash_type.h</label>
        <link refid="hash__type_8h"/>
      </node>
      <node id="65">
        <label>util/moneystr.h</label>
        <link refid="moneystr_8h"/>
        <childnode refid="3" relation="include">
        </childnode>
        <childnode refid="39" relation="include">
        </childnode>
        <childnode refid="13" relation="include">
        </childnode>
      </node>
      <node id="30">
        <label>util/strencodings.h</label>
        <link refid="strencodings_8h"/>
        <childnode refid="31" relation="include">
        </childnode>
        <childnode refid="25" relation="include">
        </childnode>
        <childnode refid="32" relation="include">
        </childnode>
        <childnode refid="33" relation="include">
        </childnode>
        <childnode refid="21" relation="include">
        </childnode>
        <childnode refid="37" relation="include">
        </childnode>
        <childnode refid="23" relation="include">
        </childnode>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="38" relation="include">
        </childnode>
        <childnode refid="39" relation="include">
        </childnode>
        <childnode refid="13" relation="include">
        </childnode>
        <childnode refid="36" relation="include">
        </childnode>
        <childnode refid="40" relation="include">
        </childnode>
        <childnode refid="28" relation="include">
        </childnode>
        <childnode refid="7" relation="include">
        </childnode>
      </node>
      <node id="32">
        <label>util/string.h</label>
        <link refid="string_8h"/>
        <childnode refid="25" relation="include">
        </childnode>
        <childnode refid="33" relation="include">
        </childnode>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="24" relation="include">
        </childnode>
        <childnode refid="34" relation="include">
        </childnode>
        <childnode refid="35" relation="include">
        </childnode>
        <childnode refid="13" relation="include">
        </childnode>
        <childnode refid="36" relation="include">
        </childnode>
        <childnode refid="7" relation="include">
        </childnode>
      </node>
      <node id="42">
        <label>util/types.h</label>
        <link refid="util_2types_8h"/>
      </node>
      <node id="41">
        <label>algorithm</label>
      </node>
      <node id="33">
        <label>array</label>
      </node>
      <node id="63">
        <label>atomic</label>
      </node>
      <node id="21">
        <label>bit</label>
      </node>
      <node id="26">
        <label>cassert</label>
      </node>
      <node id="8">
        <label>chain.h</label>
      </node>
      <node id="37">
        <label>charconv</label>
      </node>
      <node id="9">
        <label>coins.h</label>
      </node>
      <node id="6">
        <label>compare</label>
      </node>
      <node id="22">
        <label>concepts</label>
      </node>
      <node id="23">
        <label>cstddef</label>
      </node>
      <node id="4">
        <label>cstdint</label>
      </node>
      <node id="11">
        <label>cstdlib</label>
      </node>
      <node id="24">
        <label>cstring</label>
      </node>
      <node id="60">
        <label>hash.h</label>
      </node>
      <node id="50">
        <label>ios</label>
      </node>
      <node id="47">
        <label>iterator</label>
      </node>
      <node id="38">
        <label>limits</label>
      </node>
      <node id="34">
        <label>locale</label>
      </node>
      <node id="51">
        <label>map</label>
      </node>
      <node id="52">
        <label>memory</label>
      </node>
      <node id="56">
        <label>numeric</label>
      </node>
      <node id="39">
        <label>optional</label>
      </node>
      <node id="53">
        <label>set</label>
      </node>
      <node id="64">
        <label>source_location</label>
      </node>
      <node id="27">
        <label>span</label>
      </node>
      <node id="35">
        <label>sstream</label>
      </node>
      <node id="55">
        <label>stdexcept</label>
      </node>
      <node id="13">
        <label>string</label>
      </node>
      <node id="36">
        <label>string_view</label>
      </node>
      <node id="40">
        <label>system_error</label>
      </node>
      <node id="43">
        <label>tuple</label>
      </node>
      <node id="28">
        <label>type_traits</label>
      </node>
      <node id="58">
        <label>util/time.h</label>
      </node>
      <node id="29">
        <label>utility</label>
      </node>
      <node id="44">
        <label>variant</label>
      </node>
      <node id="7">
        <label>vector</label>
      </node>
    </incdepgraph>
    <sectiondef kind="func">
      <memberdef kind="function" id="tx__verify_8cpp_1adc332cd7ac94e639bb4239618341be19" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>bool</type>
        <definition>bool IsFinalTx</definition>
        <argsstring>(const CTransaction &amp;tx, int nBlockHeight, int64_t nBlockTime)</argsstring>
        <name>IsFinalTx</name>
        <param>
          <type>const <ref refid="class_c_transaction" kindref="compound">CTransaction</ref> &amp;</type>
          <declname>tx</declname>
        </param>
        <param>
          <type>int</type>
          <declname>nBlockHeight</declname>
        </param>
        <param>
          <type>int64_t</type>
          <declname>nBlockTime</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Check if transaction is final and can be included in a block with the specified height and time. <ref refid="namespace_consensus" kindref="compound">Consensus</ref> critical. </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/consensus/tx_verify.cpp" line="17" column="6" bodyfile="src/consensus/tx_verify.cpp" bodystart="17" bodyend="37"/>
      </memberdef>
      <memberdef kind="function" id="tx__verify_8cpp_1abc528b150bf26a1644aef9713336dda2" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>std::pair&lt; int, int64_t &gt;</type>
        <definition>std::pair&lt; int, int64_t &gt; CalculateSequenceLocks</definition>
        <argsstring>(const CTransaction &amp;tx, int flags, std::vector&lt; int &gt; &amp;prevHeights, const CBlockIndex &amp;block)</argsstring>
        <name>CalculateSequenceLocks</name>
        <param>
          <type>const <ref refid="class_c_transaction" kindref="compound">CTransaction</ref> &amp;</type>
          <declname>tx</declname>
        </param>
        <param>
          <type>int</type>
          <declname>flags</declname>
        </param>
        <param>
          <type>std::vector&lt; int &gt; &amp;</type>
          <declname>prevHeights</declname>
        </param>
        <param>
          <type>const <ref refid="class_c_block_index" kindref="compound">CBlockIndex</ref> &amp;</type>
          <declname>block</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Calculates the block height and previous block&apos;s median time past at which the transaction will be considered final in the context of BIP 68. For each input that is not sequence locked, the corresponding entries in prevHeights are set to 0 as they do not affect the calculation. </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/consensus/tx_verify.cpp" line="39" column="11" bodyfile="src/consensus/tx_verify.cpp" bodystart="39" bodyend="95"/>
      </memberdef>
      <memberdef kind="function" id="tx__verify_8cpp_1ab6bb0246e751e82b8d6e3c97ed88b839" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>bool</type>
        <definition>bool EvaluateSequenceLocks</definition>
        <argsstring>(const CBlockIndex &amp;block, std::pair&lt; int, int64_t &gt; lockPair)</argsstring>
        <name>EvaluateSequenceLocks</name>
        <param>
          <type>const <ref refid="class_c_block_index" kindref="compound">CBlockIndex</ref> &amp;</type>
          <declname>block</declname>
        </param>
        <param>
          <type>std::pair&lt; int, int64_t &gt;</type>
          <declname>lockPair</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/consensus/tx_verify.cpp" line="97" column="6" bodyfile="src/consensus/tx_verify.cpp" bodystart="97" bodyend="105"/>
      </memberdef>
      <memberdef kind="function" id="tx__verify_8cpp_1ad5b7bf644ada0a55c6aac8cfa89ed14a" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>bool</type>
        <definition>bool SequenceLocks</definition>
        <argsstring>(const CTransaction &amp;tx, int flags, std::vector&lt; int &gt; &amp;prevHeights, const CBlockIndex &amp;block)</argsstring>
        <name>SequenceLocks</name>
        <param>
          <type>const <ref refid="class_c_transaction" kindref="compound">CTransaction</ref> &amp;</type>
          <declname>tx</declname>
        </param>
        <param>
          <type>int</type>
          <declname>flags</declname>
        </param>
        <param>
          <type>std::vector&lt; int &gt; &amp;</type>
          <declname>prevHeights</declname>
        </param>
        <param>
          <type>const <ref refid="class_c_block_index" kindref="compound">CBlockIndex</ref> &amp;</type>
          <declname>block</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Check if transaction is final per BIP 68 sequence numbers and can be included in a block. <ref refid="namespace_consensus" kindref="compound">Consensus</ref> critical. Takes as input a list of heights at which tx&apos;s inputs (in order) confirmed. </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/consensus/tx_verify.cpp" line="107" column="6" bodyfile="src/consensus/tx_verify.cpp" bodystart="107" bodyend="110"/>
      </memberdef>
      <memberdef kind="function" id="tx__verify_8cpp_1ad2eaf4f8542c12ea9ee1183609cc6d1a" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>unsigned int</type>
        <definition>unsigned int GetLegacySigOpCount</definition>
        <argsstring>(const CTransaction &amp;tx)</argsstring>
        <name>GetLegacySigOpCount</name>
        <param>
          <type>const <ref refid="class_c_transaction" kindref="compound">CTransaction</ref> &amp;</type>
          <declname>tx</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Auxiliary functions for transaction validation (ideally should not be exposed) Count ECDSA signature operations the old-fashioned (pre-0.6) way <simplesect kind="return"><para>number of sigops this transaction&apos;s outputs will produce when spent </para>
</simplesect>
<simplesect kind="see"><para>CTransaction::FetchInputs </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/consensus/tx_verify.cpp" line="112" column="14" bodyfile="src/consensus/tx_verify.cpp" bodystart="112" bodyend="124"/>
      </memberdef>
      <memberdef kind="function" id="tx__verify_8cpp_1ad6c100c0465bcda555599ecd8e5577b8" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>unsigned int</type>
        <definition>unsigned int GetP2SHSigOpCount</definition>
        <argsstring>(const CTransaction &amp;tx, const CCoinsViewCache &amp;inputs)</argsstring>
        <name>GetP2SHSigOpCount</name>
        <param>
          <type>const <ref refid="class_c_transaction" kindref="compound">CTransaction</ref> &amp;</type>
          <declname>tx</declname>
        </param>
        <param>
          <type>const <ref refid="class_c_coins_view_cache" kindref="compound">CCoinsViewCache</ref> &amp;</type>
          <declname>mapInputs</declname>
          <defname>inputs</defname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Count ECDSA signature operations in pay-to-script-hash inputs.</para>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">mapInputs</parametername>
</parameternamelist>
<parameterdescription>
<para>Map of previous transactions that have outputs we&apos;re spending </para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>maximum number of sigops required to validate this transaction&apos;s inputs </para>
</simplesect>
<simplesect kind="see"><para>CTransaction::FetchInputs </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/consensus/tx_verify.cpp" line="126" column="14" bodyfile="src/consensus/tx_verify.cpp" bodystart="126" bodyend="141"/>
      </memberdef>
      <memberdef kind="function" id="tx__verify_8cpp_1ac1e236f29c0fd2b8ecee5a2846122151" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int64_t</type>
        <definition>int64_t GetTransactionSigOpCost</definition>
        <argsstring>(const CTransaction &amp;tx, const CCoinsViewCache &amp;inputs, script_verify_flags flags)</argsstring>
        <name>GetTransactionSigOpCost</name>
        <param>
          <type>const <ref refid="class_c_transaction" kindref="compound">CTransaction</ref> &amp;</type>
          <declname>tx</declname>
        </param>
        <param>
          <type>const <ref refid="class_c_coins_view_cache" kindref="compound">CCoinsViewCache</ref> &amp;</type>
          <declname>inputs</declname>
        </param>
        <param>
          <type><ref refid="classscript__verify__flags" kindref="compound">script_verify_flags</ref></type>
          <declname>flags</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Compute total signature operation cost of a transaction. <parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">tx</parametername>
</parameternamelist>
<parameterdescription>
<para>Transaction for which we are computing the cost </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">inputs</parametername>
</parameternamelist>
<parameterdescription>
<para>Map of previous transactions that have outputs we&apos;re spending </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">flags</parametername>
</parameternamelist>
<parameterdescription>
<para>Script verification flags </para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>Total signature operation cost of tx </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/consensus/tx_verify.cpp" line="143" column="9" bodyfile="src/consensus/tx_verify.cpp" bodystart="143" bodyend="162"/>
      </memberdef>
    </sectiondef>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="comment">//<sp/>Copyright<sp/>(c)<sp/>2017-present<sp/>The<sp/>Bitcoin<sp/>Core<sp/>developers</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Distributed<sp/>under<sp/>the<sp/>MIT<sp/>software<sp/>license,<sp/>see<sp/>the<sp/>accompanying</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3"><highlight class="normal"></highlight><highlight class="comment">//<sp/>file<sp/>COPYING<sp/>or<sp/>http://www.opensource.org/licenses/mit-license.php.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4"><highlight class="normal"></highlight></codeline>
<codeline lineno="5"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;<ref refid="tx__verify_8h" kindref="compound">consensus/tx_verify.h</ref>&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6"><highlight class="normal"></highlight></codeline>
<codeline lineno="7"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;chain.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;coins.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="9"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;<ref refid="amount_8h" kindref="compound">consensus/amount.h</ref>&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="10"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;<ref refid="consensus_8h" kindref="compound">consensus/consensus.h</ref>&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="11"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;<ref refid="consensus_2validation_8h" kindref="compound">consensus/validation.h</ref>&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="12"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;<ref refid="primitives_2transaction_8h" kindref="compound">primitives/transaction.h</ref>&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="13"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;<ref refid="interpreter_8h" kindref="compound">script/interpreter.h</ref>&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="14"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;<ref refid="check_8h" kindref="compound">util/check.h</ref>&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="15"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;<ref refid="moneystr_8h" kindref="compound">util/moneystr.h</ref>&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="16"><highlight class="normal"></highlight></codeline>
<codeline lineno="17"><highlight class="normal"></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="tx__verify_8cpp_1adc332cd7ac94e639bb4239618341be19" kindref="member">IsFinalTx</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_c_transaction" kindref="compound">CTransaction</ref><sp/>&amp;tx,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>nBlockHeight,<sp/>int64_t<sp/>nBlockTime)</highlight></codeline>
<codeline lineno="18"><highlight class="normal">{</highlight></codeline>
<codeline lineno="19"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(tx.<ref refid="class_c_transaction_1a84dbc8ee3156eed0c514531f8de6d320" kindref="member">nLockTime</ref><sp/>==<sp/>0)</highlight></codeline>
<codeline lineno="20"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="21"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((int64_t)tx.<ref refid="class_c_transaction_1a84dbc8ee3156eed0c514531f8de6d320" kindref="member">nLockTime</ref><sp/>&lt;<sp/>((int64_t)tx.<ref refid="class_c_transaction_1a84dbc8ee3156eed0c514531f8de6d320" kindref="member">nLockTime</ref><sp/>&lt;<sp/>LOCKTIME_THRESHOLD<sp/>?<sp/>(int64_t)nBlockHeight<sp/>:<sp/>nBlockTime))</highlight></codeline>
<codeline lineno="22"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="23"><highlight class="normal"></highlight></codeline>
<codeline lineno="24"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Even<sp/>if<sp/>tx.nLockTime<sp/>isn&apos;t<sp/>satisfied<sp/>by<sp/>nBlockHeight/nBlockTime,<sp/>a</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="25"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>transaction<sp/>is<sp/>still<sp/>considered<sp/>final<sp/>if<sp/>all<sp/>inputs&apos;<sp/>nSequence<sp/>==</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="26"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>SEQUENCE_FINAL<sp/>(0xffffffff),<sp/>in<sp/>which<sp/>case<sp/>nLockTime<sp/>is<sp/>ignored.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="27"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="28"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Because<sp/>of<sp/>this<sp/>behavior<sp/>OP_CHECKLOCKTIMEVERIFY/CheckLockTime()<sp/>will</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="29"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>also<sp/>check<sp/>that<sp/>the<sp/>spending<sp/>input&apos;s<sp/>nSequence<sp/>!=<sp/>SEQUENCE_FINAL,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="30"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>ensuring<sp/>that<sp/>an<sp/>unsatisfied<sp/>nLockTime<sp/>value<sp/>will<sp/>actually<sp/>cause</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="31"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>IsFinalTx()<sp/>to<sp/>return<sp/>false<sp/>here:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="32"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal">&amp;<sp/>txin<sp/>:<sp/>tx.<ref refid="class_c_transaction_1aaed1b4913ffce3eaaf4c5e13aa09d27f" kindref="member">vin</ref>)<sp/>{</highlight></codeline>
<codeline lineno="33"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!(txin.nSequence<sp/>==<sp/><ref refid="class_c_tx_in_1ae7da98947fdb02a38addd61179e6c36e" kindref="member">CTxIn::SEQUENCE_FINAL</ref>))</highlight></codeline>
<codeline lineno="34"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="35"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="36"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="37"><highlight class="normal">}</highlight></codeline>
<codeline lineno="38"><highlight class="normal"></highlight></codeline>
<codeline lineno="39"><highlight class="normal">std::pair&lt;int,<sp/>int64_t&gt;<sp/><ref refid="tx__verify_8cpp_1abc528b150bf26a1644aef9713336dda2" kindref="member">CalculateSequenceLocks</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_c_transaction" kindref="compound">CTransaction</ref><sp/>&amp;tx,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="bitcoin-tx_8cpp_1ac8bf36fe0577cba66bccda3a6f7e80a4" kindref="member">flags</ref>,<sp/>std::vector&lt;int&gt;&amp;<sp/>prevHeights,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_c_block_index" kindref="compound">CBlockIndex</ref>&amp;<sp/>block)</highlight></codeline>
<codeline lineno="40"><highlight class="normal">{</highlight></codeline>
<codeline lineno="41"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="validation_8cpp_1afb7ea74ba028421697aa7f364741ee6c" kindref="member">assert</ref>(prevHeights.size()<sp/>==<sp/>tx.<ref refid="class_c_transaction_1aaed1b4913ffce3eaaf4c5e13aa09d27f" kindref="member">vin</ref>.size());</highlight></codeline>
<codeline lineno="42"><highlight class="normal"></highlight></codeline>
<codeline lineno="43"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Will<sp/>be<sp/>set<sp/>to<sp/>the<sp/>equivalent<sp/>height-<sp/>and<sp/>time-based<sp/>nLockTime</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="44"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>values<sp/>that<sp/>would<sp/>be<sp/>necessary<sp/>to<sp/>satisfy<sp/>all<sp/>relative<sp/>lock-</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="45"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>time<sp/>constraints<sp/>given<sp/>our<sp/>view<sp/>of<sp/>block<sp/>chain<sp/>history.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="46"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>The<sp/>semantics<sp/>of<sp/>nLockTime<sp/>are<sp/>the<sp/>last<sp/>invalid<sp/>height/time,<sp/>so</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="47"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>use<sp/>-1<sp/>to<sp/>have<sp/>the<sp/>effect<sp/>of<sp/>any<sp/>height<sp/>or<sp/>time<sp/>being<sp/>valid.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="48"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>nMinHeight<sp/>=<sp/>-1;</highlight></codeline>
<codeline lineno="49"><highlight class="normal"><sp/><sp/><sp/><sp/>int64_t<sp/>nMinTime<sp/>=<sp/>-1;</highlight></codeline>
<codeline lineno="50"><highlight class="normal"></highlight></codeline>
<codeline lineno="51"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>fEnforceBIP68<sp/>=<sp/>tx.<ref refid="class_c_transaction_1a4e70f410ba958435b6dfa3b562aa510d" kindref="member">version</ref><sp/>&gt;=<sp/>2<sp/>&amp;&amp;<sp/><ref refid="bitcoin-tx_8cpp_1ac8bf36fe0577cba66bccda3a6f7e80a4" kindref="member">flags</ref><sp/>&amp;<sp/>LOCKTIME_VERIFY_SEQUENCE;</highlight></codeline>
<codeline lineno="52"><highlight class="normal"></highlight></codeline>
<codeline lineno="53"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Do<sp/>not<sp/>enforce<sp/>sequence<sp/>numbers<sp/>as<sp/>a<sp/>relative<sp/>lock<sp/>time</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="54"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>unless<sp/>we<sp/>have<sp/>been<sp/>instructed<sp/>to</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="55"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!fEnforceBIP68)<sp/>{</highlight></codeline>
<codeline lineno="56"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>std::make_pair(nMinHeight,<sp/>nMinTime);</highlight></codeline>
<codeline lineno="57"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="58"><highlight class="normal"></highlight></codeline>
<codeline lineno="59"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>txinIndex<sp/>=<sp/>0;<sp/>txinIndex<sp/>&lt;<sp/>tx.<ref refid="class_c_transaction_1aaed1b4913ffce3eaaf4c5e13aa09d27f" kindref="member">vin</ref>.size();<sp/>txinIndex++)<sp/>{</highlight></codeline>
<codeline lineno="60"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_c_tx_in" kindref="compound">CTxIn</ref>&amp;<sp/>txin<sp/>=<sp/>tx.<ref refid="class_c_transaction_1aaed1b4913ffce3eaaf4c5e13aa09d27f" kindref="member">vin</ref>[txinIndex];</highlight></codeline>
<codeline lineno="61"><highlight class="normal"></highlight></codeline>
<codeline lineno="62"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Sequence<sp/>numbers<sp/>with<sp/>the<sp/>most<sp/>significant<sp/>bit<sp/>set<sp/>are<sp/>not</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="63"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>treated<sp/>as<sp/>relative<sp/>lock-times,<sp/>nor<sp/>are<sp/>they<sp/>given<sp/>any</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="64"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>consensus-enforced<sp/>meaning<sp/>at<sp/>this<sp/>point.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="65"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(txin.<ref refid="class_c_tx_in_1a226d890a323aa88e91b64ec9e2ab280d" kindref="member">nSequence</ref><sp/>&amp;<sp/><ref refid="class_c_tx_in_1af452e618acb30ed1414042b8ad6895cf" kindref="member">CTxIn::SEQUENCE_LOCKTIME_DISABLE_FLAG</ref>)<sp/>{</highlight></codeline>
<codeline lineno="66"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>The<sp/>height<sp/>of<sp/>this<sp/>input<sp/>is<sp/>not<sp/>relevant<sp/>for<sp/>sequence<sp/>locks</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="67"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>prevHeights[txinIndex]<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="68"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="69"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="70"><highlight class="normal"></highlight></codeline>
<codeline lineno="71"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>nCoinHeight<sp/>=<sp/>prevHeights[txinIndex];</highlight></codeline>
<codeline lineno="72"><highlight class="normal"></highlight></codeline>
<codeline lineno="73"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(txin.<ref refid="class_c_tx_in_1a226d890a323aa88e91b64ec9e2ab280d" kindref="member">nSequence</ref><sp/>&amp;<sp/><ref refid="class_c_tx_in_1aa259003bfb88325b06081ee678fbd0a4" kindref="member">CTxIn::SEQUENCE_LOCKTIME_TYPE_FLAG</ref>)<sp/>{</highlight></codeline>
<codeline lineno="74"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>int64_t<sp/>nCoinTime{<ref refid="check_8h_1acbd5520ad7c4d365ede4ed94b421231b" kindref="member">Assert</ref>(block.<ref refid="class_c_block_index_1ac20120d6b64792647a63d216b26e4b53" kindref="member">GetAncestor</ref>(std::max(nCoinHeight<sp/>-<sp/>1,<sp/>0)))-&gt;GetMedianTimePast()};</highlight></codeline>
<codeline lineno="75"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>NOTE:<sp/>Subtract<sp/>1<sp/>to<sp/>maintain<sp/>nLockTime<sp/>semantics</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="76"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>BIP<sp/>68<sp/>relative<sp/>lock<sp/>times<sp/>have<sp/>the<sp/>semantics<sp/>of<sp/>calculating</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="77"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>the<sp/>first<sp/>block<sp/>or<sp/>time<sp/>at<sp/>which<sp/>the<sp/>transaction<sp/>would<sp/>be</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="78"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>valid.<sp/>When<sp/>calculating<sp/>the<sp/>effective<sp/>block<sp/>time<sp/>or<sp/>height</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="79"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>for<sp/>the<sp/>entire<sp/>transaction,<sp/>we<sp/>switch<sp/>to<sp/>using<sp/>the</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="80"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>semantics<sp/>of<sp/>nLockTime<sp/>which<sp/>is<sp/>the<sp/>last<sp/>invalid<sp/>block</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="81"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>time<sp/>or<sp/>height.<sp/><sp/>Thus<sp/>we<sp/>subtract<sp/>1<sp/>from<sp/>the<sp/>calculated</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="82"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>time<sp/>or<sp/>height.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="83"><highlight class="normal"></highlight></codeline>
<codeline lineno="84"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Time-based<sp/>relative<sp/>lock-times<sp/>are<sp/>measured<sp/>from<sp/>the</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="85"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>smallest<sp/>allowed<sp/>timestamp<sp/>of<sp/>the<sp/>block<sp/>containing<sp/>the</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="86"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>txout<sp/>being<sp/>spent,<sp/>which<sp/>is<sp/>the<sp/>median<sp/>time<sp/>past<sp/>of<sp/>the</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="87"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>block<sp/>prior.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="88"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nMinTime<sp/>=<sp/>std::max(nMinTime,<sp/>nCoinTime<sp/>+<sp/>(int64_t)((txin.<ref refid="class_c_tx_in_1a226d890a323aa88e91b64ec9e2ab280d" kindref="member">nSequence</ref><sp/>&amp;<sp/><ref refid="class_c_tx_in_1a6e4a62e280c00f73cf69e1b9fe5f420d" kindref="member">CTxIn::SEQUENCE_LOCKTIME_MASK</ref>)<sp/>&lt;&lt;<sp/><ref refid="class_c_tx_in_1af3e53090c7ed2023646e1bb85c23998b" kindref="member">CTxIn::SEQUENCE_LOCKTIME_GRANULARITY</ref>)<sp/>-<sp/>1);</highlight></codeline>
<codeline lineno="89"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="90"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nMinHeight<sp/>=<sp/>std::max(nMinHeight,<sp/>nCoinHeight<sp/>+<sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal">)(txin.<ref refid="class_c_tx_in_1a226d890a323aa88e91b64ec9e2ab280d" kindref="member">nSequence</ref><sp/>&amp;<sp/><ref refid="class_c_tx_in_1a6e4a62e280c00f73cf69e1b9fe5f420d" kindref="member">CTxIn::SEQUENCE_LOCKTIME_MASK</ref>)<sp/>-<sp/>1);</highlight></codeline>
<codeline lineno="91"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="92"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="93"><highlight class="normal"></highlight></codeline>
<codeline lineno="94"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>std::make_pair(nMinHeight,<sp/>nMinTime);</highlight></codeline>
<codeline lineno="95"><highlight class="normal">}</highlight></codeline>
<codeline lineno="96"><highlight class="normal"></highlight></codeline>
<codeline lineno="97"><highlight class="normal"></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="tx__verify_8cpp_1ab6bb0246e751e82b8d6e3c97ed88b839" kindref="member">EvaluateSequenceLocks</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_c_block_index" kindref="compound">CBlockIndex</ref>&amp;<sp/>block,<sp/>std::pair&lt;int,<sp/>int64_t&gt;<sp/>lockPair)</highlight></codeline>
<codeline lineno="98"><highlight class="normal">{</highlight></codeline>
<codeline lineno="99"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="validation_8cpp_1afb7ea74ba028421697aa7f364741ee6c" kindref="member">assert</ref>(block.<ref refid="class_c_block_index_1a0265c1d3d6cc413eb1e964b045f3f538" kindref="member">pprev</ref>);</highlight></codeline>
<codeline lineno="100"><highlight class="normal"><sp/><sp/><sp/><sp/>int64_t<sp/>nBlockTime<sp/>=<sp/>block.<ref refid="class_c_block_index_1a0265c1d3d6cc413eb1e964b045f3f538" kindref="member">pprev</ref>-&gt;<ref refid="class_c_block_index_1a11dfc5fcb174cc0d9fab58f7106abcfb" kindref="member">GetMedianTimePast</ref>();</highlight></codeline>
<codeline lineno="101"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(lockPair.first<sp/>&gt;=<sp/>block.<ref refid="class_c_block_index_1a17d981419afeee27eb36a8b43183e49a" kindref="member">nHeight</ref><sp/>||<sp/>lockPair.second<sp/>&gt;=<sp/>nBlockTime)</highlight></codeline>
<codeline lineno="102"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="103"><highlight class="normal"></highlight></codeline>
<codeline lineno="104"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="105"><highlight class="normal">}</highlight></codeline>
<codeline lineno="106"><highlight class="normal"></highlight></codeline>
<codeline lineno="107"><highlight class="normal"></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="tx__verify_8cpp_1ad5b7bf644ada0a55c6aac8cfa89ed14a" kindref="member">SequenceLocks</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_c_transaction" kindref="compound">CTransaction</ref><sp/>&amp;tx,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="bitcoin-tx_8cpp_1ac8bf36fe0577cba66bccda3a6f7e80a4" kindref="member">flags</ref>,<sp/>std::vector&lt;int&gt;&amp;<sp/>prevHeights,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_c_block_index" kindref="compound">CBlockIndex</ref>&amp;<sp/>block)</highlight></codeline>
<codeline lineno="108"><highlight class="normal">{</highlight></codeline>
<codeline lineno="109"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="tx__verify_8cpp_1ab6bb0246e751e82b8d6e3c97ed88b839" kindref="member">EvaluateSequenceLocks</ref>(block,<sp/><ref refid="tx__verify_8cpp_1abc528b150bf26a1644aef9713336dda2" kindref="member">CalculateSequenceLocks</ref>(tx,<sp/><ref refid="bitcoin-tx_8cpp_1ac8bf36fe0577cba66bccda3a6f7e80a4" kindref="member">flags</ref>,<sp/>prevHeights,<sp/>block));</highlight></codeline>
<codeline lineno="110"><highlight class="normal">}</highlight></codeline>
<codeline lineno="111"><highlight class="normal"></highlight></codeline>
<codeline lineno="112"><highlight class="normal"></highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="tx__verify_8cpp_1ad2eaf4f8542c12ea9ee1183609cc6d1a" kindref="member">GetLegacySigOpCount</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_c_transaction" kindref="compound">CTransaction</ref>&amp;<sp/>tx)</highlight></codeline>
<codeline lineno="113"><highlight class="normal">{</highlight></codeline>
<codeline lineno="114"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>nSigOps<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="115"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal">&amp;<sp/>txin<sp/>:<sp/>tx.<ref refid="class_c_transaction_1aaed1b4913ffce3eaaf4c5e13aa09d27f" kindref="member">vin</ref>)</highlight></codeline>
<codeline lineno="116"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="117"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nSigOps<sp/>+=<sp/>txin.<ref refid="class_c_tx_in_1a12bda3b498d6ed110bfb102a19ef5a12" kindref="member">scriptSig</ref>.<ref refid="class_c_script_1a80c50b9db06c9c017f27f2eba801e564" kindref="member">GetSigOpCount</ref>(</highlight><highlight class="keyword">false</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="118"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="119"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal">&amp;<sp/>txout<sp/>:<sp/>tx.<ref refid="class_c_transaction_1ab6db6ccb0e8e9a2442296af044a29d56" kindref="member">vout</ref>)</highlight></codeline>
<codeline lineno="120"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="121"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nSigOps<sp/>+=<sp/>txout.scriptPubKey.GetSigOpCount(</highlight><highlight class="keyword">false</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="122"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="123"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>nSigOps;</highlight></codeline>
<codeline lineno="124"><highlight class="normal">}</highlight></codeline>
<codeline lineno="125"><highlight class="normal"></highlight></codeline>
<codeline lineno="126"><highlight class="normal"></highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="tx__verify_8cpp_1ad6c100c0465bcda555599ecd8e5577b8" kindref="member">GetP2SHSigOpCount</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_c_transaction" kindref="compound">CTransaction</ref>&amp;<sp/>tx,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_c_coins_view_cache" kindref="compound">CCoinsViewCache</ref>&amp;<sp/>inputs)</highlight></codeline>
<codeline lineno="127"><highlight class="normal">{</highlight></codeline>
<codeline lineno="128"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(tx.<ref refid="class_c_transaction_1a6b4def31a0a2fbc975d0087ad2d4391a" kindref="member">IsCoinBase</ref>())</highlight></codeline>
<codeline lineno="129"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0;</highlight></codeline>
<codeline lineno="130"><highlight class="normal"></highlight></codeline>
<codeline lineno="131"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>nSigOps<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="132"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>tx.<ref refid="class_c_transaction_1aaed1b4913ffce3eaaf4c5e13aa09d27f" kindref="member">vin</ref>.size();<sp/>i++)</highlight></codeline>
<codeline lineno="133"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="134"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_coin" kindref="compound">Coin</ref>&amp;<sp/>coin<sp/>=<sp/>inputs.<ref refid="class_c_coins_view_cache_1a87f1f2449e10859291ddbdc1d090cba3" kindref="member">AccessCoin</ref>(tx.<ref refid="class_c_transaction_1aaed1b4913ffce3eaaf4c5e13aa09d27f" kindref="member">vin</ref>[i].prevout);</highlight></codeline>
<codeline lineno="135"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="validation_8cpp_1afb7ea74ba028421697aa7f364741ee6c" kindref="member">assert</ref>(!coin.<ref refid="class_coin_1ae0032141d9e76130a91e97e19eaad1ec" kindref="member">IsSpent</ref>());</highlight></codeline>
<codeline lineno="136"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_c_tx_out" kindref="compound">CTxOut</ref><sp/>&amp;prevout<sp/>=<sp/>coin.<ref refid="class_coin_1adafe93fbab174bb8f09c8a3b9df178fa" kindref="member">out</ref>;</highlight></codeline>
<codeline lineno="137"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(prevout.<ref refid="class_c_tx_out_1ae3e8cf0b02315c479aae11f2b51f83bf" kindref="member">scriptPubKey</ref>.<ref refid="class_c_script_1a4b0e5117708f9c9f449ae68a6ed3ae81" kindref="member">IsPayToScriptHash</ref>())</highlight></codeline>
<codeline lineno="138"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nSigOps<sp/>+=<sp/>prevout.<ref refid="class_c_tx_out_1ae3e8cf0b02315c479aae11f2b51f83bf" kindref="member">scriptPubKey</ref>.<ref refid="class_c_script_1a80c50b9db06c9c017f27f2eba801e564" kindref="member">GetSigOpCount</ref>(tx.<ref refid="class_c_transaction_1aaed1b4913ffce3eaaf4c5e13aa09d27f" kindref="member">vin</ref>[i].scriptSig);</highlight></codeline>
<codeline lineno="139"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="140"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>nSigOps;</highlight></codeline>
<codeline lineno="141"><highlight class="normal">}</highlight></codeline>
<codeline lineno="142"><highlight class="normal"></highlight></codeline>
<codeline lineno="143"><highlight class="normal">int64_t<sp/><ref refid="tx__verify_8cpp_1ac1e236f29c0fd2b8ecee5a2846122151" kindref="member">GetTransactionSigOpCost</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_c_transaction" kindref="compound">CTransaction</ref>&amp;<sp/>tx,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_c_coins_view_cache" kindref="compound">CCoinsViewCache</ref>&amp;<sp/>inputs,<sp/><ref refid="classscript__verify__flags" kindref="compound">script_verify_flags</ref><sp/><ref refid="bitcoin-tx_8cpp_1ac8bf36fe0577cba66bccda3a6f7e80a4" kindref="member">flags</ref>)</highlight></codeline>
<codeline lineno="144"><highlight class="normal">{</highlight></codeline>
<codeline lineno="145"><highlight class="normal"><sp/><sp/><sp/><sp/>int64_t<sp/>nSigOps<sp/>=<sp/><ref refid="tx__verify_8cpp_1ad2eaf4f8542c12ea9ee1183609cc6d1a" kindref="member">GetLegacySigOpCount</ref>(tx)<sp/>*<sp/>WITNESS_SCALE_FACTOR;</highlight></codeline>
<codeline lineno="146"><highlight class="normal"></highlight></codeline>
<codeline lineno="147"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(tx.<ref refid="class_c_transaction_1a6b4def31a0a2fbc975d0087ad2d4391a" kindref="member">IsCoinBase</ref>())</highlight></codeline>
<codeline lineno="148"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>nSigOps;</highlight></codeline>
<codeline lineno="149"><highlight class="normal"></highlight></codeline>
<codeline lineno="150"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="bitcoin-tx_8cpp_1ac8bf36fe0577cba66bccda3a6f7e80a4" kindref="member">flags</ref><sp/>&amp;<sp/><ref refid="interpreter_8h_1adfb2695ade741a5e62728f3586ec1637aeb9561bbd06f9c457e9a44535a261134" kindref="member">SCRIPT_VERIFY_P2SH</ref>)<sp/>{</highlight></codeline>
<codeline lineno="151"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nSigOps<sp/>+=<sp/><ref refid="tx__verify_8cpp_1ad6c100c0465bcda555599ecd8e5577b8" kindref="member">GetP2SHSigOpCount</ref>(tx,<sp/>inputs)<sp/>*<sp/>WITNESS_SCALE_FACTOR;</highlight></codeline>
<codeline lineno="152"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="153"><highlight class="normal"></highlight></codeline>
<codeline lineno="154"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>tx.<ref refid="class_c_transaction_1aaed1b4913ffce3eaaf4c5e13aa09d27f" kindref="member">vin</ref>.size();<sp/>i++)</highlight></codeline>
<codeline lineno="155"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="156"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_coin" kindref="compound">Coin</ref>&amp;<sp/>coin<sp/>=<sp/>inputs.<ref refid="class_c_coins_view_cache_1a87f1f2449e10859291ddbdc1d090cba3" kindref="member">AccessCoin</ref>(tx.<ref refid="class_c_transaction_1aaed1b4913ffce3eaaf4c5e13aa09d27f" kindref="member">vin</ref>[i].prevout);</highlight></codeline>
<codeline lineno="157"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="validation_8cpp_1afb7ea74ba028421697aa7f364741ee6c" kindref="member">assert</ref>(!coin.<ref refid="class_coin_1ae0032141d9e76130a91e97e19eaad1ec" kindref="member">IsSpent</ref>());</highlight></codeline>
<codeline lineno="158"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_c_tx_out" kindref="compound">CTxOut</ref><sp/>&amp;prevout<sp/>=<sp/>coin.<ref refid="class_coin_1adafe93fbab174bb8f09c8a3b9df178fa" kindref="member">out</ref>;</highlight></codeline>
<codeline lineno="159"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nSigOps<sp/>+=<sp/><ref refid="interpreter_8cpp_1a5d5bf87ebcbac564a5d22a3df5d7e9ac" kindref="member">CountWitnessSigOps</ref>(tx.<ref refid="class_c_transaction_1aaed1b4913ffce3eaaf4c5e13aa09d27f" kindref="member">vin</ref>[i].scriptSig,<sp/>prevout.<ref refid="class_c_tx_out_1ae3e8cf0b02315c479aae11f2b51f83bf" kindref="member">scriptPubKey</ref>,<sp/>tx.<ref refid="class_c_transaction_1aaed1b4913ffce3eaaf4c5e13aa09d27f" kindref="member">vin</ref>[i].scriptWitness,<sp/><ref refid="bitcoin-tx_8cpp_1ac8bf36fe0577cba66bccda3a6f7e80a4" kindref="member">flags</ref>);</highlight></codeline>
<codeline lineno="160"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="161"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>nSigOps;</highlight></codeline>
<codeline lineno="162"><highlight class="normal">}</highlight></codeline>
<codeline lineno="163"><highlight class="normal"></highlight></codeline>
<codeline lineno="164"><highlight class="normal"></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="namespace_consensus_1a3dc747e8073036ed753fd2f53d5d1015" kindref="member">Consensus::CheckTxInputs</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_c_transaction" kindref="compound">CTransaction</ref>&amp;<sp/>tx,<sp/><ref refid="class_tx_validation_state" kindref="compound">TxValidationState</ref>&amp;<sp/>state,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_c_coins_view_cache" kindref="compound">CCoinsViewCache</ref>&amp;<sp/>inputs,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>nSpendHeight,<sp/><ref refid="amount_8h_1a4eaf3a5239714d8c45b851527f7cb564" kindref="member">CAmount</ref>&amp;<sp/>txfee)</highlight></codeline>
<codeline lineno="165"><highlight class="normal">{</highlight></codeline>
<codeline lineno="166"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>are<sp/>the<sp/>actual<sp/>inputs<sp/>available?</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="167"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!inputs.<ref refid="class_c_coins_view_cache_1aed3ee6fa10e37a5f22862b45e8abb3b4" kindref="member">HaveInputs</ref>(tx))<sp/>{</highlight></codeline>
<codeline lineno="168"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>state.<ref refid="class_validation_state_1a738c8515139b5b4088c0fccc16978bb1" kindref="member">Invalid</ref>(<ref refid="consensus_2validation_8h_1af79c18cdf56a2455d281427abb70f89fa16d3efb22890f6c8dd36c8e0e81dd796" kindref="member">TxValidationResult::TX_MISSING_INPUTS</ref>,<sp/></highlight><highlight class="stringliteral">&quot;bad-txns-inputs-missingorspent&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="169"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="tinyformat_8h_1a56c674871a61baaad36ad52238c08857" kindref="member">strprintf</ref>(</highlight><highlight class="stringliteral">&quot;%s:<sp/>inputs<sp/>missing/spent&quot;</highlight><highlight class="normal">,<sp/>__func__));</highlight></codeline>
<codeline lineno="170"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="171"><highlight class="normal"></highlight></codeline>
<codeline lineno="172"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="amount_8h_1a4eaf3a5239714d8c45b851527f7cb564" kindref="member">CAmount</ref><sp/>nValueIn<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="173"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>tx.<ref refid="class_c_transaction_1aaed1b4913ffce3eaaf4c5e13aa09d27f" kindref="member">vin</ref>.size();<sp/>++i)<sp/>{</highlight></codeline>
<codeline lineno="174"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_c_out_point" kindref="compound">COutPoint</ref><sp/>&amp;prevout<sp/>=<sp/>tx.<ref refid="class_c_transaction_1aaed1b4913ffce3eaaf4c5e13aa09d27f" kindref="member">vin</ref>[i].prevout;</highlight></codeline>
<codeline lineno="175"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_coin" kindref="compound">Coin</ref>&amp;<sp/>coin<sp/>=<sp/>inputs.<ref refid="class_c_coins_view_cache_1a87f1f2449e10859291ddbdc1d090cba3" kindref="member">AccessCoin</ref>(prevout);</highlight></codeline>
<codeline lineno="176"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="validation_8cpp_1afb7ea74ba028421697aa7f364741ee6c" kindref="member">assert</ref>(!coin.<ref refid="class_coin_1ae0032141d9e76130a91e97e19eaad1ec" kindref="member">IsSpent</ref>());</highlight></codeline>
<codeline lineno="177"><highlight class="normal"></highlight></codeline>
<codeline lineno="178"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>If<sp/>prev<sp/>is<sp/>coinbase,<sp/>check<sp/>that<sp/>it&apos;s<sp/>matured</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="179"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(coin.<ref refid="class_coin_1a6b4def31a0a2fbc975d0087ad2d4391a" kindref="member">IsCoinBase</ref>()<sp/>&amp;&amp;<sp/>nSpendHeight<sp/>-<sp/>coin.<ref refid="class_coin_1a83c6e5c63b15b7acaec51e3bb857fe16" kindref="member">nHeight</ref><sp/>&lt;<sp/>COINBASE_MATURITY)<sp/>{</highlight></codeline>
<codeline lineno="180"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>state.<ref refid="class_validation_state_1a738c8515139b5b4088c0fccc16978bb1" kindref="member">Invalid</ref>(<ref refid="consensus_2validation_8h_1af79c18cdf56a2455d281427abb70f89fa4c15966c8a24612f3cd0214361ee04b9" kindref="member">TxValidationResult::TX_PREMATURE_SPEND</ref>,<sp/></highlight><highlight class="stringliteral">&quot;bad-txns-premature-spend-of-coinbase&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="181"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="tinyformat_8h_1a56c674871a61baaad36ad52238c08857" kindref="member">strprintf</ref>(</highlight><highlight class="stringliteral">&quot;tried<sp/>to<sp/>spend<sp/>coinbase<sp/>at<sp/>depth<sp/>%d&quot;</highlight><highlight class="normal">,<sp/>nSpendHeight<sp/>-<sp/>coin.<ref refid="class_coin_1a83c6e5c63b15b7acaec51e3bb857fe16" kindref="member">nHeight</ref>));</highlight></codeline>
<codeline lineno="182"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="183"><highlight class="normal"></highlight></codeline>
<codeline lineno="184"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Check<sp/>for<sp/>negative<sp/>or<sp/>overflow<sp/>input<sp/>values</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="185"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nValueIn<sp/>+=<sp/>coin.<ref refid="class_coin_1adafe93fbab174bb8f09c8a3b9df178fa" kindref="member">out</ref>.<ref refid="class_c_tx_out_1a2565a2ff256ecf0a445d0fc53180fe07" kindref="member">nValue</ref>;</highlight></codeline>
<codeline lineno="186"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<ref refid="amount_8h_1a12db56a9a1c931941f0943ecbb278aae" kindref="member">MoneyRange</ref>(coin.<ref refid="class_coin_1adafe93fbab174bb8f09c8a3b9df178fa" kindref="member">out</ref>.<ref refid="class_c_tx_out_1a2565a2ff256ecf0a445d0fc53180fe07" kindref="member">nValue</ref>)<sp/>||<sp/>!<ref refid="amount_8h_1a12db56a9a1c931941f0943ecbb278aae" kindref="member">MoneyRange</ref>(nValueIn))<sp/>{</highlight></codeline>
<codeline lineno="187"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>state.<ref refid="class_validation_state_1a738c8515139b5b4088c0fccc16978bb1" kindref="member">Invalid</ref>(<ref refid="consensus_2validation_8h_1af79c18cdf56a2455d281427abb70f89fad623c6a3361887cbd2cf1fe3c2bfb261" kindref="member">TxValidationResult::TX_CONSENSUS</ref>,<sp/></highlight><highlight class="stringliteral">&quot;bad-txns-inputvalues-outofrange&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="188"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="189"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="190"><highlight class="normal"></highlight></codeline>
<codeline lineno="191"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="amount_8h_1a4eaf3a5239714d8c45b851527f7cb564" kindref="member">CAmount</ref><sp/>value_out<sp/>=<sp/>tx.<ref refid="class_c_transaction_1ad325d3d1c0604156775849f0c15ac442" kindref="member">GetValueOut</ref>();</highlight></codeline>
<codeline lineno="192"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(nValueIn<sp/>&lt;<sp/>value_out)<sp/>{</highlight></codeline>
<codeline lineno="193"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>state.<ref refid="class_validation_state_1a738c8515139b5b4088c0fccc16978bb1" kindref="member">Invalid</ref>(<ref refid="consensus_2validation_8h_1af79c18cdf56a2455d281427abb70f89fad623c6a3361887cbd2cf1fe3c2bfb261" kindref="member">TxValidationResult::TX_CONSENSUS</ref>,<sp/></highlight><highlight class="stringliteral">&quot;bad-txns-in-belowout&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="194"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="tinyformat_8h_1a56c674871a61baaad36ad52238c08857" kindref="member">strprintf</ref>(</highlight><highlight class="stringliteral">&quot;value<sp/>in<sp/>(%s)<sp/>&lt;<sp/>value<sp/>out<sp/>(%s)&quot;</highlight><highlight class="normal">,<sp/><ref refid="moneystr_8cpp_1a1ef0729147807284909e10785955672b" kindref="member">FormatMoney</ref>(nValueIn),<sp/><ref refid="moneystr_8cpp_1a1ef0729147807284909e10785955672b" kindref="member">FormatMoney</ref>(value_out)));</highlight></codeline>
<codeline lineno="195"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="196"><highlight class="normal"></highlight></codeline>
<codeline lineno="197"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Tally<sp/>transaction<sp/>fees</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="198"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="amount_8h_1a4eaf3a5239714d8c45b851527f7cb564" kindref="member">CAmount</ref><sp/>txfee_aux<sp/>=<sp/>nValueIn<sp/>-<sp/>value_out;</highlight></codeline>
<codeline lineno="199"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<ref refid="amount_8h_1a12db56a9a1c931941f0943ecbb278aae" kindref="member">MoneyRange</ref>(txfee_aux))<sp/>{</highlight></codeline>
<codeline lineno="200"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>state.<ref refid="class_validation_state_1a738c8515139b5b4088c0fccc16978bb1" kindref="member">Invalid</ref>(<ref refid="consensus_2validation_8h_1af79c18cdf56a2455d281427abb70f89fad623c6a3361887cbd2cf1fe3c2bfb261" kindref="member">TxValidationResult::TX_CONSENSUS</ref>,<sp/></highlight><highlight class="stringliteral">&quot;bad-txns-fee-outofrange&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="201"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="202"><highlight class="normal"></highlight></codeline>
<codeline lineno="203"><highlight class="normal"><sp/><sp/><sp/><sp/>txfee<sp/>=<sp/>txfee_aux;</highlight></codeline>
<codeline lineno="204"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="205"><highlight class="normal">}</highlight></codeline>
    </programlisting>
    <location file="src/consensus/tx_verify.cpp"/>
  </compounddef>
</doxygen>
