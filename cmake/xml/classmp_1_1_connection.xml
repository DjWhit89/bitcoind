<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.15.0" xml:lang="en-US">
  <compounddef id="classmp_1_1_connection" kind="class" language="C++" prot="public">
    <compoundname>mp::Connection</compoundname>
    <includes refid="proxy-io_8h" local="no">proxy-io.h</includes>
    <sectiondef kind="public-attrib">
      <memberdef kind="variable" id="classmp_1_1_connection_1a37b5b5040fdf06491742db64e929dbeb" prot="public" static="no" mutable="no">
        <type><ref refid="classmp_1_1_event_loop_ref" kindref="compound">EventLoopRef</ref></type>
        <definition>EventLoopRef m_loop</definition>
        <argsstring></argsstring>
        <name>m_loop</name>
        <qualifiedname>mp::Connection::m_loop</qualifiedname>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/ipc/libmultiprocess/include/mp/proxy-io.h" line="416" column="18" bodyfile="src/ipc/libmultiprocess/include/mp/proxy-io.h" bodystart="416" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="classmp_1_1_connection_1a826fdcefcc3eae8215a8b1d8628892bc" prot="public" static="no" mutable="no">
        <type>kj::Own&lt; kj::AsyncIoStream &gt;</type>
        <definition>kj::Own&lt;kj::AsyncIoStream&gt; m_stream</definition>
        <argsstring></argsstring>
        <name>m_stream</name>
        <qualifiedname>mp::Connection::m_stream</qualifiedname>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/ipc/libmultiprocess/include/mp/proxy-io.h" line="417" column="13" bodyfile="src/ipc/libmultiprocess/include/mp/proxy-io.h" bodystart="417" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="classmp_1_1_connection_1aa3a0b29328e0fc0ec8b26132feb0fcc5" prot="public" static="no" mutable="no">
        <type><ref refid="classmp_1_1_logging_error_handler" kindref="compound">LoggingErrorHandler</ref></type>
        <definition>LoggingErrorHandler m_error_handler</definition>
        <argsstring></argsstring>
        <name>m_error_handler</name>
        <qualifiedname>mp::Connection::m_error_handler</qualifiedname>
        <initializer>{*<ref refid="classmp_1_1_connection_1a37b5b5040fdf06491742db64e929dbeb" kindref="member">m_loop</ref>}</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/ipc/libmultiprocess/include/mp/proxy-io.h" line="418" column="25" bodyfile="src/ipc/libmultiprocess/include/mp/proxy-io.h" bodystart="418" bodyend="418"/>
      </memberdef>
      <memberdef kind="variable" id="classmp_1_1_connection_1a20da0cbcf16fc5a09b87c061496cb1b1" prot="public" static="no" mutable="no">
        <type>kj::TaskSet</type>
        <definition>kj::TaskSet m_on_disconnect</definition>
        <argsstring></argsstring>
        <name>m_on_disconnect</name>
        <qualifiedname>mp::Connection::m_on_disconnect</qualifiedname>
        <initializer>{<ref refid="classmp_1_1_connection_1aa3a0b29328e0fc0ec8b26132feb0fcc5" kindref="member">m_error_handler</ref>}</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/ipc/libmultiprocess/include/mp/proxy-io.h" line="419" column="17" bodyfile="src/ipc/libmultiprocess/include/mp/proxy-io.h" bodystart="419" bodyend="419"/>
      </memberdef>
      <memberdef kind="variable" id="classmp_1_1_connection_1a54d27701ff67ea0db8ae9e852c274d30" prot="public" static="no" mutable="no">
        <type>::capnp::TwoPartyVatNetwork</type>
        <definition>::capnp::TwoPartyVatNetwork m_network</definition>
        <argsstring></argsstring>
        <name>m_network</name>
        <qualifiedname>mp::Connection::m_network</qualifiedname>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/ipc/libmultiprocess/include/mp/proxy-io.h" line="420" column="33" bodyfile="src/ipc/libmultiprocess/include/mp/proxy-io.h" bodystart="420" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="classmp_1_1_connection_1a67cb43da9e4f67dbc9d6a74a3c301a0e" prot="public" static="no" mutable="no">
        <type>std::optional&lt;::capnp::RpcSystem&lt;::capnp::rpc::twoparty::VatId &gt; &gt;</type>
        <definition>std::optional&lt;::capnp::RpcSystem&lt;::capnp::rpc::twoparty::VatId&gt; &gt; m_rpc_system</definition>
        <argsstring></argsstring>
        <name>m_rpc_system</name>
        <qualifiedname>mp::Connection::m_rpc_system</qualifiedname>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/ipc/libmultiprocess/include/mp/proxy-io.h" line="421" column="19" bodyfile="src/ipc/libmultiprocess/include/mp/proxy-io.h" bodystart="421" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="classmp_1_1_connection_1aa8499cb4f42a4f1fb12b46a450bfc951" prot="public" static="no" mutable="no">
        <type>ThreadMap::Client</type>
        <definition>ThreadMap::Client m_thread_map</definition>
        <argsstring></argsstring>
        <name>m_thread_map</name>
        <qualifiedname>mp::Connection::m_thread_map</qualifiedname>
        <initializer>{nullptr}</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/ipc/libmultiprocess/include/mp/proxy-io.h" line="425" column="23" bodyfile="src/ipc/libmultiprocess/include/mp/proxy-io.h" bodystart="425" bodyend="425"/>
      </memberdef>
      <memberdef kind="variable" id="classmp_1_1_connection_1a1008c41395d28e937364a9806754856c" prot="public" static="no" mutable="no">
        <type>::capnp::CapabilityServerSet&lt; Thread &gt;</type>
        <definition>::capnp::CapabilityServerSet&lt;Thread&gt; m_threads</definition>
        <argsstring></argsstring>
        <name>m_threads</name>
        <qualifiedname>mp::Connection::m_threads</qualifiedname>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Collection of server-side IPC worker threads (<ref refid="structmp_1_1_proxy_server_3_01_thread_01_4" kindref="compound">ProxyServer&lt;Thread&gt;</ref> objects previously returned by ThreadMap.makeThread) used to service requests to clients. </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/ipc/libmultiprocess/include/mp/proxy-io.h" line="429" column="34" bodyfile="src/ipc/libmultiprocess/include/mp/proxy-io.h" bodystart="429" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="classmp_1_1_connection_1ae364219e4df65bbd818bcfada34e4311" prot="public" static="no" mutable="no">
        <type><ref refid="namespacemp_1aa04bf09245b60eb219c446d213cc0390" kindref="member">CleanupList</ref></type>
        <definition>CleanupList m_sync_cleanup_fns</definition>
        <argsstring></argsstring>
        <name>m_sync_cleanup_fns</name>
        <qualifiedname>mp::Connection::m_sync_cleanup_fns</qualifiedname>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Cleanup functions to run if connection is broken unexpectedly. List will be empty if all <ref refid="structmp_1_1_proxy_client" kindref="compound">ProxyClient</ref> are destroyed cleanly before the connection is destroyed. </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/ipc/libmultiprocess/include/mp/proxy-io.h" line="434" column="17" bodyfile="src/ipc/libmultiprocess/include/mp/proxy-io.h" bodystart="434" bodyend="-1"/>
      </memberdef>
    </sectiondef>
    <sectiondef kind="public-func">
      <memberdef kind="function" id="classmp_1_1_connection_1af29bbec879064beec9441a1078bddec3" prot="public" static="no" const="no" explicit="no" inline="yes" virt="non-virtual">
        <type></type>
        <definition>Connection</definition>
        <argsstring>(EventLoop &amp;loop, kj::Own&lt; kj::AsyncIoStream &gt; &amp;&amp;stream_)</argsstring>
        <name>Connection</name>
        <qualifiedname>mp::Connection::Connection</qualifiedname>
        <param>
          <type><ref refid="classmp_1_1_event_loop" kindref="compound">EventLoop</ref> &amp;</type>
          <declname>loop</declname>
        </param>
        <param>
          <type>kj::Own&lt; kj::AsyncIoStream &gt; &amp;&amp;</type>
          <declname>stream_</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/ipc/libmultiprocess/include/mp/proxy-io.h" line="379" column="5" bodyfile="src/ipc/libmultiprocess/include/mp/proxy-io.h" bodystart="379" bodyend="382"/>
      </memberdef>
      <memberdef kind="function" id="classmp_1_1_connection_1a5f5fe74aee9f84ce7c92450be96dc090" prot="public" static="no" const="no" explicit="no" inline="yes" virt="non-virtual">
        <type></type>
        <definition>Connection</definition>
        <argsstring>(EventLoop &amp;loop, kj::Own&lt; kj::AsyncIoStream &gt; &amp;&amp;stream_, const std::function&lt;::capnp::Capability::Client(Connection &amp;)&gt; &amp;make_client)</argsstring>
        <name>Connection</name>
        <qualifiedname>mp::Connection::Connection</qualifiedname>
        <param>
          <type><ref refid="classmp_1_1_event_loop" kindref="compound">EventLoop</ref> &amp;</type>
          <declname>loop</declname>
        </param>
        <param>
          <type>kj::Own&lt; kj::AsyncIoStream &gt; &amp;&amp;</type>
          <declname>stream_</declname>
        </param>
        <param>
          <type>const std::function&lt;::capnp::Capability::Client(Connection &amp;)&gt; &amp;</type>
          <declname>make_client</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/ipc/libmultiprocess/include/mp/proxy-io.h" line="383" column="5" bodyfile="src/ipc/libmultiprocess/include/mp/proxy-io.h" bodystart="383" bodyend="388"/>
      </memberdef>
      <memberdef kind="function" id="classmp_1_1_connection_1a7a3e1a734e64796b393be72275bcb246" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>~Connection</definition>
        <argsstring>()</argsstring>
        <name>~Connection</name>
        <qualifiedname>mp::Connection::~Connection</qualifiedname>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Run cleanup functions. Must be called from the event loop thread. First calls synchronous cleanup functions while blocked (to free capnp Capability::Client handles owned by <ref refid="structmp_1_1_proxy_client" kindref="compound">ProxyClient</ref> objects), then schedules asynchronous cleanup functions to run in a worker thread (to run destructors of m_impl instances owned by <ref refid="structmp_1_1_proxy_server" kindref="compound">ProxyServer</ref> objects). </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/ipc/libmultiprocess/include/mp/proxy-io.h" line="395" column="5" bodyfile="src/ipc/libmultiprocess/src/mp/proxy.cpp" bodystart="83" bodyend="147"/>
      </memberdef>
      <memberdef kind="function" id="classmp_1_1_connection_1ae675a54e813b980ddd62a73db7eb39c4" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="namespacemp_1a5922c1e79ba82f5eb46c5cd0bfc69966" kindref="member">CleanupIt</ref></type>
        <definition>CleanupIt addSyncCleanup</definition>
        <argsstring>(std::function&lt; void()&gt; fn)</argsstring>
        <name>addSyncCleanup</name>
        <qualifiedname>mp::Connection::addSyncCleanup</qualifiedname>
        <param>
          <type>std::function&lt; void()&gt;</type>
          <declname>fn</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Register synchronous cleanup function to run on event loop thread (with access to capnp thread local variables) when disconnect() is called. any new i/o. </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/ipc/libmultiprocess/include/mp/proxy-io.h" line="400" column="15" bodyfile="src/ipc/libmultiprocess/src/mp/proxy.cpp" bodystart="149" bodyend="161"/>
      </memberdef>
      <memberdef kind="function" id="classmp_1_1_connection_1a66043c6fa3b03740d87ba143a21fd683" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void removeSyncCleanup</definition>
        <argsstring>(CleanupIt it)</argsstring>
        <name>removeSyncCleanup</name>
        <qualifiedname>mp::Connection::removeSyncCleanup</qualifiedname>
        <param>
          <type><ref refid="namespacemp_1a5922c1e79ba82f5eb46c5cd0bfc69966" kindref="member">CleanupIt</ref></type>
          <declname>it</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/ipc/libmultiprocess/include/mp/proxy-io.h" line="401" column="10" bodyfile="src/ipc/libmultiprocess/src/mp/proxy.cpp" bodystart="163" bodyend="170"/>
      </memberdef>
      <memberdef kind="function" id="classmp_1_1_connection_1ad80dba71352898ebf4e8f88028ddc7e1" prot="public" static="no" const="no" explicit="no" inline="yes" virt="non-virtual">
        <templateparamlist>
          <param>
            <type>typename F</type>
          </param>
        </templateparamlist>
        <type>void</type>
        <definition>void onDisconnect</definition>
        <argsstring>(F &amp;&amp;f)</argsstring>
        <name>onDisconnect</name>
        <qualifiedname>mp::Connection::onDisconnect</qualifiedname>
        <param>
          <type>F &amp;&amp;</type>
          <declname>f</declname>
        </param>
        <briefdescription>
<para>Add disconnect handler. </para>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/ipc/libmultiprocess/include/mp/proxy-io.h" line="405" column="10" bodyfile="src/ipc/libmultiprocess/include/mp/proxy-io.h" bodystart="405" bodyend="414"/>
      </memberdef>
    </sectiondef>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
<para>Object holding network &amp; rpc state associated with either an incoming server connection, or an outgoing client connection. It must be created and destroyed on the event loop thread. In addition to Cap&apos;n Proto state, it also holds lists of callbacks to run when the connection is closed. </para>
    </detaileddescription>
    <collaborationgraph>
      <node id="4">
        <label>AnnotatedMixin&lt; std::mutex &gt;</label>
        <link refid="class_annotated_mixin"/>
        <childnode refid="5" relation="public-inheritance">
        </childnode>
      </node>
      <node id="1">
        <label>Connection</label>
        <link refid="classmp_1_1_connection"/>
        <childnode refid="2" relation="usage">
          <edgelabel>m_loop</edgelabel>
        </childnode>
        <childnode refid="6" relation="usage">
          <edgelabel>m_error_handler</edgelabel>
        </childnode>
      </node>
      <node id="7">
        <label>ErrorHandler</label>
      </node>
      <node id="3">
        <label>EventLoop</label>
        <link refid="classmp_1_1_event_loop"/>
        <childnode refid="4" relation="usage">
          <edgelabel>m_mutex</edgelabel>
        </childnode>
        <childnode refid="6" relation="usage">
          <edgelabel>m_error_handler</edgelabel>
        </childnode>
        <childnode refid="8" relation="usage">
          <edgelabel>m_log_opts</edgelabel>
        </childnode>
      </node>
      <node id="2">
        <label>EventLoopRef</label>
        <link refid="classmp_1_1_event_loop_ref"/>
        <childnode refid="3" relation="usage">
          <edgelabel>m_loop</edgelabel>
        </childnode>
        <childnode refid="9" relation="usage">
          <edgelabel>m_lock</edgelabel>
        </childnode>
      </node>
      <node id="9">
        <label>Lock</label>
        <link refid="classmp_1_1_lock"/>
      </node>
      <node id="8">
        <label>LogOptions</label>
        <link refid="structmp_1_1_log_options"/>
      </node>
      <node id="6">
        <label>LoggingErrorHandler</label>
        <link refid="classmp_1_1_logging_error_handler"/>
        <childnode refid="7" relation="public-inheritance">
        </childnode>
        <childnode refid="3" relation="usage">
          <edgelabel>m_loop</edgelabel>
        </childnode>
      </node>
      <node id="5">
        <label>mutex</label>
      </node>
    </collaborationgraph>
    <location file="src/ipc/libmultiprocess/include/mp/proxy-io.h" line="376" column="1" bodyfile="src/ipc/libmultiprocess/include/mp/proxy-io.h" bodystart="377" bodyend="435"/>
    <listofallmembers>
      <member refid="classmp_1_1_connection_1ae675a54e813b980ddd62a73db7eb39c4" prot="public" virt="non-virtual"><scope>mp::Connection</scope><name>addSyncCleanup</name></member>
      <member refid="classmp_1_1_connection_1af29bbec879064beec9441a1078bddec3" prot="public" virt="non-virtual"><scope>mp::Connection</scope><name>Connection</name></member>
      <member refid="classmp_1_1_connection_1a5f5fe74aee9f84ce7c92450be96dc090" prot="public" virt="non-virtual"><scope>mp::Connection</scope><name>Connection</name></member>
      <member refid="classmp_1_1_connection_1aa3a0b29328e0fc0ec8b26132feb0fcc5" prot="public" virt="non-virtual"><scope>mp::Connection</scope><name>m_error_handler</name></member>
      <member refid="classmp_1_1_connection_1a37b5b5040fdf06491742db64e929dbeb" prot="public" virt="non-virtual"><scope>mp::Connection</scope><name>m_loop</name></member>
      <member refid="classmp_1_1_connection_1a54d27701ff67ea0db8ae9e852c274d30" prot="public" virt="non-virtual"><scope>mp::Connection</scope><name>m_network</name></member>
      <member refid="classmp_1_1_connection_1a20da0cbcf16fc5a09b87c061496cb1b1" prot="public" virt="non-virtual"><scope>mp::Connection</scope><name>m_on_disconnect</name></member>
      <member refid="classmp_1_1_connection_1a67cb43da9e4f67dbc9d6a74a3c301a0e" prot="public" virt="non-virtual"><scope>mp::Connection</scope><name>m_rpc_system</name></member>
      <member refid="classmp_1_1_connection_1a826fdcefcc3eae8215a8b1d8628892bc" prot="public" virt="non-virtual"><scope>mp::Connection</scope><name>m_stream</name></member>
      <member refid="classmp_1_1_connection_1ae364219e4df65bbd818bcfada34e4311" prot="public" virt="non-virtual"><scope>mp::Connection</scope><name>m_sync_cleanup_fns</name></member>
      <member refid="classmp_1_1_connection_1aa8499cb4f42a4f1fb12b46a450bfc951" prot="public" virt="non-virtual"><scope>mp::Connection</scope><name>m_thread_map</name></member>
      <member refid="classmp_1_1_connection_1a1008c41395d28e937364a9806754856c" prot="public" virt="non-virtual"><scope>mp::Connection</scope><name>m_threads</name></member>
      <member refid="classmp_1_1_connection_1ad80dba71352898ebf4e8f88028ddc7e1" prot="public" virt="non-virtual"><scope>mp::Connection</scope><name>onDisconnect</name></member>
      <member refid="classmp_1_1_connection_1a66043c6fa3b03740d87ba143a21fd683" prot="public" virt="non-virtual"><scope>mp::Connection</scope><name>removeSyncCleanup</name></member>
      <member refid="classmp_1_1_connection_1a7a3e1a734e64796b393be72275bcb246" prot="public" virt="non-virtual"><scope>mp::Connection</scope><name>~Connection</name></member>
    </listofallmembers>
  </compounddef>
</doxygen>
