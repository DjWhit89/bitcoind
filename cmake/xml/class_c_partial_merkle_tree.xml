<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.15.0" xml:lang="en-US">
  <compounddef id="class_c_partial_merkle_tree" kind="class" language="C++" prot="public">
    <compoundname>CPartialMerkleTree</compoundname>
    <derivedcompoundref refid="class_c_partial_merkle_tree_tester" prot="public" virt="non-virtual">CPartialMerkleTreeTester</derivedcompoundref>
    <includes refid="merkleblock_8h" local="no">merkleblock.h</includes>
    <sectiondef kind="protected-attrib">
      <memberdef kind="variable" id="class_c_partial_merkle_tree_1ae7de8ea1a7a4c588af8189287fdc6201" prot="protected" static="no" mutable="no">
        <type>unsigned int</type>
        <definition>unsigned int nTransactions</definition>
        <argsstring></argsstring>
        <name>nTransactions</name>
        <qualifiedname>CPartialMerkleTree::nTransactions</qualifiedname>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>the total number of transactions in the block </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/merkleblock.h" line="60" column="18" bodyfile="src/merkleblock.h" bodystart="60" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="class_c_partial_merkle_tree_1a7c9709e051df2ad000d299a78af27622" prot="protected" static="no" mutable="no">
        <type>std::vector&lt; bool &gt;</type>
        <definition>std::vector&lt;bool&gt; vBits</definition>
        <argsstring></argsstring>
        <name>vBits</name>
        <qualifiedname>CPartialMerkleTree::vBits</qualifiedname>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>node-is-parent-of-matched-txid bits </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/merkleblock.h" line="63" column="17" bodyfile="src/merkleblock.h" bodystart="63" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="class_c_partial_merkle_tree_1afd5b3c85c0d18bdceb71fe8fb6f8e49e" prot="protected" static="no" mutable="no">
        <type>std::vector&lt; <ref refid="classuint256" kindref="compound">uint256</ref> &gt;</type>
        <definition>std::vector&lt;uint256&gt; vHash</definition>
        <argsstring></argsstring>
        <name>vHash</name>
        <qualifiedname>CPartialMerkleTree::vHash</qualifiedname>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>txids and internal hashes </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/merkleblock.h" line="66" column="17" bodyfile="src/merkleblock.h" bodystart="66" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="class_c_partial_merkle_tree_1a3a109f65be8799fe7a141d052247b12e" prot="protected" static="no" mutable="no">
        <type>bool</type>
        <definition>bool fBad</definition>
        <argsstring></argsstring>
        <name>fBad</name>
        <qualifiedname>CPartialMerkleTree::fBad</qualifiedname>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>flag set when encountering invalid data </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/merkleblock.h" line="69" column="10" bodyfile="src/merkleblock.h" bodystart="69" bodyend="-1"/>
      </memberdef>
    </sectiondef>
    <sectiondef kind="protected-func">
      <memberdef kind="function" id="class_c_partial_merkle_tree_1ae19ef079c43ab8f99f3325aa8e66533b" prot="protected" static="no" const="yes" explicit="no" inline="yes" virt="non-virtual">
        <type>unsigned int</type>
        <definition>unsigned int CalcTreeWidth</definition>
        <argsstring>(int height) const</argsstring>
        <name>CalcTreeWidth</name>
        <qualifiedname>CPartialMerkleTree::CalcTreeWidth</qualifiedname>
        <param>
          <type>int</type>
          <declname>height</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>helper function to efficiently calculate the number of nodes at given height in the merkle tree </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/merkleblock.h" line="72" column="18" bodyfile="src/merkleblock.h" bodystart="72" bodyend="74"/>
      </memberdef>
      <memberdef kind="function" id="class_c_partial_merkle_tree_1a44cb7617ef00a4cc5911127a38a62b50" prot="protected" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="classuint256" kindref="compound">uint256</ref></type>
        <definition>uint256 CalcHash</definition>
        <argsstring>(int height, unsigned int pos, const std::vector&lt; Txid &gt; &amp;vTxid)</argsstring>
        <name>CalcHash</name>
        <qualifiedname>CPartialMerkleTree::CalcHash</qualifiedname>
        <param>
          <type>int</type>
          <declname>height</declname>
        </param>
        <param>
          <type>unsigned int</type>
          <declname>pos</declname>
        </param>
        <param>
          <type>const std::vector&lt; <ref refid="transaction__identifier_8h_1ac4bb3c35b94889843d632be4de4b223c" kindref="member">Txid</ref> &gt; &amp;</type>
          <declname>vTxid</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>calculate the hash of a node in the merkle tree (at leaf level: the txid&apos;s themselves) </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/merkleblock.h" line="77" column="13" bodyfile="src/merkleblock.cpp" bodystart="58" bodyend="76"/>
      </memberdef>
      <memberdef kind="function" id="class_c_partial_merkle_tree_1ab47aea83b06ec5714f456fcd5aff2c9a" prot="protected" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void TraverseAndBuild</definition>
        <argsstring>(int height, unsigned int pos, const std::vector&lt; Txid &gt; &amp;vTxid, const std::vector&lt; bool &gt; &amp;vMatch)</argsstring>
        <name>TraverseAndBuild</name>
        <qualifiedname>CPartialMerkleTree::TraverseAndBuild</qualifiedname>
        <param>
          <type>int</type>
          <declname>height</declname>
        </param>
        <param>
          <type>unsigned int</type>
          <declname>pos</declname>
        </param>
        <param>
          <type>const std::vector&lt; <ref refid="transaction__identifier_8h_1ac4bb3c35b94889843d632be4de4b223c" kindref="member">Txid</ref> &gt; &amp;</type>
          <declname>vTxid</declname>
        </param>
        <param>
          <type>const std::vector&lt; bool &gt; &amp;</type>
          <declname>vMatch</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>recursive function that traverses tree nodes, storing the data as bits and hashes </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/merkleblock.h" line="80" column="10" bodyfile="src/merkleblock.cpp" bodystart="79" bodyend="95"/>
      </memberdef>
      <memberdef kind="function" id="class_c_partial_merkle_tree_1a72fb7bea272855071043d8632841ab87" prot="protected" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="classuint256" kindref="compound">uint256</ref></type>
        <definition>uint256 TraverseAndExtract</definition>
        <argsstring>(int height, unsigned int pos, unsigned int &amp;nBitsUsed, unsigned int &amp;nHashUsed, std::vector&lt; Txid &gt; &amp;vMatch, std::vector&lt; unsigned int &gt; &amp;vnIndex)</argsstring>
        <name>TraverseAndExtract</name>
        <qualifiedname>CPartialMerkleTree::TraverseAndExtract</qualifiedname>
        <param>
          <type>int</type>
          <declname>height</declname>
        </param>
        <param>
          <type>unsigned int</type>
          <declname>pos</declname>
        </param>
        <param>
          <type>unsigned int &amp;</type>
          <declname>nBitsUsed</declname>
        </param>
        <param>
          <type>unsigned int &amp;</type>
          <declname>nHashUsed</declname>
        </param>
        <param>
          <type>std::vector&lt; <ref refid="transaction__identifier_8h_1ac4bb3c35b94889843d632be4de4b223c" kindref="member">Txid</ref> &gt; &amp;</type>
          <declname>vMatch</declname>
        </param>
        <param>
          <type>std::vector&lt; unsigned int &gt; &amp;</type>
          <declname>vnIndex</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>recursive function that traverses tree nodes, consuming the bits and hashes produced by TraverseAndBuild. it returns the hash of the respective node and its respective index. </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/merkleblock.h" line="86" column="13" bodyfile="src/merkleblock.cpp" bodystart="98" bodyend="134"/>
      </memberdef>
    </sectiondef>
    <sectiondef kind="public-func">
      <memberdef kind="function" id="class_c_partial_merkle_tree_1a68f5b9086f2550729a0cb48c735873ee" prot="public" static="no" const="no" explicit="no" inline="yes" virt="non-virtual">
        <type></type>
        <definition>SERIALIZE_METHODS</definition>
        <argsstring>(CPartialMerkleTree, obj)</argsstring>
        <name>SERIALIZE_METHODS</name>
        <qualifiedname>CPartialMerkleTree::SERIALIZE_METHODS</qualifiedname>
        <param>
          <type><ref refid="class_c_partial_merkle_tree" kindref="compound">CPartialMerkleTree</ref></type>
        </param>
        <param>
          <type>obj</type>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/merkleblock.h" line="90" column="5" bodyfile="src/merkleblock.h" bodystart="90" bodyend="98"/>
      </memberdef>
      <memberdef kind="function" id="class_c_partial_merkle_tree_1a4f9dfb1095f4785b72f3fe93777e8491" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>CPartialMerkleTree</definition>
        <argsstring>(const std::vector&lt; Txid &gt; &amp;vTxid, const std::vector&lt; bool &gt; &amp;vMatch)</argsstring>
        <name>CPartialMerkleTree</name>
        <qualifiedname>CPartialMerkleTree::CPartialMerkleTree</qualifiedname>
        <param>
          <type>const std::vector&lt; <ref refid="transaction__identifier_8h_1ac4bb3c35b94889843d632be4de4b223c" kindref="member">Txid</ref> &gt; &amp;</type>
          <declname>vTxid</declname>
        </param>
        <param>
          <type>const std::vector&lt; bool &gt; &amp;</type>
          <declname>vMatch</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Construct a partial merkle tree from a list of transaction ids, and a mask that selects a subset of them </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/merkleblock.h" line="101" column="5" bodyfile="src/merkleblock.cpp" bodystart="136" bodyend="148"/>
      </memberdef>
      <memberdef kind="function" id="class_c_partial_merkle_tree_1ad571ebf5b02edce3f6df6553bf4fdf55" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>CPartialMerkleTree</definition>
        <argsstring>()</argsstring>
        <name>CPartialMerkleTree</name>
        <qualifiedname>CPartialMerkleTree::CPartialMerkleTree</qualifiedname>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/merkleblock.h" line="103" column="5" bodyfile="src/merkleblock.cpp" bodystart="150" bodyend="150"/>
      </memberdef>
      <memberdef kind="function" id="class_c_partial_merkle_tree_1ac3b40cbc4e877e7d6f60e6e3581482af" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="classuint256" kindref="compound">uint256</ref></type>
        <definition>uint256 ExtractMatches</definition>
        <argsstring>(std::vector&lt; Txid &gt; &amp;vMatch, std::vector&lt; unsigned int &gt; &amp;vnIndex)</argsstring>
        <name>ExtractMatches</name>
        <qualifiedname>CPartialMerkleTree::ExtractMatches</qualifiedname>
        <param>
          <type>std::vector&lt; <ref refid="transaction__identifier_8h_1ac4bb3c35b94889843d632be4de4b223c" kindref="member">Txid</ref> &gt; &amp;</type>
          <declname>vMatch</declname>
        </param>
        <param>
          <type>std::vector&lt; unsigned int &gt; &amp;</type>
          <declname>vnIndex</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>extract the matching txid&apos;s represented by this partial merkle tree and their respective indices within the partial tree. returns the merkle root, or 0 in case of failure </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/merkleblock.h" line="110" column="13" bodyfile="src/merkleblock.cpp" bodystart="152" bodyend="183"/>
      </memberdef>
      <memberdef kind="function" id="class_c_partial_merkle_tree_1a82539a68083cd0edf23f59201f409810" prot="public" static="no" const="yes" explicit="no" inline="yes" virt="non-virtual">
        <type>unsigned int</type>
        <definition>unsigned int GetNumTransactions</definition>
        <argsstring>() const</argsstring>
        <name>GetNumTransactions</name>
        <qualifiedname>CPartialMerkleTree::GetNumTransactions</qualifiedname>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Get number of transactions the merkle proof is indicating for cross-reference with local blockchain knowledge. </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/merkleblock.h" line="115" column="18" bodyfile="src/merkleblock.h" bodystart="115" bodyend="115"/>
      </memberdef>
    </sectiondef>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
<para>Data structure that represents a partial merkle tree.</para>
<para>It represents a subset of the txid&apos;s of a known block, in a way that allows recovery of the list of txid&apos;s and the merkle root, in an authenticated way.</para>
<para>The encoding works as follows: we traverse the tree in depth-first order, storing a bit for each traversed node, signifying whether the node is the parent of at least one matched leaf txid (or a matched txid itself). In case we are at the leaf level, or this bit is 0, its merkle node hash is stored, and its children are not explored further. Otherwise, no hash is stored, but we recurse into both (or the only) child branch. During decoding, the same depth-first traversal is performed, consuming bits and hashes as they written during encoding.</para>
<para>The serialization is fixed and provides a hard guarantee about the encoded size:</para>
<para>SIZE &lt;= 10 + ceil(32.25*N)</para>
<para>Where N represents the number of leaf nodes of the partial tree. N itself is bounded by:</para>
<para>N &lt;= total_transactions N &lt;= 1 + matched_transactions*tree_height</para>
<para>The serialization format:<itemizedlist>
<listitem><para>uint32 total_transactions (4 bytes)</para>
</listitem><listitem><para>varint number of hashes (1-3 bytes)</para>
</listitem><listitem><para><ref refid="classuint256" kindref="compound">uint256</ref>[] hashes in depth-first order (&lt;= 32*N bytes)</para>
</listitem><listitem><para>varint number of bytes of flag bits (1-3 bytes)</para>
</listitem><listitem><para>byte[] flag bits, packed per 8 in a byte, least significant bit first (&lt;= 2*N-1 bits) The size constraints follow from this. </para>
</listitem></itemizedlist>
</para>
    </detaileddescription>
    <inheritancegraph>
      <node id="1">
        <label>CPartialMerkleTree</label>
        <link refid="class_c_partial_merkle_tree"/>
      </node>
      <node id="2">
        <label>CPartialMerkleTreeTester</label>
        <link refid="class_c_partial_merkle_tree_tester"/>
        <childnode refid="1" relation="public-inheritance">
        </childnode>
      </node>
    </inheritancegraph>
    <location file="src/merkleblock.h" line="56" column="1" bodyfile="src/merkleblock.h" bodystart="57" bodyend="117"/>
    <listofallmembers>
      <member refid="class_c_partial_merkle_tree_1a44cb7617ef00a4cc5911127a38a62b50" prot="protected" virt="non-virtual"><scope>CPartialMerkleTree</scope><name>CalcHash</name></member>
      <member refid="class_c_partial_merkle_tree_1ae19ef079c43ab8f99f3325aa8e66533b" prot="protected" virt="non-virtual"><scope>CPartialMerkleTree</scope><name>CalcTreeWidth</name></member>
      <member refid="class_c_partial_merkle_tree_1a4f9dfb1095f4785b72f3fe93777e8491" prot="public" virt="non-virtual"><scope>CPartialMerkleTree</scope><name>CPartialMerkleTree</name></member>
      <member refid="class_c_partial_merkle_tree_1ad571ebf5b02edce3f6df6553bf4fdf55" prot="public" virt="non-virtual"><scope>CPartialMerkleTree</scope><name>CPartialMerkleTree</name></member>
      <member refid="class_c_partial_merkle_tree_1ac3b40cbc4e877e7d6f60e6e3581482af" prot="public" virt="non-virtual"><scope>CPartialMerkleTree</scope><name>ExtractMatches</name></member>
      <member refid="class_c_partial_merkle_tree_1a3a109f65be8799fe7a141d052247b12e" prot="protected" virt="non-virtual"><scope>CPartialMerkleTree</scope><name>fBad</name></member>
      <member refid="class_c_partial_merkle_tree_1a82539a68083cd0edf23f59201f409810" prot="public" virt="non-virtual"><scope>CPartialMerkleTree</scope><name>GetNumTransactions</name></member>
      <member refid="class_c_partial_merkle_tree_1ae7de8ea1a7a4c588af8189287fdc6201" prot="protected" virt="non-virtual"><scope>CPartialMerkleTree</scope><name>nTransactions</name></member>
      <member refid="class_c_partial_merkle_tree_1a68f5b9086f2550729a0cb48c735873ee" prot="public" virt="non-virtual"><scope>CPartialMerkleTree</scope><name>SERIALIZE_METHODS</name></member>
      <member refid="class_c_partial_merkle_tree_1ab47aea83b06ec5714f456fcd5aff2c9a" prot="protected" virt="non-virtual"><scope>CPartialMerkleTree</scope><name>TraverseAndBuild</name></member>
      <member refid="class_c_partial_merkle_tree_1a72fb7bea272855071043d8632841ab87" prot="protected" virt="non-virtual"><scope>CPartialMerkleTree</scope><name>TraverseAndExtract</name></member>
      <member refid="class_c_partial_merkle_tree_1a7c9709e051df2ad000d299a78af27622" prot="protected" virt="non-virtual"><scope>CPartialMerkleTree</scope><name>vBits</name></member>
      <member refid="class_c_partial_merkle_tree_1afd5b3c85c0d18bdceb71fe8fb6f8e49e" prot="protected" virt="non-virtual"><scope>CPartialMerkleTree</scope><name>vHash</name></member>
    </listofallmembers>
  </compounddef>
</doxygen>
